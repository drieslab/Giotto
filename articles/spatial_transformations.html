<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Giotto">
<title>Spatial Transformations • Giotto</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/JetBrains_Mono-0.4.7/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial Transformations">
<meta property="og:description" content="Giotto">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Giotto</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-get-started">Get started</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-get-started">
    <a class="dropdown-item" href="../articles/installation.html">Giotto Installation</a>
    <a class="dropdown-item" href="../articles/ecosystem.html">Giotto Ecosystem</a>
    <a class="dropdown-item" href="../articles/configuration.html">Giotto Configuration</a>
    <a class="dropdown-item" href="../articles/object_creation.html">Giotto Object Creation</a>
    <a class="dropdown-item" href="../articles/structure.html">Giotto Class Structure</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Documentation</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <h6 class="dropdown-header" data-toc-skip>Seq-Scope</h6>
    <a class="dropdown-item" href="../articles/seqscope_mouse_liver.html">Mouse liver</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Visium</h6>
    <a class="dropdown-item" href="../articles/visium_mouse_kidney.html">Visium Mouse Kidney</a>
    <a class="dropdown-item" href="../articles/visium_mouse_brain.html">Visium Mouse Brain</a>
    <a class="dropdown-item" href="../articles/visium_prostate_integration.html">Visium Prostate Integration</a>
    <a class="dropdown-item" href="../articles/visium_cytassist_lungcancer.html">CytAssist Human Lung Cancer</a>
    <a class="dropdown-item" href="../articles/visium_cytassist_human_glioblastoma.html">CytAssist Multi-omics Human Glioblastoma</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Spatial Genomics</h6>
    <a class="dropdown-item" href="../articles/spatial_genomics_mouse_kidney.html">Mouse Kidney</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Xenium</h6>
    <a class="dropdown-item" href="../articles/xenium_breast_cancer.html">Xenium Human breast cancer</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Nanostring CosMx</h6>
    <a class="dropdown-item" href="../articles/nanostring_cosmx_lung_cancer.html">Nanostring CosMx Subcellular Lung Cancer</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>MERFISH</h6>
    <a class="dropdown-item" href="../articles/merfish_mouse_hypothalamic.html">MERFISH Mouse Hypothalamic Preoptic Region</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Vizgen</h6>
    <a class="dropdown-item" href="../articles/vizgen_mouse_brain.html">Vizgen Mouse Brain Receptor Map</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>seqFISH</h6>
    <a class="dropdown-item" href="../articles/mini_seqfish.html">mini seqFISH</a>
    <a class="dropdown-item" href="../articles/seqfish_cortex.html">SeqFish+ Mouse Cortex Example</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>osmFISH</h6>
    <a class="dropdown-item" href="../articles/osmfish_mouse_ss_cortex.html">osmFISH Mouse SS Cortex</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Resolve Bioscience</h6>
    <a class="dropdown-item" href="../articles/resolve_biosciences.html">Resolve Bioscience Breast Cancer Subcellular</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>CODEX</h6>
    <a class="dropdown-item" href="../articles/codex_mouse_spleen.html">Codex Mouse Spleen</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Single Cell RNA Sequencing</h6>
    <a class="dropdown-item" href="../articles/singlecell_prostate_standard.html">Prostate</a>
    <a class="dropdown-item" href="../articles/singlecell_prostate_integration.html">Prostate Integration</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>Spatial manipulation</h6>
    <a class="dropdown-item" href="../articles/spatial_transformations.html">Spatial transformations</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Image alignment</h6>
    <a class="dropdown-item" href="../articles/image_alignment.html">Image alignment</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Interactive selection</h6>
    <a class="dropdown-item" href="../articles/interactive_selection.html">Interactive selection</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Visualizations</h6>
    <a class="dropdown-item" href="../articles/visualizations.html">Visualizations</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Saving and Loading</h6>
    <a class="dropdown-item" href="../articles/saving_object.html">Saving a Giotto object</a>
    <a class="dropdown-item" href="../articles/saving_plots.html">Saving plots</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Interoperability</h6>
    <a class="dropdown-item" href="../articles/interoperability_anndata.html">AnnData</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Try Giotto in the Cloud</h6>
    <a class="dropdown-item" href="../articles/terra.html">Terra.bio</a>
    <a class="dropdown-item" href="../articles/docker.html">Docker</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <a class="dropdown-item" href="../news/index.html">Changes</a>
    <a class="dropdown-item" href="../articles/presentations.html">Presentations</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/drieslab/Giotto/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Spatial Transformations</h1>
            
            <h4 data-toc-skip class="date">7/28/23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/drieslab/Giotto/blob/HEAD/vignettes/spatial_transformations.Rmd" class="external-link"><code>vignettes/spatial_transformations.Rmd</code></a></small>
      <div class="d-none name"><code>spatial_transformations.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="spatial-object-manipulation">1. Spatial Object Manipulation<a class="anchor" aria-label="anchor" href="#spatial-object-manipulation"></a>
</h2>
<p>Spatial-omics data is defined both by the biological information that
it contains and the way that it maps to space. When assembling and
analyzing a spatial dataset, it may be necessary to spatially manipulate
the data so that they are all in a common coordinate reference frame
where all data is in at the same scaling and rotation, and properly
overlaid.</p>
<p><em>Giotto</em> extends a set of generics from <em>terra</em> in
order to make it simple to figure out where data is in space and to move
it where you need it.</p>
</div>
<div class="section level2">
<h2 id="start-giotto">2. Start Giotto<a class="anchor" aria-label="anchor" href="#start-giotto"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ensure Giotto Suite is installed</span></span>
<span><span class="va">i_p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="st">"Giotto"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">i_p</span><span class="op">)</span> <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"drieslab/Giotto@suite"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://drieslab.github.io/Giotto/">Giotto</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensure Giotto Data is installed</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="st">"GiottoData"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">i_p</span><span class="op">)</span> <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"drieslab/GiottoData"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://drieslab.github.io/GiottoData/">GiottoData</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensure the Python environment for Giotto has been installed</span></span>
<span><span class="va">genv_exists</span> <span class="op">=</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/checkGiottoEnvironment.html">checkGiottoEnvironment</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="va">genv_exists</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># The following command need only be run once to install the Giotto environment</span></span>
<span>  <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/installGiottoEnvironment.html">installGiottoEnvironment</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-mini-giotto-object-example">3. Load mini giotto object example<a class="anchor" aria-label="anchor" href="#load-mini-giotto-object-example"></a>
</h2>
<p>First we will load in the a mini dataset put together from Vizgen’s
Mouse Brain Receptor Map data release. This mini giotto object has been
pre-analyzed and comes with many analyses and data objects attached.
Most of these analyses have been performed on the ‘aggregate’ spatial
unit so we will set it as the active spatial unit in order to default to
it.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">viz</span> <span class="op">&lt;-</span> <span class="fu">GiottoData</span><span class="fu">::</span><span class="fu"><a href="https://drieslab.github.io/GiottoData/reference/loadGiottoMini.html">loadGiottoMini</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">'vizgen'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/activeSpatUnit-generic.html">activeSpatUnit</a></span><span class="op">(</span><span class="va">viz</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'aggregate'</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extract-spatial-info">4. Extract spatial info<a class="anchor" aria-label="anchor" href="#extract-spatial-info"></a>
</h2>
<p>Then we will extract the spatial subobjects that we will use. These
will be all subobjects in Giotto that contain coordinates data or
directly map their data to space.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/getGiottoImage.html">getGiottoImage</a></span><span class="op">(</span><span class="va">viz</span>, image_type <span class="op">=</span> <span class="st">'largeImage'</span>, name <span class="op">=</span> <span class="st">'dapi_z0'</span><span class="op">)</span></span>
<span><span class="va">spat_locs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/getSpatialLocations.html">getSpatialLocations</a></span><span class="op">(</span><span class="va">viz</span><span class="op">)</span></span>
<span><span class="va">spat_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/getSpatialNetwork.html">getSpatialNetwork</a></span><span class="op">(</span><span class="va">viz</span><span class="op">)</span></span>
<span><span class="va">gpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/getFeatureInfo.html">getFeatureInfo</a></span><span class="op">(</span><span class="va">viz</span>, return_giottoPoints <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">gpoly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/getPolygonInfo.html">getPolygonInfo</a></span><span class="op">(</span><span class="va">viz</span>, polygon_name <span class="op">=</span> <span class="st">'aggregate'</span>, return_giottoPolygon <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="defining-bounds-and-extent">5. Defining bounds and extent<a class="anchor" aria-label="anchor" href="#defining-bounds-and-extent"></a>
</h2>
<p>One of the most convenient descriptors of where an object is in space
is its minima and maxima in the coordinate plane, also known as the
boundaries or spatial <strong>extent</strong> of that information. It
can be thought of as bounding box around where your information exists
in space. <em>Giotto</em> incorporates usage of the
<code>SpatExtent</code> class and associated <code>ext()</code> generic
from <em>terra</em> to describe objects spatially.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ext</span><span class="op">(</span><span class="va">image</span><span class="op">)</span>     <span class="co"># giottoLargeImage</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>SpatExtent <span class="sc">:</span> <span class="fl">6400.029</span>, <span class="fl">6900.037</span>, <span class="sc">-</span><span class="fl">5150.007</span>, <span class="sc">-</span><span class="fl">4699.967</span> (xmin, xmax, ymin, ymax)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ext</span><span class="op">(</span><span class="va">spat_locs</span><span class="op">)</span> <span class="co"># spatLocsObj</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>SpatExtent <span class="sc">:</span> <span class="fl">6401.41164725267</span>, <span class="fl">6899.10802819571</span>, <span class="sc">-</span><span class="fl">5146.74746408943</span>, <span class="sc">-</span><span class="fl">4700.32590047134</span> (xmin, xmax, ymin, ymax)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ext</span><span class="op">(</span><span class="va">spat_net</span><span class="op">)</span>  <span class="co"># spatNetObj</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>SpatExtent <span class="sc">:</span> <span class="fl">6401.411647</span>, <span class="fl">6899.108028</span>, <span class="sc">-</span><span class="fl">5146.747464</span>, <span class="sc">-</span><span class="fl">4700.3259</span> (xmin, xmax, ymin, ymax)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ext</span><span class="op">(</span><span class="va">gpoints</span><span class="op">)</span>   <span class="co"># giottoPoints</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>SpatExtent <span class="sc">:</span> <span class="fl">6400.037</span>, <span class="fl">6900.0317</span>, <span class="sc">-</span><span class="fl">5149.9834</span>, <span class="sc">-</span><span class="fl">4699.9785</span> (xmin, xmax, ymin, ymax)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ext</span><span class="op">(</span><span class="va">gpoly</span><span class="op">)</span>     <span class="co"># giottoPolygon</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>SpatExtent <span class="sc">:</span> <span class="fl">6391.46568586489</span>, <span class="fl">6903.57332779812</span>, <span class="sc">-</span><span class="fl">5153.89721175534</span>, <span class="sc">-</span><span class="fl">4694.86823300896</span> (xmin, xmax, ymin, ymax)</span></code></pre></div>
<div class="section level3">
<h3 id="image-extent">5.1 Image extent<a class="anchor" aria-label="anchor" href="#image-extent"></a>
</h3>
<p>With <code>giottoLargeImage</code> objects, you are additionally able
to assign how they map to space using <code>ext()</code>. Note that
modifications performed on one <code>giottoLargeImage</code> are applied
to all references to that object unless <code><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy()</a></code> is used
first.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu">ext</span><span class="op">(</span><span class="va">image</span><span class="op">)</span> <span class="co"># save extent</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/spatial_transformations/unnamed-chunk-5-1.png"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># modify extent</span></span>
<span><span class="fu">ext</span><span class="op">(</span><span class="va">image</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">40</span>,<span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span> <span class="co"># xmin, xmax, ymin, ymax</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/spatial_transformations/unnamed-chunk-5-2.png"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ext</span><span class="op">(</span><span class="va">image</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">e</span> <span class="co"># replace</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="spatial-transformations">6. Spatial Transformations<a class="anchor" aria-label="anchor" href="#spatial-transformations"></a>
</h2>
<p>Commonly used spatial transformations are coordinate translations,
flips, and rotations. <em>Giotto</em> extends generics from
<em>terra</em> through the use of <code><a href="https://drieslab.github.io/GiottoClass/reference/spatShift.html">spatShift()</a></code>
(<code><a href="https://Rdatatable.gitlab.io/data.table/reference/shift.html" class="external-link">shift()</a></code> in <em>terra</em>), <code>flip()</code>, and
<code>spin()</code> respectively.</p>
<div class="section level3">
<h3 id="coordinate-translation">6.1 coordinate translation<a class="anchor" aria-label="anchor" href="#coordinate-translation"></a>
</h3>
<p><code><a href="https://drieslab.github.io/GiottoClass/reference/spatShift.html">spatShift()</a></code> is used for simple coordinate translations.
It takes the params <code>dx</code> and <code>dy</code> for distance to
translate along either axis.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spat_locs</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/spatial_transformations/unnamed-chunk-6-1.png"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/spatShift.html">spatShift</a></span><span class="op">(</span><span class="va">spat_locs</span>, dx <span class="op">=</span> <span class="fl">5e3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/spatial_transformations/unnamed-chunk-6-2.png"></p>
<p>(pay attention to the x coords)</p>
</div>
<div class="section level3">
<h3 id="flip">6.2 flip<a class="anchor" aria-label="anchor" href="#flip"></a>
</h3>
<p><code>flip()</code> will flip the data over a defined line of either
‘vertical’ or ‘horizontal’ symmetry (default is ‘vertical’ with the line
of symmetry being y = 0. The <code>direction</code> param partial
matches for either ‘vertical’ or ‘horizontal’. The <code>y0</code> and
<code>x0</code> params define where the line of symmetry is.</p>
<p>This is useful for assembling datasets where the data is based on
coordinates where the y values increase negatively. This behavior is
different from the default behavior in <em>terra</em> where objects are
flipped over the minima of their extents. This difference is needed
because often, values are defined in reference to the coordinate origin
and any distance away from the axes is meaningful for alignment after
flipping. If the default behavior of flipping over the extent is
desired, NULL can be passed to the relevant <code>y0</code> or
<code>x0</code> param.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rb</span> <span class="op">=</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/getRainbowColors.html">getRainbowColors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gpoly</span>, col <span class="op">=</span> <span class="va">rb</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/spatial_transformations/unnamed-chunk-7-1.png"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">flip</span><span class="op">(</span><span class="va">gpoly</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">rb</span><span class="op">)</span> <span class="co"># flip to positive y</span></span></code></pre></div>
<p><img src="images/spatial_transformations/unnamed-chunk-7-2.png"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">flip</span><span class="op">(</span><span class="va">gpoly</span>, direction <span class="op">=</span> <span class="st">'h'</span>, x0 <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">rb</span><span class="op">)</span> <span class="co"># flip across x = 10000</span></span></code></pre></div>
<p><img src="images/spatial_transformations/unnamed-chunk-7-3.png"></p>
</div>
<div class="section level3">
<h3 id="spin">6.3 spin<a class="anchor" aria-label="anchor" href="#spin"></a>
</h3>
<p><code>spin()</code> allows rotating of vector data through degrees
passed to <code>angle</code> param. The rotation happens about a
coordinate defined by <code>x0</code> and <code>y0</code>. By default
<code>x0</code> and <code>y0</code> are defined as the object
center.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gpoints</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/spatial_transformations/unnamed-chunk-8-1.png"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">spin</span><span class="op">(</span><span class="va">gpoints</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/spatial_transformations/unnamed-chunk-8-2.png"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">spin</span><span class="op">(</span><span class="va">gpoints</span>, angle <span class="op">=</span> <span class="fl">45</span>, x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/spatial_transformations/unnamed-chunk-8-3.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="session-info">7. Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>    R version <span class="dv">4</span>.<span class="fl">2.1</span> (<span class="dv">2022-06-23</span>)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>    Platform<span class="sc">:</span> x86_64<span class="sc">-</span>apple<span class="sc">-</span><span class="fu">darwin17.0</span> (<span class="dv">64</span><span class="sc">-</span>bit)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>    Running under<span class="sc">:</span> macOS Big Sur ... <span class="fl">10.16</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>    Matrix products<span class="sc">:</span> default</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>    BLAS<span class="sc">:</span>   <span class="er">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>R.framework<span class="sc">/</span>Versions<span class="sc">/</span><span class="fl">4.2</span><span class="sc">/</span>Resources<span class="sc">/</span>lib<span class="sc">/</span>libRblas.<span class="fl">0.</span>dylib</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>    LAPACK<span class="sc">:</span> <span class="er">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>R.framework<span class="sc">/</span>Versions<span class="sc">/</span><span class="fl">4.2</span><span class="sc">/</span>Resources<span class="sc">/</span>lib<span class="sc">/</span>libRlapack.dylib</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>    locale<span class="sc">:</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>    [<span class="dv">1</span>] en_US.UTF<span class="dv">-8</span><span class="sc">/</span>en_US.UTF<span class="dv">-8</span><span class="sc">/</span>en_US.UTF<span class="dv">-8</span><span class="sc">/</span>C<span class="sc">/</span>en_US.UTF<span class="dv">-8</span><span class="sc">/</span>en_US.UTF<span class="dv">-8</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>    attached base packages<span class="sc">:</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>    [<span class="dv">1</span>] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>    other attached packages<span class="sc">:</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>    [<span class="dv">1</span>] GiottoData_0.<span class="fl">2.3</span> Giotto_3.<span class="fl">3.1</span>    </span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a>    loaded via a <span class="fu">namespace</span> (and not attached)<span class="sc">:</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a>     [<span class="dv">1</span>] Rcpp_1.<span class="fl">0.11</span>       pillar_1.<span class="fl">9.0</span>      compiler_4.<span class="fl">2.1</span>    tools_4.<span class="fl">2.1</span>      </span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a>     [<span class="dv">5</span>] digest_0.<span class="fl">6.31</span>     scattermore_0<span class="fl">.8</span>   checkmate_2.<span class="fl">2.0</span>   jsonlite_1.<span class="fl">8.4</span>   </span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a>     [<span class="dv">9</span>] evaluate_0<span class="fl">.21</span>     lifecycle_1.<span class="fl">0.3</span>   tibble_3.<span class="fl">2.1</span>      gtable_0.<span class="fl">3.3</span>     </span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a>    [<span class="dv">13</span>] lattice_0<span class="fl">.20</span><span class="dv">-45</span>   png_0<span class="fl">.1</span><span class="dv">-8</span>         pkgconfig_2.<span class="fl">0.3</span>   rlang_1.<span class="fl">1.1</span>      </span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a>    [<span class="dv">17</span>] igraph_1.<span class="fl">4.2</span>      Matrix_1<span class="fl">.5</span><span class="dv">-4</span>      cli_3.<span class="fl">6.1</span>         rstudioapi_0<span class="fl">.14</span>  </span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a>    [<span class="dv">21</span>] parallel_4.<span class="fl">2.1</span>    yaml_2.<span class="fl">3.7</span>        xfun_0<span class="fl">.39</span>         fastmap_1.<span class="fl">1.1</span>    </span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a>    [<span class="dv">25</span>] terra_1<span class="fl">.7</span><span class="dv">-39</span>      withr_2.<span class="fl">5.0</span>       dplyr_1.<span class="fl">1.2</span>       knitr_1<span class="fl">.42</span>       </span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a>    [<span class="dv">29</span>] generics_0.<span class="fl">1.3</span>    vctrs_0.<span class="fl">6.2</span>       rprojroot_2.<span class="fl">0.3</span>   grid_4.<span class="fl">2.1</span>       </span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a>    [<span class="dv">33</span>] tidyselect_1.<span class="fl">2.0</span>  here_1.<span class="fl">0.1</span>        reticulate_1<span class="fl">.28</span>   glue_1.<span class="fl">6.2</span>       </span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a>    [<span class="dv">37</span>] data.table_1.<span class="fl">14.8</span> R6_2.<span class="fl">5.1</span>          fansi_1.<span class="fl">0.4</span>       rmarkdown_2<span class="fl">.21</span>   </span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a>    [<span class="dv">41</span>] ggplot2_3.<span class="fl">4.2</span>     magrittr_2.<span class="fl">0.3</span>    backports_1.<span class="fl">4.1</span>   scales_1.<span class="fl">2.1</span>     </span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a>    [<span class="dv">45</span>] codetools_0<span class="fl">.2</span><span class="dv">-18</span>  htmltools_0.<span class="fl">5.5</span>   colorspace_2<span class="fl">.1</span><span class="dv">-0</span>  utf8_1.<span class="fl">2.3</span>       </span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a>    [<span class="dv">49</span>] munsell_0.<span class="fl">5.0</span>    </span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://www.drieslab.com" class="external-link">Ruben Dries</a>, Jiaji George Chen, Natalie Del Rossi, <a href="https://labs.icahn.mssm.edu/yuanlab/" class="external-link">Guo-Cheng Yuan</a>, Matthew O’Brien, <a href="https://josschavezf.github.io" class="external-link">Joselyn C. Chávez-Fuentes</a>, Edward Ruiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
