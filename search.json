[{"path":[]},{"path":"https://drieslab.github.io/Giotto/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, caste, color, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://drieslab.github.io/Giotto/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://drieslab.github.io/Giotto/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://drieslab.github.io/Giotto/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://drieslab.github.io/Giotto/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported contacting project team rdries@bu.edu. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://drieslab.github.io/Giotto/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://drieslab.github.io/Giotto/CODE_OF_CONDUCT.html","id":"id_1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"https://drieslab.github.io/Giotto/CODE_OF_CONDUCT.html","id":"id_2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://drieslab.github.io/Giotto/CODE_OF_CONDUCT.html","id":"id_3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://drieslab.github.io/Giotto/CODE_OF_CONDUCT.html","id":"id_4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://drieslab.github.io/Giotto/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.1, available https://www.contributor-covenant.org/version/2/1/code_of_conduct.html. Community Impact Guidelines inspired Mozilla’s code conduct enforcement ladder. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"https://drieslab.github.io/Giotto/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"How to Contribute?","title":"How to Contribute?","text":"welcome contributions suggestions developers. Please contact us questions like discuss addition major modifications Giotto main code. source code Giotto Suite may found GitHub repository.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://drieslab.github.io/Giotto/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://drieslab.github.io/Giotto/articles/codex_mouse_spleen.html","id":"set-up-giotto-environment","dir":"Articles","previous_headings":"","what":"Set up Giotto environment","title":"Codex Mouse Spleen","text":"","code":"library(Giotto) library(GiottoData)  # 1. set working directory results_folder = 'path/to/result'  # Optional: Specify a path to a Python executable within a conda or miniconda  # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired."},{"path":"https://drieslab.github.io/Giotto/articles/codex_mouse_spleen.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"Dataset explanation","title":"Codex Mouse Spleen","text":"CODEX data run tutorial can found . Alternatively can use getSpatialDataset automatically download dataset like example. Goltsev et al. created multiplexed datasets normal lupus (MRL/lpr) murine spleens using CODEX technique. dataset consists 30 protein markers 734,101 single cells. tutorial, 83,787 cells sample “BALBc-3” selected analysis.","code":"# download data to working directory # use method = 'wget' if wget is available. This should be much faster. # if you run into authentication issues with wget, then add \" extra = '--no-check-certificate' \" getSpatialDataset(dataset = 'codex_spleen', directory = results_folder, method = 'wget')"},{"path":"https://drieslab.github.io/Giotto/articles/codex_mouse_spleen.html","id":"giotto-global-instructions-and-preparations","dir":"Articles","previous_headings":"","what":"1. Giotto global instructions and preparations","title":"Codex Mouse Spleen","text":"","code":"# 1. (optional) set Giotto instructions instrs = createGiottoInstructions(show_plot = FALSE,                                   save_plot = TRUE,                                   save_dir = results_folder,                                   python_path = my_python_path)  # 2. create giotto object from provided paths #### expr_path = paste0(results_folder, \"codex_BALBc_3_expression.txt.gz\") loc_path = paste0(results_folder, \"codex_BALBc_3_coord.txt\") meta_path = paste0(results_folder, \"codex_BALBc_3_annotation.txt\")"},{"path":"https://drieslab.github.io/Giotto/articles/codex_mouse_spleen.html","id":"create-giotto-object-process-data","dir":"Articles","previous_headings":"","what":"2. Create Giotto object & process data","title":"Codex Mouse Spleen","text":"Show different regions dataset","code":"# read in data information  # expression info codex_expression = readExprMatrix(expr_path, transpose = F) # cell coordinate info codex_locations = data.table::fread(loc_path) # metadata codex_metadata = data.table::fread(meta_path)  ## stitch x.y tile coordinates to global coordinates  xtilespan = 1344; ytilespan = 1008; # TODO: expand the documentation and input format of stitchTileCoordinates. Probably not enough information for new users. stitch_file = stitchTileCoordinates(location_file = codex_metadata,                                     Xtilespan = xtilespan,                                     Ytilespan = ytilespan) codex_locations = stitch_file[,.(Xcoord, Ycoord)]  # create Giotto object codex_test <- createGiottoObject(expression = codex_expression,                                   spatial_locs = codex_locations,                                  instructions = instrs) codex_metadata$cell_ID<- as.character(codex_metadata$cellID) codex_test<-addCellMetadata(codex_test, new_metadata = codex_metadata,                            by_column = T,                            column_cell_ID = \"cell_ID\") # subset Giotto object cell_meta = pDataDT(codex_test) cell_IDs_to_keep = cell_meta[Imaging_phenotype_cell_type != \"dirt\" & Imaging_phenotype_cell_type != \"noid\" & Imaging_phenotype_cell_type != \"capsule\",]$cell_ID codex_test = subsetGiotto(codex_test,                           cell_ids = cell_IDs_to_keep)  ## filter codex_test <- filterGiotto(gobject = codex_test,                            expression_threshold = 1,                            feat_det_in_min_cells = 10,                            min_det_feats_per_cell = 2,                            expression_values = c('raw'),                            verbose = T)  codex_test <- normalizeGiotto(gobject = codex_test,                               scalefactor = 6000,                               verbose = T,                               log_norm = FALSE,                               library_size_norm = FALSE,                               scale_feats = FALSE,                               scale_cells = TRUE)  ## add gene & cell statistics codex_test <- addStatistics(gobject = codex_test,expression_values = \"normalized\")  ## adjust expression matrix for technical or known variables codex_test <- adjustGiottoMatrix(gobject = codex_test,                                   expression_values = c('normalized'),                                  batch_columns = 'sample_Xtile_Ytile',                                   covariate_columns = NULL,                                  return_gobject = TRUE,                                  update_slot = c('custom'))  ## visualize spatPlot(gobject = codex_test,point_size = 0.1,           coord_fix_ratio = NULL,point_shape = 'no_border',          save_param = list(save_name = '2_a_spatPlot')) spatPlot(gobject = codex_test,          point_size = 0.2,          coord_fix_ratio = 1,          cell_color = 'sample_Xtile_Ytile',          legend_symbol_size = 3,          legend_text = 5,          save_param = list(save_name = '2_b_spatPlot'))"},{"path":"https://drieslab.github.io/Giotto/articles/codex_mouse_spleen.html","id":"dimension-reduction","dir":"Articles","previous_headings":"","what":"3. Dimension reduction","title":"Codex Mouse Spleen","text":"","code":"# use all Abs  # PCA codex_test <- runPCA(gobject = codex_test,                      expression_values = 'normalized',                      scale_unit = T,                      method = \"factominer\") signPCA(codex_test,         scale_unit = T,         scree_ylim = c(0, 3),         save_param = list(save_name = '3_a_spatPlot')) plotPCA(gobject = codex_test,         point_shape = 'no_border',         point_size = 0.2,         save_param = list(save_name = '3_b_PCA')) # UMAP codex_test <- runUMAP(codex_test,                       dimensions_to_use = 1:14,                       n_components = 2,                       n_threads = 12) plotUMAP(gobject = codex_test,          point_shape = 'no_border',          point_size = 0.2,          save_param = list(save_name = '3_c_UMAP'))"},{"path":"https://drieslab.github.io/Giotto/articles/codex_mouse_spleen.html","id":"cluster","dir":"Articles","previous_headings":"","what":"4. Cluster","title":"Codex Mouse Spleen","text":"","code":"## sNN network (default) codex_test <- createNearestNetwork(gobject = codex_test,                                    dimensions_to_use = 1:14,                                    k = 20)  ## 0.1 resolution codex_test <- doLeidenCluster(gobject = codex_test,                               resolution = 0.5,                               n_iterations = 100,                               name = 'leiden')  codex_metadata = pDataDT(codex_test) leiden_colors = GiottogetDistinctColors(length(unique(codex_metadata$leiden))) names(leiden_colors) = unique(codex_metadata$leiden)  plotUMAP(gobject = codex_test,           cell_color = 'leiden',          point_shape = 'no_border',          point_size = 0.2,          cell_color_code = leiden_colors,          save_param = list(save_name = '4_a_UMAP')) spatPlot(gobject = codex_test,          cell_color = 'leiden',          point_shape = 'no_border',          point_size = 0.2,           cell_color_code = leiden_colors,          coord_fix_ratio = 1,          label_size =2,          legend_text = 5,          legend_symbol_size = 2,          save_param = list(save_name = '4_b_spatplot'))"},{"path":"https://drieslab.github.io/Giotto/articles/codex_mouse_spleen.html","id":"co-visualize","dir":"Articles","previous_headings":"","what":"5. Co-visualize","title":"Codex Mouse Spleen","text":"","code":"spatDimPlot2D(gobject = codex_test,               cell_color = 'leiden',               spat_point_shape = 'no_border',                spat_point_size = 0.2,               dim_point_shape = 'no_border',               dim_point_size = 0.2,                cell_color_code = leiden_colors,               plot_alignment = c(\"horizontal\"),               save_param = list(save_name = '5_a_spatdimplot'))"},{"path":"https://drieslab.github.io/Giotto/articles/codex_mouse_spleen.html","id":"differential-expression","dir":"Articles","previous_headings":"","what":"6. Differential expression","title":"Codex Mouse Spleen","text":"","code":"cluster_column = 'leiden' markers_scran = findMarkers_one_vs_all(gobject=codex_test,                                        method=\"scran\",                                        expression_values=\"normalized\",                                        cluster_column=cluster_column,                                        min_feats=3) markergenes_scran = unique(markers_scran[, head(.SD, 5), by=\"cluster\"][[\"feats\"]])  plotMetaDataHeatmap(codex_test,                     expression_values = \"normalized\",                     metadata_cols = c(cluster_column),                      selected_feats = markergenes_scran,                     y_text_size = 8,                     show_values = 'zscores_rescaled',                     save_param = list(save_name = '6_a_metaheatmap')) topgenes_scran = markers_scran[, head(.SD, 1), by = 'cluster']$feats violinPlot(codex_test,            feats = unique(topgenes_scran)[1:8],            cluster_column = cluster_column,            strip_text = 8,            strip_position = 'right',            save_param = list(save_name = '6_b_violinplot')) # gini markers_gini = findMarkers_one_vs_all(gobject = codex_test,                                       method = \"gini\",                                       expression_values = \"normalized\",                                       cluster_column = cluster_column,                                       min_feats=5)  markergenes_gini = unique(markers_gini[, head(.SD, 5), by = \"cluster\"][[\"feats\"]])  plotMetaDataHeatmap(codex_test,                     expression_values = \"normalized\",                      metadata_cols = c(cluster_column),                     selected_feats = markergenes_gini,                     show_values = 'zscores_rescaled',                     save_param = list(save_name = '6_c_metaheatmap')) topgenes_gini = markers_gini[, head(.SD, 1), by = 'cluster']$feats violinPlot(codex_test,            feats = unique(topgenes_gini),            cluster_column = cluster_column,            strip_text = 8,            strip_position = 'right',            save_param = list(save_name = '6_d_violinplot'))"},{"path":"https://drieslab.github.io/Giotto/articles/codex_mouse_spleen.html","id":"cell-type-annotation","dir":"Articles","previous_headings":"","what":"7. Cell type annotation","title":"Codex Mouse Spleen","text":", dataset comes imaging phenotype annotation","code":"clusters_cell_types<-c(\"naive B cells\",\"B cells\",\"B cells\",\"naive B cells\",\"B cells\",                        \"macrophages\",\"erythroblasts\",\"erythroblasts\",\"erythroblasts\",\"CD8 + T cells\",                        \"Naive T cells\",\"CD4+ T cells\",\"Naive T cells\", \"CD4+ T cells\",\"Dendritic cells\",                        \"NK cells\",\"Dendritic cells\",\"Plasma cells\",\"endothelial cells\",\"monocytes\")  names(clusters_cell_types) = c(2,15,13,5,8,9,19,1,10,3,12,14,4,6,7,16,17,18,11,20)  codex_test = annotateGiotto(gobject = codex_test,                             annotation_vector = clusters_cell_types,                             cluster_column = 'leiden', name = 'cell_types')  plotUMAP(gobject = codex_test,          cell_color = 'cell_types',          point_shape = 'no_border',          point_size = 0.2,          show_center_label = F,          label_size = 2,          legend_text = 5,          legend_symbol_size = 2,          save_param = list(save_name = '7_a_umap_celltypes')) plotUMAP(gobject = codex_test,          cell_color = 'Imaging_phenotype_cell_type',          point_shape = 'no_border',          point_size = 0.2,          show_center_label = F,          label_size = 2,          legend_text = 5,          legend_symbol_size = 2,          save_param = list(save_name = '7_b_umap')) spatPlot(gobject = codex_test,          cell_color = 'Imaging_phenotype_cell_type',          point_shape = 'no_border',          point_size = 0.2,           coord_fix_ratio = 1,          label_size = 2,          legend_text = 5,          legend_symbol_size = 2,          save_param = list(save_name = '7_c_spatplot'))"},{"path":"https://drieslab.github.io/Giotto/articles/codex_mouse_spleen.html","id":"visualize-cell-types-and-gene-expression-in-selected-zones","dir":"Articles","previous_headings":"","what":"8. Visualize cell types and gene expression in selected zones","title":"Codex Mouse Spleen","text":"Test another region:","code":"cell_metadata = pDataDT(codex_test) subset_cell_ids = cell_metadata[sample_Xtile_Ytile==\"BALBc-3_X04_Y08\"]$cell_ID  codex_test_zone1 = subsetGiotto(codex_test,                                 cell_ids = subset_cell_ids)  plotUMAP(gobject = codex_test_zone1,           cell_color = 'Imaging_phenotype_cell_type',          point_shape = 'no_border',          point_size = 1,          show_center_label = F,          label_size = 2,          legend_text = 5,          legend_symbol_size = 2,          save_param = list(save_name = '8_a_umap')) spatPlot(gobject = codex_test_zone1,           cell_color = 'Imaging_phenotype_cell_type',          point_shape = 'no_border',          point_size = 1,           coord_fix_ratio = 1,          label_size = 2,          legend_text = 5,          legend_symbol_size = 2,          save_param = list(save_name = '8_b_spatplot')) spatDimFeatPlot2D(codex_test_zone1,                  expression_values = 'scaled',                 feats = c(\"CD8a\",\"CD19\"),                 spat_point_shape = 'no_border',                 dim_point_shape = 'no_border',                 cell_color_gradient = c(\"darkblue\", \"white\", \"red\"),                 save_param = list(save_name = '8_c_spatdimplot')) cell_metadata = pDataDT(codex_test) subset_cell_ids = cell_metadata[sample_Xtile_Ytile==\"BALBc-3_X04_Y03\"]$cell_ID  codex_test_zone2 = subsetGiotto(codex_test, cell_ids = subset_cell_ids)  plotUMAP(gobject = codex_test_zone2,          cell_color = 'Imaging_phenotype_cell_type',          point_shape = 'no_border',          point_size = 1,          show_center_label = F,          label_size = 2,          legend_text = 5,          legend_symbol_size = 2,          save_param = list(save_name = '8_d_umap')) spatPlot(gobject = codex_test_zone2,          cell_color = 'Imaging_phenotype_cell_type',          point_shape = 'no_border',          point_size = 1,           coord_fix_ratio = 1,          label_size = 2,          legend_text = 5,          legend_symbol_size = 2,          save_param = list(save_name = '8_e_spatPlot')) spatDimFeatPlot2D(codex_test_zone2,                  expression_values = 'scaled',                 feats = c(\"CD4\", \"CD106\"),                 spat_point_shape = 'no_border',                 dim_point_shape = 'no_border',                 cell_color_gradient = c(\"darkblue\", \"white\", \"red\"),                 save_param = list(save_name = '8_f_spatdimgeneplot'))"},{"path":"https://drieslab.github.io/Giotto/articles/configuration.html","id":"configuring-the-giotto-environment","dir":"Articles","previous_headings":"","what":"1. Configuring the Giotto Environment","title":"Giotto Configuration","text":"Giotto contains several functions contain wrappers Python code thus requires environment containing Python. Utilizing functionality reticulate package, Giotto contains function sets miniconda environment installs required Python packages within environment. function, installGiottoEnvironment, run, Giotto automatically default utilizing environment.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/configuration.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"2. Start Giotto","title":"Giotto Configuration","text":"function installGiottoEnvironment two particular arguments useful reinstallation, necessary: force_miniconda: force reinstallation miniconda, default FALSE force_environment: force reinstallation Giotto environment, default FALSE Note , default, installGiottoEnvironment installs specific version Python required package. time tutorial’s creation, following versions utilized: Python 3.10.2 pandas 1.5.1 networkx 2.8.8 python-igraph 0.10.2 leidenalg 0.9.0 python-louvain 0.16 python.app (Mac ) 1.4 scikit-learn 1.1.3 smfishHmrf 1.3.3","code":"# Ensure Giotto Suite is installed if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") }  library(Giotto)  # Ensure Giotto Data is installed if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") }  library(GiottoData)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/configuration.html","id":"customizing-the-giotto-installation","dir":"Articles","previous_headings":"","what":"3. Customizing the Giotto Installation","title":"Giotto Configuration","text":"different versions Python packages necessary workflow, Giotto may installed accordingly. Ensure required packages, listed , accounted installing. Simply specify desired version numbers package within vector, provide vector packages_to_install argument within installGiottoEnvironment. Note machine type relevant providing packages_to_install installGiottoEnvironment; function identify OS use install/install packages (.e. python.app) accordingly.","code":"### Note that the following code has been provided to indicate how to install ### Giotto with customized Python and Python package versions. It has been  ### intentionally commented out so that it will not run and overwrite the  ### default versions unless deliberately edited.  ### new_pkg_versions <- c('pandas==1.4.4', ###                       'networkx==2.6.3', ###                       'python-igraph==0.9.6', ###                       'leidenalg==0.8.7', ###                       'python-louvain==0.15', ###                       'scikit-learn==0.24.2', ###                       'python.app==2') ###  ### ############################ ### # If altering the original Giotto Installation is not desired, DO NOT ### # run the following command as written. ### ############################ ### installGiottoEnvironment(packages_to_install = new_pkg_versions, ###                          python_version = '3.8') # Default is 3.10.2"},{"path":"https://drieslab.github.io/Giotto/articles/configuration.html","id":"advanced-using-a-non-default-conda-environment-with-giotto","dir":"Articles","previous_headings":"","what":"4. Advanced: Using a non-default Conda Environment with Giotto","title":"Giotto Configuration","text":"using reticulate's default miniconda path create environment undesirable, Giotto environment may created within existing anaconda/miniconda environment specifying mini_install_path argument: provided, chosen reticulate::install_miniconda(). Please note required input format: - Correct format: mini_install_path = “C://conda/lives/” “C:\\\\conda\\lives\\” - INCORRECT formats: mini_install_path = “C://conda/lives//” “C:\\\\conda\\lives\\\\” Unexpected behavior arise force_miniconda set TRUE mini_install_path specified encompasses non-reticulate environment, prompts reticulate miniconda installation. Note installation aforementioned packages necessary full functionality Giotto. .yml file provided repository convenience alternative installation methods. desired environment named “giotto_env”, Giotto unable automatically detect conda environment, must specified within workflow. use specific, non-default named Conda environment, path system-specific python executable within environment must provided createGiottoInstructions. direct reticulate activate utilize environment within R session. See Create Giotto Object details.","code":"installGiottoEnvironment(mini_install_path = \"C:/my/conda/lives/here\")"},{"path":"https://drieslab.github.io/Giotto/articles/configuration.html","id":"package-accessibility","dir":"Articles","previous_headings":"","what":"5. Package Accessibility","title":"Giotto Configuration","text":"Giotto makes use following Python packages (respective dependencies) full functionality: pandas networkx python-igraph leidenalg python-louvain python.app (Mac ) scikit-learn smfishHmrf brief troubleshooting workflow investigate reticulate can access . Note “community” “sklearn” aliases “python-louvain” “scikit-learn”, respectively.","code":"# Creating Giotto Instructions without specifying a Python path will make  # reticulate activate the default Giotto environment.  default_instrs <- createGiottoInstructions()  # Extract python path information default_python_path <- default_instrs$python_path  # Make reticulate iteratively check for the packages pkg_check <- function(){   py_pkgs = c('pandas','networkx', 'igraph', 'leidenalg','community','sklearn','python.app')   py_pkg_error = character()   test_availability = TRUE      for (i in py_pkgs){     if(i == 'python.app' & Sys.info()[['sysname']] != \"Darwin\"){       # If the machine OS is not OSX (Mac), break out of the loop       # Otherwise, also check for python.app       break     }     test_availability <- reticulate::py_module_available(i)     if(!test_availability) {py_pkg_error <- c(py_pkg_error,i)}   }      if(test_availability){     cat('All Python packages for Giotto are accessible at environment:\\n', default_python_path)   }else{     for (x in py_pkg_error) cat(x,'was not found within environment:\\n',default_python_path,'\\n\\n')   }      return(py_pkg_error) }  pkg_check()"},{"path":"https://drieslab.github.io/Giotto/articles/configuration.html","id":"troubleshooting-packages-not-found","dir":"Articles","previous_headings":"","what":"6. Troubleshooting Packages not Found","title":"Giotto Configuration","text":"fix issue hand, potential action items: Remove attempt reinstall Giotto environment. Run removeGiottoEnvironment, terminate R. Open completely new R session, run installGiottoEnvironment Post issue Giotto GitHub page . Please include version numbers R, Giotto, OS use time issue.","code":"# Restart the R session, while maintaining workspace variables. # If using RStudio, the following command will do exactly that: .rs.restartR()  # Direct reticulate to use Python within the Giotto Environment reticulate::use_python(default_python_path)  # Check if packages exist again. Ensure function from above code block is defined. missing_packages <- pkg_check()  retry_install <- length(missing_packages) > 0  if(retry_install){      # Attempt to reinstall all packages.   pkgs_w_versions <- c('pandas==1.5.1',                        'networkx==2.8.8',                        'python-igraph==0.10.2',                        'leidenalg==0.9.0',                        'python-louvain==0.16',                        'python.app==1.4',                        'scikit-learn==1.1.3')      python_version = \"3.10.2\"      py_pkgs = c('pandas','networkx',               'igraph', 'leidenalg',               'python-louvain','scikit-learn','python.app')      if(Sys.info()[['sysname']] != \"Darwin\"){     pkgs_w_versions = pkgs_w_versions[!grepl(pattern = 'python.app', x = pkgs_w_versions)]     py_pkgs = py_pkgs[!grepl(pattern = 'python.app', x = py_pkgs)]   }      env_location <- reticulate::py_discover_config()$pythonhome   partial_path_to_conda <- paste0(reticulate::miniconda_path(),'/envs/giotto_env')      py_lou = pkgs_w_versions[grepl(pattern = 'python-louvain',x = pkgs_w_versions)]   pip_packages = c(\"smfishhmrf\", py_lou)   pkgs_w_versions = pkgs_w_versions[!grepl(pattern = 'python-louvain',x = pkgs_w_versions)]      if(.Platform[['OS.type']] == 'unix') {          conda_full_path = paste0(partial_conda_path,'/','bin/conda')          # Remove all previous installations     reticulate::conda_remove(envname = env_location,                              packages = py_pkgs,                              conda = conda_full_path)          # Reinstall     reticulate::conda_install(packages = pkgs_w_versions,                               envname = env_location,                               method = 'conda',                               conda = conda_full_path,                               python_version = python_version)          # Reinstall with pip     reticulate::conda_install(packages = pip_packages,                               envname = env_location,                               method = 'conda',                               conda = conda_full_path,                               pip = TRUE,                               python_version = python_version)   }   else if(.Platform[['OS.type']] == 'windows'){     conda_full_path = paste0(partial_conda_path,'/','condabin/conda.bat')          # Remove all previous installations     reticulate::conda_remove(envname = env_location,                              packages = py_pkgs,                              conda = conda_full_path)          # Reinstall     reticulate::conda_install(packages = pkgs_w_versions,                               envname = env_location,                               method = 'conda',                               conda = conda_full_path,                               python_version = python_version,                               channel = c('conda-forge', 'vtraag'))          # Reinstall with pip     reticulate::conda_install(packages = pip_packages,                               envname = env_location,                               method = 'conda',                               conda = conda_full_path,                               pip = TRUE,                               python_version = python_version)   } }"},{"path":"https://drieslab.github.io/Giotto/articles/configuration.html","id":"session-info","dir":"Articles","previous_headings":"","what":"7. Session Info","title":"Giotto Configuration","text":"","code":"sessionInfo() R version 4.2.2 (2022-10-31 ucrt) Platform: x86_64-w64-mingw32/x64 (64-bit) Running under: Windows 10 x64 (build 22621)  Matrix products: default  locale: [1] LC_COLLATE=English_United States.utf8  [2] LC_CTYPE=English_United States.utf8    [3] LC_MONETARY=English_United States.utf8 [4] LC_NUMERIC=C                           [5] LC_TIME=English_United States.utf8      attached base packages: [1] stats     graphics  grDevices utils     datasets  methods   base       other attached packages: [1] GiottoData_0.1.0 Giotto_3.2.1      loaded via a namespace (and not attached): [1] Rcpp_1.0.10       pillar_1.9.0      compiler_4.2.2    tools_4.2.2       [5] digest_0.6.30     jsonlite_1.8.3    evaluate_0.20     lifecycle_1.0.3   [9] tibble_3.2.1      gtable_0.3.3      lattice_0.20-45   png_0.1-7         [13] pkgconfig_2.0.3   rlang_1.1.0       Matrix_1.5-1      cli_3.4.1         [17] rstudioapi_0.14   parallel_4.2.2    yaml_2.3.7        xfun_0.38         [21] fastmap_1.1.0     terra_1.7-18      dplyr_1.1.1       knitr_1.42        [25] rappdirs_0.3.3    generics_0.1.3    vctrs_0.6.1       grid_4.2.2        [29] tidyselect_1.2.0  reticulate_1.26   glue_1.6.2        data.table_1.14.6 [33] R6_2.5.1          fansi_1.0.4       rmarkdown_2.21    ggplot2_3.4.1     [37] magrittr_2.0.3    scales_1.2.1      codetools_0.2-18  htmltools_0.5.4   [41] colorspace_2.1-0  utf8_1.2.3        munsell_0.5.0"},{"path":"https://drieslab.github.io/Giotto/articles/docker.html","id":"docker-image-with-rstudio","dir":"Articles","previous_headings":"","what":"1. Docker Image with RStudio","title":"Docker images","text":"set Docker Image linked RStudio Giotto pre-installed.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/docker.html","id":"instructions","dir":"Articles","previous_headings":"1. Docker Image with RStudio","what":"Instructions","title":"Docker images","text":"Follow instructions create Docker container run Giotto: docker pull giottopackage/rstudio_suite_modular:latest may use port long use. can set password whatever like. yourport either 8787 port assigned step 2. Username: rstudio Note: password enter whatever declared step 2. library(Giotto) Now can run analysis Giotto!","code":""},{"path":"https://drieslab.github.io/Giotto/articles/docker.html","id":"docker-image-with-bash-terminal","dir":"Articles","previous_headings":"","what":"2. Docker Image with bash terminal","title":"Docker images","text":"prefer run analysis directly terminal, set Docker Image able run bash environment.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/docker.html","id":"instructions-1","dir":"Articles","previous_headings":"2. Docker Image with bash terminal","what":"Instructions","title":"Docker images","text":"Follow instructions create Docker container run Giotto: docker pull giottopackage/suite_modular:latest docker run -ti giottopackage/suite_modular:latest /bin/bash R library(Giotto) Now can run analysis Giotto!","code":""},{"path":"https://drieslab.github.io/Giotto/articles/ecosystem.html","id":"explanation","dir":"Articles","previous_headings":"","what":"1. Explanation","title":"Giotto Ecosystem","text":"plan curate ecosystem different, related packages modularize Giotto Suite extend functionalities. , detail different helper module(s) within Giotto Ecosystem.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/ecosystem.html","id":"giottodata","dir":"Articles","previous_headings":"","what":"2. GiottoData","title":"Giotto Ecosystem","text":"package depends Giotto Suite leverages various functions within saving loading Giotto objects. contains dataset helper functions loadGiottoMini() getSpatialDataset(). Note getSpatialDataset() moved Giotto Suite GiottoData! addition dataset helpers, created mini Giotto Objects testing Giotto Suite’s capabilities rapidly streamlining tutorial experience. GiottoData currently includes two mini Giotto Objects derived Vizgen Visium data; mini Giotto Objects published future. , include mini objects, S4 subobjects Giotto Object (.e. exprObj), effort make Giotto Object structure transparent possible. GiottoData may downloaded similar fashion Giotto Suite: scripts used create mini giotto objects mini objects available repository may extend /improve may utilize purposes!","code":"devtools::install_github(\"drieslab/GiottoData\")"},{"path":"https://drieslab.github.io/Giotto/articles/ecosystem.html","id":"start-giotto","dir":"Articles","previous_headings":"2. GiottoData","what":"2.1 Start Giotto","title":"Giotto Ecosystem","text":"","code":"# Ensure Giotto Suite is installed if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") }  library(Giotto)  # Ensure Giotto Data is installed if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") }  library(GiottoData)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/ecosystem.html","id":"create-a-giotto-object","dir":"Articles","previous_headings":"2. GiottoData","what":"2.2 Create a Giotto object","title":"Giotto Ecosystem","text":"","code":"visium_mini = loadGiottoMini(dataset = 'visium')"},{"path":"https://drieslab.github.io/Giotto/articles/ecosystem.html","id":"session-info","dir":"Articles","previous_headings":"","what":"3. Session Info","title":"Giotto Ecosystem","text":"","code":"sessionInfo() R version 4.2.2 (2022-10-31 ucrt)     Platform: x86_64-w64-mingw32/x64 (64-bit)     Running under: Windows 10 x64 (build 22621)      Matrix products: default      locale:     [1] LC_COLLATE=English_United States.utf8      [2] LC_CTYPE=English_United States.utf8        [3] LC_MONETARY=English_United States.utf8     [4] LC_NUMERIC=C                               [5] LC_TIME=English_United States.utf8          attached base packages:     [1] stats     graphics  grDevices utils     datasets  methods   base           other attached packages:     [1] GiottoData_0.1.0 Giotto_3.2.1          loaded via a namespace (and not attached):      [1] Rcpp_1.0.10       pillar_1.9.0      compiler_4.2.2    tools_4.2.2            [5] digest_0.6.30     jsonlite_1.8.3    evaluate_0.20     lifecycle_1.0.3        [9] tibble_3.2.1      gtable_0.3.3      lattice_0.20-45   png_0.1-7             [13] pkgconfig_2.0.3   rlang_1.1.0       Matrix_1.5-1      cli_3.4.1             [17] rstudioapi_0.14   parallel_4.2.2    yaml_2.3.7        xfun_0.38             [21] fastmap_1.1.0     terra_1.7-18      dplyr_1.1.1       knitr_1.42            [25] rappdirs_0.3.3    generics_0.1.3    vctrs_0.6.1       grid_4.2.2            [29] tidyselect_1.2.0  reticulate_1.26   glue_1.6.2        data.table_1.14.6     [33] R6_2.5.1          fansi_1.0.4       rmarkdown_2.21    ggplot2_3.4.1         [37] magrittr_2.0.3    scales_1.2.1      codetools_0.2-18  htmltools_0.5.4       [41] colorspace_2.1-0  utf8_1.2.3        munsell_0.5.0"},{"path":"https://drieslab.github.io/Giotto/articles/image_alignment.html","id":"giotto-and-image-data","dir":"Articles","previous_headings":"","what":"1. Giotto and Image Data","title":"Image Alignment","text":"Multiple images may attached Giotto object. Spatial data can overlaid upon images may used downstream analyses. Giotto attempts automate addition alignment images much possible, manual adjustments may sometimes necessary. tutorial covering automatic manual adjustment. examples tutorial worked using Visium’s normal human prostate FFPE dataset Visium (automatic) manual adjustment workflows. manual download data required; please see Visium Directory Structure Details . example working high definition images may require ROI alignment stitching, please see Nanostring CosMx lung data analysis.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/image_alignment.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"2. Start Giotto","title":"Image Alignment","text":"","code":"# Ensure Giotto Suite is installed if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") } library(Giotto)  # Ensure Giotto Data is installed if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") } library(GiottoData)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/image_alignment.html","id":"conceptual-overview","dir":"Articles","previous_headings":"","what":"3. Conceptual Overview","title":"Image Alignment","text":"Giotto currently supports two types image objects. purposes, images loaded using terra placed giottoLargeImage objects. giottoLargeImage objects load sampled subsets original image needed represent image, increasing efficiency analysis high-resolution images. Alternatively, smaller images loaded using magick package placed giottoImage objects. offers direct access powerful image processing functionality magick package among Giotto functions analysis viewing. giottoLargeImage objects can downsampled giottoImage objects necessary use convertGiottoLargeImageToMG() function. giottoImage container giottoImages S4 class objects slots containing image metadata necessary plot properly. magick package allows easy access image processing functions well ability access images pointers, images loaded memory needed. Please note result using pointers access image, giottoImages saved sessions, since pointer die given R session closed. However, information used create image retained within giottoObject images slot, described . incorporated giottoObject, giottoImages added images slot giottoObject. images slot organized list() multiple giottoImages may added referred individually using name given. giottoImage Structure name - name giottoImage, need match name variable stores giotto image. Default ‘image’. mg_object - image loaded magick object (pointer) minmax - x y minimum maximum values found spatial locations boundaries - adjustment values stretching image based minmax values scale_factor - scale factor spatial locations image resolution - spatial location units covered per pixel OS_platform - computer environment *Note minmax refers relevant values associated spatial locations rather image. values given either providing spatial locations directly calling createGiottoImage() later steps involve giottoObjects associated spatial locations. maximum flexibility, Giotto plots images spatial data different layers largely independent . spatial data plotted first, essentially serving anchor (xmin, xmax, ymin, ymax). image, matter actual dimensions resolution, stretched fit plot according accompanying metadata (xmin_adj, xmax_adj, ymin_adj, ymax_adj) can edited user.  Calling giottoImage display class name, followed values occupy minmax, boundary adjustment, scale_factor, resolution slots. actual image boundaries displayed spatial values, detail points image’s edges stretched. spatial datasets currently generate spatial locations based map onto original image. Although brief explanation somewhat simplified, Giotto’s automatic alignment works follows: Scale image dimensions original dimensions dividing scaling_factor xmin_adj = (spatial location xmin) - 0 xmax_adj = (xmax image bound original dimensions) - (spatial location xmax) ymin_adj = (spatial location ymin) - (ymin image bound original dimensions) ymax_adj = 0 - (spatial location ymax) instance, assume giottoImage object named GImage already created: intuition defining parameters way detailed within inversion necessary dropdown text beneath Standard workflow.","code":"GImage  ## R TERMINAL OUTPUT: #  # An object of class ' giottoImage ' with name  image  #   # Min and max values are:  #  Max on x-axis:  23520  #  Min on x-axis:  5066  #  Max on y-axis:  -3682  #  Min on y-axis:  -23148  #   # Boundary adjustment are:  #  Max adjustment on x-axis:  3949.001  #  Min adjustment on x-axis:  5066  #  Max adjustment on y-axis:  3682  #  Min adjustment on y-axis:  2082.277  #   # Boundaries are:  #  Image x-axis max boundary:  27469  #  Image x-axis min boundary:  0  #  Image y-axis max boundary:  0  #  Image y-axis min boundary:  -25230.28  # # Scale factor:  #          x          y  # 0.07280935 0.07280935  #  #  Resolution:  #        x        y  #  13.7345  13.7345  # # File Path:  # [1] \"/path/to/directory/tissue_image.png\""},{"path":"https://drieslab.github.io/Giotto/articles/image_alignment.html","id":"visium-workflow-automated","dir":"Articles","previous_headings":"","what":"4. Visium Workflow (Automated):","title":"Image Alignment","text":"Assembly Giotto object well reading alignment tissue staining image Visium spatial subdirectory done automatically using createGiottoVisiumObject(). Note order run following code, Output Files “Feature barcode matrix (raw)” “Spatial imaging data” dataset must downloaded extracted structured Visium directory. Visium Directory Structure Details , details structure Visium Directory creating Giotto object using createGiottoVisiumObject() purposes tutorial shown. Nonetheless, procedure standard practice using Giotto Visium Data. First create new directory. Visium Directory. , open terminal within directory, enter following commands: create two subdirectories within Visium Directory, titled “raw_feature_bc_matrix” “spatial”. subdirectories contain barcode expression information, images scaling information, respectively. Now, Visium Directory may inputted createGiottoVisiumObject()! giotto object using either hires lowres image loaded depending whether “tissue_hires_image.png” “tissue_lowres_image.png” provided png_name argument. example, hires image plotted.","code":"wget https://cf.10xgenomics.com/samples/spatial-exp/1.3.0/Visium_FFPE_Human_Normal_Prostate/Visium_FFPE_Human_Normal_Prostate_raw_feature_bc_matrix.tar.gz tar -xzvf Visium_FFPE_Human_Normal_Prostate_raw_feature_bc_matrix.tar.gz wget https://cf.10xgenomics.com/samples/spatial-exp/1.3.0/Visium_FFPE_Human_Normal_Prostate/Visium_FFPE_Human_Normal_Prostate_spatial.tar.gz tar -xzvf Visium_FFPE_Human_Normal_Prostate_spatial.tar.gz library(Giotto) library(GiottoData)  VisiumDir = '/path/to/visium/directory/' results_directory = paste0(getwd(),'/gobject_imaging_results/')  # Optional: Specify a path to a Python executable within a conda or miniconda # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired.  # Optional: Set Giotto instructions instrs = createGiottoInstructions(save_plot = TRUE,                                   show_plot = TRUE,                                   save_dir = results_directory,                                   python_path = my_python_path) # Create a Giotto Object using Visium Data FFPE_prostate <- createGiottoVisiumObject(expr_data = 'raw',                                           visium_dir = VisiumDir,                                           png_name = \"tissue_hires_image.png\",                                           instructions = instrs) # visualize spots that are in tissue spatPlot2D(FFPE_prostate,            show_image = TRUE,            cell_color = 'in_tissue',            save_param = list(save_name = 'high_res_IT'))"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/image_alignment.html","id":"invert-y-values","dir":"Articles","previous_headings":"5. Standard Workflow","what":"5.1 Invert Y-Values","title":"Image Alignment","text":"beginning, important acknowledge differences may exist conventions defining coordinates within images plots. result, often required make spatial location y values negative. inversion necessary spatial locations appear orientation image. transformation spatial locations automatically done Visium datasets createGiottoVisiumObject(). standard workflow, important determine necessary data hand. inversion necessary Image Coordinates vs Plotting Coordinates convention, origin image coordinates defined upper left, coordinates increase rightward (x coordinate) downward (y coordinate). Many spatial methods inherit convention generating spatial location data. However, Giotto plots coordinates originating lower left. Thus, without inversion y coordinates, spatial locations displayed vertically flipped compared intended seen.  fix multiply Y-values spatial locations -1, inverting . may done prior creation giotto object multiplying y values within spatial location matrix -1. giotto object already created, yet spatial data still needs inversion, running following commands invert y coordinates. , my_gobject refers giottoObject my_spatlocs refers name spatial locations image aligned.","code":"# Retrieve original spatial location data as a spatLocObj spatlocs <- getSpatialLocations(gobject = my_gobject,                                 spat_loc_name = my_spatlocs,                                 output = 'spatLocsObj')  spatlocs[]$sdimy <- -spatlocs[]$sdimy # Note the negative sign operator for inversion  # Overwrite the original spatial locations with the inverted ones my_gobject <- setSpatialLocations(gobject = my_gobject,                                   spat_loc_name = my_spatlocs,                                   spatlocs = spatlocs)"},{"path":"https://drieslab.github.io/Giotto/articles/image_alignment.html","id":"create-giottoimage","dir":"Articles","previous_headings":"5. Standard Workflow","what":"5.2 Create giottoImage","title":"Image Alignment","text":"giottoImages created using createGiottoImage() function. function requires magick-compatible image (eg. jpg, tiff, png) provided mg_object argument either filepath magick object. automatic image alignment desired, scale_factor parameter required, scales spatial locations image. parameter required since spatial locations contain information size image past spatial xmax ymin values. two image bounds instead inferred scaling current image dimensions spatial locations. Visium datasets, scaling information available scalefactors_json.json file found within spatial subdirectory. scalefactors_json.json dataset: Providing appropriate factor scale_factor parameter result automatic alignment. Alignment values: Without spatial locations Alignment values: Note default values given minmax boundaries case. (Optional) Providing spatial location information either gobject parameters spat_loc_name spatial_locs populate minmax boundary slots attempt auto-align image spatial locations. auto-alignment can bypassed using do_manual_adj = TRUE minmax slot populated. spatial locations, also do_manual_adj = TRUE Alignment values: do_manual_adj = TRUE, automatic alignment bypassed favor four manual adjustment values. values (Boundary adjustment) default 0.","code":"{\"tissue_hires_scalef\": 0.072809346, \"tissue_lowres_scalef\": 0.021842804, \"fiducial_diameter_fullres\": 304.63145798068047, \"spot_diameter_fullres\": 188.58137874994503} lowResPath <- paste0(VisiumDir,\"Spatial/tissue_lowres_image.png\") lowResG_img <- createGiottoImage(gobject = FFPE_prostate,                                  mg_object = lowResPath,                                  name = \"low_res\",                                  scale_factor = 0.021842804) lowResG_img An object of class ' giottoImage ' with name  low_res       Min and max values are:       Max on x-axis:  23520       Min on x-axis:  5066       Max on y-axis:  -3682       Min on y-axis:  -23148       Boundary adjustment are:       Max adjustment on x-axis:  3949.001       Min adjustment on x-axis:  5066       Max adjustment on y-axis:  3682       Min adjustment on y-axis:  2077.699       Boundaries are:       Image x-axis max boundary:  27469       Image x-axis min boundary:  0       Image y-axis max boundary:  4.547474e-13       Image y-axis min boundary:  -25225.7       Scale factor:              x         y      0.0218428 0.0218428        Resolution:             x        y      45.78167 45.78167        File Path:      [1] \"~/Visium_FFPE_Human_Normal_Prostate/Spatial/tissue_lowres_image.png\" lowResG_img_no_locs <- createGiottoImage(mg_object = lowResPath,                                          name = \"low_res_no_locs\",                                          scale_factor = 0.021842804) lowResG_img_no_locs An object of class ' giottoImage ' with name  low_res_no_locs       Min and max values are:       Max on x-axis:  10       Min on x-axis:  0       Max on y-axis:  10       Min on y-axis:  0       Boundary adjustment are:       Max adjustment on x-axis:  0       Min adjustment on x-axis:  0       Max adjustment on y-axis:  0       Min adjustment on y-axis:  0       Boundaries are:       Image x-axis max boundary:  10       Image x-axis min boundary:  0       Image y-axis max boundary:  10       Image y-axis min boundary:  0       Scale factor:              x         y      0.0218428 0.0218428        Resolution:             x        y      45.78167 45.78167        File Path:      [1] \"~/Visium_FFPE_Human_Normal_Prostate/Spatial/tissue_lowres_image.png\" lowResG_img_manual <- createGiottoImage(gobject = FFPE_prostate,                                         mg_object = lowResPath,                                         name = \"low_res_manual\",                                         do_manual_adj = TRUE,                                         xmin_adj = 0,                                         xmax_adj = 0,                                         ymin_adj = 0,                                         ymax_adj = 0,                                         scale_factor = 0.021842804) lowResG_img_manual An object of class ' giottoImage ' with name  low_res_manual       Min and max values are:       Max on x-axis:  23520       Min on x-axis:  5066       Max on y-axis:  -3682       Min on y-axis:  -23148       Boundary adjustment are:       Max adjustment on x-axis:  0       Min adjustment on x-axis:  0       Max adjustment on y-axis:  0       Min adjustment on y-axis:  0       Boundaries are:       Image x-axis max boundary:  23520       Image x-axis min boundary:  5066       Image y-axis max boundary:  -3682       Image y-axis min boundary:  -23148       Scale factor:              x         y      0.0218428 0.0218428        Resolution:             x        y      45.78167 45.78167        File Path:      [1] \"~/Visium_FFPE_Human_Normal_Prostate/Spatial/tissue_lowres_image.png\""},{"path":"https://drieslab.github.io/Giotto/articles/image_alignment.html","id":"add-giottoimage-to-giottoobject-and-visualize","dir":"Articles","previous_headings":"5. Standard Workflow","what":"5.3 Add giottoImage to giottoObject and Visualize","title":"Image Alignment","text":"","code":"# Since lowResG_img_no_locs is not associated with the gobject FFPE_prostate, it # may not be added to the gobject. FFPE_prostate = addGiottoImage(gobject = FFPE_prostate,                                images = list(lowResG_img))  spatPlot2D(gobject = FFPE_prostate,           show_image = TRUE,           image_name = \"low_res\",           cell_color = \"in_tissue\",           save_param = list(save_name = 'low_res_IT'))"},{"path":"https://drieslab.github.io/Giotto/articles/image_alignment.html","id":"manual-adjustment","dir":"Articles","previous_headings":"","what":"6. Manual Adjustment","title":"Image Alignment","text":"Manually adjusting plotting images comes either createGiottoImage() using do_manual_adj = TRUE four adjustment values (xmin_adj, xmax_adj, ymin_adj, ymax_adj) giottoImage creation using updateGiottoImage(). method performed eye may necessary depending preference despite accounting scaling, image coordinates match spatial coordinates reason.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/image_alignment.html","id":"during-giottoimage-creation","dir":"Articles","previous_headings":"6. Manual Adjustment","what":"6.1 During giottoImage creation","title":"Image Alignment","text":"","code":"# createGiottoImage with manually defined adjustment values lowResG_img_update_manual <- createGiottoImage(gobject = FFPE_prostate,                                                mg_object = lowResPath,                                                 name = \"low_res_update_manual\",                                                do_manual_adj = TRUE,                                                xmin_adj = 5066,                                                xmax_adj = 3949,                                                ymin_adj = 2078,                                                ymax_adj = 3682,                                                scale_factor = 0.021842804) FFPE_prostate = addGiottoImage(gobject = FFPE_prostate,                                 images = list(lowResG_img_update_manual))  spatPlot2D(gobject = FFPE_prostate,            show_image = TRUE,            image_name = \"low_res_update_manual\",            cell_color = \"in_tissue\",            save_param = list(save_name = 'low_res_update_manual_IT'))"},{"path":"https://drieslab.github.io/Giotto/articles/image_alignment.html","id":"after-giottoimage-creation-within-the-giottoobject","dir":"Articles","previous_headings":"6. Manual Adjustment","what":"6.2 After giottoImage creation, within the giottoObject","title":"Image Alignment","text":"","code":"# createGiottoImage with manually defined adjustment values lowResG_img_to_update <- createGiottoImage(gobject = FFPE_prostate,                                            mg_object = lowResPath,                                            name = \"low_res_to_update\",                                            do_manual_adj = TRUE,                                            xmin_adj = 0,                                            xmax_adj = 0,                                            ymin_adj = 0,                                            ymax_adj = 0,                                            scale_factor = 0.021842804) FFPE_prostate = addGiottoImage(gobject = FFPE_prostate,                                 images = list(lowResG_img_to_update))  spatPlot2D(gobject = FFPE_prostate,            show_image = TRUE,            image_name = \"low_res_to_update\",            cell_color = \"in_tissue\",            save_param = list(save_name = 'low_res_before_update_IT')) # Use updateGiottoImage() to update the image adjustment values FFPE_prostate = updateGiottoImage(gobject = FFPE_prostate,                                   image_name = \"low_res_to_update\",                                   xmin_adj = 5066,                                   xmax_adj = 3949,                                   ymin_adj = 2078,                                   ymax_adj = 3682)  spatPlot2D(gobject = FFPE_prostate,            show_image = TRUE,            image_name = \"low_res_to_update\",            cell_color = \"in_tissue\",            save_param = list(save_name = 'low_res_after_update_IT'))"},{"path":"https://drieslab.github.io/Giotto/articles/image_alignment.html","id":"session-info","dir":"Articles","previous_headings":"","what":"7. Session Info","title":"Image Alignment","text":"","code":"sessionInfo() R version 4.2.2 (2022-10-31 ucrt)     Platform: x86_64-w64-mingw32/x64 (64-bit)     Running under: Windows 10 x64 (build 22621)      Matrix products: default      locale:     [1] LC_COLLATE=English_United States.utf8      [2] LC_CTYPE=English_United States.utf8        [3] LC_MONETARY=English_United States.utf8     [4] LC_NUMERIC=C                               [5] LC_TIME=English_United States.utf8          attached base packages:     [1] stats     graphics  grDevices utils     datasets  methods   base           other attached packages:     [1] GiottoData_0.1.0 Giotto_3.2.1          loaded via a namespace (and not attached):      [1] reticulate_1.26    tidyselect_1.2.0   terra_1.7-18       xfun_0.38               [5] lattice_0.20-45    colorspace_2.1-0   vctrs_0.6.1        generics_0.1.3          [9] htmltools_0.5.4    yaml_2.3.7         utf8_1.2.3         rlang_1.1.0            [13] R.oo_1.25.0        pillar_1.9.0       glue_1.6.2         withr_2.5.0            [17] R.utils_2.12.2     rappdirs_0.3.3     RColorBrewer_1.1-3 lifecycle_1.0.3        [21] munsell_0.5.0      gtable_0.3.3       ragg_1.2.4         R.methodsS3_1.8.2      [25] codetools_0.2-18   evaluate_0.20      labeling_0.4.2     knitr_1.42             [29] fastmap_1.1.0      parallel_4.2.2     fansi_1.0.4        Rcpp_1.0.10            [33] scales_1.2.1       magick_2.7.4       jsonlite_1.8.3     systemfonts_1.0.4      [37] farver_2.1.1       textshaping_0.3.6  ggplot2_3.4.1      png_0.1-7              [41] digest_0.6.30      dplyr_1.1.1        grid_4.2.2         rprojroot_2.0.3        [45] cowplot_1.1.1      here_1.0.1         cli_3.4.1          tools_4.2.2            [49] magrittr_2.0.3     tibble_3.2.1       pkgconfig_2.0.3    Matrix_1.5-1           [53] data.table_1.14.6  rmarkdown_2.21     rstudioapi_0.14    R6_2.5.1               [57] compiler_4.2.2"},{"path":"https://drieslab.github.io/Giotto/articles/installation.html","id":"installing-giotto-suite","dir":"Articles","previous_headings":"","what":"1. Installing Giotto Suite","title":"Installation","text":"Giotto Suite installed via R required Python modules must installed order Giotto Suite function properly. instructions installation Giotto Suite package required Python environment.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/installation.html","id":"requirements","dir":"Articles","previous_headings":"1. Installing Giotto Suite","what":"1.1 Requirements","title":"Installation","text":"R (>= 4.0.1) Python (>= 3.6) Windows, MacOS Linux specific installation tools Posit (previously RStudio)","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/installation.html","id":"install-giotto-suite","dir":"Articles","previous_headings":"2. Installation","what":"2.1 Install Giotto Suite","title":"Installation","text":"","code":"# Necessary for installation from R if(!\"devtools\" %in% installed.packages()) {   install.packages(\"devtools\") }  devtools::install_github(\"drieslab/Giotto@suite\")"},{"path":"https://drieslab.github.io/Giotto/articles/installation.html","id":"install-the-giotto-python-environment","dir":"Articles","previous_headings":"2. Installation","what":"2.2 Install the Giotto Python Environment","title":"Installation","text":"","code":"library(Giotto) installGiottoEnvironment()"},{"path":"https://drieslab.github.io/Giotto/articles/installation.html","id":"try-giotto-in-the-cloud","dir":"Articles","previous_headings":"","what":"3. Try Giotto in the cloud","title":"Installation","text":"can also run analyses Giotto Terra.bio. Take look Terra tutorial. Encountering errors? Checkout Troubleshooting page help. Alternatively, post issue Giotto GitHub page . Please include version numbers R, Giotto, OS use time issue.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/installation.html","id":"session-info","dir":"Articles","previous_headings":"","what":"4. Session Info","title":"Installation","text":"","code":"sessionInfo() R version 4.2.2 (2022-10-31 ucrt)     Platform: x86_64-w64-mingw32/x64 (64-bit)     Running under: Windows 10 x64 (build 22621)      Matrix products: default      locale:     [1] LC_COLLATE=English_United States.utf8      [2] LC_CTYPE=English_United States.utf8        [3] LC_MONETARY=English_United States.utf8     [4] LC_NUMERIC=C                               [5] LC_TIME=English_United States.utf8          attached base packages:     [1] stats     graphics  grDevices utils     datasets  methods   base           other attached packages:     [1] Giotto_3.2.1      loaded via a namespace (and not attached):      [1] Rcpp_1.0.10       pillar_1.9.0      compiler_4.2.2    tools_4.2.2            [5] digest_0.6.30     jsonlite_1.8.3    evaluate_0.20     lifecycle_1.0.3        [9] tibble_3.2.1      gtable_0.3.3      lattice_0.20-45   pkgconfig_2.0.3       [13] rlang_1.1.0       Matrix_1.5-1      cli_3.4.1         rstudioapi_0.14       [17] parallel_4.2.2    yaml_2.3.7        xfun_0.38         fastmap_1.1.0         [21] terra_1.7-18      dplyr_1.1.1       knitr_1.42        generics_0.1.3        [25] vctrs_0.6.1       grid_4.2.2        tidyselect_1.2.0  glue_1.6.2            [29] data.table_1.14.6 R6_2.5.1          fansi_1.0.4       rmarkdown_2.21        [33] ggplot2_3.4.1     magrittr_2.0.3    scales_1.2.1      codetools_0.2-18      [37] htmltools_0.5.4   colorspace_2.1-0  utf8_1.2.3        munsell_0.5.0"},{"path":"https://drieslab.github.io/Giotto/articles/interactive_selection.html","id":"set-up-giotto-object","dir":"Articles","previous_headings":"","what":"Set up Giotto object","title":"Interactive selection","text":"NOTE: follow tutorial, must pre-run Parts 1-4 Mouse Visium Brain tutorial can use input either ggplot2 object, terra::rast image, output running spatPlot2D( ) function.","code":"# Ensure Giotto Suite is installed. if(!'Giotto' %in% installed.packages()) {   devtools::install_github('drieslab/Giotto@suite') }  # Ensure GiottoData, a small, helper module for tutorials, is installed. if(!'GiottoData' %in% installed.packages()) {   devtools::install_github('drieslab/GiottoData') }  library(Giotto)  # Ensure the Python environment for Giotto has been installed. genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment.   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/interactive_selection.html","id":"create-a-giotto-spatplot-object","dir":"Articles","previous_headings":"","what":"1. Create a Giotto spatPlot object","title":"Interactive selection","text":"creating spatPlot2D object, can plot spatial cells/spots show tissue image background. plan select individual clusters cell types, recommend coloring cells/spots using cell_color argument.","code":"## Plot spatial cells/spots my_spatPlot <- spatPlot2D(gobject = visium_brain,                           cell_color = 'leiden_clus',                           point_size = 1.5,                           point_alpha = 0.5,                           show_image = FALSE)  ## Plot spatial cells/spots with tissue on the background my_spatPlot <- spatPlot2D(gobject = visium_brain,                           point_size = 1.5,                           point_alpha = 0.1,                           show_image = TRUE)"},{"path":"https://drieslab.github.io/Giotto/articles/interactive_selection.html","id":"run-the-interactive-selection-tool","dir":"Articles","previous_headings":"","what":"2. Run the interactive selection tool","title":"Interactive selection","text":"plotInteractivePolygons( ) run ShinyApp gadget within RStudio session. Use cursor draw area interest add name. can draw many regions wish.   can use additional parameters passed polygon( ) function, line thickness color polygons.   Use slider bars zoom plot draw tiny polygons.","code":"## Run the Shiny app with default parameters plotInteractivePolygons(my_spatPlot) ## Run the Shiny app using the tissue image plotInteractivePolygons(my_spatPlot) ## Modify the width and/or color of the line plotInteractivePolygons(my_spatPlot,                         color = 'black',                         lwd = 2) ## Modify the width or heigh of the plotted image plotInteractivePolygons(my_spatPlot,                         height = 500) ## Use the zoom in and out slide-bars to select small areas plotInteractivePolygons(my_spatPlot,                         height = 320)"},{"path":"https://drieslab.github.io/Giotto/articles/interactive_selection.html","id":"save-the-coordinates","dir":"Articles","previous_headings":"","what":"3. Save the coordinates","title":"Interactive selection","text":"Click button Done finished selecting areas interest. default, plotInteractivePolygons() print polygon x y coordinates ‘data.table’ object Console panel, can store output using assignment operator.  Now, let’s add polygon coordinates Giotto object: Finally, add corresponding polygon ID cell Metadata. default, function add ‘no_polygon’ label cells outside polygons, can customize using na.label argument.","code":"## The polygon coordinates will be saved on my_polygon_coordinates as a data.table object my_polygon_coordinates <- plotInteractivePolygons(my_spatPlot,                                                   height = 320) ## We must transform the data.table or data.frame with coordinates into a Giotto polygon object my_giotto_polygons <- createGiottoPolygonsFromDfr(my_polygon_coordinates, name = 'selections')  ## Then, add the polygons to the Giotto object visium_brain <- addGiottoPolygons(gobject = visium_brain,                                   gpolygons = list(my_giotto_polygons)) ## Using the default parameters visium_brain <- addPolygonCells(visium_brain,                                 polygon_name = 'selections')  ## Let's see how it looks like now the cell_metadata pDataDT(visium_brain) ## Customize the NA label visium_brain <- addPolygonCells(visium_brain,                                 polygon_name = 'selections',                                 na.label = 'No Polygon')"},{"path":"https://drieslab.github.io/Giotto/articles/interactive_selection.html","id":"get-the-cells-located-within-each-polygon","dir":"Articles","previous_headings":"","what":"4. Get the cells located within each polygon","title":"Interactive selection","text":"can extract coordinates IDs cells located within one multiple regions interest.","code":"## Provide the name of the polygon to extract cells from getCellsFromPolygon(visium_brain,                     polygon_name = 'selections',                     polygons = 'polygon 1') ## If no polygon name is provided, the function will retrieve cells located within all polygons getCellsFromPolygon(visium_brain,                     polygon_name = 'selections')"},{"path":"https://drieslab.github.io/Giotto/articles/interactive_selection.html","id":"compare-gene-expression","dir":"Articles","previous_headings":"","what":"5. Compare gene expression","title":"Interactive selection","text":"Let’s compare expression levels genes interest selected regions.","code":"## You can provide a list of genes comparePolygonExpression(visium_brain,                          selected_feats = c('Stmn1', 'Psd', 'Ly6h')) ## Or calculate the top genes expressed within each region, then provide the result to compare polygons. scran_results <- findMarkers_one_vs_all(visium_brain,                                         spat_unit = 'cell',                                         feat_type = 'rna',                                         method = 'scran',                                         expression_values = 'normalized',                                         cluster_column = 'selections',                                         min_feats = 10)  top_genes <- scran_results[, head(.SD, 2), by = 'cluster']$feats  comparePolygonExpression(visium_brain,                          selected_feats = top_genes)"},{"path":"https://drieslab.github.io/Giotto/articles/interactive_selection.html","id":"compare-cell-type-abundance","dir":"Articles","previous_headings":"","what":"6. Compare cell type abundance","title":"Interactive selection","text":"run analysis finding clusters annotated cell types within cell metadata slot, can use column name compare abundance cell types selected regions.","code":"## By default, the function will look for the leiden_cluster compareCellAbundance(visium_brain)  ## You can use other columns within the cell metadata table to compare the cell type abundances compareCellAbundance(visium_brain, cell_type_column = 'cell_type')"},{"path":"https://drieslab.github.io/Giotto/articles/interactive_selection.html","id":"create-a-spatplot-per-region","dir":"Articles","previous_headings":"","what":"7. Create a spatPlot per region","title":"Interactive selection","text":"can use spatPlot( ) arguments isolate plot region. Also, can color cell cluster, cell type expression level.","code":"## Compare clusters within each region spatPlot2D(visium_brain,            cell_color = 'leiden_clus',            group_by = 'selections',            point_size = 1,            coord_fix_ratio = 1,            cow_n_col = 3,            show_legend = FALSE) ## Compare expression levels between regions spatFeatPlot2D(visium_brain,                expression_values = 'scaled',                group_by = 'selections',                feats = 'Psd',                point_size = 1)"},{"path":"https://drieslab.github.io/Giotto/articles/interactive_selection.html","id":"plot-again-the-polygons","dir":"Articles","previous_headings":"","what":"8. Plot again the polygons","title":"Interactive selection","text":"can plot drawn polygons. minimal input Giotto object containing polygon coordinates within spatial_info slot, well spatial plot.  Additionaly, can plot polygons providing vector polygon IDs.","code":"## Plot all polygons plotPolygons(visium_brain,              polygon_name = 'selections',              x = my_spatPlot) ## Plot a subset of polygons plotPolygons(visium_brain,              polygon_name = 'selections',              x = my_spatPlot,              polygons = 'polygon 2')"},{"path":"https://drieslab.github.io/Giotto/articles/interoperability_anndata.html","id":"converting-to-and-from-anndata-squidpy-flavor","dir":"Articles","previous_headings":"","what":"1. Converting to and from AnnData (squidpy-flavor)","title":"Interoperability: AnnData","text":"tutorial details use conversion functions anndataToGiotto() giottoToAnnData(). mini Giotto object used minimal computational requirements. Please note functions inherently active development, since changes either squidpy anndata possible.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/interoperability_anndata.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"2. Start Giotto","title":"Interoperability: AnnData","text":"","code":"# Ensure Giotto Suite is installed if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") }  library(Giotto)  # Ensure Giotto Data is installed if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") }  library(GiottoData)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/interoperability_anndata.html","id":"create-a-giotto-object","dir":"Articles","previous_headings":"","what":"3. Create a Giotto object","title":"Interoperability: AnnData","text":"","code":"# Specify path to which results may be saved results_directory = paste0(getwd(),'/giotto_anndata_conversion/')   # Optional: Specify a path to a Python executable within a conda or miniconda  # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired.  mini_gobject = loadGiottoMini(dataset = 'vizgen',                                python_path = my_python_path)  instrs = showGiottoInstructions(mini_gobject) instrs$save_dir = results_directory  mini_gobject = replaceGiottoInstructions(gobject = mini_gobject,                                          instructions = instrs)"},{"path":"https://drieslab.github.io/Giotto/articles/interoperability_anndata.html","id":"convert-giotto-to-anndata","dir":"Articles","previous_headings":"","what":"4. Convert Giotto to AnnData","title":"Interoperability: AnnData","text":"Since Giotto structured hierarchally, converting Giotto AnnData result multiple .h5ad files. file correspond Giotto spat_unit feat_type pair. Furthermore, expression slot treated layer resulting AnnData slot. Squidpy anndata objects take different defaults various operations compared Giotto. instance, default nearest neighbor network kNN squidpy, default Giotto sNN. ’ll create kNN addition sNN within object already show handled. cell creates nearest network almost default parameters. ’ll change make new network show converter handles . Since multiple spat_unit feat_type pairs, multiple files created function. names .h5ad files returned. case non-anndata-default nearest network spatial network name, key_added terms recorded saved .txt files named accordingly. Please see documentation details.","code":"mini_gobject = createNearestNetwork(gobject = mini_gobject,                                     spat_unit = \"aggregate\",                                     feat_type = \"rna\",                                     type = \"kNN\",                                     dim_reduction_to_use = \"umap\",                                     dim_reduction_name = \"umap\",                                     k = 15,                                     name = \"kNN.umap\") mini_gobject = createNearestNetwork(gobject = mini_gobject,                                     spat_unit = \"aggregate\",                                     feat_type = \"rna\",                                     type = \"kNN\",                                     dim_reduction_to_use = \"umap\",                                     dim_reduction_name = \"umap\",                                     k = 6,                                     name = \"new_network\") anndata_conversions = giottoToAnnData(gobject = mini_gobject,                                       save_directory = results_directory,                                       python_path = my_python_path)"},{"path":"https://drieslab.github.io/Giotto/articles/interoperability_anndata.html","id":"anndata-to-giotto","dir":"Articles","previous_headings":"","what":"5. AnnData to Giotto","title":"Interoperability: AnnData","text":"convert AnnData Object back Giotto object, must first saved .h5ad file. name said file may provided anndataToGiotto() conversion. nearest neighbor network spatial netowkr created using key_added argument, may provided arguments n_key_added /spatial_n_key_added, respectively. converting anndata object originally giotto object, .txt files generated giottoToAnnData() may provided arguments well.","code":"z0_rna_gobject <- anndataToGiotto(anndata_path = \"./giotto_anndata_conversion/z0_rna_converted_gobject.h5ad\",                                   python_path = my_python_path)  z1_rna_gobject <- anndataToGiotto(anndata_path = \"./giotto_anndata_conversion/z1_rna_converted_gobject.h5ad\",                                   python_path = my_python_path)  aggregate_rna_gobject <- anndataToGiotto(anndata_path = \"./giotto_anndata_conversion/aggregate_rna_converted_gobject.h5ad\",                                          python_path = my_python_path,                                          n_key_added = list(\"sNN.pca\",\"new_network\"),                                          spatial_n_key_added = \"aggregate_rna_spatial_network_keys_added.txt\")"},{"path":"https://drieslab.github.io/Giotto/articles/interoperability_anndata.html","id":"session-info","dir":"Articles","previous_headings":"","what":"6. Session Info","title":"Interoperability: AnnData","text":"","code":"sessionInfo() R version 4.2.2 (2022-10-31 ucrt)     Platform: x86_64-w64-mingw32/x64 (64-bit)     Running under: Windows 10 x64 (build 22621)      Matrix products: default      locale:     [1] LC_COLLATE=English_United States.utf8      [2] LC_CTYPE=English_United States.utf8        [3] LC_MONETARY=English_United States.utf8     [4] LC_NUMERIC=C                               [5] LC_TIME=English_United States.utf8          attached base packages:     [1] stats     graphics  grDevices utils     datasets  methods   base           other attached packages:     [1] GiottoData_0.2.1 Giotto_3.2.1          loaded via a namespace (and not attached):      [1] Rcpp_1.0.10       pillar_1.9.0      compiler_4.2.2    tools_4.2.2            [5] digest_0.6.30     jsonlite_1.8.3    evaluate_0.20     lifecycle_1.0.3        [9] tibble_3.2.1      gtable_0.3.3      lattice_0.20-45   png_0.1-7             [13] pkgconfig_2.0.3   rlang_1.1.0       igraph_1.4.1      Matrix_1.5-1          [17] cli_3.4.1         rstudioapi_0.14   parallel_4.2.2    yaml_2.3.7            [21] xfun_0.38         fastmap_1.1.0     terra_1.7-18      dplyr_1.1.1           [25] knitr_1.42        rappdirs_0.3.3    generics_0.1.3    vctrs_0.6.1           [29] rprojroot_2.0.3   grid_4.2.2        tidyselect_1.2.0  here_1.0.1            [33] reticulate_1.26   glue_1.6.2        data.table_1.14.6 R6_2.5.1              [37] fansi_1.0.4       rmarkdown_2.21    ggplot2_3.4.1     magrittr_2.0.3        [41] scales_1.2.1      codetools_0.2-18  htmltools_0.5.4   colorspace_2.1-0      [45] utf8_1.2.3        munsell_0.5.0     dbscan_1.1-11"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"1. Start Giotto","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"","code":"library(Giotto) library(GiottoData)  # Specify path from which data may be retrieved/stored data_directory = paste0(getwd(),'/gobject_visual_data/') # alternatively, \"/path/to/where/the/data/lives/\"  # Specify path to which results may be saved results_directory = paste0(getwd(),'/gobject_visual_results/')  # alternatively, \"/path/to/store/the/results/\"  # Optional: Specify a path to a Python executable within a conda or miniconda  # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired."},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"Dataset Explanation","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"Moffitt et al. created 3D spatial expression dataset consisting 155 genes ~1 million single cells acquired mouse hypothalamic preoptic regions. Please ensure wget installed locally streamline download.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"dataset-download","dir":"Articles","previous_headings":"","what":"Dataset Download","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"","code":"# In the event of authentication issues with wget,  # add \", extra = '--no-check-certificate' \" after the method argument. # Get the dataset: getSpatialDataset(dataset = 'merfish_preoptic',                    directory = data_directory,                    method = 'wget')"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"create-giotto-instructions-prepare-data","dir":"Articles","previous_headings":"","what":"1. Create Giotto Instructions & Prepare Data","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"","code":"# Optional, but encouraged: Set Giotto instructions instrs = createGiottoInstructions(save_plot = TRUE,                                   show_plot = TRUE,                                   save_dir = results_directory,                                    python_path = my_python_path)  # Create file paths to feed data into Giotto Object expr_path = paste0(data_directory, \"merFISH_3D_data_expression.txt.gz\") loc_path = paste0(data_directory, \"merFISH_3D_data_cell_locations.txt\") meta_path = paste0(data_directory, \"merFISH_3D_metadata.txt\")"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"create-giotto-object-process-data","dir":"Articles","previous_headings":"","what":"2. Create Giotto Object & Process Data","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"First pre-test filter parameters features cells.    Use previously generated plots inform filter decisions. Now, take glance data 2D 3D.","code":"# Create Giotto object merFISH_gobject <- createGiottoObject(expression = expr_path,                                       spatial_locs = loc_path,                                       instructions = instrs)   # Add additional metadata metadata = data.table::fread(meta_path) merFISH_gobject = addCellMetadata(merFISH_gobject,                                    new_metadata = metadata$layer_ID,                                    vector_name = 'layer_ID') merFISH_gobject = addCellMetadata(merFISH_gobject,                                   new_metadata = metadata$orig_cell_types,                                   vector_name = 'orig_cell_types') filterDistributions(merFISH_gobject, detection = 'feats') filterDistributions(merFISH_gobject, detection = 'cells') filterCombinations(merFISH_gobject,                   expression_thresholds = c(0,1e-6,1e-5),                   feat_det_in_min_cells = c(500, 1000, 1500),                   min_det_feats_per_cell = c(1, 5, 10)) ## Data Processing  # Filter data merFISH_gobject <- filterGiotto(gobject = merFISH_gobject,                                 feat_det_in_min_cells = 0,                                 min_det_feats_per_cell = 0) # Normalize data merFISH_gobject <- normalizeGiotto(gobject = merFISH_gobject,                                     scalefactor = 10000,                                     verbose = T)  # Add statistics to Giotto Object merFISH_gobject <- addStatistics(gobject = merFISH_gobject,                                   expression_values = 'normalized')  # Adjust for covariates merFISH_gobject <- adjustGiottoMatrix(gobject = merFISH_gobject, expression_values = c('normalized'),                                       batch_columns = NULL, covariate_columns = c('layer_ID'),                                       return_gobject = TRUE,                                       update_slot = c('custom')) # 2D spatPlot(gobject = merFISH_gobject, point_size = 1.5) # 3D spatPlot3D(gobject = merFISH_gobject, point_size = 1.25, axis_scale = 'real')"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"part-3-dimension-reduction","dir":"Articles","previous_headings":"","what":"Part 3: Dimension Reduction","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"155 genes within dataset. Use (default) within dimension reduction.  PCA, UMAP may run. Run UMAP clusters may visualized upon .","code":"merFISH_gobject <- runPCA(gobject = merFISH_gobject,                            feats_to_use = NULL,                            scale_unit = FALSE,                            center = TRUE)  # View details about the principal components screePlot(merFISH_gobject) merFISH_gobject <- runUMAP(merFISH_gobject,                             dimensions_to_use = 1:8,                             n_components = 3,                             n_threads = 4)  plotUMAP_3D(gobject = merFISH_gobject, point_size = 1.5)"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"part-4-cluster","dir":"Articles","previous_headings":"","what":"Part 4: Cluster","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"Create nearest network, perform Leiden clustering. clusters may visualized UMAP.","code":"# Create a sNN network (default) merFISH_gobject <- createNearestNetwork(gobject = merFISH_gobject,                                          dimensions_to_use = 1:8,                                          k = 15) # Leiden cluster merFISH_gobject <- doLeidenCluster(gobject = merFISH_gobject,                                     resolution = 0.2,                                     n_iterations = 200,                                    name = 'leiden_0.2_200') # Plot the clusters upon the UMAP plotUMAP_3D(gobject = merFISH_gobject,              cell_color = 'leiden_0.2_200',              point_size = 1.5,              show_center_label = F)"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"part-5-co-visualize","dir":"Articles","previous_headings":"","what":"Part 5: Co-Visualize","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"View clusters -tissue layer.","code":"spatPlot2D(gobject = merFISH_gobject,             point_size = 1.5,             cell_color = 'leiden_0.2_200',             group_by = 'layer_ID',             cow_n_col = 2,             group_by_subset = c(260, 160, 60, -40, -140, -240))"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"part-6-cell-type-marker-gene-detection","dir":"Articles","previous_headings":"","what":"Part 6: Cell Type Marker Gene Detection","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"Call findMarkers_one_vs_all identify marker features. Click function see alternate methods, look findGiniMarkers section details gini method. marker features determined, observe differential expression across clusters within violin plot.","code":"markers = findMarkers_one_vs_all(gobject = merFISH_gobject,                                  method = 'gini',                                  expression_values = 'normalized',                                  cluster_column = 'leiden_0.2_200',                                  min_feats = 1, rank_score = 2) # Display details about the marker genes in-console markers[, head(.SD, 2), by = 'cluster']  # violinplot topgini_genes = unique(markers[, head(.SD, 2), by = 'cluster']$feats) violinPlot(merFISH_gobject, feats = topgini_genes, cluster_column = 'leiden_0.2_200', strip_position = 'right') topgini_genes = unique(markers[, head(.SD, 6), by = 'cluster']$feats) plotMetaDataHeatmap(merFISH_gobject, expression_values = 'scaled',                     metadata_cols = c('leiden_0.2_200'),                     selected_feats = topgini_genes)"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"part-7-cell-type-annotation","dir":"Articles","previous_headings":"","what":"Part 7: Cell-Type Annotation","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"Use known marker differentially expressed genes (DEGs) identify cell type cluster.  Since Leiden clusters types cells dataset, cell type may assigned different cluster numbers. may done verifying particular clusters highly express marker genes corresponding cell type. heatmap used streamline process. Call annotateGiotto map cell types Leiden clusters; appear cell_metadata within giottoObject.","code":"# Known markers and DEGs selected_genes = c('Myh11', 'Klf4', 'Fn1', 'Cd24a', 'Cyr61', 'Nnat', 'Trh',                     'Selplg', 'Pou3f2', 'Aqp4', 'Traf4', 'Pdgfra', 'Opalin',                     'Mbp', 'Ttyh2', 'Fezf1', 'Cbln1', 'Slc17a6', 'Scg2', 'Isl1', 'Gad1')  gobject_cell_metadata = pDataDT(merFISH_gobject) cluster_order = unique(gobject_cell_metadata$leiden_0.2_200)  plotMetaDataHeatmap(merFISH_gobject, expression_values = 'scaled',                     metadata_cols = c('leiden_0.2_200'),                     selected_feats = selected_genes,                     custom_feat_order = rev(selected_genes),                     custom_cluster_order = cluster_order) # Name clusters clusters_cell_types_hypo = c('Inhibitory', 'Inhibitory', 'Excitatory', 'Astrocyte','OD Mature', 'Endothelial',                              'OD Mature', 'OD Immature',  'Ambiguous','Ependymal', 'Endothelial', 'Microglia', 'OD Mature') names(clusters_cell_types_hypo) = as.character(sort(cluster_order))  merFISH_gobject = annotateGiotto(gobject = merFISH_gobject,                                   annotation_vector = clusters_cell_types_hypo,                                  cluster_column = 'leiden_0.2_200',                                   name = 'cell_types')  ## show heatmap plotMetaDataHeatmap(merFISH_gobject,                      expression_values = 'scaled',                     metadata_cols = c('cell_types'),                     selected_feats = selected_genes,                     custom_feat_order = rev(selected_genes),                     custom_cluster_order = clusters_cell_types_hypo)"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"part-8-visualize","dir":"Articles","previous_headings":"","what":"Part 8: Visualize","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"","code":"# Assign colors to each cell type  mycolorcode = c('red', 'lightblue', 'yellowgreen','purple', 'darkred',                 'magenta', 'mediumblue', 'yellow', 'gray') names(mycolorcode) = c('Inhibitory', 'Excitatory','OD Mature', 'OD Immature',                         'Astrocyte', 'Microglia', 'Ependymal','Endothelial', 'Ambiguous')  plotUMAP_3D(merFISH_gobject,              cell_color = 'cell_types',              point_size = 1.5,              cell_color_code = mycolorcode) spatPlot3D(merFISH_gobject,            cell_color = 'cell_types', axis_scale = 'real',            sdimx = 'sdimx', sdimy = 'sdimy', sdimz = 'sdimz',            show_grid = F, cell_color_code = mycolorcode) spatPlot2D(gobject = merFISH_gobject, point_size = 1.0,            cell_color = 'cell_types', cell_color_code = mycolorcode,            group_by = 'layer_ID', cow_n_col = 2, group_by_subset = c(seq(260, -290, -100)))"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"excitatory-cells-only","dir":"Articles","previous_headings":"Part 8: Visualize","what":"Excitatory Cells Only","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"","code":"spatPlot3D(merFISH_gobject,            cell_color = 'cell_types', axis_scale = 'real',            sdimx = 'sdimx', sdimy = 'sdimy', sdimz = 'sdimz',            show_grid = F, cell_color_code = mycolorcode,            select_cell_groups = 'Excitatory', show_other_cells = F) spatPlot2D(gobject = merFISH_gobject, point_size = 1.0,             cell_color = 'cell_types', cell_color_code = mycolorcode,            select_cell_groups = 'Excitatory', show_other_cells = F,            group_by = 'layer_ID', cow_n_col = 2, group_by_subset = c(seq(260, -290, -100)))"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"inhibitory-cells-only","dir":"Articles","previous_headings":"Part 8: Visualize","what":"Inhibitory Cells Only","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"","code":"spatPlot3D(merFISH_gobject,            cell_color = 'cell_types', axis_scale = 'real',            sdimx = 'sdimx', sdimy = 'sdimy', sdimz = 'sdimz',            show_grid = F, cell_color_code = mycolorcode,            select_cell_groups = 'Inhibitory', show_other_cells = F) spatPlot2D(gobject = merFISH_gobject, point_size = 1.0,             cell_color = 'cell_types', cell_color_code = mycolorcode,            select_cell_groups = 'Inhibitory', show_other_cells = F,            group_by = 'layer_ID', cow_n_col = 2, group_by_subset = c(seq(260, -290, -100)))"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"od-and-astrocytes-only","dir":"Articles","previous_headings":"Part 8: Visualize","what":"OD and Astrocytes Only","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"","code":"spatPlot3D(merFISH_gobject,            cell_color = 'cell_types', axis_scale = 'real',            sdimx = 'sdimx', sdimy = 'sdimy', sdimz = 'sdimz',            show_grid = F, cell_color_code = mycolorcode,            select_cell_groups = c('Astrocyte', 'OD Mature', 'OD Immature'), show_other_cells = F) spatPlot2D(gobject = merFISH_gobject, point_size = 1.0,             cell_color = 'cell_types', cell_color_code = mycolorcode,            select_cell_groups = c('Astrocyte', 'OD Mature', 'OD Immature'), show_other_cells = F,            group_by = 'layer_ID', cow_n_col = 2, group_by_subset = c(seq(260, -290, -100)))"},{"path":"https://drieslab.github.io/Giotto/articles/merfish_mouse_hypothalamic.html","id":"other-cells-only","dir":"Articles","previous_headings":"Part 8: Visualize","what":"Other Cells Only","title":"MERFISH Mouse Hypothalamic Preoptic Region","text":"","code":"spatPlot3D(merFISH_gobject,            cell_color = 'cell_types', axis_scale = 'real',            sdimx = 'sdimx', sdimy = 'sdimy', sdimz = 'sdimz',            show_grid = F, cell_color_code = mycolorcode,            select_cell_groups = c('Microglia', 'Ependymal', 'Endothelial'), show_other_cells = F) spatPlot2D(gobject = merFISH_gobject, point_size = 1.0,             cell_color = 'cell_types', cell_color_code = mycolorcode,            select_cell_groups = c('Microglia', 'Ependymal', 'Endothelial'), show_other_cells = F,            group_by = 'layer_ID', cow_n_col = 2, group_by_subset = c(seq(260, -290, -100)))"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"Start Giotto","title":"mini seqFISH","text":"","code":"# Ensure Giotto Suite is installed. if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") }  # Ensure GiottoData, a small, helper module for tutorials, is installed. if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") }  library(Giotto) # Ensure the Python environment for Giotto has been installed. genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment.   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"set-giotto-instructions-optional","dir":"Articles","previous_headings":"Start Giotto","what":"Set Giotto instructions (optional)","title":"mini seqFISH","text":"","code":"library(Giotto) library(GiottoData)  # to automatically save figures in save_dir set save_plot to TRUE temp_dir = getwd() myinstructions = createGiottoInstructions(save_dir = temp_dir,                                            save_plot = FALSE,                                            show_plot = TRUE)"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"create-a-giotto-object","dir":"Articles","previous_headings":"","what":"1. Create a Giotto object","title":"mini seqFISH","text":"minimum requirements : Matrix expression information (path ) x,y(,z) coordinates cells spots (path ) work Giotto instructions part Giotto object: Show instructions associated Giotto object showGiottoInstructions() Change one instructions changeGiottoInstructions() Replace instructions replaceGiottoInstructions() Read get specific Giotto instruction readGiottoInstructions()","code":"# download data data_directory = paste0(temp_dir, '/data/') getSpatialDataset(dataset = 'mini_seqFISH', directory = data_directory, method = 'wget') # giotto object  expr_path = paste0(data_directory, \"seqfish_field_expr.txt.gz\") loc_path = paste0(data_directory, \"seqfish_field_locs.txt\") seqfish_mini = createGiottoObject(expression = expr_path,                                    spatial_locs = loc_path,                                    instructions = myinstructions) # show instructions associated with giotto object (seqfish_mini) showGiottoInstructions(seqfish_mini)"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"processing-steps","dir":"Articles","previous_headings":"","what":"2. Processing steps","title":"mini seqFISH","text":"Filter genes cells based detection frequencies Normalize expression matrix (log transformation, scaling factor /z-scores) Add cell gene statistics (optional) Adjust expression matrix technical covariates batches (optional). results stored custom slot.","code":"seqfish_mini = filterGiotto(gobject = seqfish_mini,                              expression_threshold = 0.5,                              feat_det_in_min_cells = 20,                              min_det_feats_per_cell = 0) seqfish_mini = normalizeGiotto(gobject = seqfish_mini, scalefactor = 6000, verbose = T) seqfish_mini = addStatistics(gobject = seqfish_mini) seqfish_mini = adjustGiottoMatrix(gobject = seqfish_mini,                                    expression_values = c('normalized'),                                    covariate_columns = c('nr_feats', 'total_expr'))"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"dimension-reduction","dir":"Articles","previous_headings":"","what":"3. Dimension reduction","title":"mini seqFISH","text":"Identify highly variable features (HVF)  Perform PCA Identify number significant principal components (PCs)   Run UMAP /t-SNE PCs (directly matrix)","code":"seqfish_mini = calculateHVF(gobject = seqfish_mini) seqfish_mini = runPCA(gobject = seqfish_mini) screePlot(seqfish_mini, ncp = 20) plotPCA(seqfish_mini) seqfish_mini = runUMAP(seqfish_mini, dimensions_to_use = 1:5, n_threads = 2) plotUMAP(gobject = seqfish_mini) seqfish_mini = runtSNE(seqfish_mini, dimensions_to_use = 1:5) plotTSNE(gobject = seqfish_mini)"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"clustering","dir":"Articles","previous_headings":"","what":"4. Clustering","title":"mini seqFISH","text":"Create shared (default) nearest network PCA space (directly matrix) Cluster nearest network Leiden Louvain (k-means hclust alternatives)    following step requires installation {ggdendro}.","code":"seqfish_mini = createNearestNetwork(gobject = seqfish_mini, dimensions_to_use = 1:5, k = 5) seqfish_mini = doLeidenCluster(gobject = seqfish_mini, resolution = 0.4, n_iterations = 1000) # visualize UMAP cluster results plotUMAP(gobject = seqfish_mini, cell_color = 'leiden_clus', show_NN_network = T, point_size = 2.5) # visualize UMAP and spatial results spatDimPlot(gobject = seqfish_mini, cell_color = 'leiden_clus', spat_point_shape = 'voronoi') # heatmap and dendrogram showClusterHeatmap(gobject = seqfish_mini, cluster_column = 'leiden_clus') # install.packages('ggdendro') library(ggdendro) showClusterDendrogram(seqfish_mini, h = 0.5, rotate = T, cluster_column = 'leiden_clus')"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"differential-expression","dir":"Articles","previous_headings":"","what":"5. Differential expression","title":"mini seqFISH","text":"","code":"gini_markers = findMarkers_one_vs_all(gobject = seqfish_mini,                                       method = 'gini',                                       expression_values = 'normalized',                                       cluster_column = 'leiden_clus',                                       min_feats = 20,                                       min_expr_gini_score = 0.5,                                       min_det_gini_score = 0.5) # get top 2 genes per cluster and visualize with violin plot topgenes_gini = gini_markers[, head(.SD, 2), by = 'cluster'] violinPlot(seqfish_mini, feats = topgenes_gini$feats[1:4], cluster_column = 'leiden_clus') # get top 6 genes per cluster and visualize with heatmap topgenes_gini2 = gini_markers[, head(.SD, 6), by = 'cluster'] plotMetaDataHeatmap(seqfish_mini, selected_feats = topgenes_gini2$feats,                     metadata_cols = c('leiden_clus'))"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"cell-type-annotation","dir":"Articles","previous_headings":"","what":"6. Cell type annotation","title":"mini seqFISH","text":"","code":"clusters_cell_types = c('cell A', 'cell B', 'cell C', 'cell D',                         'cell E', 'cell F', 'cell G', 'cell H') names(clusters_cell_types) = 1:8 seqfish_mini = annotateGiotto(gobject = seqfish_mini,                                annotation_vector = clusters_cell_types,                                cluster_column = 'leiden_clus',                                name = 'cell_types') # check new cell metadata pDataDT(seqfish_mini) # visualize annotations spatDimPlot(gobject = seqfish_mini, cell_color = 'cell_types',              spat_point_size = 3, dim_point_size = 3) # heatmap topgenes_heatmap = gini_markers[, head(.SD, 4), by = 'cluster'] plotHeatmap(gobject = seqfish_mini,             feats = topgenes_heatmap$feats,              feat_order = 'custom',             feat_custom_order = unique(topgenes_heatmap$feats),             cluster_column = 'cell_types',             legend_nrows = 1)"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"spatial-grid","dir":"Articles","previous_headings":"","what":"7. Spatial grid","title":"mini seqFISH","text":"Create grid based defined step sizes x,y(,z) axes.","code":"seqfish_mini = createSpatialGrid(gobject = seqfish_mini,                                  sdimx_stepsize = 300,                                  sdimy_stepsize = 300,                                  minimum_padding = 50) showGiottoSpatGrids(seqfish_mini) # visualize grid spatPlot(gobject = seqfish_mini, show_grid = T, point_size = 1.5)"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"spatial-network","dir":"Articles","previous_headings":"","what":"8. Spatial network","title":"mini seqFISH","text":"Visualize information default Delaunay network Create spatial Delaunay network (default) Create spatial kNN network","code":"plotStatDelaunayNetwork(gobject = seqfish_mini, maximum_distance = 400) seqfish_mini = createSpatialNetwork(gobject = seqfish_mini, minimum_k = 2,                                      maximum_distance_delaunay = 400) seqfish_mini = createSpatialNetwork(gobject = seqfish_mini, minimum_k = 2,                                      method = 'kNN', k = 10) showGiottoSpatNetworks(seqfish_mini) # visualize the two different spatial networks   spatPlot(gobject = seqfish_mini, show_network = T,          network_color = 'blue', spatial_network_name = 'Delaunay_network',          point_size = 2.5, cell_color = 'leiden_clus') spatPlot(gobject = seqfish_mini, show_network = T,          network_color = 'blue', spatial_network_name = 'kNN_network',          point_size = 2.5, cell_color = 'leiden_clus')"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"spatial-genes","dir":"Articles","previous_headings":"","what":"9. Spatial genes","title":"mini seqFISH","text":"Identify spatial genes 3 different methods: binSpect k-means binarization (default) binSpect rank binarization silhouetteRank Visualize top 4 genes per method.","code":"km_spatialgenes = binSpect(seqfish_mini) spatFeatPlot2D(seqfish_mini, expression_values = 'scaled',                 feats = km_spatialgenes[1:4]$feats,                point_shape = 'border', point_border_stroke = 0.1,                show_network = F, network_color = 'lightgrey', point_size = 2.5,                cow_n_col = 2) rank_spatialgenes = binSpect(seqfish_mini, bin_method = 'rank') spatFeatPlot2D(seqfish_mini, expression_values = 'scaled',                 feats = rank_spatialgenes[1:4]$feats,                point_shape = 'border', point_border_stroke = 0.1,                show_network = F, network_color = 'lightgrey', point_size = 2.5,                cow_n_col = 2) silh_spatialgenes = silhouetteRank(gobject = seqfish_mini) # TODO: suppress print output spatFeatPlot2D(seqfish_mini, expression_values = 'scaled',                 feats = silh_spatialgenes[1:4]$genes,                point_shape = 'border', point_border_stroke = 0.1,                show_network = F, network_color = 'lightgrey', point_size = 2.5,                cow_n_col = 2)"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"spatial-co-expression-patterns","dir":"Articles","previous_headings":"","what":"10. Spatial co-expression patterns","title":"mini seqFISH","text":"Identify robust spatial co-expression patterns using spatial network grid subset individual spatial genes. Calculate spatial correlation scores Cluster correlation scores","code":"# 1. calculate spatial correlation scores  ext_spatial_genes = km_spatialgenes[1:500]$feats spat_cor_netw_DT = detectSpatialCorFeats(seqfish_mini,                                          method = 'network',                                           spatial_network_name = 'Delaunay_network',                                          subset_feats = ext_spatial_genes) # 2. cluster correlation scores spat_cor_netw_DT = clusterSpatialCorFeats(spat_cor_netw_DT,                                            name = 'spat_netw_clus', k = 8) heatmSpatialCorFeats(seqfish_mini, spatCorObject = spat_cor_netw_DT,                       use_clus_name = 'spat_netw_clus') netw_ranks = rankSpatialCorGroups(seqfish_mini,                                    spatCorObject = spat_cor_netw_DT,                                    use_clus_name = 'spat_netw_clus') top_netw_spat_cluster = showSpatialCorFeats(spat_cor_netw_DT,                                              use_clus_name = 'spat_netw_clus',                                             selected_clusters = 6,                                              show_top_feats = 1) cluster_genes_DT = showSpatialCorFeats(spat_cor_netw_DT,                                         use_clus_name = 'spat_netw_clus',                                        show_top_feats = 1) cluster_genes = cluster_genes_DT$clus; names(cluster_genes) = cluster_genes_DT$feat_ID seqfish_mini = createMetafeats(seqfish_mini,                                feat_clusters = cluster_genes,                                name = 'cluster_metagene') spatCellPlot(seqfish_mini,              spat_enr_names = 'cluster_metagene',              cell_annotation_values = netw_ranks$clusters,              point_size = 1.5, cow_n_col = 3)"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"spatial-hmrf-domains","dir":"Articles","previous_headings":"","what":"11. Spatial HMRF domains","title":"mini seqFISH","text":"following HMRF function requires {smfishHmrf} .","code":"# remotes::install_bitbucket(repo = 'qzhudfci/smfishhmrf-r', ref='master') library(smfishHmrf)  hmrf_folder = paste0(temp_dir,'/','11_HMRF/') if(!file.exists(hmrf_folder)) dir.create(hmrf_folder, recursive = T) # perform hmrf my_spatial_genes = km_spatialgenes[1:100]$feats HMRF_spatial_genes = doHMRF(gobject = seqfish_mini,                             expression_values = 'scaled',                             spatial_genes = my_spatial_genes,                             spatial_network_name = 'Delaunay_network',                             k = 9,                             betas = c(28,2,2),                             output_folder = paste0(hmrf_folder, '/', 'Spatial_genes/SG_top100_k9_scaled')) # check and select hmrf for(i in seq(28, 30, by = 2)) {   viewHMRFresults2D(gobject = seqfish_mini,                     HMRFoutput = HMRF_spatial_genes,                     k = 9, betas_to_view = i,                     point_size = 2) } seqfish_mini = addHMRF(gobject = seqfish_mini,                        HMRFoutput = HMRF_spatial_genes,                        k = 9, betas_to_add = c(28),                        hmrf_name = 'HMRF') # visualize selected hmrf result giotto_colors = GiottogetDistinctColors(9) names(giotto_colors) = 1:9 spatPlot(gobject = seqfish_mini, cell_color = 'HMRF_k9_b.28',          point_size = 3, coord_fix_ratio = 1, cell_color_code = giotto_colors)"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"cell-neighborhood-cell-typecell-type-interactions","dir":"Articles","previous_headings":"","what":"12. Cell neighborhood: cell-type/cell-type interactions","title":"mini seqFISH","text":"","code":"set.seed(seed = 2841) cell_proximities = cellProximityEnrichment(gobject = seqfish_mini,                                            cluster_column = 'cell_types',                                            spatial_network_name = 'Delaunay_network',                                            adjust_method = 'fdr',                                            number_of_simulations = 1000) # barplot cellProximityBarplot(gobject = seqfish_mini,                       CPscore = cell_proximities,                       min_orig_ints = 5, min_sim_ints = 5, p_val = 0.5) ## heatmap cellProximityHeatmap(gobject = seqfish_mini, CPscore = cell_proximities,                       order_cell_types = T, scale = T,                      color_breaks = c(-1.5, 0, 1.5),                       color_names = c('blue', 'white', 'red')) # network cellProximityNetwork(gobject = seqfish_mini, CPscore = cell_proximities,                       remove_self_edges = T, only_show_enrichment_edges = T) # network with self-edges cellProximityNetwork(gobject = seqfish_mini, CPscore = cell_proximities,                      remove_self_edges = F, self_loop_strength = 0.3,                      only_show_enrichment_edges = F,                      rescale_edge_weights = T,                      node_size = 8,                      edge_weight_range_depletion = c(1, 2),                      edge_weight_range_enrichment = c(2,5))"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"visualization-of-specific-cell-types","dir":"Articles","previous_headings":"12. Cell neighborhood: cell-type/cell-type interactions","what":"Visualization of specific cell types","title":"mini seqFISH","text":"","code":"# Option 1 spec_interaction = \"cell D--cell F\" cellProximitySpatPlot2D(gobject = seqfish_mini,                         interaction_name = spec_interaction,                         show_network = T,                         cluster_column = 'cell_types',                         cell_color = 'cell_types',                         cell_color_code = c('cell D' = 'lightblue', 'cell F' = 'red'),                         point_size_select = 4, point_size_other = 2) # Option 2: create additional metadata seqfish_mini = addCellIntMetadata(seqfish_mini,                                   spat_unit = \"cell\",                                   spatial_network = 'Delaunay_network',                                   cluster_column = 'cell_types',                                   cell_interaction = spec_interaction,                                   name = 'D_F_interactions') spatPlot(seqfish_mini, cell_color = 'D_F_interactions', legend_symbol_size = 3,          select_cell_groups =  c('other_cell D', 'other_cell F', 'select_cell D', 'select_cell F'))"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"cell-neighborhood-interaction-changed-features","dir":"Articles","previous_headings":"","what":"13. Cell neighborhood: interaction changed features","title":"mini seqFISH","text":"","code":"## select top 25 highest expressing genes gene_metadata = fDataDT(seqfish_mini) plot(gene_metadata$nr_cells, gene_metadata$mean_expr) plot(gene_metadata$nr_cells, gene_metadata$mean_expr_det) quantile(gene_metadata$mean_expr_det) high_expressed_genes = gene_metadata[mean_expr_det > 4]$feat_ID  ## identify features (genes) that are associated with proximity to other cell types ICFscoresHighGenes = findICF(gobject = seqfish_mini,                              selected_feats = high_expressed_genes,                              spatial_network_name = 'Delaunay_network',                              cluster_column = 'cell_types',                              diff_test = 'permutation',                              adjust_method = 'fdr',                              nr_permutations = 500,                              do_parallel = T) ## visualize all genes plotCellProximityFeats(seqfish_mini, icfObject = ICFscoresHighGenes, method = 'dotplot') ## filter genes ICFscoresFilt = filterICF(ICFscoresHighGenes, min_cells = 2, min_int_cells = 2, min_fdr = 0.1,                           min_spat_diff = 0.1, min_log2_fc = 0.1, min_zscore = 1) ## visualize subset of interaction changed genes (ICGs) ICF_genes = c('Cpne2', 'Scg3', 'Cmtm3', 'Cplx1', 'Lingo1') ICF_genes_types = c('cell E', 'cell D', 'cell D', 'cell G', 'cell E') names(ICF_genes) = ICF_genes_types plotICF(gobject = seqfish_mini,         icfObject = ICFscoresHighGenes,         source_type = 'cell A',         source_markers = c('Csf1r', 'Laptm5'),         ICF_feats = ICF_genes)"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"cell-neighborhood-ligand-receptor-cell-cell-communication","dir":"Articles","previous_headings":"","what":"14. Cell neighborhood: ligand-receptor cell-cell communication","title":"mini seqFISH","text":"","code":"LR_data = data.table::fread(paste0(data_directory, \"mouse_ligand_receptors.txt\")) LR_data[, ligand_det := ifelse(mouseLigand %in% seqfish_mini@feat_ID[['rna']], T, F)] LR_data[, receptor_det := ifelse(mouseReceptor %in% seqfish_mini@feat_ID[['rna']], T, F)] LR_data_det = LR_data[ligand_det == T & receptor_det == T] select_ligands = LR_data_det$mouseLigand select_receptors = LR_data_det$mouseReceptor  ## get statistical significance of gene pair expression changes based on expression ## expr_only_scores = exprCellCellcom(gobject = seqfish_mini,                                    cluster_column = 'cell_types',                                    random_iter = 50,                                    feat_set_1 = select_ligands,                                    feat_set_2 = select_receptors)  ## get statistical significance of gene pair expression changes upon cell-cell interaction spatial_all_scores = spatCellCellcom(seqfish_mini,                                      spat_unit = 'cell',                                      feat_type = 'rna',                                      spatial_network_name = 'Delaunay_network',                                      cluster_column = 'cell_types',                                      random_iter = 50,                                      feat_set_1 = select_ligands,                                      feat_set_2 = select_receptors,                                      adjust_method = 'fdr',                                      do_parallel = T,                                      cores = 4,                                      verbose = 'none')  ## * plot communication scores #### ## select top LR ## selected_spat = spatial_all_scores[p.adj <= 0.5 & abs(log2fc) > 0.1 & lig_nr >= 2 & rec_nr >= 2] data.table::setorder(selected_spat, -PI) top_LR_ints = unique(selected_spat[order(-abs(PI))]$LR_comb)[1:33] top_LR_cell_ints = unique(selected_spat[order(-abs(PI))]$LR_cell_comb)[1:33] plotCCcomHeatmap(gobject = seqfish_mini,                  comScores = spatial_all_scores,                  selected_LR = top_LR_ints,                  selected_cell_LR = top_LR_cell_ints,                  show = 'LR_expr') plotCCcomDotplot(gobject = seqfish_mini,                  comScores = spatial_all_scores,                  selected_LR = top_LR_ints,                  selected_cell_LR = top_LR_cell_ints,                  cluster_on = 'PI') ## * spatial vs rank #### comb_comm = combCCcom(spatialCC = spatial_all_scores,                       exprCC = expr_only_scores) # top differential activity levels for ligand receptor pairs plotRankSpatvsExpr(gobject = seqfish_mini,                    comb_comm,                    expr_rnk_column = 'exprPI_rnk',                    spat_rnk_column = 'spatPI_rnk',                    midpoint = 10) ## * recovery #### ## predict maximum differential activity plotRecovery(gobject = seqfish_mini,              comb_comm,              expr_rnk_column = 'exprPI_rnk',              spat_rnk_column = 'spatPI_rnk',              ground_truth = 'spatial')"},{"path":"https://drieslab.github.io/Giotto/articles/mini_seqfish.html","id":"export-giotto-analyzer-to-viewer","dir":"Articles","previous_headings":"","what":"15. Export Giotto Analyzer to Viewer","title":"mini seqFISH","text":"","code":"viewer_folder = paste0(temp_dir, '/', 'Mouse_cortex_viewer') # select annotations, reductions and expression values to view in Giotto Viewer exportGiottoViewer(gobject = seqfish_mini,                    output_directory = viewer_folder,                    factor_annotations = c('cell_types',                                           'leiden_clus',                                           'HMRF_k9_b.28'),                    numeric_annotations = 'total_expr',                    dim_reductions = c('umap'),                    dim_reduction_names = c('umap'),                    expression_values = 'scaled',                    expression_rounding = 3,                    overwrite_dir = T)"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"setup","dir":"Articles","previous_headings":"","what":"1. Setup","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"# Custom color palettes from rcartocolor # pal10 = rcartocolor::carto_pal(n = 10, name = 'Pastel') pal10 = c(\"#66C5CC\",\"#F6CF71\",\"#F89C74\",\"#DCB0F2\",\"#87C55F\",           \"#9EB9F3\",\"#FE88B1\",\"#C9DB74\",\"#8BE0A4\",\"#B3B3B3\") # viv10 = rcartocolor::carto_pal(n = 10, name = 'Vivid') viv10 = c(\"#E58606\",\"#5D69B1\",\"#52BCA3\",\"#99C945\",\"#CC61B0\",           \"#24796C\",\"#DAA51B\",\"#2F8AC4\",\"#764E9F\",\"#A5AA99\")  # set working directory results_folder = '/path/to/directory'  # Optional: Specify a path to a Python executable within a conda or miniconda # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired.  ## Set object behavior # by directly saving plots, but not rendering them you will save a lot of time instrs = createGiottoInstructions(save_dir = results_folder,                                   save_plot = TRUE,                                   show_plot = FALSE,                                   return_plot = FALSE,                                   python_path = my_python_path)"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"sec-loadfxn","dir":"Articles","previous_headings":"1. Setup","what":"1.1 CosMx Project loading function","title":"Nanostring CosMx Subcellular Lung Cancer","text":"Convenience function loading CosMx data. loads subcellular transcript information polygons generates giotto object giottoPoints objects ‘rna’ ‘neg_probe’ nested gobject feat_info slot, giottoPolygon object ‘cell’ spatial unit spatial_info slot. function performs manual object creation steps described . skip steps preliminary data exploration, go Section 5. Additionally, comparison count matrix produced convenience function ‘subcellular’ workflow Nanostring’s provided matrix can found Section 6.4.","code":"## provide path to nanostring folder data_path = '/path/to/data/Lung12-Flat_files_and_images/'  ## create giotto cosmx object fov_join = createGiottoCosMxObject(cosmx_dir = data_path,                                    data_to_use = 'subcellular', # only subcellular                                    FOVs = c(2,3,4),                                    instructions = instrs)  showGiottoFeatInfo(fov_join) showGiottoSpatialInfo(fov_join)"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"subcellular-detections-points-info","dir":"Articles","previous_headings":"2. Data exploration and loading","what":"2.1 Subcellular detections (points info)","title":"Nanostring CosMx Subcellular Lung Cancer","text":"tx_file.csv contains subcellular detections information. contains information individual feature detections within sample. fov FOV detection happened cell_ID ID cell detection happened x_global_px global spatial x location pixels y_global_px global spatial y location pixels x_local_px spatial x location pixels within FOV y_local_px spatial y location pixels within FOV z z plane detection called (-1 16) target feature probe targeted CellComp Cellular compartment detection happened (0, Cytoplasm, Membrane, Nuclear)","code":"## provide path to nanostring folder data_path = '/path/to/data/Lung12-Flat_files_and_images/'  # load transcript coordinates tx_coord_all = data.table::fread(paste0(data_path, 'Lung12_tx_file.csv'))  colnames(tx_coord_all) cat('\\n') # z planes tx_coord_all[, table(z)] cat('\\n') # Cell compartment tx_coord_all[, table(CellComp)] # [1] \"fov\"         \"cell_ID\"     \"x_global_px\" \"y_global_px\" # [5] \"x_local_px\"  \"y_local_px\"  \"z\"           \"target\"      # [9] \"CellComp\"  #  # z #      -1       0       1       2       3       4       5       6  #   23723 3466178 2522315 2694973 2686531 2648926 2660346 2711105  #       7       8       9      10      11      12      13      14  # 2855259 3700831   36840    6594    6466    6787    6944    6959  #      15      16  #   17603       2  #    # CellComp #         0 Cytoplasm  Membrane   Nuclear  #   6619744   5770549   3368411  10299678"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"split-detections-by-features-vs-negative-probes","dir":"Articles","previous_headings":"2. Data exploration and loading","what":"2.2 Split detections by features vs negative probes","title":"Nanostring CosMx Subcellular Lung Cancer","text":"tx_file.csv contains information actual features (960 targeted gene probes dataset) negative probes (20) targeted alien sequences defined External RNA Controls Consortium (ERCC) exist human tissue. two types detections treated separate feature types (feat_type) placed separate expression matrices.","code":"all_IDs = tx_coord_all[, unique(target)] # negative probe IDs neg_IDs = all_IDs[grepl(pattern = 'NegPrb', all_IDs)] cat('Negative Probe IDs\\n') neg_IDs cat('\\nFeature IDs\\n') feat_IDs = all_IDs[!all_IDs %in% neg_IDs] length(feat_IDs)  # split detections feat_coords_all = tx_coord_all[target %in% feat_IDs] neg_coords_all = tx_coord_all[target %in% neg_IDs]  cat('\\nFeatures: ', feat_coords_all[, .N], '\\n',     'NegProbes: ', neg_coords_all[, .N]) # Negative Probe IDs #  [1] \"NegPrb15\" \"NegPrb18\" \"NegPrb7\"  \"NegPrb21\" \"NegPrb13\" #  [6] \"NegPrb10\" \"NegPrb11\" \"NegPrb9\"  \"NegPrb3\"  \"NegPrb16\" # [11] \"NegPrb23\" \"NegPrb14\" \"NegPrb20\" \"NegPrb8\"  \"NegPrb19\" # [16] \"NegPrb6\"  \"NegPrb5\"  \"NegPrb12\" \"NegPrb17\" \"NegPrb22\" #  # Number of feature IDs # [1] 960 #  # Features:  25875734 # NegProbes:  182648 #   [1] \"IL7R\"       \"SEC61G\"     \"IGHA1\"      \"CD164\"      \"IL6\"        #   [6] \"CCR2\"       \"KRT86\"      \"NEAT1\"      \"NLRP1\"      \"S100A10\"    #  [11] \"KRT80\"      \"MYH11\"      \"OLR1\"       \"FYN\"        \"NR1H4\"      #  [16] \"NDRG1\"      \"AGR2\"       \"FGR\"        \"NFKB1\"      \"IL4R\"       #  [21] \"VWF\"        \"EOMES\"      \"COL16A1\"    \"IL1RL1\"     \"ITGAL\"      #  [26] \"GLUD1\"      \"STAT3\"      \"MAPK14\"     \"VHL\"        \"CD44\"       #  [31] \"RAMP1\"      \"ZFP36\"      \"CD27\"       \"GDF15\"      \"EPCAM\"      #  [36] \"LAMP3\"      \"LTB\"        \"COL12A1\"    \"LGALS9\"     \"HLA-DQB1\"   #  [41] \"CLU\"        \"ALCAM\"      \"TLR7\"       \"FGF1\"       \"NR1H3\"      #  [46] \"TNFSF18\"    \"EIF5A\"      \"LGALS3\"     \"CD63\"       \"FOXP3\"      #  [51] \"DCN\"        \"CUZD1\"      \"LIF\"        \"BMP6\"       \"HCST\"       #  [56] \"VSIR\"       \"STAT1\"      \"GDNF\"       \"UBE2C\"      \"APOA1\"      #  [61] \"ADGRF1\"     \"PDGFC\"      \"IL17A\"      \"YES1\"       \"TGFBR2\"     #  [66] \"GPX3\"       \"IFIH1\"      \"SOX9\"       \"MX1\"        \"IGKC\"       #  [71] \"CD8A\"       \"PTGES3\"     \"KRAS\"       \"CRYAB\"      \"ACTA2\"      #  [76] \"EGF\"        \"CD5L\"       \"BCL2L1\"     \"SRGN\"       \"FGFR3\"      #  [81] \"CD53\"       \"CELSR2\"     \"MTRNR2L1\"   \"LAMP2\"      \"LAIR1\"      #  [86] \"FGF13\"      \"EFNA1\"      \"CLEC2B\"     \"FZD5\"       \"SYK\"        #  [91] \"FES\"        \"MZT2A\"      \"SERPINA1\"   \"HIF1A\"      \"JUN\"        #  [96] \"THBS1\"      \"CHEK2\"      \"CD274\"      \"CXCL3\"      \"IL11\"       # [101] \"GPX1\"       \"FASLG\"      \"EPHA2\"      \"TGFB3\"      \"RARG\"       # [106] \"CLDN4\"      \"G6PC2\"      \"KITLG\"      \"ADGRG3\"     \"RPL34\"      # [111] \"HLA-A\"      \"ESAM\"       \"HDAC1\"      \"MGP\"        \"MECOM\"      # [116] \"MRC2\"       \"ACE2\"       \"COL4A2\"     \"CDH1\"       \"ATG10\"      # [121] \"IL32\"       \"SERPINA3\"   \"SRC\"        \"IGFBP6\"     \"IER3\"       # [126] \"QRFPR\"      \"CD276\"      \"ITGA9\"      \"INHBA\"      \"CXCL1\"      # [131] \"ATG12\"      \"ERBB2\"      \"FCRLA\"      \"TIE1\"       \"EFNB1\"      # [136] \"IGHG2\"      \"FZD3\"       \"SAA1\"       \"CCL23\"      \"JUNB\"       # [141] \"COTL1\"      \"CSF1R\"      \"TNFAIP6\"    \"KIT\"        \"RSPO1\"      # [146] \"RARB\"       \"CXCR4\"      \"CD28\"       \"FGFR2\"      \"RGS1\"       # [151] \"ACVR2A\"     \"CD3G\"       \"ADORA2A\"    \"IGFBP3\"     \"NOD2\"       # [156] \"KRT1\"       \"LPAR5\"      \"CD36\"       \"ACKR3\"      \"CCL3\"       # [161] \"CD48\"       \"TYK2\"       \"TGFB1\"      \"CD2\"        \"CTSG\"       # [166] \"CFLAR\"      \"IDO1\"       \"TIMP1\"      \"TGFBR1\"     \"BTK\"        # [171] \"BMP7\"       \"HSPB1\"      \"GDF10\"      \"CD37\"       \"ADIPOQ\"     # [176] \"WNT5A\"      \"TAP1\"       \"CRIP1\"      \"ATF3\"       \"PTHLH\"      # [181] \"ITGA3\"      \"CD3E\"       \"TGFB2\"      \"HLA-DRA\"    \"TLR8\"       # [186] \"ADGRG5\"     \"ITGAE\"      \"MKI67\"      \"EPHA4\"      \"CSF3\"       # [191] \"BMP3\"       \"COL6A1\"     \"IL1RN\"      \"CCR7\"       \"CD19\"       # [196] \"VCAN\"       \"FAS\"        \"WNT7A\"      \"FCGBP\"      \"IL18R1\"     # [201] \"EPHB4\"      \"TYROBP\"     \"KRT14\"      \"TACSTD2\"    \"PF4\"        # [206] \"JCHAIN\"     \"WIF1\"       \"ANXA2\"      \"CYSTM1\"     \"RPL32\"      # [211] \"KRT13\"      \"CFD\"        \"COL14A1\"    \"STMN1\"      \"CCL4\"       # [216] \"PTGS2\"      \"SUCNR1\"     \"RAD51\"      \"THBS2\"      \"KDR\"        # [221] \"SCGB3A1\"    \"CENPF\"      \"CD52\"       \"ROR1\"       \"GZMA\"       # [226] \"HCAR2\"      \"CSF3R\"      \"IL10RB\"     \"CXCL2\"      \"GZMH\"       # [231] \"PECAM1\"     \"CCL2\"       \"DUSP5\"      \"SLC40A1\"    \"PTGDR2\"     # [236] \"ITGB8\"      \"SAT1\"       \"S100A6\"     \"IFNB1\"      \"IGFBP7\"     # [241] \"TCL1A\"      \"S100P\"      \"DST\"        \"IFI27\"      \"H4C3\"       # [246] \"MMP16\"      \"CX3CL1\"     \"CALM3\"      \"DUSP6\"      \"IL36G\"      # [251] \"COL6A2\"     \"SOX4\"       \"TNFRSF10B\"  \"CCL19\"      \"KRT19\"      # [256] \"ACE\"        \"TPM2\"       \"FGF9\"       \"COL1A2\"     \"RAC1\"       # [261] \"RPL21\"      \"IL15RA\"     \"HMGN2\"      \"VEGFA\"      \"CDKN1A\"     # [266] \"COL18A1\"    \"IGF1\"       \"SLPI\"       \"FLT1\"       \"CD9\"        # [271] \"KRT5\"       \"TNFRSF12A\"  \"MIF\"        \"YBX3\"       \"S100A4\"     # [276] \"HPGDS\"      \"INHA\"       \"IGHG1\"      \"CLEC12A\"    \"NPPC\"       # [281] \"KRT8\"       \"IFNL2\"      \"TPSAB1\"     \"ATR\"        \"SMAD3\"      # [286] \"TUBB\"       \"KRT7\"       \"TBX21\"      \"CTNNB1\"     \"IRF4\"       # [291] \"DMBT1\"      \"ACKR4\"      \"SPARCL1\"    \"POU5F1\"     \"IRF3\"       # [296] \"MMP7\"       \"RXRA\"       \"TNFRSF11B\"  \"IL12A\"      \"DDR1\"       # [301] \"IL1RAP\"     \"ITGAM\"      \"DDIT3\"      \"TWIST1\"     \"NLRP2\"      # [306] \"LDLR\"       \"CXCL10\"     \"SAA2\"       \"KRT23\"      \"CAV1\"       # [311] \"IL1A\"       \"B2M\"        \"ELANE\"      \"TEK\"        \"ITGAV\"      # [316] \"FKBP11\"     \"ICAM3\"      \"TNFSF10\"    \"ERBB3\"      \"ADGRG6\"     # [321] \"CD80\"       \"CPA3\"       \"CTSW\"       \"MAML2\"      \"PHLDA2\"     # [326] \"LIFR\"       \"IL13RA1\"    \"HILPDA\"     \"KLF2\"       \"EPHA7\"      # [331] \"IL18\"       \"COL1A1\"     \"GLUL\"       \"DDR2\"       \"TM4SF1\"     # [336] \"KRT6C\"      \"COL5A2\"     \"CLEC10A\"    \"CSHL1\"      \"IL2RB\"      # [341] \"TPSB2\"      \"ITK\"        \"C1QC\"       \"CXCL16\"     \"IFNA1\"      # [346] \"IFNAR1\"     \"IGF2\"       \"ATG5\"       \"NKG7\"       \"RARRES2\"    # [351] \"AZU1\"       \"CLEC4A\"     \"GSTP1\"      \"GPBAR1\"     \"TNFRSF1A\"   # [356] \"IFITM3\"     \"DUSP1\"      \"CCR10\"      \"EPHB2\"      \"ITGA6\"      # [361] \"CAMP\"       \"CD14\"       \"TXK\"        \"SERPINH1\"   \"NPR3\"       # [366] \"MTOR\"       \"CRP\"        \"MMP2\"       \"IGF2R\"      \"TAGLN\"      # [371] \"PSAP\"       \"MS4A1\"      \"MST1R\"      \"KLRK1\"      \"BGN\"        # [376] \"TNFRSF9\"    \"P2RY12\"     \"PTK2\"       \"IL23A\"      \"RXRB\"       # [381] \"NOTCH3\"     \"FOXF1\"      \"COL15A1\"    \"SQSTM1\"     \"CCL15\"      # [386] \"S100A2\"     \"MMP3\"       \"CCL8\"       \"ESR1\"       \"SMARCB1\"    # [391] \"RGCC\"       \"PPARA\"      \"IL2RA\"      \"SMAD4\"      \"EFNA4\"      # [396] \"RARRES1\"    \"COL3A1\"     \"ITGB6\"      \"CD74\"       \"ANXA4\"      # [401] \"SFN\"        \"ARHGDIB\"    \"TNFRSF10A\"  \"VEGFC\"      \"HLA-B\"      # [406] \"HLA-DRB5\"   \"CD3D\"       \"ITGA1\"      \"ANGPT1\"     \"KRT24\"      # [411] \"MET\"        \"MALAT1\"     \"HSP90AB1\"   \"ABL2\"       \"LTF\"        # [416] \"MMP12\"      \"ACKR1\"      \"MERTK\"      \"S100A9\"     \"FZD8\"       # [421] \"INS\"        \"CD33\"       \"HDAC3\"      \"OSM\"        \"CYP1B1\"     # [426] \"ITGB2\"      \"CD40LG\"     \"CALD1\"      \"CLOCK\"      \"COL11A1\"    # [431] \"C9orf16\"    \"IL1B\"       \"CCL11\"      \"FGF18\"      \"BID\"        # [436] \"MT1X\"       \"KLK3\"       \"CCL28\"      \"RAMP3\"      \"OXER1\"      # [441] \"IL3RA\"      \"ADGRB3\"     \"FASN\"       \"MMP8\"       \"ITGA2\"      # [446] \"CCL5\"       \"MRC1\"       \"IGFBP5\"     \"PPARG\"      \"G6PD\"       # [451] \"CCND1\"      \"TLR2\"       \"RAMP2\"      \"PTPRC\"      \"BIRC5\"      # [456] \"ITM2A\"      \"IL11RA\"     \"STAT5A\"     \"COL27A1\"    \"PPARD\"      # [461] \"FFAR4\"      \"ADGRE5\"     \"FGF7\"       \"MMP14\"      \"MZB1\"       # [466] \"NOSIP\"      \"TNFRSF19\"   \"ADGRL2\"     \"FABP5\"      \"IFNGR1\"     # [471] \"VTN\"        \"FCER1G\"     \"CASP8\"      \"ITGB1\"      \"SOX2\"       # [476] \"GNLY\"       \"CCRL2\"      \"RSPO3\"      \"IGF1R\"      \"NOTCH2\"     # [481] \"IL10RA\"     \"TWIST2\"     \"LMNA\"       \"LCN2\"       \"PSCA\"       # [486] \"ADGRG2\"     \"AKT1\"       \"SPRY4\"      \"SELL\"       \"PDGFD\"      # [491] \"LYN\"        \"WNT11\"      \"IFNAR2\"     \"TNFRSF14\"   \"OASL\"       # [496] \"SNAI2\"      \"OLFM4\"      \"CYTOR\"      \"CXCR6\"      \"RARA\"       # [501] \"RUNX3\"      \"WNT3\"       \"PIGR\"       \"PDCD1\"      \"RGS2\"       # [506] \"LEFTY2\"     \"TLR5\"       \"CDKN3\"      \"ACVRL1\"     \"FZD4\"       # [511] \"FGF2\"       \"SMO\"        \"AHR\"        \"SELPLG\"     \"HDAC5\"      # [516] \"GATA3\"      \"CD81\"       \"PNOC\"       \"PLAC8\"      \"HLA-DPA1\"   # [521] \"MXRA8\"      \"CXCR1\"      \"SNAI1\"      \"KLRB1\"      \"IFNG\"       # [526] \"COL17A1\"    \"IL7\"        \"LUM\"        \"MMP1\"       \"IL22RA1\"    # [531] \"ITGB5\"      \"IL33\"       \"LYZ\"        \"FFAR3\"      \"SOD2\"       # [536] \"HCK\"        \"CCR1\"       \"UCP1\"       \"WNT10B\"     \"OXGR1\"      # [541] \"FGG\"        \"BST1\"       \"RELT\"       \"WNT5B\"      \"IL12RB2\"    # [546] \"DUSP2\"      \"HBB\"        \"CD83\"       \"CLEC2D\"     \"CSF2RB\"     # [551] \"HDAC11\"     \"IL17RE\"     \"COL5A3\"     \"WNT7B\"      \"TSLP\"       # [556] \"CALM1\"      \"IL2RG\"      \"CLEC4D\"     \"ADGRL1\"     \"APP\"        # [561] \"KRT20\"      \"CCL4L2\"     \"CD68\"       \"VIM\"        \"H2AZ1\"      # [566] \"LINC02446\"  \"BAX\"        \"CD34\"       \"FZD6\"       \"CEACAM6\"    # [571] \"ST6GALNAC3\" \"PTGS1\"      \"TNFSF8\"     \"VEGFD\"      \"ADGRF5\"     # [576] \"HSD3B2\"     \"COL9A2\"     \"KRT16\"      \"PDGFB\"      \"FYB1\"       # [581] \"CASP3\"      \"BRCA1\"      \"CXCL9\"      \"CLEC1A\"     \"IL20RA\"     # [586] \"HSPA1B\"     \"LEP\"        \"GCG\"        \"LY6D\"       \"DUSP4\"      # [591] \"CD59\"       \"EPHA3\"      \"RORA\"       \"WNT2\"       \"ADGRA2\"     # [596] \"CALM2\"      \"CLEC7A\"     \"HLA-C\"      \"TNFSF4\"     \"TYMS\"       # [601] \"IFITM1\"     \"MT2A\"       \"SMAD2\"      \"KRT17\"      \"PTK6\"       # [606] \"OSMR\"       \"CHEK1\"      \"CD79A\"      \"CASR\"       \"SPRY2\"      # [611] \"IGHM\"       \"S100B\"      \"GDF6\"       \"TNFSF9\"     \"IL34\"       # [616] \"DLL1\"       \"SPOCK2\"     \"NRXN1\"      \"CSF1\"       \"IL6ST\"      # [621] \"HDAC4\"      \"TOP2A\"      \"GAS6\"       \"ITGA5\"      \"COL5A1\"     # [626] \"ST6GAL1\"    \"TNFRSF1B\"   \"EMP3\"       \"TNFRSF13B\"  \"KRT6B\"      # [631] \"ABL1\"       \"CTLA4\"      \"EPOR\"       \"SLC2A4\"     \"MMP9\"       # [636] \"IL24\"       \"CHI3L1\"     \"PTGDS\"      \"CD209\"      \"RPL37\"      # [641] \"CD38\"       \"GPNMB\"      \"STAT5B\"     \"ETS1\"       \"DDC\"        # [646] \"LGALS1\"     \"KRT18\"      \"MYL9\"       \"EFNB3\"      \"ANXA1\"      # [651] \"BST2\"       \"COL4A1\"     \"GSN\"        \"CD58\"       \"CD55\"       # [656] \"PTPRCAP\"    \"VCAM1\"      \"ACVR1\"      \"IL12B\"      \"RB1\"        # [661] \"C11orf96\"   \"XCL2\"       \"SPINK1\"     \"C1QA\"       \"ITGAX\"      # [666] \"TNFRSF21\"   \"JAK1\"       \"IL17RB\"     \"IFNL3\"      \"HLA-DQA1\"   # [671] \"ETV5\"       \"TNFSF12\"    \"TIGIT\"      \"ENTPD1\"     \"RSPO2\"      # [676] \"ANGPT4\"     \"TLR4\"       \"EPHB3\"      \"ICOSLG\"     \"NRIP3\"      # [681] \"MARCO\"      \"NLRC4\"      \"CCL13\"      \"CIITA\"      \"OAS1\"       # [686] \"HBA1\"       \"EFNB2\"      \"HLA-DRB1\"   \"ADGRF3\"     \"TUBB4B\"     # [691] \"MAF\"        \"TSHZ2\"      \"SPP1\"       \"IL2\"        \"CALB1\"      # [696] \"CCL7\"       \"ADGRE1\"     \"XCL1\"       \"PDGFRA\"     \"CXCL17\"     # [701] \"STAT6\"      \"SLC2A1\"     \"COL8A1\"     \"SST\"        \"PTGES\"      # [706] \"LAG3\"       \"CCL18\"      \"CIDEA\"      \"BMP4\"       \"CXCL8\"      # [711] \"EGFR\"       \"KRT4\"       \"DNMT3A\"     \"FLT3LG\"     \"HLA-E\"      # [716] \"FZD7\"       \"OAS3\"       \"COL9A3\"     \"TLR1\"       \"APOD\"       # [721] \"ICAM2\"      \"PDGFA\"      \"PRF1\"       \"TFEB\"       \"AREG\"       # [726] \"ARG1\"       \"IL27RA\"     \"TNFRSF10D\"  \"GADD45B\"    \"HSP90AA1\"   # [731] \"DPP4\"       \"MMP19\"      \"TPM1\"       \"P2RX5\"      \"CST7\"       # [736] \"BEST1\"      \"MMP10\"      \"CXCR5\"      \"PTTG1\"      \"TOX\"        # [741] \"CDH11\"      \"MYC\"        \"PDGFRB\"     \"ANGPTL1\"    \"ADGRF4\"     # [746] \"AHI1\"       \"HLA-DPB1\"   \"TNFRSF11A\"  \"TNFSF15\"    \"AR\"         # [751] \"IL1R1\"      \"CCL20\"      \"NLRC5\"      \"HAVCR2\"     \"LTBR\"       # [756] \"GDF3\"       \"TAP2\"       \"INSR\"       \"IL15\"       \"HSD17B2\"    # [761] \"CD84\"       \"MPO\"        \"SELENOP\"    \"SEC23A\"     \"DHRS2\"      # [766] \"HSP90B1\"    \"HSPA1A\"     \"BCL2\"       \"XBP1\"       \"RBPJ\"       # [771] \"EZH2\"       \"MSMB\"       \"EFNA5\"      \"AXL\"        \"NLRP3\"      # [776] \"FN1\"        \"CD8B\"       \"CXCR2\"      \"CNTFR\"      \"TNFRSF18\"   # [781] \"COL6A3\"     \"CCR5\"       \"NRG4\"       \"ITGB4\"      \"CSF2\"       # [786] \"TLR3\"       \"IGHD\"       \"CD70\"       \"INHBB\"      \"MAPK13\"     # [791] \"MEG3\"       \"PLA2R1\"     \"MAP1LC3B\"   \"PPBP\"       \"IL17D\"      # [796] \"CD4\"        \"IL20\"       \"IL17B\"      \"KRT15\"      \"RPL22\"      # [801] \"RYK\"        \"NTRK2\"      \"CCL21\"      \"DDX58\"      \"CD24\"       # [806] \"IL10\"       \"PARP1\"      \"CD300A\"     \"CDH5\"       \"BTG1\"       # [811] \"NFKBIA\"     \"PRSS2\"      \"CXCL6\"      \"CSF2RA\"     \"ADGRD1\"     # [816] \"WNT9A\"      \"ADIRF\"      \"ICOS\"       \"KRT6A\"      \"CD86\"       # [821] \"C5AR2\"      \"FOS\"        \"SCG5\"       \"IFNGR2\"     \"LGALS3BP\"   # [826] \"CD69\"       \"RGS5\"       \"BMP2\"       \"BMP5\"       \"RELA\"       # [831] \"CLCF1\"      \"COL4A5\"     \"BMPR2\"      \"FCGR3A\"     \"REG1A\"      # [836] \"EZR\"        \"IL12RB1\"    \"RAC2\"       \"C1QB\"       \"RNF43\"      # [841] \"CLEC4E\"     \"PCNA\"       \"CLEC5A\"     \"FABP4\"      \"PGR\"        # [846] \"CD163\"      \"ICAM1\"      \"ADGRG1\"     \"HTT\"        \"CD47\"       # [851] \"AQP3\"       \"OAS2\"       \"GPR183\"     \"LEFTY1\"     \"WNT2B\"      # [856] \"BMX\"        \"JAG1\"       \"PTGIS\"      \"EPHB6\"      \"NPR2\"       # [861] \"SREBF1\"     \"CD40\"       \"DNTT\"       \"IL16\"       \"IFIT1\"      # [866] \"ANGPT2\"     \"PTGES2\"     \"DNMT1\"      \"GZMB\"       \"TSC22D1\"    # [871] \"HCAR3\"      \"FGF12\"      \"HGF\"        \"BMP1\"       \"ENG\"        # [876] \"CXCL5\"      \"B3GNT7\"     \"ADM2\"       \"CLEC14A\"    \"ARF1\"       # [881] \"ACVR1B\"     \"GC\"         \"AATK\"       \"ARTN\"       \"ADGRA3\"     # [886] \"FFAR2\"      \"TNF\"        \"S100A8\"     \"BATF3\"      \"SIGIRR\"     # [891] \"VPREB3\"     \"BECN1\"      \"FZD1\"       \"PROK2\"      \"NCR1\"       # [896] \"IL17RA\"     \"IL1R2\"      \"CPB1\"       \"JAK2\"       \"IL6R\"       # [901] \"NANOG\"      \"CYP19A1\"    \"NPPB\"       \"PGF\"        \"FPR1\"       # [906] \"NR1H2\"      \"NRXN3\"      \"NOTCH1\"     \"NR3C1\"      \"KRT10\"      # [911] \"SERPINB5\"   \"CSK\"        \"ADGRB2\"     \"CELSR1\"     \"GPER1\"      # [916] \"RPS4Y1\"     \"HMGB2\"      \"BMPR1A\"     \"PDCD1LG2\"   \"TNFRSF4\"    # [921] \"GZMK\"       \"FGFR1\"      \"GDF9\"       \"SOSTDC1\"    \"TNFSF14\"    # [926] \"NGFR\"       \"UPK3A\"      \"CCL3L3\"     \"BAG3\"       \"LY75\"       # [931] \"ADGRL4\"     \"TTR\"        \"NPR1\"       \"VEGFB\"      \"NRG1\"       # [936] \"AZGP1\"      \"PROKR1\"     \"CXCR3\"      \"STAT4\"      \"ETV4\"       # [941] \"ATM\"        \"TNFRSF17\"   \"APOB\"       \"ADGRE2\"     \"COL21A1\"    # [946] \"CX3CR1\"     \"CMKLR1\"     \"MS4A4A\"     \"COL9A1\"     \"TNFSF13B\"   # [951] \"SOD1\"       \"ACTG2\"      \"TP53\"       \"ADGRV1\"     \"IAPP\"       # [956] \"CCL26\"      \"CXCL14\"     \"CHGA\"       \"CXCL12\"     \"CEACAM1\""},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"preview-negative-probes-optional","dir":"Articles","previous_headings":"2. Data exploration and loading > 2.2 Split detections by features vs negative probes","what":"2.2.1 Preview negative probes (optional)","title":"Nanostring CosMx Subcellular Lung Cancer","text":"Previewing probe information can done converting giottoPoints using plot(). show preview negative probes. Note: previewing rna expression information, highly recommended set subset features using feats param. default plot points, can slow large data.","code":"neg_points = createGiottoPoints(   x = neg_coords_all[, .(target, x_global_px, y_global_px)] ) plot(neg_points, point_size = 0.2, feats = neg_IDs)"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"fov-shifts","dir":"Articles","previous_headings":"2. Data exploration and loading","what":"2.3 FOV shifts","title":"Nanostring CosMx Subcellular Lung Cancer","text":"fov_positions_file.csv contains information x y shifts needed order put FOVs tiles together cohesive whole. information needed image attachment alignment process.","code":"#  load field of vision (fov) positions fov_offset_file = data.table::fread(paste0(data_path, 'Lung12_fov_positions_file.csv')) #     fov x_global_px y_global_px #  1:   1  -4977.7778   -160233.3 #  2:   2    494.4444   -160233.3 #  3:   3   5966.6667   -160233.3 #  4:   4  11438.8889   -160233.3 #  5:   5  -4977.7778   -156583.3 #  6:   6    494.4444   -156583.3 #  7:   7   5966.6667   -156583.3 #  8:   8  11438.8889   -156583.3 #  9:   9  -4977.7778   -152933.3 # 10:  10    494.4444   -152933.3 # 11:  11   5966.6667   -152933.3 # 12:  12  11438.8889   -152933.3 # 13:  13  -4977.7778   -149283.3 # 14:  14    494.4444   -149283.3 # 15:  15   5966.6667   -149283.3 # 16:  16  11438.8889   -149283.3 # 17:  17  -4977.7778   -145633.3 # 18:  18    494.4444   -145633.3 # 19:  19   5966.6667   -145633.3 # 20:  20  11438.8889   -145633.3 # 21:  21  -4977.7778   -141983.3 # 22:  22    494.4444   -141983.3 # 23:  23   5966.6667   -141983.3 # 24:  24  11438.8889   -141983.3 # 25:  25  -4977.7778   -138333.3 # 26:  26    494.4444   -138333.3 # 27:  27   5966.6667   -138333.3 # 28:  28  11438.8889   -138333.3 #     fov x_global_px y_global_px"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"choose-field-of-view-for-analysis","dir":"Articles","previous_headings":"2. Data exploration and loading","what":"2.4 Choose field of view for analysis","title":"Nanostring CosMx Subcellular Lung Cancer","text":"CosMx data large Giotto loads subcellular information FOV. dataset includes 28 FOVs can difficult computers handle . tutorial use FOVs ‘02’, ‘03’, ‘04’ correspond 3 FOVs visible bottom right negative probe preview .","code":"gobjects_list = list()  id_set = c('02', '03', '04')"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"create-a-giotto-object-for-each-fov","dir":"Articles","previous_headings":"","what":"3. Create a Giotto Object for each FOV","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"for(fov_i in 1:length(id_set)) {    fov_id = id_set[fov_i]     # 1. original composite image as png   original_composite_image = paste0(data_path, 'CellComposite/CellComposite_F0', fov_id,'.jpg')    # 2. input cell segmentation as mask file   segmentation_mask = paste0(data_path, 'CellLabels/CellLabels_F0', fov_id, '.tif')    # 3. input features coordinates + offset   feat_coord = feat_coords_all[fov == as.numeric(fov_id)]   neg_coord = neg_coords_all[fov == as.numeric(fov_id)]   feat_coord = feat_coord[,.(x_local_px, y_local_px, z, target)]   neg_coord = neg_coord[,.(x_local_px, y_local_px, z, target)]   colnames(feat_coord) = c('x', 'y', 'z', 'gene_id')   colnames(neg_coord) = c('x', 'y', 'z', 'gene_id')   feat_coord = feat_coord[,.(x, y, gene_id)]   neg_coord = neg_coord[,.(x, y, gene_id)]     fovsubset = createGiottoObjectSubcellular(     gpoints = list('rna' = feat_coord,                    'neg_probe' = neg_coord),     gpolygons = list('cell' = segmentation_mask),     polygon_mask_list_params = list(       mask_method = 'guess',       flip_vertical = TRUE,       flip_horizontal = FALSE,       shift_horizontal_step = FALSE     ),     instructions = instrs   )     # cell centroids are now used to provide the spatial locations   fovsubset = addSpatialCentroidLocations(fovsubset,                                           poly_info = 'cell')    # create and add Giotto images   composite = createGiottoLargeImage(raster_object = original_composite_image,                                      negative_y = FALSE,                                      name = 'composite')    fovsubset = addGiottoImage(gobject = fovsubset,                              largeImages = list(composite))     fovsubset = convertGiottoLargeImageToMG(giottoLargeImage = composite,                                           #mg_name = 'composite',                                           gobject = fovsubset,                                           return_gobject = TRUE)    gobjects_list[[fov_i]] = fovsubset  }"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"join-fov-giotto-objects","dir":"Articles","previous_headings":"","what":"4. Join FOV Giotto Objects","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"new_names = paste0(\"fov0\", id_set)  id_match = match(as.numeric(id_set), fov_offset_file$fov) x_shifts = fov_offset_file[id_match]$x_global_px y_shifts = fov_offset_file[id_match]$y_global_px  # Create Giotto object that includes all selected FOVs fov_join = joinGiottoObjects(gobject_list = gobjects_list,                              gobject_names = new_names,                              join_method = 'shift',                              x_shift = x_shifts,                              y_shift = y_shifts)"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"sec-objdone","dir":"Articles","previous_headings":"","what":"5. Visualize Cells and Genes of Interest","title":"Nanostring CosMx Subcellular Lung Cancer","text":"plotting subcellular data, Giotto uses spatInSituPlot functions. Spatial plots showing feature points polygons plotted using spatInSituPlotPoints().","code":"showGiottoImageNames(fov_join)  # Set up vector of image names id_set = c('02', '03', '04') new_names = paste0(\"fov0\", id_set) image_names = paste0(new_names, '-image')  spatInSituPlotPoints(fov_join,                      show_image = TRUE,                      image_name = image_names,                      feats = list('rna' = c('MMP2', 'VEGFA', 'IGF1R',                                             'MKI67', 'EPCAM', 'KRT8')),                      feats_color_code = viv10,                      spat_unit = 'cell',                      point_size = 0.01,                      show_polygon = TRUE,                      use_overlap = FALSE,                      polygon_feat_type = 'cell',                      polygon_color = 'white',                      polygon_line_size = 0.03,                      save_param = list(base_height = 3,                                        save_name = '1_inSituFeats'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"visualize-cell-centroids","dir":"Articles","previous_headings":"5. Visualize Cells and Genes of Interest","what":"5.1 Visualize Cell Centroids","title":"Nanostring CosMx Subcellular Lung Cancer","text":"standard spatPlot2D() function can also used, works aggregated information assembled based subcellular information. Plotting information based cell centroids can done function.","code":"spatPlot2D(gobject = fov_join,            image_name = image_names,            show_image = TRUE,            point_shape = 'no_border',            point_size = 0.01,            point_alpha = 0.5,            coord_fix_ratio = 1,            save_param = list(base_height = 2,                              save_name = '2_spatCentroids'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"aggregate-subcellular-features","dir":"Articles","previous_headings":"","what":"6. Aggregate subcellular features","title":"Nanostring CosMx Subcellular Lung Cancer","text":"Giotto supports working directly subcellular features order generate cell feature matrices. data generated way given spatial unit 'cell'. workflow recommended loading provided cell feature (aggregated expression) matrix including subcellular information secondary data. raw subcellular information pre-made expression matrix loaded time, subcellular data data generated given spatial unit 'cell' pre-generated aggregated information given different spatial unit 'cell_agg' differentiate two sources information. step, aggregating feature points 'rna' 'neg_probe' 'cell' spatial unit.","code":"# Find the feature points overlapped by polygons. This overlap information is then # returned to the relevant giottoPolygon object's overlaps slot. fov_join = calculateOverlapRaster(fov_join, feat_info = 'rna') fov_join = calculateOverlapRaster(fov_join, feat_info = 'neg_probe')  # Convert the overlap information into a cell by feature expression matrix which # is then stored in the Giotto object's expression slot fov_join = overlapToMatrix(fov_join, feat_info = 'rna') fov_join = overlapToMatrix(fov_join, feat_info = 'neg_probe')  showGiottoExpression(fov_join) # └──Spatial unit \"cell\" #    ├──Feature type \"rna\" #    │  └──Expression data \"raw\" values: #    │        An object of class exprObj  #    │        for spatial unit: \"cell\" and feature type: \"rna\"  #    │          Provenance:  cell  #    │         #    │        contains: #    │        960 x 8066 sparse Matrix of class \"dgCMatrix\" #    │                                               #    │        LY6D  . . 1 . . . . . . . . . . ...... #    │        IGHA1 . . . . . . . 2 . 1 . . . ...... #    │        VWF   . . . 1 . . . . . 1 . . . ...... #    │         #    │         ........suppressing 8053 columns and 954 rows  #    │                                                #    │        CLEC2D 1 . . . . . . . . 1 . . . ...... #    │        MARCO  . . . . . . . . . . . . . ...... #    │        AATK   . . . . . . . . . . . . 2 ...... #    │         #    │         First four colnames: #    │         fov002-cell_1 fov002-cell_2 #    │         fov002-cell_3 fov002-cell_4  #    │      #    └──Feature type \"neg_probe\" #       └──Expression data \"raw\" values: #             An object of class exprObj  #             for spatial unit: \"cell\" and feature type: \"neg_probe\"  #               Provenance:  cell  #              #             contains: #             20 x 8066 sparse Matrix of class \"dgCMatrix\" #                                                       #             NegPrb8  . . . . . . . . . . 2 . . ...... #             NegPrb10 1 . . . . . . . . . . . 1 ...... #             NegPrb20 . . . . . . . . . . . . . ...... #              #              ........suppressing 8053 columns and 14 rows  #                                                       #             NegPrb18 . . . . . . . . . . . . . ...... #             NegPrb12 . . . . . . . . . . . . . ...... #             NegPrb15 1 . 1 . . . . . . . . . . ...... #              #              First four colnames: #              fov002-cell_1 fov002-cell_2 #              fov002-cell_3 fov002-cell_4"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"plot-histograms-of-total-counts-per-cell","dir":"Articles","previous_headings":"6. Aggregate subcellular features","what":"6.1 Plot histograms of total counts per cell","title":"Nanostring CosMx Subcellular Lung Cancer","text":"RNA Negative Probes","code":"filterDistributions(fov_join,                     plot_type = 'hist',                     detection = 'cells',                     method = 'sum',                     feat_type = 'rna',                     nr_bins = 100,                     save_param = list(base_height = 3,                                       save_name = '3.1_totalexpr'))  filterDistributions(fov_join,                     plot_type = 'hist',                     detection = 'cells',                     method = 'sum',                     feat_type = 'neg_probe',                     nr_bins = 25,                     save_param = list(base_height = 3,                                       save_name = '3.2_totalnegprbe'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"d-density-plots","dir":"Articles","previous_headings":"6. Aggregate subcellular features","what":"6.2 2D Density Plots","title":"Nanostring CosMx Subcellular Lung Cancer","text":"Density-based representations may sometimes preferred instead viewing raw points information, especially points dense enough overplotting. overlaps information calculated, spatInSituPlotDensity() can used order get general idea much expression feature.","code":"spatInSituPlotDensity(gobject = fov_join,                       feats = c(\"MMP2\", \"VEGFA\", \"IGF1R\",                                 'MKI67', 'EPCAM', 'KRT8'),                       cow_n_col = 2,                       save_param = list(base_height = 4,                                         save_name = '4_inSituDens'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"extract-data-from-giotto-object","dir":"Articles","previous_headings":"6. Aggregate subcellular features","what":"6.3 Extract Data from Giotto Object","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"# combine cell data morphometa = combineCellData(fov_join,                              feat_type = 'rna')  # combine feature data featmeta = combineFeatureData(fov_join,                               feat_type = c('rna'))  # combine overlapping feature data featoverlapmeta = combineFeatureOverlapData(fov_join,                                             feat_type = c('rna')) # $rna #                  cell_ID    sdimx     sdimy geom part          x         y hole list_ID feat #       1:   fov002-cell_1  1025.82 -156627.0    1    1   979.4444 -156585.3    0  fov002  rna #       2:   fov002-cell_1  1025.82 -156627.0    1    1  1043.4444 -156585.3    0  fov002  rna #       3:   fov002-cell_1  1025.82 -156627.0    1    1  1043.4444 -156586.3    0  fov002  rna #       4:   fov002-cell_1  1025.82 -156627.0    1    1  1048.4444 -156586.3    0  fov002  rna #       5:   fov002-cell_1  1025.82 -156627.0    1    1  1048.4444 -156587.3    0  fov002  rna #      ---                                                                                     # 1280551: fov004-cell_999 15294.68 -158713.1 6378    1 15288.8889 -158685.3    0  fov004  rna # 1280552: fov004-cell_999 15294.68 -158713.1 6378    1 15292.8889 -158685.3    0  fov004  rna # 1280553: fov004-cell_999 15294.68 -158713.1 6378    1 15292.8889 -158683.3    0  fov004  rna # 1280554: fov004-cell_999 15294.68 -158713.1 6378    1 15298.8889 -158683.3    0  fov004  rna # 1280555: fov004-cell_999 15294.68 -158713.1 6378    1 15298.8889 -158681.3    0  fov004  rna # $rna #          feat_ID    geom part         x         y hole z fov  CellComp   feat_ID_uniq feat spat_unit #       1:    AATK   23962    1  3725.974 -160100.8    0 5   2  Membrane   fov002-23962  rna      cell #       2:    AATK   28924    1  3344.687 -158576.3    0 5   2  Membrane   fov002-28924  rna      cell #       3:    AATK   32363    1  4972.508 -158667.6    0 5   2         0   fov002-32363  rna      cell #       4:    AATK   37076    1  4502.724 -158180.0    0 5   2         0   fov002-37076  rna      cell #       5:    AATK   42621    1  2404.527 -158087.4    0 8   2         0   fov002-42621  rna      cell #      ---                                                                                             # 3331156:   ZFP36 3327938    1 16866.039 -160138.1    0 2   4   Nuclear fov004-1223368  rna      cell # 3331157:   ZFP36 3328013    1 16842.374 -160133.1    0 1   4   Nuclear fov004-1223443  rna      cell # 3331158:   ZFP36 3328281    1 16117.825 -160208.1    0 5   4 Cytoplasm fov004-1223711  rna      cell # 3331159:   ZFP36 3328522    1 12781.322 -160146.5    0 2   4   Nuclear fov004-1223952  rna      cell # 3331160:   ZFP36 3330762    1 16086.589 -160222.2    0 6   4   Nuclear fov004-1226192  rna      cell # $rna #          feat_ID    geom part         x         y hole          poly_ID   feat_ID_uniq poly_info feat #       1:    AATK   23962    1  3725.974 -160100.8    0             <NA>   fov002-23962      cell  rna #       2:    AATK   28924    1  3344.687 -158576.3    0             <NA>   fov002-28924      cell  rna #       3:    AATK   32363    1  4972.508 -158667.6    0 fov002-cell_1084   fov002-32363      cell  rna #       4:    AATK   37076    1  4502.724 -158180.0    0             <NA>   fov002-37076      cell  rna #       5:    AATK   42621    1  2404.527 -158087.4    0             <NA>   fov002-42621      cell  rna #      ---                                                                                              # 3331156:   ZFP36 3327938    1 16866.039 -160138.1    0 fov004-cell_2661 fov004-1223368      cell  rna # 3331157:   ZFP36 3328013    1 16842.374 -160133.1    0 fov004-cell_2661 fov004-1223443      cell  rna # 3331158:   ZFP36 3328281    1 16117.825 -160208.1    0 fov004-cell_2663 fov004-1223711      cell  rna # 3331159:   ZFP36 3328522    1 12781.322 -160146.5    0 fov004-cell_2664 fov004-1223952      cell  rna # 3331160:   ZFP36 3330762    1 16086.589 -160222.2    0 fov004-cell_2676 fov004-1226192      cell  rna"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"sec-matcompare","dir":"Articles","previous_headings":"6. Aggregate subcellular features","what":"6.4 Comparison of Giotto aggregated and Nanostring provided matrices","title":"Nanostring CosMx Subcellular Lung Cancer","text":"Comparison Giotto’s aggregated matrix results provided Nanostring. FOV2 used comparison. Matrices expected similar sets cell polygons/masks used .   Overall, nanostring matrix 416099 - 415952 = 147 non-zero values giotto’s matrix FOV2. Within 411050 shared entries called methods (common j indices), appears major bias terms counts/values assigned. Moreover, vast majority shared entries values (difference 0).","code":"# Load and prepare data  nanoDT = data.table::fread(paste0(data_path, 'Lung12_exprMat_file.csv')) test1 = nanoDT[fov == 2] # Set up cell_IDs test1[, cell_ID := paste0('cell_', cell_ID)] test1[, cell_ID := paste0('f', fov, '-', cell_ID)] test1[, fov := NULL]  test1mat = Giottot_flex(Giottodt_to_matrix(test1)) testnano_f2 = test1mat # Remove cell_0 (all tx counts that do not fall within a polygon) testnano_f2 = testnano_f2[, -1] # Remove negative probe counts testnano_f2 = testnano_f2[!grepl('NegPrb', rownames(testnano_f2)),]  # giotto matrix testg = fov_join@expression$cell$rna$raw[] testg_f2 = testg[, grepl('fov002', colnames(testg))] sorted_rownames = sort(rownames(testg_f2)) testg_f2 = testg_f2[sorted_rownames, ]  # Prepare matrix comparison # Summarise sparse matrices (i and j are matrix indices, x is value) testg_f2_DT = data.table::as.data.table(Matrix::summary(testg_f2)) testg_f2_DT[, method := 'giotto'] testnano_f2_DT = data.table::as.data.table(Matrix::summary(testnano_f2)) testnano_f2_DT[, method := 'nanostring'] testDT = data.table::rbindlist(list(testg_f2_DT, testnano_f2_DT)) # Combine sparse matrix indices testDT[, combo := paste0(i,'-',j)] # Plot results library(ggplot2)  # matrix index similarity pl_n = ggplot() pl_n = pl_n + geom_tile(data = testnano_f2_DT, aes(x = i, y = j, fill = log(x+1))) pl_n = pl_n + ggtitle('Nanostring Sparse Matrix') pl_n = pl_n + scale_fill_gradient(low = 'blue', high = 'red') pl_n = pl_n + theme(panel.grid.major = element_blank(),                     panel.grid.minor = element_blank(),                     panel.background = element_rect(fill = \"black\"))  pl_g = ggplot() pl_g = pl_g + geom_tile(data = testg_f2_DT, aes(x = i, y = j, fill = log(x+1))) pl_g = pl_g + ggtitle('Giotto Sparse Matrix') pl_g = pl_g + scale_fill_gradient(low = 'blue', high = 'red') pl_g = pl_g + theme(panel.grid.major = element_blank(),                     panel.grid.minor = element_blank(),                     panel.background = element_rect(fill = \"black\"))   combplot = cowplot::plot_grid(pl_n, pl_g,                               nrow = 2,                               labels = 'AUTO') print(combplot) # directly compare differences in matrix values (counts assigned) vartestDT = testDT[, list(var = var(x), diff = diff(x), mean = mean(x)), by = .(i,j)] data.table::setorder(vartestDT, var)  # check arbitrary index values testDT[i == '812' & j == '2'] testDT[i == '667' & j == '1072'] testDT[i == '667' & j == '2880']  # plot difference in values pl = ggplot() pl = pl + geom_bar(data = vartestDT, aes(x = diff)) pl = pl + theme_bw() pl = pl + labs(x = 'difference nanostring - Giotto') pl  testDT[order(x)] #      i j x method combo # 1: 812 2 1 giotto 812-2 #  #      i    j  x     method    combo # 1: 667 1072 50     giotto 667-1072 # 2: 667 1072 56 nanostring 667-1072 #  #      i    j  x     method    combo # 1: 667 2880 24     giotto 667-2880 # 2: 667 2880 15 nanostring 667-2880 testDT[, .N, by = 'method']  testDT[, method, by = combo][, sum(duplicated(combo))] #        method      N # 1:     giotto 415952 # 2: nanostring 416099 #  # 411050"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"filtering-and-normalization","dir":"Articles","previous_headings":"","what":"7. Filtering and normalization","title":"Nanostring CosMx Subcellular Lung Cancer","text":"expression matrix generated subcellular information, analysis proceeds data filtering normalization. normalization step, employ two types. standard normalization method: library size normalization log normalization. method produce normalized scaled values returned ‘normalized’ ’scaled’expression matrices respectively. tutorial, normalized values used generating expression statistics plotting expression values. scaled values ignored. also generate normalized values negative probes visualization purposes library normalization step skipped. pearson residuals: normalization uses method described Lause/Kobak et al, 2021. produces set values similar utility scaled matrix offer improvements HVF detection PCA generation. values used statistics, plotting expression values, differential expression analysis. Note: show functions metadata return information. retrieve metadata information, instead use pDataDT() fDataDT() along feat_type param either ‘rna’ ‘neg_probe’.","code":"# filter (feat_type = 'rna' by default) fov_join <- filterGiotto(gobject = fov_join,                          feat_type = 'rna',                          expression_threshold = 1,                          feat_det_in_min_cells = 5,                          min_det_feats_per_cell = 5)  # normalize # standard method of normalization (log normalization based) fov_join <- normalizeGiotto(gobject = fov_join,                             feat_type = 'rna',                             norm_methods = 'standard',                             verbose = TRUE) fov_join <- normalizeGiotto(gobject = fov_join,                             feat_type = 'neg_probe',                             norm_methods = 'standard',                             library_size_norm = FALSE,                             verbose = TRUE)  # new normalization method based on pearson correlations (Lause/Kobak et al. 2021) # this normalized matrix is given the name 'pearson' using the update_slot param fov_join <- normalizeGiotto(gobject = fov_join,                             feat_type = 'rna',                             scalefactor = 5000,                             verbose = TRUE,                             norm_methods = 'pearson_resid',                             update_slot = 'pearson')  showGiottoExpression(fov_join) # └──Spatial unit \"cell\" #    ├──Feature type \"rna\" #    │  ├──Expression data \"raw\" values: #    │  │     An object of class exprObj  #    │  │     for spatial unit: \"cell\" and feature type: \"rna\"  #    │  │       Provenance:  cell  #    │  │      #    │  │     contains: #    │  │     960 x 8049 sparse Matrix of class \"dgCMatrix\" #    │  │                                            #    │  │     LY6D  . . 1 . . . . . . . . . . ...... #    │  │     IGHA1 . . . . . . . 2 . 1 . . . ...... #    │  │     VWF   . . . 1 . . . . . 1 . . . ...... #    │  │      #    │  │      ........suppressing 8036 columns and 954 rows  #    │  │                                             #    │  │     CLEC2D 1 . . . . . . . . 1 . . . ...... #    │  │     MARCO  . . . . . . . . . . . . . ...... #    │  │     AATK   . . . . . . . . . . . . 2 ...... #    │  │      #    │  │      First four colnames: #    │  │      fov002-cell_1 fov002-cell_2 #    │  │      fov002-cell_3 fov002-cell_4  #    │  │   #    │  ├──Expression data \"normalized\" values: #    │  │     An object of class exprObj  #    │  │     for spatial unit: \"cell\" and feature type: \"rna\"  #    │  │       Provenance:  cell  #    │  │      #    │  │     contains: #    │  │     960 x 8049 sparse Matrix of class \"dgCMatrix\" #    │  │                                                                       #    │  │     LY6D  . . 4.666202 .        . . . .        . .       . . . ...... #    │  │     IGHA1 . . .        .        . . . 5.666544 . 4.70044 . . . ...... #    │  │     VWF   . . .        4.940306 . . . .        . 4.70044 . . . ...... #    │  │      #    │  │      ........suppressing 8036 columns and 954 rows  #    │  │                                                                 #    │  │     CLEC2D 4.146744 . . . . . . . . 4.70044 . . .        ...... #    │  │     MARCO  .        . . . . . . . . .       . . .        ...... #    │  │     AATK   .        . . . . . . . . .       . . 5.909612 ...... #    │  │      #    │  │      First four colnames: #    │  │      fov002-cell_1 fov002-cell_2 #    │  │      fov002-cell_3 fov002-cell_4  #    │  │   #    │  ├──Expression data \"scaled\" values: #    │  │     An object of class exprObj  #    │  │     for spatial unit: \"cell\" and feature type: \"rna\" #    │  │       Provenance: cell #    │  │      #    │  │     contains: #    │  │     960 x 8049 dense matrix of class \"dgeMatrix\" #    │  │      #    │  │                 [,1]        [,2]       [,3]       [,4] #    │  │     LY6D  -0.4392934 -0.07558225  2.8787372 -0.3035845 #    │  │     IGHA1 -0.7570656 -0.51785331 -0.6631650 -0.6198371 #    │  │     VWF   -0.4387262 -0.07479291 -0.3300452  2.8316967 #    │  │     BECN1 -0.4359960 -0.07099306 -0.3271882 -0.3003029 #    │  │      #    │  │      First four colnames: #    │  │      fov002-cell_1 fov002-cell_2 #    │  │      fov002-cell_3 fov002-cell_4  #    │  │   #    │  └──Expression data \"pearson\" values: #    │        An object of class exprObj  #    │        for spatial unit: \"cell\" and feature type: \"rna\" #    │          Provenance: cell #    │         #    │        contains: #    │        960 x 8049 dense matrix of class \"dgeMatrix\" #    │         #    │                    [,1]       [,2]       [,3]       [,4] #    │        LY6D  -0.4031565 -0.1363425  2.6585234 -0.3025217 #    │        IGHA1 -1.4462051 -0.4933275 -1.2011147 -1.0898172 #    │        VWF   -0.4178857 -0.1413313 -0.3460168  2.8722347 #    │        BECN1 -0.4074196 -0.1377863 -0.3373461 -0.3057230 #    │         #    │         First four colnames: #    │         fov002-cell_1 fov002-cell_2 #    │         fov002-cell_3 fov002-cell_4  #    │      #    └──Feature type \"neg_probe\" #       ├──Expression data \"raw\" values: #       │     An object of class exprObj  #       │     for spatial unit: \"cell\" and feature type: \"neg_probe\"  #       │       Provenance:  cell  #       │      #       │     contains: #       │     20 x 8049 sparse Matrix of class \"dgCMatrix\" #       │                                               #       │     NegPrb8  . . . . . . . . . . 2 . . ...... #       │     NegPrb10 1 . . . . . . . . . . . 1 ...... #       │     NegPrb20 . . . . . . . . . . . . . ...... #       │      #       │      ........suppressing 8036 columns and 14 rows  #       │                                               #       │     NegPrb18 . . . . . . . . . . . . . ...... #       │     NegPrb12 . . . . . . . . . . . . . ...... #       │     NegPrb15 1 . 1 . . . . . . . . . . ...... #       │      #       │      First four colnames: #       │      fov002-cell_1 fov002-cell_2 #       │      fov002-cell_3 fov002-cell_4  #       │   #       ├──Expression data \"normalized\" values: #       │     An object of class exprObj  #       │     for spatial unit: \"cell\" and feature type: \"neg_probe\"  #       │       Provenance:  cell  #       │      #       │     contains: #       │     20 x 8049 sparse Matrix of class \"dgCMatrix\" #       │                                                      #       │     NegPrb8  . . . . . . . . . . 1.584963 . . ...... #       │     NegPrb10 1 . . . . . . . . . .        . 1 ...... #       │     NegPrb20 . . . . . . . . . . .        . . ...... #       │      #       │      ........suppressing 8036 columns and 14 rows  #       │                                               #       │     NegPrb18 . . . . . . . . . . . . . ...... #       │     NegPrb12 . . . . . . . . . . . . . ...... #       │     NegPrb15 1 . 1 . . . . . . . . . . ...... #       │      #       │      First four colnames: #       │      fov002-cell_1 fov002-cell_2 #       │      fov002-cell_3 fov002-cell_4  #       │   #       └──Expression data \"scaled\" values: #             An object of class exprObj  #             for spatial unit: \"cell\" and feature type: \"neg_probe\" #               Provenance: cell #              #             contains: #             20 x 8049 dense matrix of class \"dgeMatrix\" #              #                            [,1]        [,2]       [,3]        [,4] #             NegPrb8  -0.3207888  0.03413209 -0.4045849  0.03413209 #             NegPrb10  2.7851943  0.69791153 -0.3914547  0.69791153 #             NegPrb20 -0.3685845 -2.11549922 -0.4471068 -2.11549922 #             NegPrb21 -0.3472432 -1.15566687 -0.4281203 -1.15566687 #              #              First four colnames: #              fov002-cell_1 fov002-cell_2 #              fov002-cell_3 fov002-cell_4 # add statistics based on log normalized values for features rna and negative probes fov_join = addStatistics(gobject = fov_join,                          expression_values = 'normalized',                          feat_type = 'rna') fov_join = addStatistics(gobject = fov_join,                          expression_values = 'normalized',                          feat_type = 'neg_probe')  # View cellular data (default is feat = 'rna') showGiottoCellMetadata(fov_join) # View feature data showGiottoFeatMetadata(fov_join) # └──Spatial unit \"cell\" #    ├──Feature type \"rna\" #    │     An object of class cellMetaObj  #    │     Provenance: cell  #    │              cell_ID list_ID nr_feats perc_feats total_expr #    │     1: fov002-cell_1  fov002      203  21.145833   925.1119 #    │     2: fov002-cell_2  fov002       31   3.229167   231.4284 #    │     3: fov002-cell_3  fov002      140  14.583333   712.4315 #    │     4: fov002-cell_4  fov002      124  12.916667   652.3757 #    │   #    └──Feature type \"neg_probe\" #          An object of class cellMetaObj  #          Provenance: cell  #                   cell_ID list_ID nr_feats perc_feats total_expr #          1: fov002-cell_1  fov002        2         10          2 #          2: fov002-cell_2  fov002        0          0          0 #          3: fov002-cell_3  fov002        3         15          3 #          4: fov002-cell_4  fov002        0          0          0 # └──Spatial unit \"cell\" #    ├──Feature type \"rna\" #    │     An object of class featMetaObj  #    │     Provenance: cell  #    │        feat_ID nr_cells perc_cells total_expr mean_expr mean_expr_det #    │     1:    LY6D      922   11.45484   3933.493 0.4886934      4.266262 #    │     2:   IGHA1     2900   36.02932  15960.468 1.9829131      5.503610 #    │     3:     VWF      919   11.41757   4047.916 0.5029092      4.404696 #    │     4:   BECN1      903   11.21878   3828.386 0.4756350      4.239630 #    │   #    └──Feature type \"neg_probe\" #          An object of class featMetaObj  #          Provenance: cell  #              feat_ID nr_cells perc_cells total_expr  mean_expr mean_expr_det #          1:  NegPrb8      642   7.976146   716.2937 0.08899164      1.115722 #          2: NegPrb10      566   7.031929   611.7775 0.07600664      1.080879 #          3: NegPrb20      888  11.032426  1003.0484 0.12461776      1.129559 #          4: NegPrb21      771   9.578830   849.4211 0.10553125      1.101713"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"histogram-of-log-normalized-data","dir":"Articles","previous_headings":"8. View Transcript Total Expression Distribution","what":"8.1 Histogram of log normalized data","title":"Nanostring CosMx Subcellular Lung Cancer","text":"RNA  Negative Probe","code":"filterDistributions(fov_join,                     detection = 'cells',                     feat_type = 'rna',                     expression_values = 'normalized',                     method = 'sum',                     nr_bins = 100,                     save_param = list(base_height = 3,                                       save_name = '5.1_rna_norm_total_hist'))  filterDistributions(fov_join,                     detection = 'cell',                     feat_type = 'neg_probe',                     expression_values = 'normalized',                     method = 'sum',                     nr_bins = 20,                     save_param = list(base_height = 3,                                       save_name = '5.2_neg_norm_total_hist'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"plot-spatially-as-centroids","dir":"Articles","previous_headings":"8. View Transcript Total Expression Distribution","what":"8.2 Plot spatially as centroids","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"spatPlot2D(gobject = fov_join,            cell_color = 'total_expr',            color_as_factor = FALSE,            show_image = TRUE,            image_name = image_names,            point_size = 0.9,            point_alpha = 0.75,            save_param = list(base_height = 2,                              save_name = '5.3_color_centroids'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"plot-spatially-as-color-scaled-polygons","dir":"Articles","previous_headings":"8. View Transcript Total Expression Distribution","what":"8.3 Plot spatially as color-scaled polygons","title":"Nanostring CosMx Subcellular Lung Cancer","text":"RNA  Negative Probe","code":"spatInSituPlotPoints(fov_join,                      show_polygon = TRUE,                      polygon_color = 'gray',                      polygon_line_size = 0.05,                      polygon_fill = 'total_expr',                      polygon_fill_as_factor = FALSE,                      save_param = list(base_height = 2,                                        save_name = '5.4_rna_color_polys'))  spatInSituPlotPoints(fov_join,                      feat_type = 'neg_probe',                      show_polygon = TRUE,                      polygon_color = 'gray',                      polygon_line_size = 0.05,                      polygon_fill = 'total_expr',                      polygon_fill_as_factor = FALSE,                      save_param = list(base_height = 2,                                        save_name = '5.5_neg_color_polys'))"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"detect-highly-variable-genes-and-generate-pca","dir":"Articles","previous_headings":"9. Dimension Reduction","what":"9.1 Detect highly variable genes and generate PCA","title":"Nanostring CosMx Subcellular Lung Cancer","text":"Detect highly variable genes using pearson residuals method based ‘pearson’ expression matrix. results returned new ‘hvf’ column ‘rna’ feature metadata. PCA generation also based ‘pearson’ matrix. Scaling centering PCA usually done default skipped since pearson matrix already scaled.","code":"fov_join = calculateHVF(fov_join,                         method = 'var_p_resid',                         expression_values = 'pearson',                         save_param = list(base_height = 5,                                           save_name = '6.1_pearson_HVF'))  # print HVFs gene_meta = fDataDT(fov_join) gene_meta[hvf == 'yes', feat_ID] #   [1] \"IGHA1\"    \"S100A4\"   \"NEAT1\"    \"MYH11\"    \"BMP6\"     #   [6] \"LGALS3\"   \"CLU\"      \"LTB\"      \"HLA-DQB1\" \"GDF15\"    #  [11] \"ENTPD1\"   \"CCL21\"    \"IL17A\"    \"GDNF\"     \"COL5A1\"   #  [16] \"HLA-B\"    \"IGKC\"     \"COL4A2\"   \"MZT2A\"    \"SERPINA1\" #  [21] \"THBS1\"    \"MGP\"      \"IL32\"     \"HLA-DPA1\" \"RGS1\"     #  [26] \"IGFBP3\"   \"FCRLA\"    \"CXCL1\"    \"TYK2\"     \"KLF2\"     #  [31] \"HSPB1\"    \"ITGB6\"    \"COL6A1\"   \"WIF1\"     \"ANXA2\"    #  [36] \"THBS2\"    \"DUSP5\"    \"CXCL8\"    \"COL6A2\"   \"FGF2\"     #  [41] \"HSPA1A\"   \"TIMP1\"    \"TPM2\"     \"CD163\"    \"NPPC\"     #  [46] \"KRT8\"     \"IGHG1\"    \"CD68\"     \"SAA1\"     \"KRT7\"     #  [51] \"IGHM\"     \"IL1RN\"    \"B2M\"      \"LUM\"      \"FKBP11\"   #  [56] \"COL1A1\"   \"COL5A2\"   \"CX3CR1\"   \"MAF\"      \"TAGLN\"    #  [61] \"IL23A\"    \"BGN\"      \"FN1\"      \"DCN\"      \"CXCL10\"   #  [66] \"CD74\"     \"RARRES1\"  \"MALAT1\"   \"LTF\"      \"HLA-DRB5\" #  [71] \"CALD1\"    \"C11orf96\" \"ADGRE2\"   \"MT1X\"     \"IGFBP5\"   #  [76] \"IGHG2\"    \"LCN2\"     \"TEK\"      \"PIGR\"     \"DUSP1\"    #  [81] \"IGFBP7\"   \"TM4SF1\"   \"DUSP2\"    \"CEACAM6\"  \"VIM\"      #  [86] \"FOS\"      \"COL9A2\"   \"CCL19\"    \"OLFM4\"    \"HLA-DPB1\" #  [91] \"CXCL14\"   \"NFKBIA\"   \"HLA-DQA1\" \"CD14\"     \"HLA-C\"    #  [96] \"DLL1\"     \"KRT17\"    \"LDLR\"     \"CCL2\"     \"GLUL\"     # [101] \"TPSAB1\"   \"COL3A1\"   \"C1QA\"     \"S100A8\"   \"GSN\"      # [106] \"HSPA1B\"   \"MMP12\"    \"COL18A1\"  \"CIITA\"    \"HLA-DRB1\" # [111] \"PSAP\"     \"SOD2\"     \"S100A2\"   \"LGALS1\"   \"STAT4\"    # [116] \"GADD45B\"  \"KDR\"      \"MMP14\"    \"KRT19\"    \"IL17D\"    # [121] \"MT2A\"     \"CXCR6\"    \"IL1B\"     \"FCGBP\"    \"CCL3L3\"   # [126] \"SPP1\"     \"CCL3\"     \"S100A6\"   \"IL16\"     \"ITGB4\"    # [131] \"RGCC\"     \"COL6A3\"   \"COL1A2\"   \"C1QC\"     \"CD8A\"     # [136] \"GZMK\"     \"TCL1A\"    \"IGF2\"     \"JCHAIN\"   \"SPARCL1\"  # [141] \"NDRG1\"    \"PSCA\"     \"CXCL3\"    \"HLA-DRA\"  \"CD79A\"    # [146] \"MEG3\"     \"SRGN\"     \"COL4A1\"   \"TNFRSF19\" \"ICAM1\"    # [151] \"RGS2\"     \"LYZ\"      \"CD83\"     \"CCL4L2\"   \"CD69\"     # [156] \"ACTA2\"    \"KRT5\"     \"MMP10\"    \"MMP2\"     \"CXCR5\"    # [161] \"CPA3\"     \"TPSB2\"    \"C1QB\"     \"CXCL2\"    \"CXCL5\"    # [166] \"AGR2\"     \"PDCD1\"    \"BCL2\"     \"XBP1\"     \"PDGFRB\" fov_join = runPCA(fov_join,                   scale_unit = FALSE,                   center = FALSE,                   expression_values = 'pearson')  # screeplot uses the generated PCA. No need to specify expr values screePlot(fov_join, ncp = 20, save_param = list(save_name = '6.2_screeplot'))  plotPCA(fov_join,         cell_color = 'nr_feats', # (from log norm statistics)         color_as_factor = FALSE,         point_size = 0.1,         point_shape = 'no_border',         save_param = list(save_name = '6.3_PCA'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"run-umap","dir":"Articles","previous_headings":"9. Dimension Reduction","what":"9.2 Run UMAP","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"# Generate UMAP from PCA fov_join <- runUMAP(fov_join,                     dimensions_to_use = 1:10,                     n_threads = 4)  plotUMAP(gobject = fov_join, save_param = list(save_name = '6.4_UMAP'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"plot-features-on-expression-space","dir":"Articles","previous_headings":"9. Dimension Reduction","what":"9.3 Plot features on expression space","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"dimFeatPlot2D(gobject = fov_join,               feat_type = 'rna',               feats = c('MKI67', 'CD8A', 'CD4',                         'COL1A1', 'MS4A1', 'MZB1'),               expression_values = 'normalized',               point_shape = 'no_border',               point_size = 0.01,               cow_n_col = 3,               save_param = list(base_height = 5,                                 save_name = '6.5_UMAP_feats'))"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"visualize-clustering","dir":"Articles","previous_headings":"10. Cluster","what":"10.1 Visualize clustering","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"fov_join <- createNearestNetwork(gobject = fov_join,                                  dimensions_to_use = 1:10,                                  k = 10)  fov_join <- doLeidenCluster(gobject = fov_join,                             resolution = 0.07,                             n_iterations = 1000)  # visualize UMAP cluster results plotUMAP(gobject = fov_join,          cell_color = 'leiden_clus',          cell_color_code = pal10,          show_NN_network = TRUE,          point_size = 2,          save_param = list(save_name = '7.1_UMAP_leiden'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"visualize-clustering-on-expression-and-spatial-space","dir":"Articles","previous_headings":"10. Cluster","what":"10.2 Visualize clustering on expression and spatial space","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"# visualize UMAP and spatial results spatDimPlot2D(gobject = fov_join,               show_image = TRUE,               image_name = image_names,               cell_color = 'leiden_clus',               cell_color_code = pal10,               spat_point_size = 1,               save_param = list(save_name = '7.2_spatdim_leiden'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"map-clustering-spatially","dir":"Articles","previous_headings":"10. Cluster","what":"10.3 Map clustering spatially","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"spatInSituPlotPoints(fov_join,                      feats = list('rna' = c('MMP2', 'VEGFA', 'IGF1R',                                             'MKI67', 'EPCAM', 'MZB1')),                      point_size = 0.15,                      feats_color_code = viv10,                      show_polygon = TRUE,                      polygon_color = 'white',                      polygon_line_size = 0.01,                      polygon_fill = 'leiden_clus',                      polygon_fill_as_factor = TRUE,                      polygon_fill_code = pal10,                      save_param = list(base_height = 5,                                        save_name = '7.3_spatinsitu_leiden'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"small-subset-visualization","dir":"Articles","previous_headings":"","what":"11. Small Subset Visualization","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"#subset a Giotto object based on spatial locations smallfov <- subsetGiottoLocs(fov_join,                              x_max = 3000,                              x_min = 1000,                              y_max = -157800,                              y_min = -159800)  #extract all genes observed in new object smallfeats <- fDataDT(smallfov)[, feat_ID]  #plot all genes spatInSituPlotPoints(smallfov,                      feats = list(smallfeats),                      point_size = 0.15,                      polygon_line_size = 0.1,                      show_polygon = TRUE,                      polygon_color = 'white',                      show_image = TRUE,                      largeImage_name = 'fov002-composite',                      show_legend = FALSE,                      save_param = list(save_name = '8.1_smallfov_points'))  # plot only the polygon outlines spatInSituPlotPoints(smallfov,                      polygon_line_size = 0.1,                      polygon_alpha = 0,                      polygon_color = 'white',                      show_polygon = TRUE,                      show_image = TRUE,                      largeImage_name = 'fov002-composite',                      show_legend = FALSE,                      save_param = list(save_name = '8.2_smallfov_poly'))  # plot polygons colorlabeled with leiden clusters spatInSituPlotPoints(smallfov,                      polygon_line_size = 0.1,                      show_polygon = TRUE,                      polygon_fill = 'leiden_clus',                      polygon_fill_as_factor = TRUE,                      polygon_fill_code = pal10,                      show_image = TRUE,                      largeImage_name = 'fov002-composite',                      show_legend = FALSE,                      save_param = list(save_name = '8.3_smallfov_leiden'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"spatial-expression-patterns","dir":"Articles","previous_headings":"","what":"12. Spatial Expression Patterns","title":"Nanostring CosMx Subcellular Lung Cancer","text":"Find spatially organized gene expression examining binarized expression cells spatial neighbors.","code":"# create spatial network based on physical distance of cell centroids fov_join = createSpatialNetwork(gobject = fov_join,                                 minimum_k = 2,                                 maximum_distance_delaunay = 50)   # perform Binary Spatial Extraction of genes - NOTE: Depending on your system this could take time km_spatialgenes = binSpect(fov_join)  # visualize spatial expression of selected genes obtained from binSpect spatFeatPlot2D(fov_join,                expression_values = 'normalized',                feats = km_spatialgenes$feats[1:10],                point_shape = 'no_border',                point_border_stroke = 0.01,                point_size = 0.01,                cow_n_col = 2,                save_param = list(save_name = '9_binspect_genes'))"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"violin-plot","dir":"Articles","previous_headings":"13. Identify cluster differential expression genes","what":"13.1 Violin plot","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"# Gini markers = findMarkers_one_vs_all(gobject = fov_join,                                  method = 'gini',                                  expression_values = 'normalized',                                  cluster_column = 'leiden_clus',                                  min_feats = 1,                                  rank_score = 2) # First 5 results by cluster markers[, head(.SD, 5), by = 'cluster']  # violinplot topgini_genes = unique(markers[, head(.SD, 2), by = 'cluster']$feats) violinPlot(fov_join,            feats = topgini_genes,            cluster_column = 'leiden_clus',            strip_position = 'right',            save_param = list(save_name = '10.1_gini_violin')) #     cluster    feats expression expression_gini  detection detection_gini expression_rank detection_rank   comb_score comb_rank #  1:       1  CEACAM6  0.3005461      0.32848944 0.06234867     0.32595794             0.1           0.55 5.889056e-03         1 #  2:       1     TYK2  4.3646431      0.08881957 0.67493947     0.07004094             0.1           0.55 3.421554e-04       457 #  3:       1    RAMP1  2.8381932      0.04598805 0.50665860     0.07329526             0.1           0.55 1.853888e-04       696 #  4:       1   COL9A2  3.3775202      0.02803581 0.58353511     0.05483438             0.1           0.55 8.455294e-05       857 #  5:       1     WIF1  3.6318024      0.02295722 0.62046005     0.04942676             0.1           0.55 6.240854e-05       885 #  6:       2  CEACAM6  3.5574984      0.40305510 0.69286658     0.38975970             1.0           1.00 1.570946e-01         1 #  7:       2     AGR2  2.8990604      0.39072866 0.60237781     0.38035439             1.0           1.00 1.486154e-01         2 #  8:       2     PSCA  2.7500933      0.37081552 0.54821664     0.35942508             1.0           1.00 1.332804e-01         3 #  9:       2   TM4SF1  4.2980932      0.34496868 0.80581242     0.33059895             1.0           1.00 1.140463e-01         4 # 10:       2    ITGB4  2.9779267      0.31322641 0.64266843     0.31854817             1.0           1.00 9.977770e-02         5 # 11:       3   COL1A2  5.1763307      0.35868057 0.84092940     0.32712715             1.0           1.00 1.173342e-01         1 # 12:       3   COL3A1  4.6626627      0.35227376 0.79624665     0.32419688             1.0           1.00 1.142061e-01         2 # 13:       3   COL5A1  2.8124393      0.30790277 0.54870420     0.29029496             1.0           1.00 8.938262e-02         6 # 14:       3    CALD1  2.7964416      0.29034672 0.53976765     0.27132087             1.0           1.00 7.877712e-02         7 # 15:       3   COL4A2  3.7519663      0.28290733 0.66041108     0.25489261             1.0           1.00 7.211099e-02         8 # 16:       4   JCHAIN  2.3085145      0.31920894 0.38356164     0.27096015             1.0           1.00 8.649290e-02         1 # 17:       4    IGHA1  6.0272393      0.29235201 0.77123288     0.20720352             1.0           1.00 6.057637e-02         2 # 18:       4     IGKC  6.0069266      0.27710427 0.80821918     0.21309249             1.0           1.00 5.904884e-02         3 # 19:       4    IGHG2  5.1049710      0.21301372 0.75753425     0.16159106             1.0           1.00 3.442111e-02         5 # 20:       4    IGHG1  6.0348289      0.21398818 0.84109589     0.15579987             1.0           1.00 3.333933e-02         6 # 21:       5  HLA-DRA  3.5278230      0.35261913 0.68000000     0.33461396             1.0           1.00 1.179913e-01         1 # 22:       5 HLA-DRB1  5.8080578      0.31796037 0.94000000     0.28322219             1.0           1.00 9.005343e-02         4 # 23:       5     C1QC  2.9167826      0.30428046 0.56153846     0.28012788             1.0           1.00 8.523744e-02         5 # 24:       5 HLA-DQA1  3.4158034      0.29287085 0.66307692     0.27394289             1.0           1.00 8.022989e-02         7 # 25:       5 HLA-DPA1  4.5054688      0.29433678 0.81076923     0.26644593             1.0           1.00 7.842484e-02         8 # 26:       6     IGKC  7.7995871      0.30816788 0.91193182     0.22600725             1.0           1.00 6.964818e-02         1 # 27:       6    IGHG2  8.9434075      0.31508193 1.00000000     0.21706726             1.0           1.00 6.839397e-02         3 # 28:       6     XBP1  3.0542933      0.25791147 0.55681818     0.21972330             1.0           1.00 5.666916e-02         4 # 29:       6    IGHG1  9.6683517      0.29921666 1.00000000     0.18784629             1.0           1.00 5.620674e-02         5 # 30:       6    IGHA1  3.9283810      0.17471016 0.61931818     0.13994645             1.0           1.00 2.445007e-02         9 # 31:       7   ADGRG1  2.3821747      0.34229952 0.62827225     0.35696837             1.0           1.00 1.221901e-01         1 # 32:       7    EPHB6  2.6829243      0.33650319 0.68586387     0.34987822             1.0           1.00 1.177351e-01         2 # 33:       7   SLC2A1  2.7642290      0.31840437 0.70680628     0.33418653             1.0           1.00 1.064065e-01         3 # 34:       7   S100A2  5.2415295      0.33596555 0.92670157     0.31263296             1.0           1.00 1.050339e-01         4 # 35:       7    ITGA3  4.2001159      0.32268560 0.91099476     0.31732234             1.0           1.00 1.023953e-01         5 # 36:       8    CXCL8  3.8332176      0.34293929 0.62500000     0.30076350             1.0           1.00 1.031436e-01         1 # 37:       8    CCL15  2.5480321      0.17891558 0.52500000     0.16468271             1.0           1.00 2.946430e-02        51 # 38:       8    KRT18  2.5900116      0.11144915 0.54166667     0.10688863             1.0           1.00 1.191265e-02       225 # 39:       8     RARA  3.0165397      0.10350445 0.61666667     0.09770431             1.0           1.00 1.011283e-02       269 # 40:       8    RPL21  3.8977863      0.09196966 0.74166667     0.08031020             1.0           1.00 7.386102e-03       335 # 41:       9  COL12A1  3.1357798      0.37144461 0.74000000     0.37663390             1.0           1.00 1.398986e-01         1 # 42:       9   COL6A1  5.4311138      0.37885115 0.96000000     0.35502793             1.0           1.00 1.345027e-01         2 # 43:       9   COL6A3  5.3010486      0.37021296 0.96000000     0.35369715             1.0           1.00 1.309433e-01         3 # 44:       9      LUM  4.1146700      0.36697530 0.82000000     0.35593448             1.0           1.00 1.306192e-01         4 # 45:       9   COL6A2  5.5736044      0.36936888 1.00000000     0.34879032             1.0           1.00 1.288323e-01         5 # 46:      10   JCHAIN  6.9947297      0.41405696 1.00000000     0.38000000             1.0           1.00 1.573416e-01         1 # 47:      10     IGHM  9.7929156      0.41818020 1.00000000     0.34508525             1.0           1.00 1.443078e-01         2 # 48:      10     IGKC  7.5834742      0.28325352 0.89473684     0.20871211             1.0           1.00 5.911844e-02         4 # 49:      10    IGHA1  4.4631436      0.19301447 0.73684211     0.17215134             1.0           1.00 3.322770e-02        18 # 50:      10    IGHG1  5.1429134      0.15242469 0.84210526     0.13847022             1.0           1.00 2.110628e-02        40 #     cluster    feats expression expression_gini  detection detection_gini expression_rank detection_rank   comb_score comb_rank"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"heatmap","dir":"Articles","previous_headings":"13. Identify cluster differential expression genes","what":"13.2 Heatmap","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"cluster_order = 1:10 plotMetaDataHeatmap(fov_join,                     expression_values = 'normalized',                     metadata_cols = c('leiden_clus'),                     selected_feats = topgini_genes,                     custom_cluster_order = cluster_order,                     save_param = list(base_height = 5,                                       save_name = '10.2_heatmap'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"plot-gini-genes-on-umap","dir":"Articles","previous_headings":"13. Identify cluster differential expression genes","what":"13.3 Plot gini genes on UMAP","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"# low, mid, high custom_scale = c('#440154', '#1F968B', '#FDE725')  dimFeatPlot2D(fov_join,               expression_values = 'normalized',               cell_color_gradient = custom_scale,               gradient_midpoint = 5,               feats = topgini_genes,               point_shape = 'no_border',               point_size = 0.001,               cow_n_col = 4,               save_param = list(base_height = 8,                                 save_name = '10.3_gini_genes'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"annotate-giotto-object","dir":"Articles","previous_headings":"13. Identify cluster differential expression genes","what":"13.4 Annotate Giotto Object","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"## add cell types ### clusters_cell_types_lung = c('Normal Epithelial 1', 'Cancer', 'Stromal', 'B-lineage',                              'Macrophage', 'B-lineage', 'Cancer',                              'Normal Epithelial 2', 'Stromal', 'B-lineage')  names(clusters_cell_types_lung) = 1:10 fov_join = annotateGiotto(gobject = fov_join,                           annotation_vector = clusters_cell_types_lung,                           cluster_column = 'leiden_clus',                           name = 'cell_types')  plotUMAP(fov_join,          cell_color = 'cell_types',          cell_color_code = viv10,          point_size = 1.5,          save_param = list(save_name = '11_anno_umap'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"visualize","dir":"Articles","previous_headings":"13. Identify cluster differential expression genes","what":"13.5 Visualize","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"spatDimPlot2D(gobject = fov_join,               show_image = TRUE,               image_name = image_names,               cell_color = 'cell_types',               cell_color_code = viv10,               spat_point_size = 1,               save_param = list(save_name = '12_spatdim_type')) spatInSituPlotPoints(fov_join,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'grey',                      polygon_line_size = 0.05,                      polygon_fill = 'cell_types',                      polygon_fill_as_factor = TRUE,                      polygon_fill_code = viv10,                      save_param = list(base_height = 2,                                        save_name = '13_insitu_type'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"interaction-changed-genes","dir":"Articles","previous_headings":"","what":"14. Interaction Changed Genes","title":"Nanostring CosMx Subcellular Lung Cancer","text":"","code":"future::plan('multisession', workers = 4) # NOTE: Depending on your system this could take time  icf = findInteractionChangedFeats(gobject = fov_join,                                   cluster_column = 'cell_types')  # Identify top ten interaction changed features icf$ICFscores[type_int == 'hetero']$feats[1:10]  # Skip first two genes since they are too highly expressed icf_plotfeats = icf$ICFscores[type_int == 'hetero']$feats[3:12]  # Visualize ICF expression spatInSituPlotPoints(fov_join,                      feats = list(icf_plotfeats),                      point_size = 0.001,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'gray',                      polygon_line_size = 0.05,                      polygon_fill = 'cell_types',                      polygon_fill_as_factor = TRUE,                      polygon_fill_code = pal10,                      save_param = list(base_height = 6,                                        save_name = '14_ICF'))"},{"path":"https://drieslab.github.io/Giotto/articles/nanostring_cosmx_lung_cancer.html","id":"saving-the-giotto-object","dir":"Articles","previous_headings":"","what":"15. Saving the giotto object","title":"Nanostring CosMx Subcellular Lung Cancer","text":"Giotto uses many objects include pointers information live disk instead loading everything memory. includes giotto image objects (giottoImage, giottoLargeImage) also subcellular information (giottoPoints, giottoPolygon). saving project .RDS .Rdata, pointers broken can produce errors loaded . saveGiotto() function can save Giotto Suite projects contained structured directory can properly loaded later using loadGiotto().","code":"saveGiotto(gobject = fov_join,            foldername = 'new_folder_name',            dir = '/directory/to/save/to/') sessionInfo() # R version 4.2.1 (2022-06-23) # Platform: x86_64-apple-darwin17.0 (64-bit) # Running under: macOS Big Sur 11.6 #  # Matrix products: default # LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib #  # locale: # [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #  # attached base packages: # [1] stats     graphics  grDevices utils     datasets  methods   base      #  # other attached packages: # [1] Giotto_3.1   testthat_3.1.5 ggplot2_3.4.0  #  # loaded via a namespace (and not attached): #   [1] utf8_1.2.2                  reticulate_1.26             R.utils_2.12.2              #   [4] tidyselect_1.2.0            htmlwidgets_1.5.4           grid_4.2.1                  #   [7] BiocParallel_1.32.3         Rtsne_0.16                  devtools_2.4.5              #  [10] scatterpie_0.1.8            munsell_0.5.0               ScaledMatrix_1.6.0          #  [13] codetools_0.2-18            ragg_1.2.4                  statmod_1.4.37              #  [16] scran_1.24.1                future_1.29.0               miniUI_0.1.1.1              #  [19] withr_2.5.0                 colorspace_2.0-3            Biobase_2.56.0              #  [22] knitr_1.41                  rstudioapi_0.14             stats4_4.2.1                #  [25] SingleCellExperiment_1.18.1 listenv_0.8.0               MatrixGenerics_1.10.0       #  [28] labeling_0.4.2              GenomeInfoDbData_1.2.8      polyclip_1.10-4             #  [31] farver_2.1.1                rprojroot_2.0.3             parallelly_1.32.1           #  [34] vctrs_0.5.1                 generics_0.1.3              xfun_0.35                   #  [37] R6_2.5.1                    doParallel_1.0.17           GenomeInfoDb_1.32.4         #  [40] clue_0.3-62                 rsvd_1.0.5                  locfit_1.5-9.6              #  [43] bitops_1.0-7                cachem_1.0.6                DelayedArray_0.24.0         #  [46] assertthat_0.2.1            promises_1.2.0.1            scales_1.2.1                #  [49] gtable_0.3.1                beachmat_2.14.0             globals_0.16.2              #  [52] processx_3.8.0              rlang_1.0.6                 systemfonts_1.0.4           #  [55] GlobalOptions_0.1.2         lazyeval_0.2.2              reshape2_1.4.4              #  [58] httpuv_1.6.6                tools_4.2.1                 usethis_2.1.6               #  [61] ellipsis_0.3.2              RColorBrewer_1.1-3          BiocGenerics_0.44.0         #  [64] rcartocolor_2.0.0           sessioninfo_1.2.2           Rcpp_1.0.9                  #  [67] plyr_1.8.8                  sparseMatrixStats_1.10.0    zlibbioc_1.42.0             #  [70] purrr_0.3.5                 RCurl_1.98-1.9              ps_1.7.2                    #  [73] prettyunits_1.1.1           dbscan_1.1-11               deldir_1.0-6                #  [76] GetoptLong_1.0.5            cowplot_1.1.1               urlchecker_1.0.1            #  [79] S4Vectors_0.36.0            SummarizedExperiment_1.26.1 ggrepel_0.9.2               #  [82] cluster_2.1.4               fs_1.5.2                    here_1.0.1                  #  [85] magrittr_2.0.3              data.table_1.14.6           magick_2.7.3                #  [88] circlize_0.4.15             matrixStats_0.63.0          pkgload_1.3.1               #  [91] mime_0.12                   evaluate_0.18               xtable_1.8-4                #  [94] IRanges_2.32.0              shape_1.4.6                 compiler_4.2.1              #  [97] tibble_3.1.8                crayon_1.5.2                R.oo_1.25.0                 # [100] htmltools_0.5.3             ggfun_0.0.8                 later_1.3.0                 # [103] tidyr_1.2.1                 DBI_1.1.3                   tweenr_2.0.2                # [106] ComplexHeatmap_2.12.1       MASS_7.3-58.1               Matrix_1.5-3                # [109] brio_1.1.3                  cli_3.4.1                   R.methodsS3_1.8.2           # [112] parallel_4.2.1              metapod_1.4.0               igraph_1.3.5                # [115] GenomicRanges_1.48.0        pkgconfig_2.0.3             sp_1.5-1                    # [118] terra_1.6-41                plotly_4.10.1               scuttle_1.6.3               # [121] foreach_1.5.2               dqrng_0.3.0                 XVector_0.36.0              # [124] stringr_1.4.1               callr_3.7.3                 digest_0.6.30               # [127] RcppAnnoy_0.0.20            rmarkdown_2.18              uwot_0.1.14                 # [130] edgeR_3.38.4                DelayedMatrixStats_1.20.0   shiny_1.7.3                 # [133] rjson_0.2.21                lifecycle_1.0.3             jsonlite_1.8.3              # [136] BiocNeighbors_1.14.0        desc_1.4.2                  viridisLite_0.4.1           # [139] limma_3.54.0                fansi_1.0.3                 pillar_1.8.1                # [142] lattice_0.20-45             fastmap_1.1.0               httr_1.4.4                  # [145] pkgbuild_1.3.1              glue_1.6.2                  remotes_2.4.2               # [148] png_0.1-7                   iterators_1.0.14            bluster_1.6.0               # [151] ggforce_0.4.1               stringi_1.7.8               profvis_0.3.7               # [154] textshaping_0.3.6           BiocSingular_1.14.0         memoise_2.0.1               # [157] dplyr_1.0.10                irlba_2.3.5.1               future.apply_1.10.0"},{"path":"https://drieslab.github.io/Giotto/articles/object_creation.html","id":"how-to-create-a-giotto-object","dir":"Articles","previous_headings":"","what":"1. How to create a Giotto Object","title":"Giotto Object Creation","text":"tutorial, methodology syntax create giotto object shown osmFISH data used throughout tutorial.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/object_creation.html","id":"import-giotto-and-download-the-data","dir":"Articles","previous_headings":"1. How to create a Giotto Object","what":"1.1 Import Giotto and Download the Data","title":"Giotto Object Creation","text":"download data, please ensure wget installed locally.","code":"library(Giotto)  genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment.   installGiottoEnvironment() }  # Specify path from which data may be retrieved/stored data_directory = paste0(getwd(),'/gobject_data/') # alternatively, \"/path/to/where/the/data/lives/\"  # Specify path to which results may be saved results_directory = paste0(getwd(),'/gobject_results/')  # alternatively, \"/path/to/store/the/results/\"  # Download osmFISH dataset to data_directory getSpatialDataset(dataset = 'osmfish_SS_cortex', directory = data_directory, method = 'wget')"},{"path":"https://drieslab.github.io/Giotto/articles/object_creation.html","id":"minimum-requirements-for-a-giotto-object","dir":"Articles","previous_headings":"1. How to create a Giotto Object","what":"1.2 Minimum requirements for a Giotto Object","title":"Giotto Object Creation","text":"Expression matrix Spatial locations (unnecessary scRNAseq analysis) , creating giotto object minimum requirements shown two examples. Data formatting guidelines shown code block. Expression file formatting Expression count matrices accepted Giotto columns correlating individual cells (cell IDs) rows individual features (feature IDs). data.table objects text-based files ie: (.csv, .tsv, .txt) read column 1 feature IDs. matrix DelayedMatrix objects feature IDs already incorporated rownames. Locations file formatting Numerical columns interpreted order x, y, (optionally) z coordinate. first non-numerical column taken cell IDs *Note: multiple expression files can given Giotto object creation using named list.","code":"# Example 1. # Create a Giotto object using data directly from file paths  osm_exprs = paste0(data_directory, \"osmFISH_prep_expression.txt\") osm_locs = paste0(data_directory, \"osmFISH_prep_cell_coordinates.txt\")  minimum_gobject1 = createGiottoObject(expression = osm_exprs,                                       spatial_locs = osm_locs)  # Example 2. # Create a Giotto object using objects already loaded into workspace expression_matrix = readExprMatrix(path = osm_exprs) # fast method to read expression matrix cell_locations = data.table::fread(file = osm_locs)  minimum_gobject2 = createGiottoObject(expression = expression_matrix,                                       spatial_locs = cell_locations) # Arbitrary modifications scaled_matrix = expression_matrix * 1.2 custom_matrix = expression_matrix * 0.5  # Provide multiple expression matrices at once to the Giotto Object # If these matrices are stored in files rather than in the workspace, # file paths may be provided instead of variables multi_expr_gobject = createGiottoObject(expression = list(raw = expression_matrix,                                                           scaled = scaled_matrix,                                                           custom = custom_matrix),                                         spatial_locs = cell_locations)"},{"path":"https://drieslab.github.io/Giotto/articles/object_creation.html","id":"customizing-the-giotto-object","dir":"Articles","previous_headings":"1. How to create a Giotto Object","what":"1.3 Customizing the Giotto Object","title":"Giotto Object Creation","text":"providing values createGiottoObject() parameters, possible add: Cell feature (gene) metadata: see addCellMetadata addFeatMetadata Spatial networks grids: see Visualizations Dimension reduction: see Clustering Images: see Imaging giottoInstructions: see createGiottoInstructions Providing giottoInstructions allows specification : alternative python path using Giotto Environment (default) desired directory resulting plots save Plot formatting createGiottoInstruction() used create instructions provided createGiottoObject(). instructions() function can used view, set, modify one instructions added giotto object. example customized Giotto object. Note although parameters show_plot, return_plot, save_plot specified within call createGiottoInstructions(), default values provided instruction parameters. instruction parameters default values, createGiottoInstructions() may called arguments yet instruction parameters value execution. Alternatively, named list may also provided instructions argument createGiottoObject(). However, ensure arguments createGiottoInstructions() defined providing instructions named list, since default values applied instructions made createGiottoInstructions() \\*Note thatpython_path` must specified providing instructions named list, may provided NULL. giottoInstructions may changed, completely replaced:","code":"# Specify data with file paths  osm_exprs = paste0(data_directory, \"osmFISH_prep_expression.txt\") osm_locs = paste0(data_directory, \"osmFISH_prep_cell_coordinates.txt\") meta_path = paste0(data_directory, \"osmFISH_prep_cell_metadata.txt\")  # Create instructions  # Optional: Specify a path to a Python executable within a conda or miniconda  # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired.  instrs = createGiottoInstructions(python_path = my_python_path,                                   save_dir = results_directory,                                   plot_format = 'png',                                   dpi = 200,                                   height = 9,                                   width = 9)  # Create Giotto object custom_gobject = createGiottoObject(expression = osm_exprs,                                     spatial_locs = osm_locs,                                                                           instructions = instrs)  # Add field annotations as cell metadata metadata = data.table::fread(file = meta_path) custom_gobject = addCellMetadata(custom_gobject,                                   new_metadata = metadata,                                  by_column = T,                                   column_cell_ID = 'CellID')  # Show the Giotto instructions associated with the Giotto object instructions(custom_gobject) # Change a specific previously set parameter, e.g. change dpi = 200 to dpi = 300 instructions(custom_gobject, 'dpi') = 300  # Observe that the instructions have changed instructions(custom_gobject, 'dpi')  # Create new instructions using a named list sub_results_directory = paste0(results_directory, 'specific_results/') my_python_path = instructions(custom_gobject, 'python_path') new_instrs = list(python_path = my_python_path,                   show_plot = TRUE,                   return_plot = FALSE,                   save_plot = TRUE,                   save_dir = sub_results_directory,                   plot_format = 'jpg',                   dpi = 250,                   units = 'in',                   height = 12,                   width = 12,                   is_docker = FALSE)  # Change all instructions instructions(custom_gobject) = new_instrs  # Observe that the instructions have changed instructions(custom_gobject)"},{"path":"https://drieslab.github.io/Giotto/articles/object_creation.html","id":"active-spatial-unit-and-feature-type","dir":"Articles","previous_headings":"1. How to create a Giotto Object > 1.3 Customizing the Giotto Object","what":"1.3.1 Active spatial unit and feature type","title":"Giotto Object Creation","text":"Many Giotto’s functions spat_unit feat_type parameters govern set data use. active spatial unit feature type visible directly returning giotto object decides defaults used parameters supplied. setting also stored within giottoInstructions convenient accessors specific two settings: activeSpatUnit() activeFeatType()","code":""},{"path":"https://drieslab.github.io/Giotto/articles/object_creation.html","id":"plotting-data-from-a-giotto-object","dir":"Articles","previous_headings":"1. How to create a Giotto Object","what":"1.4 Plotting Data from a Giotto Object","title":"Giotto Object Creation","text":"plotting function Giotto three important binary parameters: show_plot: print plot console, default TRUE return_plot: return plot object, default TRUE save_plot: automatically save plot, default FALSE parameters stored within giotto object provided instructions createGiottoInstructions() provided plotting functions accordingly. change parameters default values, instructions may changed replaced, parameters may manually overwritten within plotting functions. See showSaveParameters() Saving Options tutorial alternative methods save plots.  -depth look giotto object structure, take look introduction giotto classes","code":"# Plot according to Giotto Instructions (default) spatPlot(custom_gobject)  # Plot clusters, create, and save to a new subdirectory, all while overwriting formatting spatPlot(custom_gobject,           cell_color = 'ClusterName',           save_plot = TRUE,          return_plot = TRUE,          show_plot = TRUE,          save_param = list(save_folder = 'plots/', # Create subdirectory                            save_name = 'cell_clusters',                             save_format = 'png',                             units = 'in',                            base_height = 9,                            base_width = 9))"},{"path":"https://drieslab.github.io/Giotto/articles/object_creation.html","id":"session-info","dir":"Articles","previous_headings":"1. How to create a Giotto Object","what":"2. Session Info","title":"Giotto Object Creation","text":"","code":"sessionInfo() R version 4.2.1 (2022-06-23)     Platform: x86_64-apple-darwin17.0 (64-bit)     Running under: macOS Big Sur ... 10.16      Matrix products: default     BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib     LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib      locale:     [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8      attached base packages:     [1] stats     graphics  grDevices utils     datasets  methods   base           loaded via a namespace (and not attached):      [1] compiler_4.2.1  fastmap_1.1.1   cli_3.6.1       tools_4.2.1          [5] htmltools_0.5.5 rstudioapi_0.14 yaml_2.3.7      rmarkdown_2.21       [9] knitr_1.42      xfun_0.39       digest_0.6.31   jsonlite_1.8.4      [13] rlang_1.1.1     evaluate_0.21"},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"Dataset explanation","title":"osmFISH Mouse SS Cortex","text":"Codeluppi et al. created cyclic single-molecule fluorescence situ hybridization (osmFISH) technology define cellular organization somatosensory cortex expression 33 genes 5,328 cells.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"set-up-giotto-environment","dir":"Articles","previous_headings":"","what":"Set up Giotto environment","title":"osmFISH Mouse SS Cortex","text":"","code":"# Ensure Giotto Suite is installed. if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") }  # Ensure GiottoData, a small, helper module for tutorials, is installed. if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") }  library(Giotto) # Ensure the Python environment for Giotto has been installed. genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment.   installGiottoEnvironment() } library(Giotto) library(GiottoData)  # 1. set working directory results_folder = 'path/to/result'  # Optional: Specify a path to a Python executable within a conda or miniconda  # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired."},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"dataset-download","dir":"Articles","previous_headings":"","what":"Dataset download","title":"osmFISH Mouse SS Cortex","text":"osmFISH data run tutorial can found . Alternatively can use getSpatialDataset automatically download dataset like example; download data used create Giotto Object , please ensure wget installed locally.","code":"# download data to working directory #### # if wget is installed, set method = 'wget' # if you run into authentication issues with wget, then add \" extra = '--no-check-certificate' \" getSpatialDataset(dataset = 'osmfish_SS_cortex', directory = results_folder, method = 'wget')"},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"giotto-global-instructions-and-preparations","dir":"Articles","previous_headings":"","what":"1. Giotto global instructions and preparations","title":"osmFISH Mouse SS Cortex","text":"","code":"## instructions allow us to automatically save all plots into a chosen results folder instrs = createGiottoInstructions(save_plot = TRUE,                                    show_plot = FALSE,                                   save_dir = results_folder,                                   python_path = python_path)  expr_path = paste0(results_folder, \"osmFISH_prep_expression.txt\") loc_path = paste0(results_folder, \"osmFISH_prep_cell_coordinates.txt\") meta_path = paste0(results_folder, \"osmFISH_prep_cell_metadata.txt\")"},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"create-giotto-object-process-data","dir":"Articles","previous_headings":"","what":"2. Create Giotto object & process data","title":"osmFISH Mouse SS Cortex","text":"","code":"## create osm_test <- createGiottoObject(expression = expr_path,                               spatial_locs = loc_path,                               instructions = instrs)  ## add field annotation metadata = data.table::fread(file = meta_path) osm_test = addCellMetadata(osm_test, new_metadata = metadata,                            by_column = T, column_cell_ID = 'CellID') ## filter osm_test <- filterGiotto(gobject = osm_test,                          expression_threshold = 1,                          feat_det_in_min_cells = 10,                          min_det_feats_per_cell = 10,                          expression_values = c('raw'),                          verbose = T)  ## normalize Giotto ## there are two ways for osmFISH object  # 1. standard z-score way osm_test <- normalizeGiotto(gobject = osm_test)  # 2. osmFISH way raw_expr_matrix = get_expression_values(osm_test, values = \"raw\") norm_genes = (raw_expr_matrix/GiottorowSums_flex(raw_expr_matrix)) * nrow(raw_expr_matrix)  norm_genes_cells = Giottot_flex((Giottot_flex(norm_genes)/GiottocolSums_flex(norm_genes)) * ncol(raw_expr_matrix)) osm_test = set_expression_values(osm_test, values = norm_genes_cells , name = \"custom\")  ## add gene & cell statistics osm_test <- addStatistics(gobject = osm_test)  # save according to giotto instructions spatPlot2D(gobject = osm_test, cell_color = 'ClusterName', point_size = 1.5,          save_param = list(save_name = '2_a_original_clusters')) spatPlot2D(gobject = osm_test, cell_color = 'Region',          save_param = list(save_name = '2_b_original_regions')) spatPlot2D(gobject = osm_test, cell_color = 'ClusterID',          save_param = list(save_name = '2_c_clusterID')) spatPlot2D(gobject = osm_test, cell_color = 'total_expr', color_as_factor = F, gradient_midpoint = 160,          gradient_limits = c(120,220),          save_param = list(save_name = '2_d_total_expr_limits'))"},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"dimension-reduction","dir":"Articles","previous_headings":"","what":"3. Dimension reduction","title":"osmFISH Mouse SS Cortex","text":"","code":"## highly variable genes (HVG) # only 33 genes so use all genes  ## run PCA on expression values (default) osm_test <- runPCA(gobject = osm_test, expression_values = 'custom', scale_unit = F, center = F) screePlot(osm_test, ncp = 30,           save_param = list(save_name = '3_a_screeplot')) plotPCA(osm_test,         save_param = list(save_name = '3_b_PCA_reduction')) ## run UMAP and tSNE on PCA space (default) osm_test <- runUMAP(osm_test, dimensions_to_use = 1:31, n_threads = 4) plotUMAP(gobject = osm_test,          save_param = list(save_name = '3_c_UMAP_reduction.png')) plotUMAP(gobject = osm_test,          cell_color = 'total_expr', color_as_factor = F, gradient_midpoint = 180, gradient_limits = c(120, 220),          save_param = list(save_name = '3_d_UMAP_reduction_expression.png')) osm_test <- runtSNE(osm_test, dimensions_to_use = 1:31, perplexity = 70, check_duplicates = F) plotTSNE(gobject = osm_test,  save_param = list(save_name = '3_e_tSNE_reduction'))"},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"cluster","dir":"Articles","previous_headings":"","what":"4. Cluster","title":"osmFISH Mouse SS Cortex","text":"","code":"## hierarchical clustering osm_test = doHclust(gobject = osm_test, expression_values = 'custom', k = 36) plotUMAP(gobject = osm_test, cell_color = 'hclust', point_size = 2.5,          show_NN_network = F, edge_alpha = 0.05,          save_param = list(save_name = '4_a_UMAP_hclust')) ## kmeans clustering osm_test = doKmeans(gobject = osm_test, expression_values = 'normalized', dim_reduction_to_use = 'pca', dimensions_to_use = 1:20, centers = 36, nstart = 2000) plotUMAP(gobject = osm_test, cell_color = 'kmeans',          point_size = 2.5, show_NN_network = F, edge_alpha = 0.05,           save_param =  list(save_name = '4_b_UMAP_kmeans')) ## Leiden clustering strategy: # 1. overcluster # 2. merge small clusters that are highly similar  # sNN network (default) osm_test <- createNearestNetwork(gobject = osm_test, dimensions_to_use = 1:31, k = 12)  osm_test <- doLeidenCluster(gobject = osm_test, resolution = 0.09, n_iterations = 1000) plotUMAP(gobject = osm_test, cell_color = 'leiden_clus', point_size = 2.5,          show_NN_network = F, edge_alpha = 0.05,          save_param = list(save_name = '4_c_UMAP_leiden')) # merge small groups based on similarity leiden_similarities = getClusterSimilarity(osm_test,                                            expression_values = 'custom',                                            cluster_column = 'leiden_clus')  osm_test = mergeClusters(osm_test,                          expression_values = 'custom',                          cluster_column = 'leiden_clus',                          new_cluster_name = 'leiden_clus_m',                          max_group_size = 30,                          force_min_group_size = 25,                          max_sim_clusters = 10,                          min_cor_score = 0.7)  plotUMAP(gobject = osm_test, cell_color = 'leiden_clus_m', point_size = 2.5,          show_NN_network = F, edge_alpha = 0.05,          save_param = list(save_name = '4_d_UMAP_leiden_merged')) ## show cluster relationships showClusterHeatmap(gobject = osm_test, expression_values = 'custom', cluster_column = 'leiden_clus_m',                    save_param = list(save_name = '4_e_heatmap', units = 'cm'),                    row_names_gp = grid::gpar(fontsize = 6), column_names_gp = grid::gpar(fontsize = 6)) showClusterDendrogram(osm_test, cluster_column = 'leiden_clus_m', h = 1, rotate = T,                       save_param = list(save_name = '4_f_dendro', units = 'cm'))"},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"co-visualize","dir":"Articles","previous_headings":"","what":"5. Co-visualize","title":"osmFISH Mouse SS Cortex","text":"","code":"# expression and spatial spatDimPlot2D(gobject = osm_test, cell_color = 'leiden_clus', spat_point_size = 2,               save_param = list(save_name = '5_a_covis_leiden')) spatDimPlot2D(gobject = osm_test, cell_color = 'leiden_clus_m', spat_point_size = 2,               save_param = list(save_name = '5_b_covis_leiden_m')) spatDimPlot2D(gobject = osm_test, cell_color = 'leiden_clus_m',                dim_point_size = 2, spat_point_size = 2, select_cell_groups = 'm_8',               save_param = list(save_name = '5_c_covis_leiden_merged_selected')) spatDimPlot2D(gobject = osm_test, cell_color = 'total_expr', color_as_factor = F,               gradient_midpoint = 160, gradient_limits = c(120,220),               save_param = list(save_name = '5_d_total_expr'))"},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"differential-expression","dir":"Articles","previous_headings":"","what":"6. Differential expression","title":"osmFISH Mouse SS Cortex","text":"","code":"## split dendrogram nodes ## dendsplits = getDendrogramSplits(gobject = osm_test,                                  expression_values = 'custom',                                  cluster_column = 'leiden_clus_m') split_3_markers = findMarkers(gobject = osm_test,                                          method = 'gini',                                          expression_values = 'custom',                                          cluster_column = 'leiden_clus_m', group_1 = unlist(dendsplits[3]$tree_1), group_2 = unlist(dendsplits[3]$tree_2)) ## Individual populations ## markers = findMarkers_one_vs_all(gobject = osm_test,                                  method = 'scran',                                  expression_values = 'custom',                                  cluster_column = 'leiden_clus_m',                                  min_feats = 2, rank_score = 2) ## violinplot topgenes = markers[, head(.SD, 1), by = 'cluster']$feats violinPlot(osm_test, feats = unique(topgenes), cluster_column = 'leiden_clus_m', expression_values = 'custom',            strip_text = 5, strip_position = 'right',            save_param = c(save_name = '6_a_violinplot')) plotMetaDataHeatmap(osm_test, expression_values = 'custom',                     metadata_cols = c('leiden_clus_m'),                      save_param = c(save_name = '6_b_metaheatmap')) plotMetaDataHeatmap(osm_test, expression_values = 'custom',                     metadata_cols = c('leiden_clus_m'),                      save_param = c(save_name = '6_e_metaheatmap_all_genes')) plotMetaDataHeatmap(osm_test, expression_values = 'custom',                     metadata_cols = c('ClusterName'),                      save_param = c(save_name = '6_f_metaheatmap_all_genes_names'))"},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"cell-type-annotation","dir":"Articles","previous_headings":"","what":"7. Cell type annotation","title":"osmFISH Mouse SS Cortex","text":"Use annotateGiotto() annotate clusters. dataset, ClusterName metadata.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"spatial-grid","dir":"Articles","previous_headings":"","what":"8. Spatial grid","title":"osmFISH Mouse SS Cortex","text":"","code":"osm_test <- createSpatialGrid(gobject = osm_test,                               sdimx_stepsize = 2000,                               sdimy_stepsize = 2000,                               minimum_padding = 0) spatPlot2D(osm_test, cell_color = 'ClusterName', show_grid = T,             grid_color = 'lightblue', spatial_grid_name = 'spatial_grid',            point_size = 1.5,            save_param = c(save_name = '8_grid_det_cell_types'))"},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"spatial-network","dir":"Articles","previous_headings":"","what":"9. Spatial network","title":"osmFISH Mouse SS Cortex","text":"","code":"osm_test <- createSpatialNetwork(gobject = osm_test) spatPlot2D(gobject = osm_test, show_network = T,            network_color = 'blue',            point_size = 1.5, cell_color = 'ClusterName', legend_symbol_size = 2,            save_param = c(save_name = '9_spatial_network_k10'))"},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"spatial-genes","dir":"Articles","previous_headings":"","what":"10. Spatial genes","title":"osmFISH Mouse SS Cortex","text":"","code":"# km binarization kmtest = binSpect(osm_test, calc_hub = T, hub_min_int = 5,                   bin_method = 'kmeans')  spatDimFeatPlot2D(osm_test, expression_values = 'scaled',                feats = kmtest$feats[1:3], plot_alignment = 'horizontal',                cow_n_col = 1,                save_param = c(save_name = '10_a_spatial_genes_km'))"},{"path":"https://drieslab.github.io/Giotto/articles/osmfish_mouse_ss_cortex.html","id":"cell-cell-preferential-proximity","dir":"Articles","previous_headings":"","what":"12. Cell-cell preferential proximity","title":"osmFISH Mouse SS Cortex","text":"","code":"## calculate frequently seen proximities cell_proximities = cellProximityEnrichment(gobject = osm_test,                                            cluster_column = 'ClusterName',                                            number_of_simulations = 1000) ## barplot cellProximityBarplot(gobject = osm_test, CPscore = cell_proximities, min_orig_ints = 25, min_sim_ints = 25,                      save_param = c(save_name = '12_a_barplot_cell_cell_enrichment')) ## heatmap cellProximityHeatmap(gobject = osm_test, CPscore = cell_proximities, order_cell_types = T, scale = T,                      color_breaks = c(-1.5, 0, 1.5), color_names = c('blue', 'white', 'red'),                      save_param = c(save_name = '12_b_heatmap_cell_cell_enrichment', unit = 'in')) ## network cellProximityNetwork(gobject = osm_test, CPscore = cell_proximities, remove_self_edges = F, only_show_enrichment_edges = T,                      save_param = c(save_name = '12_c_network_cell_cell_enrichment')) ## visualization spec_interaction = \"Astrocyte_Mfge8--Oligodendrocyte_Precursor_cells\" cellProximitySpatPlot(gobject = osm_test,                       interaction_name = spec_interaction,                       cluster_column = 'ClusterName',                        cell_color = 'ClusterName', cell_color_code = c('Astrocyte_Mfge8' = 'blue', 'Oligodendrocyte_Precursor_cells' = 'red'),                       coord_fix_ratio = 0.5,  point_size_select = 3, point_size_other = 1.5,                       save_param = c(save_name = '12_d_cell_cell_enrichment_selected'))"},{"path":[]},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"Start Giotto","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"library(Giotto) library(GiottoData)  # 1. set working directory my_working_dir = '/path/to/directory'  # Optional: Specify a path to a Python executable within a conda or miniconda  # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired."},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"input-files","dir":"Articles","previous_headings":"","what":"Input Files","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"## provide path to resolve bioscience folder data_path = '/path/to/Resolve_bioscience_cancer'   # 1. original image as png original_DAPI_image = paste0(data_path, '/', 'sample2_DAPI.jpg')  # 2. input cell segmentation as mask file # can also be provided as a 3-column polygon file # to be used as image background AND to store segmentations as polygons # can be obtained through Fiji / QuPath / Ilastik / Cellpose / ... segmentation_mask = paste0(data_path, '/', 'Mask3.png')  # 3. input features coordinates tx_coord = fread(paste0(data_path, '/', 'data_sample2.txt')) colnames(tx_coord) = c('x', 'y', 'z', 'gene_id') tx_coord = tx_coord[,.(x, y, gene_id)]"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"create-subcellular-giotto-object","dir":"Articles","previous_headings":"","what":"1. Create Subcellular Giotto Object","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"testobj = createGiottoObjectSubcellular(gpoints = list('rna' = tx_coord),                                         gpolygons = list('cell' = segmentation_mask),                                         instructions = instrs,                                         verbose = FALSE,                                         cores = 32)"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"create-spatial-locations","dir":"Articles","previous_headings":"","what":"2. Create Spatial Locations","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"# centroids are now used to provide the spatial locations (centroid of each cell) # needed for certain downstream spatial analyses testobj = addSpatialCentroidLocations(testobj,                                       poly_info = 'cell')"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"add-image-information","dir":"Articles","previous_headings":"","what":"3. Add Image Information","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"# create Giotto images DAPI_image = createGiottoImage(gobject = testobj,                                name = 'DAPI',                                do_manual_adj = T,                                xmax_adj = 0,ymax_adj = 0,                                xmin_adj = 0,ymin_adj = 0,                                image_transformations = 'flip_x_axis',                                mg_object = original_DAPI_image)  segm_image = createGiottoImage(gobject = testobj,                                name = 'segmentation',                                do_manual_adj = T,                                xmax_adj = 0,ymax_adj = 0,                                xmin_adj = 0,ymin_adj = 0,                                image_transformations = 'flip_x_axis',                                mg_object = segmentation_mask)  # add images to Giotto object testobj = addGiottoImage(testobj,                          images = list(DAPI_image, segm_image))  # provides an overview of available images showGiottoImageNames(testobj)"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"visualize-original-images","dir":"Articles","previous_headings":"","what":"4. Visualize Original Images","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"# visualize overlay of calculated cell centroid with original image and segmentation mask file # by setting show_plot to FALSE and save_plot to TRUE you can save quite some time when creating plots # with big images it sometimes takes quite long for R/Rstudio to render them spatPlot2D(gobject = testobj,             image_name = 'DAPI',             point_size = 1.5) spatPlot2D(gobject = testobj,             image_name = 'segmentation',             point_size = 1.5)"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"calculate-cell-shape-overlap","dir":"Articles","previous_headings":"","what":"5. Calculate Cell Shape Overlap","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"tictoc::tic() testobj = calculateOverlap(testobj,                            method = 'parallel',                            x_step = 1000,                            y_step = 1000,                            poly_info = 'cell',                            feat_info = 'rna') tictoc::toc() #convert overlap to matrix  testobj = overlapToMatrix(testobj,                           poly_info = 'cell',                           feat_info = 'rna',                           name = 'raw')"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"filter-data","dir":"Articles","previous_headings":"","what":"6. Filter Data","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"# features can be filtered individually # cells will be filtered across features  # first filter on rna subc_test <- filterGiotto(gobject = testobj,                           expression_threshold = 1,                           feat_det_in_min_cells = 20,                           min_det_feats_per_cell = 5)  spatPlot2D(gobject = subc_test,            image_name = 'segmentation', show_image = TRUE,            point_size = 1.5)"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"process-giotto-object","dir":"Articles","previous_headings":"","what":"7. Process Giotto Object","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"# rna data, default. # other feature modalities can be processed and filtered in an anologous manner subc_test <- normalizeGiotto(gobject = subc_test,                               scalefactor = 6000,                               verbose = T) subc_test <- addStatistics(gobject = subc_test) subc_test <- adjustGiottoMatrix(gobject = subc_test,                                 expression_values = c('normalized'),                                 covariate_columns = c('nr_feats', 'total_expr'))  subc_test <- normalizeGiotto(gobject = subc_test, norm_methods = 'pearson_resid', update_slot = 'pearson') showGiottoExpression(subc_test)"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"dimension-reduction","dir":"Articles","previous_headings":"","what":"8. Dimension Reduction","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"# Find highly valuable Features  # typical way of calculating HVF subc_test <- calculateHVF(gobject = subc_test, HVFname= 'hvg_orig') # new method based on variance of pearson residuals for each gene subc_test <- calculateHVF(gobject = subc_test,                           method = 'var_p_resid',                            expression_values = 'pearson',                           show_plot = T) #run PCA subc_test <- runPCA(gobject = subc_test,                     expression_values = 'pearson',                     scale_unit = F, center = F)  screePlot(subc_test, ncp = 20) plotPCA(subc_test,         dim1_to_use = 1,         dim2_to_use = 2) # run UMAP subc_test <- runUMAP(subc_test,                       dimensions_to_use = 1:5,                       n_threads = 2) plotUMAP(gobject = subc_test)"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"cluster","dir":"Articles","previous_headings":"","what":"9. Cluster","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"subc_test <- createNearestNetwork(gobject = subc_test,                                    dimensions_to_use = 1:5,                                    k = 5) subc_test <- doLeidenCluster(gobject = subc_test,                               resolution = 0.05,                               n_iterations = 1000,                               name = 'leiden_0.05')  # Create color palettes, or proceed with Giotto defaults devtools::install_github(\"alyssafrazee/RSkittleBrewer\") colorcode = lacroix_palette(type = \"paired\") featcolor = lacroix_palette(\"KeyLime\", type = \"discrete\")  # visualize UMAP cluster results plotUMAP(gobject = subc_test,           cell_color = 'leiden_clus',          show_NN_network = T,           point_size = 2.5,           cell_color_code = colorcode) # visualize UMAP and spatial results spatDimPlot2D(gobject = subc_test,               show_image = T,                image_name = 'segmentation',               cell_color = 'leiden_clus',               spat_point_size = 2,                cell_color_code = colorcode) # Plot a cluster heatmap showClusterHeatmap(gobject = subc_test,                     cluster_column = 'leiden_clus',                    save_param = list(save_format = 'pdf',base_height = 6, base_width = 8, units = 'cm')) # See cluster relationships in a dendogram showClusterDendrogram(subc_test,                        h = 0.5,                        rotate = T,                        cluster_column = 'leiden_clus')"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"create-a-spatial-network","dir":"Articles","previous_headings":"","what":"10. Create a Spatial Network","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"subc_test = createSpatialNetwork(gobject = subc_test,                                  spat_loc_name = 'cell',                                  minimum_k = 3,                                  maximum_distance_delaunay = 100)  spatPlot2D(gobject = subc_test,            image_name = 'segmentation',             show_image = TRUE,            point_size = 1.5,             show_network = TRUE)"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"visualize-subcellular-data","dir":"Articles","previous_headings":"","what":"11. Visualize SubCellular Data","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"# Visualize clustered cells spatInSituPlotPoints(subc_test,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'white',                      polygon_line_size = 0.1,                      polygon_fill = 'leiden_clus',                      polygon_fill_as_factor = T ,                       polygon_fill_code = colorcode) # individual plotting of transcripts and polygon information  # all cells spatInSituPlotPoints(testobj,                      feats = list('rna' = c(\"MMP2\", \"VEGFA\", \"IGF1R\", 'CDH2', 'MKI67')),                      point_size = 0.2,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'white',                      polygon_line_size = 0.1) # filtered cells spatInSituPlotPoints(subc_test,                      feats = list('rna' = c(\"MMP2\", \"VEGFA\", \"IGF1R\", 'CDH2', 'MKI67')),                      point_size = 0.2,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'white',                      polygon_line_size = 0.1) # faster plotting method if you have many points spatInSituPlotPoints(subc_test,                      plot_method = 'scattermore',                      feats = list('rna' = c(\"MMP2\", \"VEGFA\", \"IGF1R\", 'CDH2', 'MKI67')),                      point_size = 0.2,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'white',                      polygon_line_size = 0.1)"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"subset-by-location","dir":"Articles","previous_headings":"11. Visualize SubCellular Data","what":"11.1 Subset by Location","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"# can be used to focus on specific spatial structures # to zoom in on niche environments  subloc = subsetGiottoLocs(subc_test,                           x_min = 0, x_max = 2000,                           y_min = 0, y_max = 2000,                           poly_info = 'cell')  # show subset of genes spatInSituPlotPoints(subloc,                      feats = list('rna' = c(\"MMP2\", \"VEGFA\", \"IGF1R\", 'CDH2', 'MKI67')),                      point_size = 0.6,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'white',                      polygon_line_size = 0.1) # show subset of genes and color cells according to clusters spatInSituPlotPoints(subloc,                      feats = list('rna' = c(\"MMP2\", \"VEGFA\", \"IGF1R\", 'CDH2', 'MKI67')),                      point_size = 0.6,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'white',                      polygon_line_size = 0.1,                      polygon_fill = 'leiden_clus',                      polygon_fill_as_factor = T,                       polygon_fill_code = colorcode,                      feats_color_code = featcolor) # show subset of genes and color cells according to total expression # use a faster and more efficient point plotting method = scattermore spatInSituPlotPoints(subloc,                      plot_method = 'scattermore',                      feats = list('rna' = c(\"MMP2\", \"VEGFA\", \"IGF1R\", 'CDH2', 'MKI67')),                      point_size = 0.6,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'white',                      polygon_line_size = 0.1,                      polygon_fill = 'total_expr',                      polygon_fill_as_factor = F) # show cells and color them according to total expression spatInSituPlotPoints(subloc,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'white',                      polygon_line_size = 0.1,                      polygon_fill = 'total_expr',                      polygon_fill_as_factor = F) # show cells and color them according to total cluster information spatInSituPlotPoints(subloc,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'white',                      polygon_line_size = 0.1,                      polygon_fill = 'leiden_clus',                      polygon_fill_as_factor = T,                       polygon_fill_code = colorcode)"},{"path":"https://drieslab.github.io/Giotto/articles/resolve_biosciences.html","id":"find-interaction-changed-features","dir":"Articles","previous_headings":"","what":"12. Find Interaction Changed Features","title":"Resolve Bioscience Breast Cancer Subcellular","text":"","code":"# find interaction changed Features # In this case, features are genes whose expression difference is associated with a neighboring cell type future::plan('multisession', workers = 4) # sometimes unstable, restart R session  test = findInteractionChangedFeats(gobject = subc_test,                                    cluster_column = 'leiden_clus')  test$ICFscores[type_int == 'hetero']  spatInSituPlotPoints(subc_test,                      feats = list('rna' = c(\"CTSD\", \"BMP1\")),                      point_size = 0.6,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'black',                      polygon_line_size = 0.1,                      polygon_fill = 'leiden_clus',                      polygon_fill_as_factor = T,                      polygon_fill_code = colorcode,                      feats_color_code = featcolor)"},{"path":"https://drieslab.github.io/Giotto/articles/saving_object.html","id":"tutorial-explanation","dir":"Articles","previous_headings":"","what":"1. Tutorial explanation","title":"Saving your analysis","text":"Giotto objects contain certain objects act pointers data reference pull . can help lowering amount memory needed decrease load times, pointer objects save reload properly using saveRDS() readRDS(). Giotto instead implements saveGiotto() loadGiotto() functions collects data attached object saves standalone manner. functions demonstrated using small subset Vizgen mouse brain dataset easily available GiottoData package.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/saving_object.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"2. Start Giotto","title":"Saving your analysis","text":"","code":"# Ensure Giotto Suite is installed if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") }  library(Giotto)  # Ensure Giotto Data is installed if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") }  library(GiottoData)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/saving_object.html","id":"create-a-giotto-object","dir":"Articles","previous_headings":"","what":"3. Create a Giotto object","title":"Saving your analysis","text":"","code":"vizgen = loadGiottoMini(dataset = 'vizgen') [1] \"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/GiottoData//Mini_datasets/Vizgen/VizgenObject//Features/rna_feature_spatVector.shp\"     [1] \"rna\"     [1] \"aggregate_spatInfo_spatVector.shp\" \"z0_spatInfo_spatVector.shp\"            [3] \"z1_spatInfo_spatVector.shp\"            [1] \"aggregate_spatInfo_spatVectorCentroids.shp\"     [2] \"z0_spatInfo_spatVectorCentroids.shp\"            [3] \"z1_spatInfo_spatVectorCentroids.shp\"            [1] \"rna_aggregate_spatInfo_spatVectorOverlaps.shp\"     [2] \"rna_z0_spatInfo_spatVectorOverlaps.shp\"            [3] \"rna_z1_spatInfo_spatVectorOverlaps.shp\"            [1] \"poly_ID\"      \"feat_ID\"      \"feat_ID_uniq\" \"stack\"            [1] \"poly_ID\"      \"feat_ID\"      \"feat_ID_uniq\"     [1] \"poly_ID\"      \"feat_ID\"      \"feat_ID_uniq\""},{"path":"https://drieslab.github.io/Giotto/articles/saving_object.html","id":"show-existing-info","dir":"Articles","previous_headings":"","what":"4. Show Existing Info","title":"Saving your analysis","text":"Many analyses first performed mini object fill saved using saveGiotto(). Returning object gives overview contents. object also functions expected. first set active spatial unit ‘aggregate’ plot saved leiden clustering results.","code":"vizgen An object of class giotto      >Active spat_unit:  z0      >Active feat_type:  rna      [SUBCELLULAR INFO]     polygons      : z0 z1 aggregate      features      : rna      [AGGREGATE INFO]     expression -----------------------       [z0][rna] raw       [z1][rna] raw       [aggregate][rna] raw normalized scaled pearson     spatial locations ----------------       [z0] raw       [z1] raw       [aggregate] raw     spatial networks -----------------       [aggregate] Delaunay_network kNN_network     dim reduction --------------------       [aggregate][rna] pca umap tsne     nearest neighbor networks --------       [aggregate][rna] sNN.pca     attached images ------------------     giottoLargeImage : 4 items...      Use objHistory() to see steps and params used activeSpatUnit(vizgen) = 'aggregate' spatPlot2D(vizgen,            show_image = TRUE,            cell_color = 'leiden_clus',            largeImage_name = 'dapi_z0',            point_alpha = 0.5)"},{"path":"https://drieslab.github.io/Giotto/articles/saving_object.html","id":"saving-the-object","dir":"Articles","previous_headings":"","what":"5. Saving the Object","title":"Saving your analysis","text":"save object, important inputs object saved, directory place saved object, actual folder within directory contain Giotto’s files. dir param defaults working directory, specifying object saved temporary directory.","code":"saveGiotto(gobject = vizgen,            dir = tempdir(),            foldername = 'vizgen')"},{"path":"https://drieslab.github.io/Giotto/articles/saving_object.html","id":"faster-saving-with-qs","dir":"Articles","previous_headings":"","what":"6. Faster Saving with qs","title":"Saving your analysis","text":"saveGiotto() defaults using saveRDS() main files, qs implements faster read write functions serialization. Saving using qs done passing param method = 'qs'. Note qs additional package installed default Giotto can installed install.packages(qs).","code":""},{"path":"https://drieslab.github.io/Giotto/articles/saving_object.html","id":"loading-the-object","dir":"Articles","previous_headings":"","what":"7. Loading the Object","title":"Saving your analysis","text":"load object, path folder needed. Additional params interest : reconnect_giottoImage -instead reading saved images folder- attempts reconnect pointer objects based filepaths recorded. requires Giotto object loaded system generated images moved. python_path allows new python path set loading.","code":"test_vizgen = loadGiotto(path_to_folder = file.path(tempdir(), 'vizgen')) test_vizgen An object of class giotto      >Active spat_unit:  aggregate      >Active feat_type:  rna      [SUBCELLULAR INFO]     polygons      : z0 z1 aggregate      features      : rna      [AGGREGATE INFO]     expression -----------------------       [z0][rna] raw       [z1][rna] raw       [aggregate][rna] raw normalized scaled pearson     spatial locations ----------------       [z0] raw       [z1] raw       [aggregate] raw     spatial networks -----------------       [aggregate] Delaunay_network kNN_network     dim reduction --------------------       [aggregate][rna] pca umap tsne     nearest neighbor networks --------       [aggregate][rna] sNN.pca     attached images ------------------     giottoLargeImage : 4 items...      Use objHistory() to see steps and params used activeSpatUnit(test_vizgen) = 'aggregate' spatPlot2D(test_vizgen,            show_image = TRUE,            cell_color = 'leiden_clus',            largeImage_name = 'dapi_z0',            point_alpha = 0.5)"},{"path":"https://drieslab.github.io/Giotto/articles/saving_object.html","id":"session-info","dir":"Articles","previous_headings":"","what":"8. Session Info","title":"Saving your analysis","text":"","code":"sessionInfo() R version 4.2.1 (2022-06-23)     Platform: x86_64-apple-darwin17.0 (64-bit)     Running under: macOS Big Sur ... 10.16      Matrix products: default     BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib     LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib      locale:     [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8      attached base packages:     [1] stats     graphics  grDevices utils     datasets  methods   base           other attached packages:     [1] GiottoData_0.2.1 Giotto_3.2.1          loaded via a namespace (and not attached):      [1] Rcpp_1.0.10        RColorBrewer_1.1-3 pillar_1.9.0       compiler_4.2.1          [5] tools_4.2.1        digest_0.6.31      jsonlite_1.8.4     evaluate_0.20           [9] lifecycle_1.0.3    tibble_3.2.1       gtable_0.3.3       lattice_0.20-45        [13] png_0.1-8          pkgconfig_2.0.3    rlang_1.1.0        igraph_1.4.1           [17] Matrix_1.5-3       cli_3.6.1          rstudioapi_0.14    parallel_4.2.1         [21] yaml_2.3.7         xfun_0.38          fastmap_1.1.1      terra_1.7-22           [25] withr_2.5.0        dplyr_1.1.1        knitr_1.42         generics_0.1.3         [29] vctrs_0.6.1        rprojroot_2.0.3    grid_4.2.1         tidyselect_1.2.0       [33] here_1.0.1         reticulate_1.28    glue_1.6.2         data.table_1.14.8      [37] R6_2.5.1           fansi_1.0.4        rmarkdown_2.21     farver_2.1.1           [41] ggplot2_3.4.2      magrittr_2.0.3     scales_1.2.1       codetools_0.2-18       [45] htmltools_0.5.5    colorspace_2.1-0   labeling_0.4.2     utf8_1.2.3             [49] munsell_0.5.0"},{"path":"https://drieslab.github.io/Giotto/articles/saving_plots.html","id":"explanation","dir":"Articles","previous_headings":"","what":"1. Explanation","title":"Saving Plots","text":"tutorial walks saving spatial data plots. Please see Configuration Giotto Object vignettes walking tutorial. R/Posit Giotto provide different ways save spatial data. , giottoObject created without using giottoInstructions save parameters plotting functions within Giotto well default saving methods built R/Posit may emphasized . Note plotting functions, parameters available save_param argument may found running showSaveParameters().","code":""},{"path":"https://drieslab.github.io/Giotto/articles/saving_plots.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"2. Start Giotto","title":"Saving Plots","text":"","code":"# Ensure Giotto Suite is installed if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") }  library(Giotto)  # Ensure Giotto Data is installed if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") }  library(GiottoData)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/saving_plots.html","id":"create-a-giotto-object","dir":"Articles","previous_headings":"","what":"3. Create a Giotto object","title":"Saving Plots","text":"Since focus vignette saving methods, giottoObject created giottoInstructions. See Giotto Object intuition working giottoObject provided instructions.","code":"data_directory = paste0(getwd(),'/')  # Download dataset  getSpatialDataset(dataset = 'osmfish_SS_cortex',                    directory = data_directory, method = 'wget')  # Specify path to files osm_exprs = paste0(data_directory, \"osmFISH_prep_expression.txt\") osm_locs = paste0(data_directory, \"osmFISH_prep_cell_coordinates.txt\") meta_path = paste0(data_directory, \"osmFISH_prep_cell_metadata.txt\")  ## CREATE GIOTTO OBJECT with expression data and location data my_gobject = createGiottoObject(expression = osm_exprs,                                 spatial_locs = osm_locs)  metadata = data.table::fread(file = meta_path) my_gobject = addCellMetadata(my_gobject,                               new_metadata = metadata,                              by_column = T,                               column_cell_ID = 'CellID')"},{"path":"https://drieslab.github.io/Giotto/articles/saving_plots.html","id":"standard-r-save-methods","dir":"Articles","previous_headings":"","what":"4. Standard R Save Methods","title":"Saving Plots","text":"Note default, plotting functions return plot object may saved manipulated. Manually save plot PDF current working directory:","code":"save_path = paste0(getwd(),'/first_plot.pdf') library(ggplot2)  # This function serves only to ensure the following lines run consecutively. save_pdf_plot = function(){    pdf(file = save_path, width = 7, height = 7)   pl = spatPlot(my_gobject)   dev.off() }  save_pdf_plot()  ### Plot clusters, edit plot object, then save using the ggplot add-on, cowplot: mypl = spatPlot(gobject = my_gobject,                  cell_color = 'ClusterName') # Add a black background mypl = mypl + theme(panel.background = element_rect(fill ='black'),                     panel.grid = element_blank())  # Add a legend mypl = mypl + guides(fill = guide_legend(override.aes = list(size=5)))  # Save in the current working directory cowplot::save_plot(plot = mypl,                    filename = 'clusters_black.png',                     path = getwd(),                    device = png(),                    dpi = 300,                     base_height = 10,                     base_width = 10)"},{"path":"https://drieslab.github.io/Giotto/articles/saving_plots.html","id":"save-plot-directly-to-the-default-folder","dir":"Articles","previous_headings":"","what":"5. Save Plot Directly to the Default Folder","title":"Saving Plots","text":"default save folder current working directory. case instructions provided, save_dir specified within giottoInstructions. See createGiottoInstructions documentation Giotto Object default arguments details.","code":"spatPlot(my_gobject,           cell_color = 'ClusterName',           save_plot = TRUE)"},{"path":"https://drieslab.github.io/Giotto/articles/saving_plots.html","id":"save-plot-directly-but-overwrite-default-save-parameters","dir":"Articles","previous_headings":"","what":"6. Save plot Directly, but Overwrite Default Save Parameters","title":"Saving Plots","text":"example, assume desired plot : - Shown console - returned object plotting function call -Saved subdirectory current working directory .png file dpi 200, height 9 inches, width 9 inches. - Saved file name “my_name” See Giotto Object details. Run command showSaveParameters() see available parameters.","code":"# Specify new subdirectory name results_directory =  'my_subfolder/'  # Plot clusters, create, and save to a new subdirectory with specifications above. spatPlot(my_gobject,           cell_color = 'ClusterName',           save_plot = TRUE,          return_plot = FALSE,          save_param = list(save_folder = results_directory, # Create subdirectory                            save_name = 'my_name',                             save_format = 'png',                             units = 'in',                            base_height = 9,                            base_width = 9))"},{"path":"https://drieslab.github.io/Giotto/articles/saving_plots.html","id":"just-view-the-plot","dir":"Articles","previous_headings":"","what":"7. Just View the Plot","title":"Saving Plots","text":"See Giotto Object details. Set save_plot return_plot FALSE.","code":"# Plot without saving spatPlot(my_gobject,           cell_color = 'ClusterName',           save_plot = FALSE, return_plot = FALSE, show_plot = T)"},{"path":"https://drieslab.github.io/Giotto/articles/saving_plots.html","id":"just-save-the-plot-fastest-for-large-datasets","dir":"Articles","previous_headings":"","what":"8. Just save the plot (FASTEST for large datasets!)","title":"Saving Plots","text":"See Giotto Object details. Set show_plot return_plot FALSE, set save_plot TRUE.","code":"spatPlot(my_gobject,           cell_color = 'ClusterName',           save_plot = TRUE,           return_plot = FALSE,           show_plot = FALSE,          save_param = list(save_name = 'only_save'))"},{"path":"https://drieslab.github.io/Giotto/articles/saving_plots.html","id":"session-info","dir":"Articles","previous_headings":"","what":"9. Session Info","title":"Saving Plots","text":"","code":"sessionInfo() R version 4.2.2 (2022-10-31 ucrt) Platform: x86_64-w64-mingw32/x64 (64-bit) Running under: Windows 10 x64 (build 22621)  Matrix products: default  locale: [1] LC_COLLATE=English_United States.utf8  [2] LC_CTYPE=English_United States.utf8    [3] LC_MONETARY=English_United States.utf8 [4] LC_NUMERIC=C                           [5] LC_TIME=English_United States.utf8      attached base packages: [1] stats     graphics  grDevices utils     datasets  methods   base       other attached packages: [1] ggplot2_3.4.1    GiottoData_0.2.1 Giotto_3.2.1      loaded via a namespace (and not attached): [1] Rcpp_1.0.10        RColorBrewer_1.1-3 pillar_1.9.0       compiler_4.2.2     [5] tools_4.2.2        digest_0.6.30      jsonlite_1.8.3     evaluate_0.20      [9] lifecycle_1.0.3    tibble_3.2.1       gtable_0.3.3       lattice_0.20-45    [13] png_0.1-7          pkgconfig_2.0.3    rlang_1.1.0        Matrix_1.5-1       [17] cli_3.4.1          rstudioapi_0.14    parallel_4.2.2     yaml_2.3.7         [21] xfun_0.38          fastmap_1.1.0      terra_1.7-18       withr_2.5.0        [25] dplyr_1.1.1        knitr_1.42         systemfonts_1.0.4  rappdirs_0.3.3     [29] generics_0.1.3     vctrs_0.6.1        cowplot_1.1.1      grid_4.2.2         [33] tidyselect_1.2.0   reticulate_1.26    glue_1.6.2         data.table_1.14.6  [37] R6_2.5.1           textshaping_0.3.6  fansi_1.0.4        rmarkdown_2.21     [41] farver_2.1.1       magrittr_2.0.3     scales_1.2.1       codetools_0.2-18   [45] htmltools_0.5.4    colorspace_2.1-0   ragg_1.2.4         labeling_0.4.2     [49] utf8_1.2.3         munsell_0.5.0"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"Start Giotto","title":"SeqFish+ Mouse Cortex Example","text":"","code":"# Ensure Giotto Suite is installed. if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") }  # Ensure GiottoData, a small, helper module for tutorials, is installed. if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") }  library(Giotto) # Ensure the Python environment for Giotto has been installed. genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment.   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"Dataset Explanation","title":"SeqFish+ Mouse Cortex Example","text":"Several fields - containing 100’s cells - mouse cortex subventricular zone imaged seqFISH+. coordinates cells within field independent , order visualize process cells together imaging fields stitched together providing x y-offset values specific field. offset values known estimates based original raw image:","code":""},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"download-data","dir":"Articles","previous_headings":"","what":"Download Data","title":"SeqFish+ Mouse Cortex Example","text":"","code":"library(GiottoData)  my_working_dir = '/path/to/directory/' getSpatialDataset(dataset = 'seqfish_SS_cortex', directory = my_working_dir, method = 'wget')"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"giotto-instructions-and-preparation","dir":"Articles","previous_headings":"","what":"1. Giotto Instructions and Preparation","title":"SeqFish+ Mouse Cortex Example","text":"","code":"#  set Giotto instructions instrs = createGiottoInstructions(save_plot = FALSE,                                    show_plot = TRUE,                                   save_dir = my_working_dir,                                    python_path = NULL)  # create giotto object from provided paths #### expr_path = paste0(my_working_dir, \"cortex_svz_expression.txt\") loc_path = paste0(my_working_dir, \"cortex_svz_centroids_coord.txt\") meta_path = paste0(my_working_dir, \"cortex_svz_centroids_annot.txt\") #This dataset contains multiple field of views which need to be stitched together # first merge location and additional metadata SS_locations = data.table::fread(loc_path) cortex_fields = data.table::fread(meta_path) SS_loc_annot = data.table::merge.data.table(SS_locations, cortex_fields, by = 'ID') SS_loc_annot[, ID := factor(ID, levels = paste0('cell_',1:913))] data.table::setorder(SS_loc_annot, ID) # create file with offset information my_offset_file = data.table::data.table(field = c(0, 1, 2, 3, 4, 5, 6),                                         x_offset = c(0, 1654.97, 1750.75, 1674.35, 675.5, 2048, 675),                                         y_offset = c(0, 0, 0, 0, -1438.02, -1438.02, 0)) # create a stitch file stitch_file = stitchFieldCoordinates(location_file = SS_loc_annot,                                      offset_file = my_offset_file,                                      cumulate_offset_x = T,                                      cumulate_offset_y = F,                                      field_col = 'FOV',                                      reverse_final_x = F,                                      reverse_final_y = T) stitch_file = stitch_file[,.(ID, X_final, Y_final)] stitch_file$ID <- as.character(stitch_file$ID) my_offset_file = my_offset_file[,.(field, x_offset_final, y_offset_final)]"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"create-giotto-object-process-data","dir":"Articles","previous_headings":"","what":"2. Create Giotto object & process data","title":"SeqFish+ Mouse Cortex Example","text":"","code":"# create Giotto object SS_seqfish <- createGiottoObject(expression = expr_path,                                  spatial_locs = stitch_file,                                  offset_file = my_offset_file,                                  instructions = instrs) # add additional annotation if wanted SS_seqfish = addCellMetadata(SS_seqfish,                              new_metadata = cortex_fields,                              by_column = T,                              column_cell_ID = 'ID') # subset data to the cortex field of views cell_metadata = pDataDT(SS_seqfish) cortex_cell_ids = cell_metadata[FOV %in% 0:4]$cell_ID SS_seqfish = subsetGiotto(SS_seqfish, cell_ids = cortex_cell_ids) # filter SS_seqfish <- filterGiotto(gobject = SS_seqfish,                            expression_threshold = 1,                            feat_det_in_min_cells = 10,                            min_det_feats_per_cell = 10,                            expression_values = c('raw'),                            verbose = T) # normalize SS_seqfish <- normalizeGiotto(gobject = SS_seqfish, scalefactor = 6000, verbose = T) # add gene & cell statistics SS_seqfish <- addStatistics(gobject = SS_seqfish) # adjust expression matrix for technical or known variables SS_seqfish <- adjustGiottoMatrix(gobject = SS_seqfish, expression_values = c('normalized'),                                  covariate_columns = c('nr_feats', 'total_expr'),                                  return_gobject = TRUE,                                  update_slot = c('custom')) # visualize spatPlot(gobject = SS_seqfish)"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"dimension-reduction","dir":"Articles","previous_headings":"","what":"3. Dimension Reduction","title":"SeqFish+ Mouse Cortex Example","text":"","code":"## highly variable features (HVF) SS_seqfish <- calculateHVF(gobject = SS_seqfish) ## select genes based on highly variable features and gene statistics, both found in feature (gene) metadata gene_metadata = fDataDT(SS_seqfish) featgenes = gene_metadata[hvf == 'yes' & perc_cells > 4 & mean_expr_det > 0.5]$feat_ID ## run PCA on expression values (default) SS_seqfish <- runPCA(gobject = SS_seqfish, genes_to_use = featgenes, scale_unit = F, center = F) screePlot(SS_seqfish) plotPCA(gobject = SS_seqfish) SS_seqfish <- runUMAP(SS_seqfish, dimensions_to_use = 1:15, n_threads = 10) plotUMAP(gobject = SS_seqfish) SS_seqfish <- runtSNE(SS_seqfish, dimensions_to_use = 1:15) plotTSNE(gobject = SS_seqfish)"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"cluster","dir":"Articles","previous_headings":"","what":"4. Cluster","title":"SeqFish+ Mouse Cortex Example","text":"following step requires installation {ggdendro}.","code":"## sNN network (default) SS_seqfish <- createNearestNetwork(gobject = SS_seqfish,                                    dimensions_to_use = 1:15,                                    k = 15) ## Leiden clustering SS_seqfish <- doLeidenCluster(gobject = SS_seqfish,                               resolution = 0.4,                               n_iterations = 1000) plotUMAP(gobject = SS_seqfish,          cell_color = 'leiden_clus',          show_NN_network = T,          point_size = 2.5) ## Leiden subclustering for specified clusters SS_seqfish = doLeidenSubCluster(gobject = SS_seqfish,                                  cluster_column = 'leiden_clus',                                 resolution = 0.2, k_neighbors = 10,                                 pca_param = list(expression_values = 'normalized', scale_unit = F),                                 nn_param = list(dimensions_to_use = 1:5),                                 selected_clusters = c(5, 6, 7),                                 name = 'sub_leiden_clus_select') ## set colors for clusters subleiden_order = c( 1.1, 2.1, 3.1, 4.1, 5.1, 5.2,                       6.1, 6.2, 7.1,  7.2, 8.1, 9.1) subleiden_colors = GiottogetDistinctColors(length(subleiden_order))  names(subleiden_colors) = subleiden_order plotUMAP(gobject = SS_seqfish,          cell_color = 'sub_leiden_clus_select', cell_color_code = subleiden_colors,          show_NN_network = T, point_size = 2.5, show_center_label = F,           legend_text = 12, legend_symbol_size = 3) ## show cluster relationships showClusterHeatmap(gobject = SS_seqfish, cluster_column = 'sub_leiden_clus_select',                    row_names_gp = grid::gpar(fontsize = 9), column_names_gp = grid::gpar(fontsize = 9)) # install.packages('ggdendro') library(ggdendro) showClusterDendrogram(SS_seqfish, h = 0.5, rotate = T, cluster_column = 'sub_leiden_clus_select')"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"visualize-spatial-and-expression-space","dir":"Articles","previous_headings":"","what":"5. Visualize Spatial and Expression Space","title":"SeqFish+ Mouse Cortex Example","text":"","code":"# expression and spatial spatDimPlot(gobject = SS_seqfish, cell_color = 'sub_leiden_clus_select',              cell_color_code = subleiden_colors,             dim_point_size = 2, spat_point_size = 2) # selected groups and provide new colors groups_of_interest = c(6.1, 6.2, 7.1, 7.2) group_colors = c('red', 'green', 'blue', 'purple'); names(group_colors) = groups_of_interest spatDimPlot(gobject = SS_seqfish, cell_color = 'sub_leiden_clus_select',              dim_point_size = 2, spat_point_size = 2,             select_cell_groups = groups_of_interest, cell_color_code = group_colors)"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"cell-type-marker-gene-detection","dir":"Articles","previous_headings":"","what":"6. Cell Type Marker Gene Detection","title":"SeqFish+ Mouse Cortex Example","text":"","code":"## gini  gini_markers_subclusters = findMarkers_one_vs_all(gobject = SS_seqfish,                                                   method = 'gini',                                                   expression_values = 'normalized',                                                   cluster_column = 'sub_leiden_clus_select',                                                   min_feats = 20,                                                   min_expr_gini_score = 0.5,                                                   min_det_gini_score = 0.5) topgenes_gini = gini_markers_subclusters[, head(.SD, 2), by = 'cluster'] ## violin plot violinPlot(SS_seqfish, feats = unique(topgenes_gini$feats), cluster_column = 'sub_leiden_clus_select',            strip_text = 8, strip_position = 'right', cluster_custom_order = unique(topgenes_gini$cluster)) # cluster heatmap topgenes_gini2 = gini_markers_subclusters[, head(.SD, 6), by = 'cluster'] plotMetaDataHeatmap(SS_seqfish, selected_feats = unique(topgenes_gini2$feats),                      custom_feat_order = unique(topgenes_gini2$feats),                     custom_cluster_order = unique(topgenes_gini2$cluster),                     metadata_cols = c('sub_leiden_clus_select'), x_text_size = 10, y_text_size = 10)"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"cell-type-annotation","dir":"Articles","previous_headings":"","what":"7. Cell Type Annotation","title":"SeqFish+ Mouse Cortex Example","text":"","code":"## general cell types ## create vector with names clusters_cell_types_cortex = c('L6 eNeuron', 'L4 eNeuron', 'L2/3 eNeuron', 'L5 eNeuron',                                 'Lhx6 iNeuron', 'Adarb2 iNeuron',                                 'endothelial', 'mural',                                'OPC','Olig',                                'astrocytes', 'microglia') names(clusters_cell_types_cortex) = c(1.1, 2.1, 3.1, 4.1,                                       5.1, 5.2,                                       6.1, 6.2,                                        7.1, 7.2,                                       8.1, 9.1) SS_seqfish = annotateGiotto(gobject = SS_seqfish, annotation_vector = clusters_cell_types_cortex,                             cluster_column = 'sub_leiden_clus_select', name = 'cell_types') # cell type order and colors cell_type_order = c('L6 eNeuron', 'L5 eNeuron', 'L4 eNeuron', 'L2/3 eNeuron',                     'astrocytes', 'Olig', 'OPC','Adarb2 iNeuron', 'Lhx6 iNeuron',                     'endothelial', 'mural', 'microglia') cell_type_colors = subleiden_colors names(cell_type_colors) = clusters_cell_types_cortex[names(subleiden_colors)] cell_type_colors = cell_type_colors[cell_type_order] ## violin plot violinPlot(gobject = SS_seqfish, feats = unique(topgenes_gini$feats),            strip_text = 7, strip_position = 'right',             cluster_custom_order = cell_type_order,            cluster_column = 'cell_types', color_violin = 'cluster') # co-visualization spatDimPlot(gobject = SS_seqfish, cell_color = 'cell_types',             dim_point_size = 2, spat_point_size = 2, dim_show_cluster_center = F, dim_show_center_label = T) ## heatmap genes vs cells gini_markers_subclusters[, cell_types := clusters_cell_types_cortex[cluster] ] gini_markers_subclusters[, cell_types := factor(cell_types, cell_type_order)] data.table::setorder(gini_markers_subclusters, cell_types) plotHeatmap(gobject = SS_seqfish,             feats = gini_markers_subclusters[, head(.SD, 3), by = 'cell_types']$feats,              feat_order = 'custom',             feat_custom_order = unique(gini_markers_subclusters[, head(.SD, 3), by = 'cluster']$feats),             cluster_column = 'cell_types', cluster_order = 'custom',             cluster_custom_order = unique(gini_markers_subclusters[, head(.SD, 3), by = 'cell_types']$cell_types),              legend_nrows = 2) plotHeatmap(gobject = SS_seqfish,             cluster_color_code = cell_type_colors,             feats = gini_markers_subclusters[, head(.SD, 6), by = 'cell_types']$feats,             feat_order = 'custom',             feat_label_selection = gini_markers_subclusters[, head(.SD, 2), by = 'cluster']$feats,             feat_custom_order = unique(gini_markers_subclusters[, head(.SD, 6), by = 'cluster']$feats),             cluster_column = 'cell_types', cluster_order = 'custom',             cluster_custom_order = unique(gini_markers_subclusters[, head(.SD, 3), by = 'cell_types']$cell_types),              legend_nrows = 2)"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"spatial-grid","dir":"Articles","previous_headings":"","what":"8. Spatial Grid","title":"SeqFish+ Mouse Cortex Example","text":"","code":"SS_seqfish <- createSpatialGrid(gobject = SS_seqfish,                                 sdimx_stepsize = 500,                                 sdimy_stepsize = 500,                                 minimum_padding = 50) spatPlot(gobject = SS_seqfish, show_grid = T, point_size = 1.5)"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"spatial-network","dir":"Articles","previous_headings":"","what":"9. Spatial Network","title":"SeqFish+ Mouse Cortex Example","text":"","code":"## delaunay network: stats + creation plotStatDelaunayNetwork(gobject = SS_seqfish, maximum_distance = 400, save_plot = F) SS_seqfish = createSpatialNetwork(gobject = SS_seqfish, minimum_k = 2, maximum_distance_delaunay = 400) ## create spatial networks based on k and/or distance from centroid SS_seqfish <- createSpatialNetwork(gobject = SS_seqfish, method = 'kNN', k = 5, name = 'spatial_network') SS_seqfish <- createSpatialNetwork(gobject = SS_seqfish, method = 'kNN', k = 10, name = 'large_network') SS_seqfish <- createSpatialNetwork(gobject = SS_seqfish, method = 'kNN', k = 100,                                    maximum_distance_knn = 200, minimum_k = 2, name = 'distance_network') ## visualize different spatial networks on first field (~ layer 1) cell_metadata = pDataDT(SS_seqfish) field1_ids = cell_metadata[FOV == 0]$cell_ID subSS_seqfish = subsetGiotto(SS_seqfish, cell_ids = field1_ids) spatPlot(gobject = subSS_seqfish, show_network = T,          network_color = 'blue', spatial_network_name = 'Delaunay_network',          point_size = 2.5, cell_color = 'cell_types') spatPlot(gobject = subSS_seqfish, show_network = T,          network_color = 'blue', spatial_network_name = 'spatial_network',          point_size = 2.5, cell_color = 'cell_types') spatPlot(gobject = subSS_seqfish, show_network = T,          network_color = 'blue', spatial_network_name = 'large_network',          point_size = 2.5, cell_color = 'cell_types') spatPlot(gobject = subSS_seqfish, show_network = T,          network_color = 'blue', spatial_network_name = 'distance_network',          point_size = 2.5, cell_color = 'cell_types')"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"individual-spatial-genes","dir":"Articles","previous_headings":"10. Spatial Genes","what":"Individual spatial genes","title":"SeqFish+ Mouse Cortex Example","text":"","code":"## 3 new methods to identify spatial genes km_spatialfeats = binSpect(SS_seqfish) spatGenePlot(SS_seqfish, expression_values = 'scaled', genes = km_spatialfeats[1:4]$feats,              point_shape = 'border', point_border_stroke = 0.1,              show_network = F, network_color = 'lightgrey', point_size = 2.5,               cow_n_col = 2)"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"spatial-genes-co-expression-modules","dir":"Articles","previous_headings":"10. Spatial Genes","what":"Spatial Genes Co-Expression Modules","title":"SeqFish+ Mouse Cortex Example","text":"","code":"## spatial co-expression patterns ## ext_spatial_genes = km_spatialfeats[1:500]$feats ## 1. calculate gene spatial correlation and single-cell correlation  ## create spatial correlation object spat_cor_netw_DT = detectSpatialCorFeats(SS_seqfish,                                           method = 'network',                                          spatial_network_name = 'Delaunay_network',                                          subset_feats = ext_spatial_genes) ## 2. cluster correlated genes & visualize spat_cor_netw_DT = clusterSpatialCorFeats(spat_cor_netw_DT,                                            name = 'spat_netw_clus',                                            k = 8) heatmSpatialCorFeats(SS_seqfish, spatCorObject = spat_cor_netw_DT, use_clus_name = 'spat_netw_clus',                       heatmap_legend_param = list(title = NULL)) # 3. rank spatial correlated clusters and show genes for selected clusters netw_ranks = rankSpatialCorGroups(SS_seqfish,                                    spatCorObject = spat_cor_netw_DT,                                   use_clus_name = 'spat_netw_clus') top_netw_spat_cluster = showSpatialCorFeats(spat_cor_netw_DT,                                              use_clus_name = 'spat_netw_clus',                                             selected_clusters = 6,                                             show_top_feats = 1) # 4. create metagene enrichment score for clusters cluster_genes_DT = showSpatialCorFeats(spat_cor_netw_DT,                                         use_clus_name = 'spat_netw_clus',                                        show_top_feats = 1) cluster_genes = cluster_genes_DT$clus; names(cluster_genes) = cluster_genes_DT$feat_ID SS_seqfish = createMetafeats(SS_seqfish,                               feat_clusters = cluster_genes,                               name = 'cluster_metagene') spatCellPlot(SS_seqfish,              spat_enr_names = 'cluster_metagene',              cell_annotation_values = netw_ranks$clusters,              point_size = 1.5, cow_n_col = 3)"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"hmrf-spatial-domains","dir":"Articles","previous_headings":"","what":"11. HMRF Spatial Domains","title":"SeqFish+ Mouse Cortex Example","text":"","code":"hmrf_folder = paste0(my_working_dir,'/','11_HMRF/') if(!file.exists(hmrf_folder)) dir.create(hmrf_folder, recursive = T) my_spatial_genes = km_spatialfeats[1:100]$feats # do HMRF with different betas HMRF_spatial_genes = doHMRF(gobject = SS_seqfish,                              expression_values = 'scaled',                             spatial_genes = my_spatial_genes,                             spatial_network_name = 'Delaunay_network',                             k = 9,                             betas = c(28,2,3),                              output_folder = paste0(hmrf_folder, '/', 'Spatial_genes/SG_top100_k9_scaled')) ## view results of HMRF for(i in seq(28, 32, by = 2)) {   viewHMRFresults2D(gobject = SS_seqfish,                     HMRFoutput = HMRF_spatial_genes,                     k = 9, betas_to_view = i,                     point_size = 2) } ## add HMRF of interest to giotto object SS_seqfish = addHMRF(gobject = SS_seqfish,                      HMRFoutput = HMRF_spatial_genes,                      k = 9, betas_to_add = c(28),                      hmrf_name = 'HMRF_2') ## visualize spatPlot(gobject = SS_seqfish,           cell_color = 'HMRF_2_k9_b.28',           point_size = 3,           coord_fix_ratio = 1)"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"cell-neighborhood-cell-typecell-type-interactions","dir":"Articles","previous_headings":"","what":"12. Cell Neighborhood: Cell-Type/Cell-Type Interactions","title":"SeqFish+ Mouse Cortex Example","text":"","code":"cell_proximities = cellProximityEnrichment(gobject = SS_seqfish,                                            cluster_column = 'cell_types',                                            spatial_network_name = 'Delaunay_network',                                            adjust_method = 'fdr',                                            number_of_simulations = 2000) ## barplot cellProximityBarplot(gobject = SS_seqfish,                      CPscore = cell_proximities,                       min_orig_ints = 5, min_sim_ints = 5) ## heatmap cellProximityHeatmap(gobject = SS_seqfish,                       CPscore = cell_proximities,                       order_cell_types = T, scale = T,                      color_breaks = c(-1.5, 0, 1.5),                       color_names = c('blue', 'white', 'red')) ## network cellProximityNetwork(gobject = SS_seqfish,                       CPscore = cell_proximities, remove_self_edges = T,                      only_show_enrichment_edges = T) ## network with self-edges cellProximityNetwork(gobject = SS_seqfish, CPscore = cell_proximities,                      remove_self_edges = F, self_loop_strength = 0.3,                      only_show_enrichment_edges = F,                      rescale_edge_weights = T,                      node_size = 8,                      edge_weight_range_depletion = c(1, 2),                      edge_weight_range_enrichment = c(2,5)) ## visualization of specific cell types # Option 1 spec_interaction = \"astrocytes--Olig\" cellProximitySpatPlot2D(gobject = SS_seqfish,                         interaction_name = spec_interaction,                         show_network = T,                         cluster_column = 'cell_types',                         cell_color = 'cell_types',                         cell_color_code = c(astrocytes = 'lightblue', Olig = 'red'),                         point_size_select = 4, point_size_other = 2) # Option 2: create additional metadata SS_seqfish = addCellIntMetadata(SS_seqfish,                                  spatial_network = 'spatial_network',                                 cluster_column = 'cell_types',                                 cell_interaction = spec_interaction,                                 name = 'astro_olig_ints') spatPlot(SS_seqfish, cell_color = 'astro_olig_ints',          select_cell_groups =  c('other_astrocytes', 'other_Olig', 'select_astrocytes', 'select_Olig'),          legend_symbol_size = 3)"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"part-13--cell-neighborhood-interaction-changed-features","dir":"Articles","previous_headings":"","what":"Part 13. Cell Neighborhood: Interaction Changed Features","title":"SeqFish+ Mouse Cortex Example","text":"","code":"library(future) ## select top 25th highest expressing genes gene_metadata = fDataDT(SS_seqfish) plot(gene_metadata$nr_cells, gene_metadata$mean_expr) plot(gene_metadata$nr_cells, gene_metadata$mean_expr_det) quantile(gene_metadata$mean_expr_det) high_expressed_genes = gene_metadata[mean_expr_det > 3.5]$feat_ID ## identify genes that are associated with proximity to other cell types plan('multisession', workers = 6) ICFsForesHighGenes =  findInteractionChangedFeats(gobject = SS_seqfish,                               selected_feats = high_expressed_genes,                               spatial_network_name = 'Delaunay_network',                               cluster_column = 'cell_types',                               diff_test = 'permutation',                               adjust_method = 'fdr',                               nr_permutations = 2000,                                do_parallel = T) ## visualize all genes plotCellProximityFeats(SS_seqfish, icfObject = ICFscoresHighGenes,                         method = 'dotplot') ## filter genes ICFscoresFilt = filterICF(ICFscoresHighGenes) ## visualize subset of interaction changed genes (ICFs) ICF_genes = c('Jakmip1', 'Golgb1', 'Dact2', 'Ddx27', 'Abl1', 'Zswim8') ICF_genes_types = c('Lhx6 iNeuron', 'Lhx6 iNeuron', 'L4 eNeuron', 'L4 eNeuron', 'astrocytes', 'astrocytes') names(ICF_genes) = ICF_genes_types plotICF(gobject = SS_seqfish,         icfObject = ICFscoresHighGenes,         source_type = 'endothelial',         source_markers = c('Pltp', 'Cldn5', 'Apcdd1'),         ICF_feats = ICF_genes)"},{"path":"https://drieslab.github.io/Giotto/articles/seqfish_cortex.html","id":"cell-neighborhood-ligand-receptor-cell-cell-communication","dir":"Articles","previous_headings":"","what":"14. Cell Neighborhood: Ligand-Receptor Cell-Cell Communication","title":"SeqFish+ Mouse Cortex Example","text":"","code":"## LR expression ## LR activity changes LR_data = data.table::fread(system.file(\"extdata\", \"mouse_ligand_receptors.txt\", package = 'Giotto')) LR_data[, ligand_det := ifelse(LR_data$mouseLigand %in% SS_seqfish@feat_ID$rna, T, F)] LR_data[, receptor_det := ifelse(LR_data$mouseReceptor %in% SS_seqfish@feat_ID$rna, T, F)] LR_data_det = LR_data[ligand_det == T & receptor_det == T] select_ligands = LR_data_det$mouseLigand select_receptors = LR_data_det$mouseReceptor ## get statistical significance of gene pair expression changes based on expression expr_only_scores = exprCellCellcom(gobject = SS_seqfish,                                    cluster_column = 'cell_types',                                     random_iter = 1000,                                    feat_set_1 = select_ligands,                                    feat_set_2 = select_receptors,                                     verbose = FALSE) ## get statistical significance of gene pair expression changes upon cell-cell interaction spatial_all_scores = spatCellCellcom(SS_seqfish,                                      spatial_network_name = 'spatial_network',                                      cluster_column = 'cell_types',                                       random_iter = 1000,                                      feat_set_1 = select_ligands,                                      feat_set_2 = select_receptors,                                      adjust_method = 'fdr',                                      do_parallel = T,                                      cores = 4,                                      verbose = 'a little') ## select top LR ## selected_spat = spatial_all_scores[p.adj <= 0.01 & abs(log2fc) > 0.25 & lig_nr >= 4 & rec_nr >= 4] data.table::setorder(selected_spat, -PI) top_LR_ints = unique(selected_spat[order(-abs(PI))]$LR_comb)[1:33] top_LR_cell_ints = unique(selected_spat[order(-abs(PI))]$LR_cell_comb)[1:33] plotCCcomDotplot(gobject = SS_seqfish,                  comScores = spatial_all_scores,                  selected_LR = top_LR_ints,                  selected_cell_LR = top_LR_cell_ints,                  cluster_on = 'PI') ## spatial vs rank #### comb_comm = combCCcom(spatialCC = spatial_all_scores,                       exprCC = expr_only_scores) ## highest levels of ligand and receptor prediction ## top differential activity levels for ligand receptor pairs plotRankSpatvsExpr(gobject = SS_seqfish,                    comb_comm,                    expr_rnk_column = 'LR_expr_rnk',                    spat_rnk_column = 'LR_spat_rnk',                    midpoint = 10) ## recovery plotRecovery(gobject = SS_seqfish,              comb_comm,              expr_rnk_column = 'LR_expr_rnk',              spat_rnk_column = 'LR_spat_rnk',              ground_truth = 'spatial')"},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"Dataset explanation","title":"Seq-Scope Mouse liver","text":"Seqscope illumina sequencing based spatial sequencing platform developed Jun Hee Lee Lab. basic strategy use illumina sequencing synthesis generate spatial barcodes use barcodes capture mRNAs tissue.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"example-raw-data-needed-for-seqscope","dir":"Articles","previous_headings":"Dataset explanation","what":"Example Raw Data needed for seqscope:","title":"Seq-Scope Mouse liver","text":"1st-seq data (single-ended, generating spatial barcodes) SeqScope_1st.fastq.gz 2nd-seq data (pair-ended, generating count matrix) SeqScope_2nd_R1.fastq.gz SeqScope_2nd_R2.fastq.gz Image (seqmentation) Tile_No_Segmented.png","code":""},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"preprocessing-to-generate-count-matrix","dir":"Articles","previous_headings":"Dataset explanation","what":"Preprocessing to generate count matrix","title":"Seq-Scope Mouse liver","text":"Seqscope pipeline generate count matrix(Gene barcode). Please refer github page use customized methods proceed. now count matrix Giotto Object. Note Spatial Barcodes typically 0.6 um resolution. One way analyze use getSimpleGrid.R getSlidingGrid.R provided Lee Lab bin counts simply follow Giotto analysis steps Visium Integration Visium","code":"# Note you need to install seqtk, STARsolo and clone their github page first. All bash scripts are stored in script directory of their github.  ## First generate the whitelist of spatial barcodes: bash extractCoord.sh [SeqScope_1st.fastq.gz] [SeqScope_2nd_R1.fastq.gz] [HDMI_length] ## Second, generating the count matrix via STAR.Solo: bash align.sh [SeqScope_2nd_R1.fastq.gz] [abc_SeqScope_2nd_R2.fastq.gz] [HDMI_length] [whitelists.txt] [outprefix] [starpath] [seqtkpath] [geneIndex]"},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"Start Giotto","title":"Seq-Scope Mouse liver","text":"","code":"# Ensure Giotto Suite is installed. if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") }  library(Giotto) # Ensure the Python environment for Giotto has been installed. genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment.   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"set-up-giotto-environment","dir":"Articles","previous_headings":"","what":"Set up Giotto Environment","title":"Seq-Scope Mouse liver","text":"","code":"# 1. set working directory results_folder = 'path/to/result'  # 2. set giotto python path # set python path to your preferred python version path # set python path to conda env/bin/ directory if manually installed Giotto python dependencies by conda # python_path = '/path_to_conda/.conda/envs/giotto/bin/python' # set python path to NULL if you want to automatically install (only the 1st time) and use the giotto miniconda environment # python_path = NULL #if(is.null(python_path)) { #  installGiottoEnvironment() #}  # 3. create giotto instructions instrs = createGiottoInstructions(save_dir = results_folder,                                   save_plot = TRUE,                                   show_plot = FALSE)"},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"create-giotto-subcellular-object","dir":"Articles","previous_headings":"","what":"1. Create Giotto Subcellular Object","title":"Seq-Scope Mouse liver","text":"order single cell subcellular analysis Giotto, suggest using GiottoSubcellular Object. Giotto Subcellular objects take cell polygons Giotto Point file (data.table contains Gene Name, Expression, x, y, etc). Therefore, first need transformation count matrix. Giotto Point file formatting Unlike normal cell gene matrix, Giotto Point file usually data.table contains Gene Name, Expression, x, y, row represent subcellular point. Seqscope data, one HDMI typically one subcellular point. Example Giotto Point file Seqscope","code":""},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"process-giotto-point-file-per-tile","dir":"Articles","previous_headings":"1. Create Giotto Subcellular Object","what":"1.1 Process Giotto Point file per tile","title":"Seq-Scope Mouse liver","text":"","code":"##expression matrix countDir = \"/path/to/Solo.out/GeneFull/raw\" expr_matrix = Giotto::get10Xmatrix(path_to_data = countDir, gene_column_index = 2)  ##Spatial coordinates spatial_coords_Dir = \"/path/to/extractCoord.sh/results/spatialcoordinates.txt\" spatial_coords = fread(\"spatial_coords_Dir\") colnames(spatial_coords)<-c(\"HDMI\",\"Lane\",\"Tile\",\"X\",\"Y\")  ##Prepare Giotto Point # Subset expression and spatial info by tile spatial_coords_tile = spatial_coords[Tile == '2104'] expr_matrix_tile = expr_matrix[, as.character(colnames(expr_matrix)) %in% spatial_coords_tile$HDMI]  # convert expression matrix to minimal data.table object matrix_tile_dt = as.data.table(Matrix::summary(expr_matrix_tile)) genes = expr_matrix_tile@Dimnames[[1]] samples = expr_matrix_tile@Dimnames[[2]] matrix_tile_dt[, gene := genes[i]] matrix_tile_dt[, hdmi := samples[j]]  # merge data.table matrix and spatial coordinates to create input for Giotto Polygons gpoints = merge.data.table(matrix_tile_dt, spatial_coords_tile, by.x = 'hdmi', by.y = 'HDMI') gpoints = gpoints[,.(hdmi, X, Y, gene, x)] colnames(gpoints) = c('hdmi', 'x', 'y', 'gene', 'counts')"},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"prepare-the-polygon-mask-file","dir":"Articles","previous_headings":"1. Create Giotto Subcellular Object","what":"1.2 Prepare the polygon mask file","title":"Seq-Scope Mouse liver","text":"Giotto can read variety different mask files provided common segmentation tools. first need check need filp x y axis.  Read polygon mask file  Polygon mask file manual formatting However, sometimes Giotto read provided mask file need manual processing mask file using terra createGiottoPolygonsFromDfr.","code":"# check total counts per hdmi gpoints_aggr = gpoints[, sum(counts), by = .(hdmi, x, y)] colnames(gpoints_aggr) = c(\"hdmi\",\"x\",\"y\",\"total_counts\") setorder(gpoints_aggr, -total_counts)  pl = ggplot() pl = pl + geom_point(data = gpoints_aggr[total_counts < 1000 & total_counts > 8], aes(x = x, y = y, color = total_counts), size = 0.05) pl = pl + scale_color_gradient2(midpoint = 15, low = 'blue', mid = 'yellow', high = 'red') pl segmentation_mask = \"/path/to/segmentation.tif\" final_polygons = createGiottoPolygonsFromMask(segmentation_mask,                                flip_vertical = FALSE,                                 flip_horizontal = FALSE) plot(final_polygons) raster = terra::rast(x = segmentation_mask) terra_polygon = terra::as.polygons(x = raster, value = T)  # convert polygon to data.table and remove unwantedly detected polygons (e.g. canvas etc) dt = GiottospatVector_to_dt(terra_polygon) npolygons = length(levels(factor(dt$part))) - 1 filter_dt = dt[geom == 1 & hole == 0 & part %in% c(0:npolygons), .(x,y,part)] filter_dt[, part := as.factor(part)]  # create new polygons from filtered data.table final_polygons = createGiottoPolygonsFromDfr(segmdfr = filter_dt)  # create giotto points first to get the extent of the points (hdmi) original_points = createGiottoPoints(x = gpoints[,.(x, y, gene, hdmi, counts)]) original_feat_ext = ext(original_points@spatVector)    # convert polygon to spatRaster to change extent to that of original points final_spatraster = Giottopolygon_to_raster(polygon = final_polygons@spatVector) ext(final_spatraster$raster) = original_feat_ext final_polygons@spatVector = as.polygons(final_spatraster$raster) final_polygons@spatVector$poly_ID = final_spatraster$ID_vector[final_polygons@spatVector$poly_i]  # flip and shift, if needed #final_polygons@spatVector = flip(final_polygons@spatVector) #yshift = ymin(original_feat_ext) - ymax(original_feat_ext) #final_polygons@spatVector = terra::shift(final_polygons@spatVector, dy = -yshift)  plot(final_polygons)"},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"create-giotto-object","dir":"Articles","previous_headings":"1. Create Giotto Subcellular Object","what":"1.3 Create Giotto Object","title":"Seq-Scope Mouse liver","text":"Add random jitter HDMI location make pseudo-situ transcript file.","code":"# add giotto points class gpoints_subset = gpoints[hdmi %in% gpoints_aggr[total_counts > 5]$hdmi]  # multiply rows with multiple counts and add jitter gpoints_extra = gpoints_subset[counts > 1] gpoints_extra = gpoints_extra[,rep(counts, counts), by = .(hdmi, gene, x, y)] gpoints_extra = rbind(gpoints_extra[,.(hdmi, gene, x, y)], gpoints_subset[counts == 1 ,.(hdmi, gene, x, y)]) jitter_x = sample(1:3, size = nrow(gpoints_extra), replace = T) jitter_y = sample(1:3, size = nrow(gpoints_extra), replace = T) gpoints_extra[, x := x + jitter_x] gpoints_extra[, y := y + jitter_y] # add subcellular information seqscope = createGiottoObjectSubcellular(gpoints = list(gpoints_extra[,.(x, y, gene, hdmi)]),                                          gpolygons = list(final_polygons),                                          instructions = instrs)  # add centroids seqscope = addSpatialCentroidLocations(seqscope,                                        poly_info = 'cell')  #Overlap to Polygon information seqscope = calculateOverlapRaster(seqscope) seqscope = overlapToMatrix(seqscope)  # Visualize top 200 expressed genes in situ spatInSituPlotPoints(seqscope, show_legend = F,                      show_image = FALSE,                      feats = list('rna' = seqscope@feat_info$rna@spatVector$feat_ID[1:200]),                      spat_unit = 'cell',                      point_size = 1,                      show_polygon = TRUE,                      use_overlap = F,                      polygon_feat_type = 'cell',                      polygon_color = 'red',                      polygon_bg_color = 'white',                      polygon_line_size = 0.2,                      coord_fix_ratio = TRUE,                      background_color = 'white')"},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"process-giotto-and-quality-control","dir":"Articles","previous_headings":"","what":"2. Process Giotto and Quality Control","title":"Seq-Scope Mouse liver","text":"","code":"# filter seqscope <- filterGiotto(gobject = seqscope,                          expression_threshold = 1,                          feat_det_in_min_cells = 5,                          min_det_feats_per_cell = 5)  #normalize seqscope <- normalizeGiotto(gobject = seqscope, scalefactor = 5000, verbose = T) # add statistics seqscope <- addStatistics(gobject = seqscope)  # View cellular data # pDataDT(seqscope) # View rna data # fDataDT(seqscope)   spatPlot2D(gobject = seqscope,            cell_color = 'total_expr', color_as_factor = F,            show_image = F,            point_size = 2.5, point_alpha = 0.75, coord_fix_ratio = T) cellmeta = pDataDT(seqscope, feat_type = 'rna') hist(cellmeta$nr_feats, 100)"},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"dimention-reduction","dir":"Articles","previous_headings":"","what":"3. Dimention Reduction","title":"Seq-Scope Mouse liver","text":"","code":"# cluster cells seqscope <- calculateHVF(gobject = seqscope, HVFname = 'hvg_orig')  seqscope <- runPCA(gobject = seqscope,                    expression_values = 'normalized',                    scale_unit = T, center = T)  seqscope <- runUMAP(seqscope, dimensions_to_use = 1:100)"},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"cluster","dir":"Articles","previous_headings":"","what":"4. Cluster","title":"Seq-Scope Mouse liver","text":"","code":"seqscope <- createNearestNetwork(gobject = seqscope, dimensions_to_use = 1:100, k = 5) seqscope <- doLeidenCluster(gobject = seqscope, resolution = 0.9, n_iterations = 1000)  # visualize UMAP cluster results   plotUMAP(gobject = seqscope, cell_color = 'leiden_clus',          show_NN_network = F, point_size = 3.5) spatInSituPlotPoints(seqscope,                      show_polygon = TRUE,                      polygon_color = 'white',                      polygon_line_size = 0.1,                      polygon_fill = 'leiden_clus',                      polygon_fill_as_factor = T,                      coord_fix_ratio = T)"},{"path":"https://drieslab.github.io/Giotto/articles/seqscope_mouse_liver.html","id":"find-spatial-genes","dir":"Articles","previous_headings":"","what":"5. Find spatial genes","title":"Seq-Scope Mouse liver","text":"","code":"seqscope<-createSpatialNetwork(gobject = seqscope, minimum_k = 2, maximum_distance_delaunay = 100)  km_spatialgenes = binSpect(seqscope, subset_feats = seqscope@feat_ID$rna) spatFeatPlot2D(seqscope, expression_values = 'scaled',                feats = km_spatialgenes$feats[1:2],                cell_color_gradient = c('blue', 'white', 'red'),                point_shape = 'border', point_border_stroke = 0.01,                show_network = T, network_color = 'lightgrey', point_size = 1.2,                cow_n_col = 1)"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_integration.html","id":"set-up-giotto-environment","dir":"Articles","previous_headings":"","what":"Set up Giotto Environment","title":"Integration of single cell datasets","text":"","code":"library(Giotto) library(GiottoData)  # 1. set working directory results_folder = 'path/to/result'  # Optional: Specify a path to a Python executable within a conda or miniconda  # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired.  # 2. create giotto instructions instrs = createGiottoInstructions(save_dir = results_folder,                                   save_plot = TRUE,                                   show_plot = FALSE,                                   python_path = my_python_path)"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_integration.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"Dataset explanation","title":"Integration of single cell datasets","text":"tutorial Harmony integration different single cell RNAseq datasets using two prostate cancer patient datasets. Ma et al. Processed 10X Single Cell RNAseq two prostate cancer patients. raw dataset can found ","code":""},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_integration.html","id":"part-1-create-giotto-object-from-10x-dataset-and-join","dir":"Articles","previous_headings":"","what":"Part 1: Create Giotto object from 10X dataset and join","title":"Integration of single cell datasets","text":"","code":"giotto_P1<-createGiottoObject(expression = get10Xmatrix(\"path/to/P1_result/outs/filtered_feature_bc_matrix\",      gene_column_index = 2,     remove_zero_rows = TRUE),     instructions = instrs)   giotto_P2<-createGiottoObject(expression = get10Xmatrix(\"path/to/P2_result/outs/filtered_feature_bc_matrix\",      gene_column_index = 2,     remove_zero_rows = TRUE),     instructions = instrs)   giotto_SC_join = joinGiottoObjects(gobject_list = list(giotto_P1, giotto_P2),                                    gobject_names = c('P1', 'P2'),                                    join_method = \"z_stack\")"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_integration.html","id":"part-2-process-joined-object","dir":"Articles","previous_headings":"","what":"Part 2: Process Joined object","title":"Integration of single cell datasets","text":"","code":"giotto_SC_join <- filterGiotto(gobject = giotto_SC_join,                                expression_threshold = 1,                                feat_det_in_min_cells = 50,                                min_det_feats_per_cell = 500,                                expression_values = c('raw'),                                verbose = T)  ## normalize giotto_SC_join <- normalizeGiotto(gobject = giotto_SC_join,                                   scalefactor = 6000)  ## add gene & cell statistics giotto_SC_join <- addStatistics(gobject = giotto_SC_join,                                 expression_values = 'raw')"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_integration.html","id":"part-3-dimension-reduction-and-clustering","dir":"Articles","previous_headings":"","what":"Part 3: Dimension reduction and clustering","title":"Integration of single cell datasets","text":"Harmony integration algorithm developed Korsunsky, . et al.. designed integration single cell data also work well spatial datasets.","code":"## PCA ## giotto_SC_join <- calculateHVF(gobject = giotto_SC_join) giotto_SC_join <- runPCA(gobject = giotto_SC_join,                          center = TRUE,                          scale_unit = TRUE) # Check screeplot to select number of PCs for clustering # screePlot(giotto_SC_join, ncp = 30, save_param = list(save_name = '3_scree_plot'))  ## WITHOUT INTEGRATION ## # --------------------- #  ## cluster and run UMAP ## # sNN network (default) showGiottoDimRed(giotto_SC_join) giotto_SC_join <- createNearestNetwork(gobject = giotto_SC_join,                                        dim_reduction_to_use = 'pca',                                        dim_reduction_name = 'pca',                                        dimensions_to_use = 1:10,                                        k = 15)  # Leiden clustering giotto_SC_join <- doLeidenCluster(gobject = giotto_SC_join,                                   resolution = 0.2,                                   n_iterations = 1000)  # UMAP giotto_SC_join = runUMAP(giotto_SC_join)  plotUMAP(gobject = giotto_SC_join,          cell_color = 'leiden_clus',          show_NN_network = T,          point_size = 1.5,          save_param = list(save_name = \"4_cluster_without_integration\")) dimPlot2D(gobject = giotto_SC_join,           dim_reduction_name = 'umap',           point_shape = 'no_border',           cell_color = \"leiden_clus\",           group_by = \"list_ID\",           show_NN_network = F,           point_size = 0.5,            show_center_label = F,           show_legend =F,           save_param = list(save_name = \"4_list_without_integration\")) ## WITH INTEGRATION ## # --------------------- #  ## data integration, cluster and run UMAP ##  # harmony #library(devtools) #install_github(\"immunogenomics/harmony\") library(harmony)  #pDataDT(giotto_SC_join) giotto_SC_join = runGiottoHarmony(giotto_SC_join,                                   vars_use = 'list_ID',                                   do_pca = F)   ## sNN network (default) #showGiottoDimRed(giotto_SC_join) giotto_SC_join <- createNearestNetwork(gobject = giotto_SC_join,                                        dim_reduction_to_use = 'harmony',                                        dim_reduction_name = 'harmony',                                        name = 'NN.harmony',                                        dimensions_to_use = 1:10,                                        k = 15)  ## Leiden clustering giotto_SC_join <- doLeidenCluster(gobject = giotto_SC_join,                                   network_name = 'NN.harmony',                                   resolution = 0.2,                                   n_iterations = 1000,                                   name = 'leiden_harmony')  # UMAP dimension reduction #showGiottoDimRed(giotto_SC_join) giotto_SC_join = runUMAP(giotto_SC_join,                          dim_reduction_name = 'harmony',                          dim_reduction_to_use = 'harmony',                          name = 'umap_harmony')  plotUMAP(gobject = giotto_SC_join,          dim_reduction_name = 'umap_harmony',          cell_color = 'leiden_harmony',          show_NN_network = T,          point_size = 1.5,          save_param = list(save_name = \"4_cluster_with_integration\")) dimPlot2D(gobject = giotto_SC_join,           dim_reduction_name = 'umap_harmony',           point_shape = 'no_border',           cell_color = \"leiden_harmony\",           group_by = \"list_ID\",           show_NN_network = F,           point_size = 0.5,            show_center_label = F,           show_legend =F ,           save_param = list(save_name = \"4_list_with_integration\"))"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_standard.html","id":"set-up-giotto-environment","dir":"Articles","previous_headings":"","what":"Set up Giotto Environment","title":"10X Single Cell RNA Sequencing","text":"","code":"library(Giotto) library(GiottoData)  # 1. set working directory results_folder = 'path/to/result'  # Optional: Specify a path to a Python executable within a conda or miniconda  # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired.  # 3. create giotto instructions instrs = createGiottoInstructions(save_dir = results_folder,                                   save_plot = TRUE,                                   show_plot = FALSE,                                   python_path = my_python_path)"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_standard.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"Dataset Explanation","title":"10X Single Cell RNA Sequencing","text":"Ma et al. Processed 10X Single Cell RNAseq two prostate cancer patients. raw dataset can found ","code":""},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_standard.html","id":"part-1-create-giotto-object-from-10x-dataset","dir":"Articles","previous_headings":"","what":"Part 1: Create Giotto object from 10X dataset","title":"10X Single Cell RNA Sequencing","text":"Note need input directory barcodes.tsv(.gz) features.tsv(.gz) matrix.mtx(.gz)","code":"giotto_SC <- createGiottoObject(expression = get10Xmatrix(\"/path/to/filtered_feature_bc_matrix\",                                                            gene_column_index = 2,                                                            remove_zero_rows = TRUE),                                 instructions = instrs)"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_standard.html","id":"part-2-process-giotto-object","dir":"Articles","previous_headings":"","what":"Part 2: Process Giotto Object","title":"10X Single Cell RNA Sequencing","text":"","code":"giotto_SC <- filterGiotto(gobject = giotto_SC,                           expression_threshold = 1,                           feat_det_in_min_cells = 50,                           min_det_feats_per_cell = 500,                           expression_values = c('raw'),                           verbose = T)  ## normalize giotto_SC <- normalizeGiotto(gobject = giotto_SC, scalefactor = 6000)  ## add mitochondria gene percentage and filter giotto object by percent mito library(rtracklayer) gtf <- import(\"Homo_sapiens.GRCh38.105.gtf.gz\") gtf <- gtf[gtf$gene_name!=\"\" & !is.na(gtf$gene_name)] mito <- gtf$gene_name[as.character(seqnames(gtf)) %in% \"MT\"] mito <- unique(mito)  giotto_SC <- addFeatsPerc(giotto_SC,                           feats = mito,                           vector_name = 'perc_mito')  giotto_SC <- subsetGiotto(giotto_SC,                           cell_ids = pDataDT(giotto_SC)[which(pDataDT(giotto_SC)$perc_mito < 15),]$cell_ID)   ## add gene & cell statistics giotto_SC <- addStatistics(gobject = giotto_SC, expression_values = 'raw')"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_standard.html","id":"part-3-dimention-reduction","dir":"Articles","previous_headings":"","what":"Part 3: Dimention Reduction","title":"10X Single Cell RNA Sequencing","text":"","code":"## PCA ## giotto_SC <- calculateHVF(gobject = giotto_SC) giotto_SC <- runPCA(gobject = giotto_SC, center = TRUE, scale_unit = TRUE) screePlot(giotto_SC, ncp = 30, save_param = list(save_name = '3_scree_plot'))"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_standard.html","id":"part-4-cluster","dir":"Articles","previous_headings":"","what":"Part 4: Cluster","title":"10X Single Cell RNA Sequencing","text":"","code":"## cluster and run UMAP ## # sNN network (default) showGiottoDimRed(giotto_SC) giotto_SC <- createNearestNetwork(gobject = giotto_SC,                                   dim_reduction_to_use = 'pca', dim_reduction_name = 'pca',                                   dimensions_to_use = 1:10, k = 15)  # UMAP giotto_SC = runUMAP(giotto_SC, dimensions_to_use = 1:10)  # Leiden clustering giotto_SC <- doLeidenCluster(gobject = giotto_SC, resolution = 0.2, n_iterations = 1000)   plotUMAP(gobject = giotto_SC,          cell_color = 'leiden_clus', show_NN_network = T, point_size = 1.5,          save_param = list(save_name = \"4_Cluster\"))"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_standard.html","id":"part-5-differential-expression","dir":"Articles","previous_headings":"","what":"Part 5: Differential Expression","title":"10X Single Cell RNA Sequencing","text":"","code":"markers_scran = findMarkers_one_vs_all(gobject=giotto_SC, method=\"scran\",                                        expression_values=\"normalized\", cluster_column='leiden_clus', min_feats=3) markergenes_scran = unique(markers_scran[, head(.SD, 3), by=\"cluster\"][[\"feats\"]])  plotMetaDataHeatmap(giotto_SC, expression_values = \"normalized\", metadata_cols = 'leiden_clus',                      selected_feats = markergenes_scran,                     y_text_size = 8, show_values = 'zscores_rescaled',                     save_param = list(save_name = '5_a_metaheatmap')) topgenes_scran = markers_scran[, head(.SD, 1), by = 'cluster']$feats # violinplot violinPlot(giotto_SC, feats = unique(topgenes_scran), cluster_column = 'leiden_clus',            strip_text = 10, strip_position = 'right',            save_param = list(save_name = '5_b_violinplot_scran', base_width = 5))"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_standard.html","id":"part-6-featureplot","dir":"Articles","previous_headings":"","what":"Part 6: FeaturePlot","title":"10X Single Cell RNA Sequencing","text":"","code":"# Plot known marker genes across different cell types. EPCAM for epithelial cells,  # DPP4(CD26) for Epithelial luminal cells, PECAM1(CD31) for Endothelial cells and CD3D for T cells dimFeatPlot2D(giotto_SC, feats = c(\"EPCAM\",\"DPP4\",\"PECAM1\",\"CD3D\"), cow_n_col = 2, save_param = list(save_name = \"6_featureplot\"))"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_standard.html","id":"part-7-cell-type-annotation","dir":"Articles","previous_headings":"","what":"Part 7: Cell type Annotation","title":"10X Single Cell RNA Sequencing","text":"","code":"prostate_labels<-c(\"Endothelial cells\",#1                    \"T cells\",#2                    \"Epithelial_basal\",#3                    \"Epithelial_luminal\",#4                    \"Fibroblasts\",#5                    \"T cells\",#6                    \"Epithelial_luminal\",#7                    \"Smooth muscle cells\",#8                    \"Macrophage & B cells\",#9                    \"Fibroblasts\",#10                    \"Mast cells\",#11                    \"Mesenchymal cells\",#12                    \"Neural Progenitor cells\")#13 names(prostate_labels)<-1:13 giotto_SC<-annotateGiotto(gobject = giotto_SC, annotation_vector = prostate_labels ,                           cluster_column = 'leiden_clus', name = 'prostate_labels') dimPlot2D(gobject = giotto_SC,     dim_reduction_name = 'umap',           cell_color = \"prostate_labels\", show_NN_network = T, point_size = 1.5,           save_param = list(save_name = \"7_Annotation\"))"},{"path":"https://drieslab.github.io/Giotto/articles/singlecell_prostate_standard.html","id":"part-8-subset-and-recluster","dir":"Articles","previous_headings":"","what":"Part 8: Subset and Recluster","title":"10X Single Cell RNA Sequencing","text":"","code":"Subset_giotto_T<-subsetGiotto(giotto_SC,                               cell_ids = pDataDT(giotto_SC)[which(pDataDT(giotto_SC)$prostate_labels == \"T cells\"),]$cell_ID) ## PCA  Subset_giotto_T <- calculateHVF(gobject = Subset_giotto_T) Subset_giotto_T <- runPCA(gobject = Subset_giotto_T, center = TRUE, scale_unit = TRUE) screePlot(Subset_giotto_T, ncp = 20, save_param = list(save_name = '8a_scree_plot')) Subset_giotto_T <- createNearestNetwork(gobject = Subset_giotto_T,                                         dim_reduction_to_use = 'pca', dim_reduction_name = 'pca',                                         dimensions_to_use = 1:20, k = 10)  # UMAP Subset_giotto_T = runUMAP(Subset_giotto_T, dimensions_to_use = 1:8)  # Leiden clustering Subset_giotto_T <- doLeidenCluster(gobject = Subset_giotto_T, resolution = 0.1, n_iterations = 1000)   plotUMAP(gobject = Subset_giotto_T,          cell_color = 'leiden_clus', show_NN_network = T, point_size = 1.5,          save_param = list(save_name = \"8b_Cluster\")) markers_scran_T = findMarkers_one_vs_all(gobject=Subset_giotto_T, method=\"scran\",                                          expression_values=\"normalized\", cluster_column='leiden_clus', min_feats=3) markergenes_scran_T = unique(markers_scran_T[, head(.SD, 5), by=\"cluster\"][[\"feats\"]])  plotMetaDataHeatmap(Subset_giotto_T, expression_values = \"normalized\", metadata_cols = 'leiden_clus',                      selected_feats = markergenes_scran_T,                     y_text_size = 8, show_values = 'zscores_rescaled',                     save_param = list(save_name = '8_c_metaheatmap')) T_labels<-c(\"Naive T cells\",#1             \"Tfh cells\",#2             \"CD8 T cells\",#3             \"NK T cells\",#4             \"CD4 T cells\")#5 names(T_labels)<-1:5 Subset_giotto_T<-annotateGiotto(gobject = Subset_giotto_T, annotation_vector = T_labels ,                                 cluster_column = 'leiden_clus', name = 'subset_labels') dimPlot2D(gobject = Subset_giotto_T,     dim_reduction_name = 'umap',           cell_color = \"subset_labels\", show_NN_network = T, point_size = 1.5,           save_param = list(save_name = \"8d_Annotation\"))"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"1. Dataset explanation","title":"Spatial Genomics Mouse Kidney","text":"tutorial covers Giotto object creation simple exploratory analysis gene expression data generated Spatial Genomics’ GenePS instrument kidney tissue resected 2-month-old female mouse. data generated using sequential fluorescence situ hybridization (seqFISH) visualize 220 genes directly sample.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"2. Start Giotto","title":"Spatial Genomics Mouse Kidney","text":"","code":"# Ensure Giotto Suite is installed if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") } library(Giotto)  # Ensure Giotto Data is installed if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") } library(GiottoData)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"project-data-paths","dir":"Articles","previous_headings":"","what":"3. Project Data Paths","title":"Spatial Genomics Mouse Kidney","text":"","code":"# Set path to folder containing spatial genomics data datadir = '/path/to/Spatial/Genomics/data/'  dapi = paste0(datadir, 'SG_MouseKidneyDataRelease_DAPI_section1.ome.tiff') mask = paste0(datadir, 'SG_MouseKidneyDataRelease_CellMask_section1.tiff') tx = paste0(datadir, 'SG_MouseKidneyDataRelease_TranscriptCoordinates_section1.csv')"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"create-a-giotto-object","dir":"Articles","previous_headings":"","what":"4. Create a Giotto object","title":"Spatial Genomics Mouse Kidney","text":"","code":"# Create and plot giotto polygons gpoly = createGiottoPolygonsFromMask(mask, shift_vertical_step = F,                                       shift_horizontal_step = F,                                       flip_horizontal = F,                                       flip_vertical = F) plot(gpoly)  # Create and plot giotto points tx = data.table::fread(tx) gpoints = createGiottoPoints(tx) plot(gpoints, raster_size = 1e3)  # Create giottoLargeImage and giottoObject gimg = createGiottoLargeImage(dapi, use_rast_ext = TRUE)  sg = createGiottoObjectSubcellular(gpoints = list('rna' = gpoints),                                    gpolygons = list('cell' = gpoly)) sg = addGiottoLargeImage(sg, largeImages = list(image = gimg))"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"aggregate-normalize-and-filter-giotto-data","dir":"Articles","previous_headings":"","what":"5. Aggregate, Normalize, and Filter Giotto Data","title":"Spatial Genomics Mouse Kidney","text":"","code":"# Aggregate sg = calculateOverlapRaster(sg,                             spatial_info = 'cell',                             feat_info = 'rna') sg = overlapToMatrix(sg) sg = addSpatialCentroidLocations(sg) # Filter and Normalize  filterDistributions(sg, detection = 'feats') filterDistributions(sg, detection = 'cells') sg = filterGiotto(sg, feat_det_in_min_cells = 100, min_det_feats_per_cell = 20, expression_threshold = 1) sg = normalizeGiotto(sg) # Statistics sg = addStatistics(sg)"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"highly-variable-features","dir":"Articles","previous_headings":"6. Dimension Reduction","what":"6.1 Highly Variable Features","title":"Spatial Genomics Mouse Kidney","text":"","code":"# Calculate highly variable features sg = calculateHVF(gobject = sg) cat(fDataDT(sg)[, sum(hvf == 'yes')], 'hvf found') # Only 18 hvf found -> better to use ALL genes -> feats_to_use = NULL sg = runPCA(gobject = sg,             spat_unit = 'cell',             expression_values = 'scaled',             feats_to_use = NULL,             scale_unit = F,             center = F)"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"pca","dir":"Articles","previous_headings":"6. Dimension Reduction","what":"6.2 PCA","title":"Spatial Genomics Mouse Kidney","text":"","code":"# Visualize Screeplot and PCA screePlot(sg,           ncp = 20,           save_param = list(             save_name = 'sg_screePlot')) plotPCA(sg,         spat_unit = 'cell',         dim_reduction_name = 'pca',         dim1_to_use = 1,         dim2_to_use = 2)"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"tsne-and-umap","dir":"Articles","previous_headings":"6. Dimension Reduction","what":"6.3 tSNE and UMAP","title":"Spatial Genomics Mouse Kidney","text":"","code":"# Run and Plot tSNE and UMAP sg = runtSNE(sg,              dimensions_to_use = 1:10,              spat_unit = 'cell',              check_duplicates = FALSE) sg = runUMAP(sg,              dimensions_to_use = 1:10,              spat_unit = 'cell') plotTSNE(sg,          point_size = 0.01,          save_param = list(           save_name = 'sg_tSNE')) plotUMAP(sg,          point_size = 0.01,          save_param = list(            save_name = 'sg_UMAP'))"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"umap-leiden-clustering","dir":"Articles","previous_headings":"7. Clustering","what":"7.1 UMAP Leiden Clustering","title":"Spatial Genomics Mouse Kidney","text":"","code":"# Clustering and UMAP cluster visualization sg = createNearestNetwork(sg,                           dimensions_to_use = 1:10,                           k = 10,                           spat_unit = 'cell') sg = doLeidenCluster(sg,                      resolution = 0.25,                      n_iterations = 100,                      spat_unit = 'cell') # Plot Leiden clusters onto UMAP plotUMAP(gobject = sg,          spat_unit = 'cell',          cell_color = 'leiden_clus',          show_legend = FALSE,          point_size = 0.01,          point_shape = 'no_border',          save_param = list(save_name = 'sg_umap_leiden'))"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"spatial-leiden-clustering","dir":"Articles","previous_headings":"7. Clustering","what":"7.2 Spatial Leiden Clustering","title":"Spatial Genomics Mouse Kidney","text":"","code":"# Plot Leiden clusters onto spatial image plot my_spatPlot <- spatPlot2D(gobject = sg,                           spat_unit = 'cell',                           cell_color = 'leiden_clus',                           point_size = 0.4,                           point_shape = 'no_border',                           show_legend = TRUE,                           image_name = gimg,                           save_param = list(                             save_name = 'sg_spat_leiden',                             base_width = 15,                             base_height = 15))"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"cell-type-marker-gene-detection","dir":"Articles","previous_headings":"","what":"8. Cell Type Marker Gene Detection","title":"Spatial Genomics Mouse Kidney","text":"","code":"# Identify gene markers per cluster markers = findMarkers_one_vs_all(gobject = sg,                                  method = 'gini',                                  expression_values = 'normalized',                                  cluster_column = 'leiden_clus',                                  min_feats = 1, rank_score = 2) # Display details about the marker genes markers[, head(.SD, 2), by = 'cluster'] # Violinplots to show marker expression topgini_genes = unique(markers[, head(.SD, 2), by = 'cluster']) violinPlot(sg, feats = topgini_genes$feats[1:10], cluster_column = 'leiden_clus') violinPlot(sg, feats = topgini_genes$feats[11:20], cluster_column = 'leiden_clus') # Known markers to Annotate Giotto selected_genes = c('My12', 'G6pc', 'Ppp1r1a', 'Grik5', 'Hsd11b2', 'Rhbg', 'Mapk11',                    'Egf17', 'Gpr55', 'Acsm2', 'Tpm2', 'D1c1', 'Shisa3',                    'Tspan2', 'Sox17', 'Eef2', 'Cd79b', 'Ctss', 'Serpina1f', 'Cyp51')  gobject_cell_metadata = pDataDT(sg) cluster_order = unique(gobject_cell_metadata$leiden_clus) # Plot markers to clusters heatmap plotMetaDataHeatmap(sg, expression_values = 'scaled',                     metadata_cols = c('leiden_clus'),                     selected_feats = selected_genes,                     custom_feat_order = rev(selected_genes),                     custom_cluster_order = cluster_order)"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"establish-delaunay-network","dir":"Articles","previous_headings":"9. Spatial Gene Expression Patterns","what":"9.1 Establish Delaunay Network","title":"Spatial Genomics Mouse Kidney","text":"","code":"plotStatDelaunayNetwork(gobject = sg, maximum_distance = 250) sg = createSpatialNetwork(gobject = sg, minimum_k = 2,                           maximum_distance_delaunay = 250) sg = createSpatialNetwork(gobject = sg, minimum_k = 2,                           method = 'kNN', k = 10)"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"binspect-by-k-means","dir":"Articles","previous_headings":"9. Spatial Gene Expression Patterns","what":"9.2 Binspect by K-Means","title":"Spatial Genomics Mouse Kidney","text":"","code":"km_spatialgenes = binSpect(sg) spatFeatPlot2D(sg, expression_values = 'scaled',                feats = km_spatialgenes[1:4]$feats,                point_shape = 'no_border',                 show_network = F, network_color = 'lightgrey', point_size = 0.5,                cow_n_col = 2)"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"binspect-by-rank","dir":"Articles","previous_headings":"9. Spatial Gene Expression Patterns","what":"9.3 Binspect by Rank","title":"Spatial Genomics Mouse Kidney","text":"","code":"rank_spatialgenes = binSpect(sg, bin_method = 'rank') spatFeatPlot2D(sg, expression_values = 'scaled',                feats = rank_spatialgenes[1:4]$feats,                point_shape = 'no_border',                 show_network = F, network_color = 'lightgrey', point_size = 0.5,                cow_n_col = 2)"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"spatial-co-expression-patterns","dir":"Articles","previous_headings":"","what":"10. Spatial Co-Expression Patterns","title":"Spatial Genomics Mouse Kidney","text":"","code":"# Spatial Co-Expression spatial_genes = km_spatialgenes[1:500]$feats  # 1. create spatial correlation object spat_cor_obj = detectSpatialCorFeats(sg,                                      method = 'network',                                      spatial_network_name = 'Delaunay_network',                                      subset_feats = spatial_genes)  # 2. identify most similar spatially correlated genes for one gene Acsm2_top10_genes = showSpatialCorFeats(spat_cor_obj, feats = 'Acsm2', show_top_feats = 10)  spatFeatPlot2D(sg, expression_values = 'scaled',                feats = Acsm2_top10_genes$variable[1:4], point_size = 0.5,                point_shape = 'no_border') # 3. cluster correlated genes & visualize spat_cor_obj = clusterSpatialCorFeats(spat_cor_obj, name = 'spat_netw_clus', k = 10)  heatmSpatialCorFeats(sg, spatCorObject = spat_cor_obj, use_clus_name = 'spat_netw_clus',                      heatmap_legend_param = list(title = 'Spatial Correlation')) # 4. rank spatial correlated clusters and show genes for selected clusters netw_ranks = rankSpatialCorGroups(sg, spatCorObject = spat_cor_obj,                                   use_clus_name = 'spat_netw_clus') top_netw_spat_cluster = showSpatialCorFeats(spat_cor_obj, use_clus_name = 'spat_netw_clus',                                             show_top_feats = 1) # 5. create metagene enrichment score for clusters cluster_genes = top_netw_spat_cluster$clus; names(cluster_genes) = top_netw_spat_cluster$feat_ID  sg = createMetafeats(sg, feat_clusters = cluster_genes, name = 'cluster_metagene') spatCellPlot(sg,              spat_enr_names = 'cluster_metagene',              cell_annotation_values = netw_ranks[1:4]$clusters,              point_size = 0.05, point_shape = 'no_border') spatCellPlot(sg,              spat_enr_names = 'cluster_metagene',              cell_annotation_values = netw_ranks[5:8]$clusters,              point_size = 0.05, point_shape = 'no_border') spatCellPlot(sg,              spat_enr_names = 'cluster_metagene',              cell_annotation_values = netw_ranks[9:10]$clusters,              point_size = 0.05, point_shape = 'no_border')"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_genomics_mouse_kidney.html","id":"session-info","dir":"Articles","previous_headings":"10. Spatial Co-Expression Patterns","what":"10.1 Session Info","title":"Spatial Genomics Mouse Kidney","text":"","code":"sessionInfo()"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_transformations.html","id":"spatial-object-manipulation","dir":"Articles","previous_headings":"","what":"1. Spatial Object Manipulation","title":"Spatial Transformations","text":"Spatial-omics data defined biological information contains way maps space. assembling analyzing spatial dataset, may necessary spatially manipulate data common coordinate reference frame data scaling rotation, properly overlaid. Giotto extends set generics terra order make simple figure data space move need .","code":""},{"path":"https://drieslab.github.io/Giotto/articles/spatial_transformations.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"2. Start Giotto","title":"Spatial Transformations","text":"","code":"# Ensure Giotto Suite is installed i_p = installed.packages() if(!\"Giotto\" %in% i_p) devtools::install_github(\"drieslab/Giotto@suite\") library(Giotto)  # Ensure Giotto Data is installed if(!\"GiottoData\" %in% i_p) devtools::install_github(\"drieslab/GiottoData\") library(GiottoData)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_transformations.html","id":"load-mini-giotto-object-example","dir":"Articles","previous_headings":"","what":"3. Load mini giotto object example","title":"Spatial Transformations","text":"First load mini dataset put together Vizgen’s Mouse Brain Receptor Map data release. mini giotto object pre-analyzed comes many analyses data objects attached. analyses performed ‘aggregate’ spatial unit set active spatial unit order default .","code":"viz <- GiottoData::loadGiottoMini(dataset = 'vizgen') activeSpatUnit(viz) <- 'aggregate'"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_transformations.html","id":"extract-spatial-info","dir":"Articles","previous_headings":"","what":"4. Extract spatial info","title":"Spatial Transformations","text":"extract spatial subobjects use. subobjects Giotto contain coordinates data directly map data space.","code":"image <- getGiottoImage(viz, image_type = 'largeImage', name = 'dapi_z0') spat_locs <- getSpatialLocations(viz) spat_net <- getSpatialNetwork(viz) gpoints <- getFeatureInfo(viz, return_giottoPoints = TRUE) gpoly <- getPolygonInfo(viz, polygon_name = 'aggregate', return_giottoPolygon = TRUE)"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_transformations.html","id":"defining-bounds-and-extent","dir":"Articles","previous_headings":"","what":"5. Defining bounds and extent","title":"Spatial Transformations","text":"One convenient descriptors object space minima maxima coordinate plane, also known boundaries spatial extent information. can thought bounding box around information exists space. Giotto incorporates usage SpatExtent class associated ext() generic terra describe objects spatially.","code":"ext(image)     # giottoLargeImage SpatExtent : 6400.029, 6900.037, -5150.007, -4699.967 (xmin, xmax, ymin, ymax) ext(spat_locs) # spatLocsObj SpatExtent : 6401.41164725267, 6899.10802819571, -5146.74746408943, -4700.32590047134 (xmin, xmax, ymin, ymax) ext(spat_net)  # spatNetObj SpatExtent : 6401.411647, 6899.108028, -5146.747464, -4700.3259 (xmin, xmax, ymin, ymax) ext(gpoints)   # giottoPoints SpatExtent : 6400.037, 6900.0317, -5149.9834, -4699.9785 (xmin, xmax, ymin, ymax) ext(gpoly)     # giottoPolygon SpatExtent : 6391.46568586489, 6903.57332779812, -5153.89721175534, -4694.86823300896 (xmin, xmax, ymin, ymax)"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_transformations.html","id":"image-extent","dir":"Articles","previous_headings":"5. Defining bounds and extent","what":"5.1 Image extent","title":"Spatial Transformations","text":"giottoLargeImage objects, additionally able assign map space using ext(). Note modifications performed one giottoLargeImage applied references object unless copy() used first.","code":"e <- ext(image) # save extent plot(image) # modify extent ext(image) <- c(0,40,0,10) # xmin, xmax, ymin, ymax plot(image) ext(image) <- e # replace"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_transformations.html","id":"spatial-transformations","dir":"Articles","previous_headings":"","what":"6. Spatial Transformations","title":"Spatial Transformations","text":"Commonly used spatial transformations coordinate translations, flips, rotations. Giotto extends generics terra use spatShift() (shift() terra), flip(), spin() respectively.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/spatial_transformations.html","id":"coordinate-translation","dir":"Articles","previous_headings":"6. Spatial Transformations","what":"6.1 coordinate translation","title":"Spatial Transformations","text":"spatShift() used simple coordinate translations. takes params dx dy distance translate along either axis.   (pay attention x coords)","code":"plot(spat_locs) plot(spatShift(spat_locs, dx = 5e3))"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_transformations.html","id":"flip","dir":"Articles","previous_headings":"6. Spatial Transformations","what":"6.2 flip","title":"Spatial Transformations","text":"flip() flip data defined line either ‘vertical’ ‘horizontal’ symmetry (default ‘vertical’ line symmetry y = 0. direction param partial matches either ‘vertical’ ‘horizontal’. y0 x0 params define line symmetry . useful assembling datasets data based coordinates y values increase negatively. behavior different default behavior terra objects flipped minima extents. difference needed often, values defined reference coordinate origin distance away axes meaningful alignment flipping. default behavior flipping extent desired, NULL can passed relevant y0 x0 param.","code":"rb = getRainbowColors(100) plot(gpoly, col = rb) plot(flip(gpoly), col = rb) # flip to positive y plot(flip(gpoly, direction = 'h', x0 = 1e4), col = rb) # flip across x = 10000"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_transformations.html","id":"spin","dir":"Articles","previous_headings":"6. Spatial Transformations","what":"6.3 spin","title":"Spatial Transformations","text":"spin() allows rotating vector data degrees passed angle param. rotation happens coordinate defined x0 y0. default x0 y0 defined object center.","code":"plot(gpoints) plot(spin(gpoints, angle = 45)) plot(spin(gpoints, angle = 45, x0 = 0, y0 = 0))"},{"path":"https://drieslab.github.io/Giotto/articles/spatial_transformations.html","id":"session-info","dir":"Articles","previous_headings":"","what":"7. Session Info","title":"Spatial Transformations","text":"","code":"sessionInfo() R version 4.2.1 (2022-06-23)     Platform: x86_64-apple-darwin17.0 (64-bit)     Running under: macOS Big Sur ... 10.16      Matrix products: default     BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib     LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib      locale:     [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8      attached base packages:     [1] stats     graphics  grDevices utils     datasets  methods   base           other attached packages:     [1] GiottoData_0.2.3 Giotto_3.3.1          loaded via a namespace (and not attached):      [1] Rcpp_1.0.11       pillar_1.9.0      compiler_4.2.1    tools_4.2.1            [5] digest_0.6.31     scattermore_0.8   checkmate_2.2.0   jsonlite_1.8.4         [9] evaluate_0.21     lifecycle_1.0.3   tibble_3.2.1      gtable_0.3.3          [13] lattice_0.20-45   png_0.1-8         pkgconfig_2.0.3   rlang_1.1.1           [17] igraph_1.4.2      Matrix_1.5-4      cli_3.6.1         rstudioapi_0.14       [21] parallel_4.2.1    yaml_2.3.7        xfun_0.39         fastmap_1.1.1         [25] terra_1.7-39      withr_2.5.0       dplyr_1.1.2       knitr_1.42            [29] generics_0.1.3    vctrs_0.6.2       rprojroot_2.0.3   grid_4.2.1            [33] tidyselect_1.2.0  here_1.0.1        reticulate_1.28   glue_1.6.2            [37] data.table_1.14.8 R6_2.5.1          fansi_1.0.4       rmarkdown_2.21        [41] ggplot2_3.4.2     magrittr_2.0.3    backports_1.4.1   scales_1.2.1          [45] codetools_0.2-18  htmltools_0.5.5   colorspace_2.1-0  utf8_1.2.3            [49] munsell_0.5.0"},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"giotto-object-structure","dir":"Articles","previous_headings":"","what":"1. Giotto Object Structure","title":"An introduction to the Giotto Suite classes","text":"Usage Giotto package revolves around giotto object. S4 class holds spatial expression data facilitates manipulation visualization Giotto package’s functions. Additional metadata outputs generated certain functions, may used downstream analyses, also stored within giotto object. self-contained nature provides convenient representation entire spatial experiment Giotto functions take given giotto object input return giotto object output. Data organized within giotto object defined slots described diagram .","code":""},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"nested-organization-of-the-giotto-object","dir":"Articles","previous_headings":"","what":"2. Nested Organization of the Giotto Object","title":"An introduction to the Giotto Suite classes","text":"Biology happens across multiple scales size types modalities. possible simply generate new object combination two, fact data spatial methods high resolution spatially contiguous, requires flexible approach permits coexistence multiple spatial units within object. allows user define spatial unit(s) biology relevant analysis re-aggregate feature information units. organization convenient compare expression across different spatial units. Additionally, determining spatial overlaps spatial units, becomes possible represent hierarchical organization biological subunits make queries using .","code":""},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"spatial-unit-and-feature-type","dir":"Articles","previous_headings":"2. Nested Organization of the Giotto Object","what":"2.1 Spatial unit and feature type","title":"An introduction to the Giotto Suite classes","text":"accommodate complexity, information subnested within many giotto object’s slots first spat_unit (spatial unit) feat_type (feature type). structurally separates set information within Giotto’s framework minimal ambiguity. summary information object contains can viewed directly returning . Included description giotto object subnesting data slot also accessor functions setting getting information .","code":"library(Giotto) library(GiottoData) library(data.table)  vizmini = loadGiottoMini('vizgen') vizmini An object of class giotto      >Active spat_unit:  z0      >Active feat_type:  rna      [SUBCELLULAR INFO]     polygons      : z0 z1 aggregate      features      : rna      [AGGREGATE INFO]     expression -----------------------       [z0][rna] raw       [z1][rna] raw       [aggregate][rna] raw normalized scaled pearson     spatial locations ----------------       [z0] raw       [z1] raw       [aggregate] raw     spatial networks -----------------       [aggregate] Delaunay_network kNN_network     spatial enrichments --------------       [aggregate][rna] cluster_metagene     dim reduction --------------------       [aggregate][rna] pca umap tsne     nearest neighbor networks --------       [aggregate][rna] sNN.pca     attached images ------------------     giottoLargeImage : 4 items...      Use objHistory() to see steps and params used"},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"show-and-list-functions","dir":"Articles","previous_headings":"2. Nested Organization of the Giotto Object","what":"2.2 Show and list functions","title":"An introduction to the Giotto Suite classes","text":"Show list functions also provided determining information exists within slots nesting. show functions print preview data within slot, return information list names (internal) functions return vector object names specified nesting","code":"showGiottoSpatLocs(vizmini) ├──Spatial unit \"z0\"     │  └──S4 spatLocsObj \"raw\" coordinates:   (498 rows)     │        An object of class spatLocsObj      │        provenance: z0     │            ------------------------     │              sdimx     sdimy                                 cell_ID     │        1: 6405.067 -4780.499  40951783403982682273285375368232495429     │        2: 6426.020 -4972.519 240649020551054330404932383065726870513     │        3: 6428.456 -4799.158 274176126496863898679934791272921588227     │        4: 6408.155 -4816.583 323754550002953984063006506310071917306     │             │        ranges:     │                sdimx     sdimy     │        [1,] 6402.438 -5146.726     │        [2,] 6899.203 -4700.157     │             │             │          ├──Spatial unit \"z1\"     │  └──S4 spatLocsObj \"raw\" coordinates:   (504 rows)     │        An object of class spatLocsObj      │        provenance: z1     │            ------------------------     │              sdimx     sdimy                                 cell_ID     │        1: 6404.014 -4779.625  40951783403982682273285375368232495429     │        2: 6408.296 -4970.794  17685062374745280598492217386845129350     │        3: 6401.148 -4991.061 223553142498364321238189328942498473503     │        4: 6430.153 -4971.251 240649020551054330404932383065726870513     │             │        ranges:     │                sdimx     sdimy     │        [1,] 6401.148 -5147.193     │        [2,] 6899.323 -4700.410     │             │             │          └──Spatial unit \"aggregate\"        └──S4 spatLocsObj \"raw\" coordinates:   (461 rows)              An object of class spatLocsObj               provenance: z0 z1                  ------------------------                    sdimx     sdimy                                 cell_ID              1: 6637.881 -5140.465 100210519278873141813371229408401071444              2: 6471.978 -4883.541 101161259912191124732236989250178928032              3: 6801.610 -4968.685 101488859781016188084173008420811094152              4: 6789.055 -5105.338 101523780333017320796881555775415156847               ranges:                      sdimx     sdimy              [1,] 6401.412 -5146.747              [2,] 6899.108 -4700.326    -   `list` functions are (internal) functions that return a `data.table`     of the available information and nesting. Giottolist_expression(vizmini) spat_unit feat_type       name     1:        z0       rna        raw     2:        z1       rna        raw     3: aggregate       rna        raw     4: aggregate       rna normalized     5: aggregate       rna     scaled     6: aggregate       rna    pearson # Find specific spat_unit objects # Giottolist_expression(vizmini, spat_unit = 'z0') spat_unit feat_type name     1:        z0       rna  raw Giottolist_expression_names(vizmini, spat_unit = 'z1', feat_type = 'rna')"},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"provenance","dir":"Articles","previous_headings":"2. Nested Organization of the Giotto Object","what":"2.3 Provenance","title":"An introduction to the Giotto Suite classes","text":"Going , sometimes different sources information can used aggregating particular spatial unit. easily shown subcellular datasets Vizgen MERSCOPE platform provide feature polygon information multiple confocal planes within tissue. aggregated information produced drawn different z-planes combinations thereof. Giotto tracks provenance information set aggregated data.","code":"expr_mat = getExpression(vizmini, spat_unit = 'aggregate') prov(expr_mat) [1] \"z0\" \"z1\""},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"giotto-subobjects","dir":"Articles","previous_headings":"","what":"3. Giotto subobjects","title":"An introduction to the Giotto Suite classes","text":"Giotto 3.0 update introduced S4 subobjects used within giotto object processing. subobjects provide formalized definitions information formatting needed giotto object slots order functional. objects standalone extensible commonly used spatial manipulation plotting methods implemented . addition, subobjects carry several pieces metadata additional slots alongside main information (e.g. also slots spat_unit feat_type alongside exprDT slot exprObj S4). makes nesting information retained taken giotto object nesting information need supplied anymore interacting setter functions. getter functions now output param defaults extracting information giotto object S4 subobject. extracting information modified returned giotto object, preferred information extracted S4 tagged information lost, convenient work S4’s main data slot [ [<- generics (see Section 3.5).","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"constructors","dir":"Articles","previous_headings":"3. Giotto subobjects > 3.1 Creating an S4 subobject","what":"3.1.1 Constructors","title":"An introduction to the Giotto Suite classes","text":"directly creating subobject, constructor functions can used. constructors createExprObj() createCellMetaObj() createFeatMetaObj() createDimObj() createNearestNetObj() createSpatLocsObj() createSpatNetObj() createSpatEnrObj() createSpatialGrid() createGiottoPoints() createGiottoPolygonsFromDfr() createGiottoPolygonsFromMask() createGiottoImage() createGiottoLargeImage() non numeric integer columns spatial location input column position(s): 3 first non-numeric column considered cell ID test consistency expression matrix. non numeric columns removed","code":"coords = data.table(   sdimx = c(1,2,3),   sdimy = c(1,2,3),   cell_ID = c('A','B','C') )  st = createSpatLocsObj(name = 'test',                        spat_unit = 'cell',                        coordinates = coords,                        provenance = 'cell') print(st) An object of class spatLocsObj : \"test\"     spat_unit : \"cell\"     provenance: cell         ------------------------      preview:        sdimx sdimy cell_ID     1:     1     1       A     2:     2     2       B     3:     3     3       C      ranges:          sdimx sdimy     [1,]     1     1     [2,]     3     3"},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"readers","dir":"Articles","previous_headings":"3. Giotto subobjects > 3.1 Creating an S4 subobject","what":"3.1.2 Readers","title":"An introduction to the Giotto Suite classes","text":"Alternatively, read functions can used take named nested lists raw data input convert lists subobjects directly usable setter functions. readers readPolygonData() readFeatData() readExprData() readCellMetadata() readFeatMetadata() readSpatLocsData() readSpatNetData() readSpatEnrichData() readDimReducData() readNearestNetData() non numeric integer columns spatial location input column position(s): 3. first non-numeric column considered cell ID test consistency expression matrix. non numeric columns removed non numeric integer columns spatial location input column position(s): 3. first non-numeric column considered cell ID test consistency expression matrix. non numeric columns removed","code":"st2 = readSpatLocsData(list(cell2 = list(test1 = coords,                                          test2 = coords))) list depth of 2      List item [1]:      spat_unit: cell2      name: test1 List item [2]:      spat_unit: cell2      name: test2 print(st2) [[1]]     An object of class spatLocsObj : \"test1\"     spat_unit : \"cell2\"     provenance: cell2         ------------------------      preview:        sdimx sdimy cell_ID     1:     1     1       A     2:     2     2       B     3:     3     3       C      ranges:          sdimx sdimy     [1,]     1     1     [2,]     3     3      [[2]]     An object of class spatLocsObj : \"test2\"     spat_unit : \"cell2\"     provenance: cell2         ------------------------      preview:        sdimx sdimy cell_ID     1:     1     1       A     2:     2     2       B     3:     3     3       C      ranges:          sdimx sdimy     [1,]     1     1     [2,]     3     3"},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"giotto-accessors","dir":"Articles","previous_headings":"3. Giotto subobjects","what":"3.2 Giotto Accessors","title":"An introduction to the Giotto Suite classes","text":"Giotto provides getter setter functions manually accessing information contained within giotto object. Note setters require data provided compatible S4 subobjects lists thereof. External data can read appropriate formats using reader functions. getter functions return S4 subobjects default. getters getExpression() getCellMetadata() getFeatMetadata() getSpatialLocations() getDimReduction() getNearestNetwork() getSpatialNetwork() getPolygonInfo() getFeatureInfo() getSpatialEnrichment() getGiottoImage() setters setExpression() setCellMetadata() setFeatureMetadata() setSpatialLocations() setDimReduction() setNearestNetwork() setSpatialNetwork() setPolygonInfo() setFeatureInfo() setSpatialEnrichment() setGiottoImage()","code":"expval = getExpression(vizmini) print(expval) An object of class exprObj : \"raw\"     spat_unit : \"z0\"     feat_type : \"rna\"     provenance: z0       contains:     336 x 498 sparse Matrix of class \"dgCMatrix\"      Adora1 . . . . . . . . . . 1 . . ......     Adgrb1 . . . . 1 . . . . . . . . ......     Adgrb3 . . . . . . . . . . 1 3 . ......       ........suppressing 485 columns and 330 rows       Blank-128 . . . . . . . . . . . . . ......     Blank-145 . . . . . . . . . . . . . ......     Gpr101    . . . . . . . . . . . . . ......       First four colnames:      40951783403982682273285375368232495429      240649020551054330404932383065726870513      274176126496863898679934791272921588227      323754550002953984063006506310071917306"},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"get-and-set-s4-spat_unit-feat_type-provenance","dir":"Articles","previous_headings":"3. Giotto subobjects","what":"3.3 Get and set S4 spat_unit, feat_type, provenance","title":"An introduction to the Giotto Suite classes","text":"spatUnit(), featType(), prov() replacement functions tagged spatial unit, feature type, provenance information respectively.","code":"# spat_unit spatUnit(expval) <- 'new_spat' spatUnit(expval) [1] \"new_spat\" # feat_type featType(expval) <- 'new_feat' featType(expval) [1] \"new_feat\" # provenance prov(expval) <- 'cell' prov(expval) [1] \"cell\""},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"setting-an-s4-subobject","dir":"Articles","previous_headings":"3. Giotto subobjects","what":"3.4 Setting an S4 subobject","title":"An introduction to the Giotto Suite classes","text":"spat_unit, feat_type, name params longer need given setting S4 subobject tagged information giottoObject. However, input given set function parameters prioritized tagged information tagged information updated.","code":"# set exprObj to tagged nesting location vizmini <- setExpression(vizmini, expval) Setting expression [new_spat][new_feat] raw Giottolist_expression(vizmini) spat_unit feat_type       name     1:        z0       rna        raw     2:        z1       rna        raw     3: aggregate       rna        raw     4: aggregate       rna normalized     5: aggregate       rna     scaled     6: aggregate       rna    pearson     7:  new_spat  new_feat        raw"},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"sec-working_with_subobjects","dir":"Articles","previous_headings":"3. Giotto subobjects","what":"3.5 Working with S4 subobjects","title":"An introduction to the Giotto Suite classes","text":"Giotto’s S4 subobjects wrap one main data object. empty [] []<- operators defined shorthand directly accessing slot contains data. example, spatLocsObj: class(spatLocsObj[]) equivalent class(spatLocsObj@coordinates) way, S4 subobjects can used contexts wrapped objects . Setting information","code":"st = getSpatialLocations(vizmini) class(st) [1] \"spatLocsObj\"     attr(,\"package\")     [1] \"Giotto\" # With empty brackets class(st[]) [1] \"data.table\" \"data.frame\" print(st) An object of class spatLocsObj : \"raw\"     spat_unit : \"z0\"     provenance: z0         ------------------------      preview:             sdimx     sdimy                                 cell_ID       1: 6405.067 -4780.499  40951783403982682273285375368232495429       2: 6426.020 -4972.519 240649020551054330404932383065726870513       3: 6428.456 -4799.158 274176126496863898679934791272921588227       4: 6408.155 -4816.583 323754550002953984063006506310071917306       5: 6425.894 -4862.808  87260224659312905497866017323180367450      ---                                                                494: 6863.376 -4764.372 264234489423886906860498828392801290668     495: 6833.515 -4724.922 328891726607418454659643302361160567789     496: 6829.474 -4755.392   6380671372744430258754116433861320161     497: 6823.512 -4713.632  75286702783716447443887872812098770697     498: 6842.534 -4717.261   9677424102111816817518421117250891895      ranges:             sdimx     sdimy     [1,] 6402.438 -5146.726     [2,] 6899.203 -4700.157 st[] = coords print(st) An object of class spatLocsObj : \"raw\"     spat_unit : \"z0\"     provenance: z0         ------------------------      preview:        sdimx sdimy cell_ID     1:     1     1       A     2:     2     2       B     3:     3     3       C      ranges:          sdimx sdimy     [1,]     1     1     [2,]     3     3"},{"path":"https://drieslab.github.io/Giotto/articles/structure.html","id":"session-info","dir":"Articles","previous_headings":"3. Giotto subobjects","what":"4. Session Info","title":"An introduction to the Giotto Suite classes","text":"","code":"sessionInfo() R version 4.2.1 (2022-06-23)     Platform: x86_64-apple-darwin17.0 (64-bit)     Running under: macOS Big Sur ... 10.16      Matrix products: default     BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib     LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib      locale:     [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8      attached base packages:     [1] stats     graphics  grDevices utils     datasets  methods   base           other attached packages:     [1] data.table_1.14.8 GiottoData_0.2.2  Giotto_3.3.1           loaded via a namespace (and not attached):      [1] Rcpp_1.0.11      pillar_1.9.0     compiler_4.2.1   tools_4.2.1           [5] digest_0.6.31    jsonlite_1.8.4   evaluate_0.21    lifecycle_1.0.3       [9] tibble_3.2.1     gtable_0.3.3     lattice_0.20-45  png_0.1-8            [13] pkgconfig_2.0.3  rlang_1.1.1      igraph_1.4.2     Matrix_1.5-4         [17] cli_3.6.1        rstudioapi_0.14  parallel_4.2.1   yaml_2.3.7           [21] xfun_0.39        fastmap_1.1.1    terra_1.7-39     withr_2.5.0          [25] dplyr_1.1.2      knitr_1.42       generics_0.1.3   vctrs_0.6.2          [29] rprojroot_2.0.3  grid_4.2.1       tidyselect_1.2.0 here_1.0.1           [33] reticulate_1.28  glue_1.6.2       R6_2.5.1         fansi_1.0.4          [37] rmarkdown_2.21   ggplot2_3.4.2    magrittr_2.0.3   scales_1.2.1         [41] codetools_0.2-18 htmltools_0.5.5  colorspace_2.1-0 utf8_1.2.3           [45] munsell_0.5.0"},{"path":"https://drieslab.github.io/Giotto/articles/terra.html","id":"launching-giotto-on-the-cloud","dir":"Articles","previous_headings":"","what":"Launching Giotto on the Cloud","title":"Terra bio","text":"can run pipelines using Giotto Cloud Terra.bio platform.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/terra.html","id":"setting-up-your-terra-account","dir":"Articles","previous_headings":"","what":"1. Setting up your Terra account","title":"Terra bio","text":"Go Terra Chrome browser Sign using email address use billing account Google Cloud Platform.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/terra.html","id":"creating-a-billing-account","dir":"Articles","previous_headings":"","what":"2. Creating a Billing Account","title":"Terra bio","text":"Create account Google Cloud Platform. Set Terra billing user account. Select Google account create billing project Terra. additional information billing account go link.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/terra.html","id":"create-a-workspace","dir":"Articles","previous_headings":"","what":"3. Create A Workspace","title":"Terra bio","text":"Create workspace within billing account. Note users access permissions workspace share billing account. Launch Virtual Machine Cloud environment.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/terra.html","id":"create-a-cloud-environment","dir":"Articles","previous_headings":"","what":"4. Create a Cloud Environment","title":"Terra bio","text":"Terra, can run Cloud Environments using Jupyter notebooks RStudio App. recommend either Juypyter notebook + Python + Bioconductor RStudio + Bioconductor options.  can customize memory usage, number CPUs, persistent disk size virtual machine.  Now can install Giotto package running R commmand:","code":"remotes::install_github('drieslab/Giotto')"},{"path":"https://drieslab.github.io/Giotto/articles/terra.html","id":"create-a-ready-to-use-cloud-environment-with-giotto","dir":"Articles","previous_headings":"","what":"5. Create a ready-to-use Cloud Environment with Giotto","title":"Terra bio","text":"can pre-install Giotto package launching Jupyter notebook RStudio App. create customized Jupyter notebook, use Terra-based Docker image: giottopackage/terra_jupyter_suite:latest  create customized RStudio session use startup script url: gs://fc-c374290b-2c96-4980-8b43-92770eebf1b1/suite.sh  Click Create Environment","code":""},{"path":"https://drieslab.github.io/Giotto/articles/terra.html","id":"share-your-workspace-with-collaborators","dir":"Articles","previous_headings":"","what":"6. Share your workspace with collaborators","title":"Terra bio","text":"can share workspace collaborators, including data, notebooks, workflows stored workspace. Go Dashboard tab workspace click three dots upper right corner. Select Share option. Add email collaborator. receive invitation joining worskpace. can select permissions granted collaborator (reader, writer owner). Click save button.  Considerations Keep mind Cloud environments (virtual machines) launched within workspace linked billing account. Simultaneous modification notebooks allowed. Opening notebook someone else editing show message, current editor notified someone else trying open notebook.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_human_glioblastoma.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"1 Dataset explanation","title":"Visium CytAssist Multi-omics Human Glioblastoma","text":"Human glioblastoma (FFPE) dataset obtained 10x Genomics. tissue sectioned described Visium CytAssist Spatial Gene Expression FFPE – Tissue Preparation Guide Demonstrated Protocol (CG000518). 5 µm tissue sections placed Superfrost glass slides, stained following deparaffinization, hard coverslipped. Sections imaged, decoverslipped, followed Demonstrated Protocol (CG000494). information dataset can found .","code":""},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_human_glioblastoma.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"2 Start Giotto","title":"Visium CytAssist Multi-omics Human Glioblastoma","text":"","code":"# Ensure Giotto Suite is installed if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto\") } library(Giotto)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment   installGiottoEnvironment() } # 1. set results directory results_directory = 'results'  # 2. set giotto python path # set python path to your preferred python version path # set python path to NULL if you want to automatically install (only the 1st time) and use the giotto miniconda environment python_path = NULL if(is.null(python_path)) {   installGiottoEnvironment() }  # 3. create giotto instructions instrs = createGiottoInstructions(save_dir = results_directory,                                   save_plot = TRUE,                                   show_plot = TRUE,                                   python_path = python_path)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_human_glioblastoma.html","id":"create-giotto-object","dir":"Articles","previous_headings":"","what":"3 Create Giotto object","title":"Visium CytAssist Multi-omics Human Glioblastoma","text":"minimum requirements matrix expression information (path ) x,y(,z) coordinates cells spots (path ) createGiottoVisiumObject() automatically detect rna protein modalities within expression matrix creating multi-omics Giotto object. work Giotto instructions part Giotto object: Show instructions associated Giotto object showGiottoInstructions() Change one instructions changeGiottoInstructions() Replace instructions replaceGiottoInstructions() Read get specific Giotto instruction readGiottoInstructions()","code":"# Provide path to visium folder data_directory <- 'path/to/visium/data'  # Create Giotto object visium = createGiottoVisiumObject(visium_dir = data_directory,                                   expr_data = 'raw',                                   png_name = 'tissue_lowres_image.png',                                   gene_column_index = 2,                                   instructions = instrs) # show instructions associated with the giotto object  showGiottoInstructions(visium)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_human_glioblastoma.html","id":"processing","dir":"Articles","previous_headings":"","what":"4 Processing","title":"Visium CytAssist Multi-omics Human Glioblastoma","text":"Filter features cells based detection frequencies Normalize expression matrix (log transformation, scaling factor /z-scores) Add cell feature statistics (optional) Adjust expression matrix technical covariates batches (optional).","code":"# Subset on spots that were covered by tissue metadata = pDataDT(visium) in_tissue_barcodes = metadata[in_tissue == 1]$cell_ID visium = subsetGiotto(visium, cell_ids = in_tissue_barcodes)  ## Visualize aligned tissue spatPlot2D(gobject = visium,            point_alpha = 0.7) # Filtering, normalization, and statistics  ## RNA feature visium <- filterGiotto(gobject = visium,                        expression_threshold = 1,                        feat_det_in_min_cells = 50,                        min_det_feats_per_cell = 1000,                        expression_values = c('raw'),                        verbose = TRUE)  visium <- normalizeGiotto(gobject = visium,                           scalefactor = 6000,                           verbose = TRUE)  visium <- addStatistics(gobject = visium)  ### Visualize number of features after processing spatPlot2D(gobject = visium,            point_alpha = 0.7,            cell_color = 'nr_feats',            color_as_factor = FALSE) ## Protein feature  visium <- filterGiotto(gobject = visium,                         spat_unit = 'cell',                        feat_type = 'protein',                        expression_threshold = 1,                        feat_det_in_min_cells = 50,                         min_det_feats_per_cell = 1,                        expression_values = 'raw',                         verbose = TRUE)  visium <- normalizeGiotto(gobject = visium,                           spat_unit = 'cell',                            feat_type = 'protein',                            scalefactor = 6000,                            verbose = TRUE)  visium <- addStatistics(gobject = visium,                         spat_unit = 'cell',                          feat_type = 'protein')  ### Visualize number of features after processing  spatPlot2D(gobject = visium,            spat_unit = 'cell',             feat_type = 'protein',             point_alpha = 0.7,             cell_color = 'nr_feats',             color_as_factor = FALSE)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_human_glioblastoma.html","id":"dimention-reduction","dir":"Articles","previous_headings":"","what":"5 Dimention Reduction","title":"Visium CytAssist Multi-omics Human Glioblastoma","text":"","code":"# Identify highly variable features (HVF) visium <- calculateHVF(gobject = visium) # PCA  ## RNA visium <- runPCA(gobject = visium)  screePlot(visium, ncp = 30) ### Visualize RNA PCA plotPCA(gobject = visium) ## Protein visium <- runPCA(gobject = visium,                  spat_unit = 'cell',                  feat_type = 'protein')  screePlot(visium,           spat_unit = 'cell',           feat_type = 'protein',           ncp = 30) ### Visualize Protein PCA plotPCA(gobject = visium,         spat_unit = 'cell',         feat_type = 'protein')"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_human_glioblastoma.html","id":"clustering","dir":"Articles","previous_headings":"","what":"6 Clustering","title":"Visium CytAssist Multi-omics Human Glioblastoma","text":"","code":"# cluster and run UMAP # sNN network (default)  ## RNA feature visium <- createNearestNetwork(gobject = visium,                                dimensions_to_use = 1:10,                                k = 30)  ## Protein feature visium <- createNearestNetwork(gobject = visium,                                spat_unit = 'cell',                                feat_type = 'protein',                                dimensions_to_use = 1:10,                                k = 30)  # Leiden clustering  ## RNA feature visium <- doLeidenCluster(gobject = visium,                           resolution = 1,                           n_iterations = 1000)  ## Protein feature visium <- doLeidenCluster(gobject = visium,                           spat_unit = 'cell',                           feat_type = 'protein',                           resolution = 1,                           n_iterations = 1000)  # UMAP  ## RNA feature visium <- runUMAP(visium,                   dimensions_to_use = 1:10)  plotUMAP(gobject = visium,          cell_color = 'leiden_clus',          show_NN_network = TRUE,          point_size = 2) ## Protein feature  visium <- runUMAP(visium,                   spat_unit = 'cell',                    feat_type = 'protein',                    dimensions_to_use = 1:10)  plotUMAP(gobject = visium,          spat_unit = 'cell',           feat_type = 'protein',           cell_color = 'leiden_clus',           show_NN_network = TRUE,           point_size = 2) # Visualize spatial plot  ## RNA feature spatPlot2D(gobject = visium,            show_image = TRUE,            cell_color = 'leiden_clus',            point_size = 2) ## Protein feature spatPlot2D(gobject = visium,            spat_unit = 'cell',            feat_type = 'protein',            show_image = TRUE,            cell_color = 'leiden_clus',            point_size = 2)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_human_glioblastoma.html","id":"multi-omics-integration","dir":"Articles","previous_headings":"","what":"7 Multi-omics integration","title":"Visium CytAssist Multi-omics Human Glioblastoma","text":"Weighted Nearest Neighbors allows integrate two modalities acquired sample. WNN re-calculate clustering provide integrated umap leiden clustering. running WNN, Giotto object must contain results running PCA calculation modality.","code":"# Calculate kNN  ## RNA modality visium <- createNearestNetwork(gobject = visium,                                type = 'kNN',                                dimensions_to_use = 1:10,                                k = 20)  ## Protein modality visium <- createNearestNetwork(gobject = visium,                                spat_unit = 'cell',                                feat_type = 'protein',                                type = 'kNN',                                dimensions_to_use = 1:10,                                k = 20)   # Run WNN visium <- runWNN(visium,                  spat_unit = \"cell\",                  modality_1 = \"rna\",                  modality_2 = \"protein\",                  pca_name_modality_1 = \"pca\",                  pca_name_modality_2 = \"protein.pca\",                  k = 20,                  integrated_feat_type = NULL,                  matrix_result_name = NULL,                  w_name_modality_1 = NULL,                  w_name_modality_2 = NULL,                  verbose = TRUE)  # Run Integrated umap visium <- runIntegratedUMAP(visium,                             modality1 = \"rna\",                             modality2 = \"protein\",                             spread = 5,                             min_dist = 0.5,                             force = FALSE)  # Calculate integrated clusters visium <- doLeidenCluster(gobject = visium,                           spat_unit = \"cell\",                           feat_type = \"rna\",                           nn_network_to_use = \"kNN\",                           network_name = \"integrated_kNN\",                           name = \"integrated_leiden_clus\",                           resolution = 1)  # Visualize integrated umap plotUMAP(gobject = visium,          spat_unit = \"cell\",          feat_type = \"rna\",          cell_color = 'integrated_leiden_clus',          dim_reduction_name = \"integrated.umap\",          point_size = 1.5,          title = \"Integrated UMAP using Integrated Leiden clusters\",          axis_title = 12,          axis_text = 10 ) # Visualize spatial plot with integrated clusters spatPlot2D(visium,            spat_unit = \"cell\",            feat_type = \"rna\",            cell_color = \"integrated_leiden_clus\",            point_size = 2,            show_image = FALSE,            title = \"Integrated Leiden clustering\")"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_human_glioblastoma.html","id":"session-info","dir":"Articles","previous_headings":"","what":"8 Session Info","title":"Visium CytAssist Multi-omics Human Glioblastoma","text":"","code":"sessionInfo()  R version 4.3.1 (2023-06-16) Platform: x86_64-apple-darwin20 (64-bit) Running under: macOS Ventura 13.5.1  Matrix products: default BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A                /Frameworks/vecLib.framework/Versions/A/libBLAS.dylib LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib          /libRlapack.dylib;  LAPACK version 3.11.0  locale: [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8  time zone: America/New_York tzcode source: internal  attached base packages: [1] stats     graphics  grDevices utils     datasets  methods   base  other attached packages: [1] Giotto_3.3.2             GiottoVisuals_0.0.0.9002 [3] GiottoClass_0.0.0.9003   GiottoUtils_0.0.0.9002  loaded via a namespace (and not attached): [1] gtable_0.3.4       xfun_0.40          ggplot2_3.4.3 [4] htmlwidgets_1.6.2  devtools_2.4.5     remotes_2.4.2.1 [7] processx_3.8.2     lattice_0.21-8     callr_3.7.3 [10] vctrs_0.6.3        tools_4.3.1        ps_1.7.5 [13] generics_0.1.3     parallel_4.3.1     tibble_3.2.1 [16] fansi_1.0.4        colorRamp2_0.1.0   pkgconfig_2.0.3 [19] Matrix_1.6-1       data.table_1.14.8  checkmate_2.2.0 [22] RColorBrewer_1.1-3 lifecycle_1.0.3    farver_2.1.1 [25] compiler_4.3.1     stringr_1.5.0      textshaping_0.3.6 [28] munsell_0.5.0      terra_1.7-39       codetools_0.2-19 [31] httpuv_1.6.11      htmltools_0.5.6    usethis_2.2.2 [34] yaml_2.3.7         later_1.3.1        pillar_1.9.0 [37] crayon_1.5.2       urlchecker_1.0.1   ellipsis_0.3.2 [40] cachem_1.0.8       magick_2.7.5       sessioninfo_1.2.2 [43] mime_0.12          tidyselect_1.2.0   digest_0.6.33 [46] stringi_1.7.12     dplyr_1.1.2        purrr_1.0.2 [49] labeling_0.4.2     cowplot_1.1.1      fastmap_1.1.1 [52] grid_4.3.1         colorspace_2.1-0   cli_3.6.1 [55] magrittr_2.0.3     pkgbuild_1.4.2     utf8_1.2.3 [58] withr_2.5.0        prettyunits_1.1.1  scales_1.2.1 [61] promises_1.2.1     backports_1.4.1    rmarkdown_2.24 [64] igraph_1.5.1       reticulate_1.31    ragg_1.2.5 [67] png_0.1-8          memoise_2.0.1      shiny_1.7.5 [70] evaluate_0.21      knitr_1.43         miniUI_0.1.1.1 [73] profvis_0.3.8      rlang_1.1.1        Rcpp_1.0.11 [76] xtable_1.8-4       glue_1.6.2         pkgload_1.3.2.1 [79] jsonlite_1.8.7     rstudioapi_0.15.0  R6_2.5.1 [82] systemfonts_1.0.4  fs_1.6.3"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"Dataset Explanation","title":"Visium CytAssist Human Lung Cancer","text":"human lung cancer (FFPE) dataset obtained 10x Genomics using CytAssist Visium technology recently developed allow users perform standard histology workflows two standard glass slides transferring transcriptional probes two-area capture visium slide. information dataset can found .","code":""},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"Start Giotto","title":"Visium CytAssist Human Lung Cancer","text":"run current vignette need install Giotto Suite branch.","code":"# Ensure Giotto Suite and GiottoData packages are installed if(!\"Giotto\" %in% installed.packages()) {    devtools::install_github(\"drieslab/Giotto@suite\") }  if(!\"Giotto\" %in% installed.packages()) {    devtools::install_github(\"drieslab/GiottoData\") }  library(Giotto) library(GiottoData)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){    # The following command need only be run once to install the Giotto environment.    installGiottoEnvironment() }  # to automatically save figures in save_dir set save_plot to TRUE temp_dir = getwd() myinstructions = createGiottoInstructions(save_dir = temp_dir,                                           save_plot = TRUE,                                           show_plot = TRUE)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"create-a-giotto-object","dir":"Articles","previous_headings":"","what":"1. Create a Giotto object","title":"Visium CytAssist Human Lung Cancer","text":"minimum requirements matrix expression information (path ) x,y(,z) coordinates cells spots (path )  work Giotto instructions part Giotto object: show instructions associated Giotto object showGiottoInstructions() change one instructions changeGiottoInstructions() replace instructions replaceGiottoInstructions() read get specific Giotto instruction readGiottoInstructions()","code":"# Provide path to visium folder data_path = paste0(temp_dir, '/data/') getSpatialDataset(dataset = 'cytassist_lungcancer', directory = data_path, method = 'wget')  # Create Giotto object   visium_lungcancer = createGiottoVisiumObject(visium_dir = data_path,                                                expr_data = 'raw',                                                png_name = 'tissue_lowres_image.png',                                                gene_column_index = 2,                                                instructions = myinstructions)  # check metadata pDataDT(visium_lungcancer)  # check available image names showGiottoImageNames(visium_lungcancer) # \"image\" is the default name  # show aligned image spatPlot(gobject = visium_lungcancer, cell_color = 'in_tissue', show_image = T, point_alpha = 0.7) # show instructions associated with giotto object (visium_lungcancer) showGiottoInstructions(visium_lungcancer)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"processing-steps","dir":"Articles","previous_headings":"","what":"2. Processing steps","title":"Visium CytAssist Human Lung Cancer","text":"filter genes cells based detection frequencies normalize expression matrix (log transformation, scaling factor /z-scores) add cell gene statistics (optional) adjust expression matrix technical covariates batches (optional). results stored custom slot.","code":"visium_lungcancer <- filterGiotto(gobject = visium_lungcancer,                                   expression_threshold = 1,                                   feat_det_in_min_cells = 50,                                   min_det_feats_per_cell = 1000,                                   expression_values = c('raw'),                                   verbose = T) visium_lungcancer <- normalizeGiotto(gobject = visium_lungcancer, scalefactor = 6000, verbose = T) visium_lungcancer <- addStatistics(gobject = visium_lungcancer)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"visualize-aligned-tissue-with-number-of-features-after-processing","dir":"Articles","previous_headings":"2. Processing steps","what":"Visualize aligned tissue with number of features after processing","title":"Visium CytAssist Human Lung Cancer","text":"","code":"spatPlot2D(gobject = visium_lungcancer, show_image = T, point_alpha = 0.7) spatPlot2D(gobject = visium_lungcancer, show_image = T, point_alpha = 0.7,            cell_color = 'nr_feats', color_as_factor = F)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"dimension-reduction","dir":"Articles","previous_headings":"","what":"3. Dimension Reduction","title":"Visium CytAssist Human Lung Cancer","text":"identify highly variable features (HVF)  perform PCA identify number significant principal components (PCs)   run UMAP /t-SNE PCs (directly matrix)","code":"visium_lungcancer <- calculateHVF(gobject = visium_lungcancer) visium_lungcancer <- runPCA(gobject = visium_lungcancer) screePlot(visium_lungcancer, ncp = 30) plotPCA(gobject = visium_lungcancer) visium_lungcancer <- runUMAP(visium_lungcancer, dimensions_to_use = 1:10) plotUMAP(gobject = visium_lungcancer) visium_lungcancer <- runtSNE(visium_lungcancer, dimensions_to_use = 1:10) plotTSNE(gobject = visium_lungcancer)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"clustering","dir":"Articles","previous_headings":"","what":"4. Clustering","title":"Visium CytAssist Human Lung Cancer","text":"create shared (default) nearest network PCA space (directly matrix) cluster nearest network Leiden Louvain (k-means hclust alternatives)","code":"# Create shared nearest network (SNN) and perform leiden clustering visium_lungcancer <- createNearestNetwork(gobject = visium_lungcancer, dimensions_to_use = 1:10, k = 30) visium_lungcancer <- doLeidenCluster(gobject = visium_lungcancer, spat_unit = 'cell', feat_type = 'rna', resolution = 0.4, n_iterations = 1000)  # visualize UMAP cluster results plotUMAP(gobject = visium_lungcancer, cell_color = 'leiden_clus', show_NN_network = T, point_size = 2) # visualize tSNE cluster results plotTSNE(gobject = visium_lungcancer, cell_color = 'leiden_clus', show_NN_network = T, point_size = 2) # visualize expression and spatial results spatDimPlot(gobject = visium_lungcancer, cell_color = 'leiden_clus',             dim_point_size = 2, spat_point_size = 2) spatDimPlot(gobject = visium_lungcancer, cell_color = 'nr_feats', color_as_factor = F,             dim_point_size = 2, dim_show_legend = T, spat_show_legend = T, spat_point_size = 2)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"differential-expression","dir":"Articles","previous_headings":"","what":"5. Differential expression","title":"Visium CytAssist Human Lung Cancer","text":"","code":"# Cell type marker detection # Gini markers gini_markers_subclusters = findMarkers_one_vs_all(gobject = visium_lungcancer,                                                   method = 'gini',                                                   expression_values = 'normalized',                                                   cluster_column = 'leiden_clus',                                                   min_featss = 20,                                                   min_expr_gini_score = 0.5,                                                   min_det_gini_score = 0.5)  # get top 2 genes per cluster and visualize with violin plot topgenes_gini = gini_markers_subclusters[, head(.SD, 2), by = 'cluster']$feats violinPlot(visium_lungcancer, feats = unique(topgenes_gini), cluster_column = 'leiden_clus',            strip_text = 8, strip_position = 'right') # cluster heatmap plotMetaDataHeatmap(visium_lungcancer,                     selected_feats = topgenes_gini,                     metadata_cols = c('leiden_clus'),                     x_text_size = 10, y_text_size = 10) # umap plots dimFeatPlot2D(visium_lungcancer,               expression_values = 'scaled',               feats = gini_markers_subclusters[, head(.SD, 1), by = 'cluster']$feats,               cow_n_col = 3, point_size = 1) # Cell type marker detection # Scran markers scran_markers_subclusters = findMarkers_one_vs_all(gobject = visium_lungcancer,                                                    method = 'scran',                                                    expression_values = 'normalized',                                                    cluster_column = 'leiden_clus')  # get top 2 genes per cluster and visualize with violin plot topgenes_scran = scran_markers_subclusters[, head(.SD, 2), by = 'cluster']$feats violinPlot(visium_lungcancer, feats = unique(topgenes_scran),            cluster_column = 'leiden_clus',            strip_text = 10, strip_position = 'right') # cluster heatmap plotMetaDataHeatmap(visium_lungcancer,                     selected_feats = topgenes_scran,                     metadata_cols = c('leiden_clus'),                     x_text_size = 10, y_text_size = 10) # umap plots dimFeatPlot2D(visium_lungcancer,               expression_values = 'scaled',               feats = scran_markers_subclusters[, head(.SD, 1), by = 'cluster']$feats,               cow_n_col = 3, point_size = 1)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"cell-type-enrichment","dir":"Articles","previous_headings":"","what":"6. Cell Type Enrichment","title":"Visium CytAssist Human Lung Cancer","text":"Visium spatial transcriptomics provide single-cell resolution, making cell type annotation harder problem. Giotto provides several ways calculate enrichment specific cell-type signature gene lists: PAGE hypergeometric test Rank DWLS Deconvolution Corresponded Single cell dataset can generated . Giotto_SC processed downsampled Loom file can also downloaded getSpatialDataset.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"page","dir":"Articles","previous_headings":"6. Cell Type Enrichment","what":"PAGE","title":"Visium CytAssist Human Lung Cancer","text":"cell-type specific signature gene list obtained previous study focused investigating therapy-induced evolution lung cancer revealed single-cell RNA sequencing. information paper scRNA-seq dataset can found .","code":"# umap plots # Create PAGE matrix # PAGE matrix should be a binary matrix with each row represent a gene marker and each column represent a cell type # There are several ways to create PAGE matrix # 1.1 create binary matrix of cell signature genes # small example # Tcells_markers = c(\"CD2\", \"CD3D\", \"CD3E\", \"CD3G\") macrophage_markers = c(\"MARCO\", \"CSF1R\", \"CD68\", \"GLDN\", \"APOE\", \"CCL3L1\", \"TREM2\", \"C1QB\", \"NUPR1\", \"FOLR2\", \"RNASE1\", \"C1QA\") dendritic_markers = c(\"CD1E\", \"CD1C\", \"FCER1A\", \"PKIB\", \"CYP2S1\", \"NDRG2\") mast_markers = c(\"CMA1\", \"TPSAB1\", \"TPSB2\") Bcell_markers = c(\"IGLL5\", \"MZB1\", \"JCHAIN\", \"DERL3\", \"SDC1\", \"MS$A1\", \"BANK1\", \"PAX5\", \"CD79A\") Bcell_PB_markers = c(\"PRDM1\", \"XSP1\", \"IRF4\") Bcell_mem_markers = c(\"MS4A1\", \"IRF8\") housekeeping_markers = c(\"ACTB\", \"GAPDH\", \"MALAT1\") neutrophils_markers = c(\"FCGR3B\", \"ALPL\", \"CXCR1\", \"CXCR2\", \"ADGRG3\", \"CMTM2\", \"PROK2\", \"MME\", \"MMP25\", \"TNFRSF10C\") pdcs_markers = c(\"SLC32A1\", \"SHD\", \"LRRC26\", \"PACSIN1\", \"LILRA4\", \"CLEC4C\", \"DNASE1L3\", \"SCT\", \"LAMP5\")  signature_matrix = makeSignMatrixPAGE(sign_names = c('T_Cells', 'Macrophage', 'Dendritic', 'Mast', 'B_cell', 'Bcell_PB', 'Bcells_memory', 'Housekeeping', 'Neutrophils', 'pDCs'),  sign_list = list(Tcells_markers,            macrophage_markers,            dendritic_markers,            mast_markers,            Bcell_markers,            Bcell_PB_markers,            Bcell_mem_markers,            housekeeping_markers,            neutrophils_markers,            pdcs_markers))  # 1.3 enrichment test with PAGE  markers_scran = findMarkers_one_vs_all(gobject=giotto_SC, method=\"scran\",                                        expression_values=\"normalized\", cluster_column = \"Class\", min_feats=3)  top_markers <- markers_scran[, head(.SD, 10), by=\"cluster\"] celltypes<-levels(factor(markers_scran$cluster)) sign_list<-list() for (i in 1:length(celltypes)){  sign_list[[i]]<-top_markers[which(top_markers$cluster == celltypes[i]),]$feats }  PAGE_matrix_3 = makeSignMatrixPAGE(sign_names = celltypes,                                    sign_list = sign_list)  #  runSpatialEnrich() can also be used as a wrapper for all currently provided enrichment options visium_lungcancer = runPAGEEnrich(gobject = visium_lungcancer, sign_matrix = signature_matrix, min_overlap_genes = 1)  # 1.4 heatmap of enrichment versus annotation (e.g. clustering result) cell_types = colnames(signature_matrix) plotMetaDataCellsHeatmap(gobject = visium_lungcancer,                          metadata_cols = 'leiden_clus',                          value_cols = cell_types,                          spat_enr_names = 'PAGE',                          x_text_size = 8,                          y_text_size = 8,                          show_plot = T,                          save_param = list(save_name=\"7_a_metaheatmap\")) cell_types_subset = colnames(signature_matrix) spatCellPlot(gobject = visium_lungcancer,              spat_enr_names = 'PAGE',              cell_annotation_values = cell_types_subset,              cow_n_col = 4, coord_fix_ratio = NULL, point_size = 0.75,              save_param = list(save_name=\"7_b_spatcellplot_1\")) spatDimCellPlot(gobject = visium_lungcancer,                 spat_enr_names = 'PAGE',                 cell_annotation_values = c('B_cell','Macrophage'),                 cow_n_col = 1, spat_point_size = 1.2,                 plot_alignment = 'horizontal',                 save_param = list(save_name=\"7_d_spatDimCellPlot\", base_width=7, base_height=10))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"spatial-grids","dir":"Articles","previous_headings":"","what":"7. Spatial Grids","title":"Visium CytAssist Human Lung Cancer","text":"","code":"visium_lungcancer <- createSpatialGrid(gobject = visium_lungcancer,                                        sdimx_stepsize = 400,                                        sdimy_stepsize = 400,                                        minimum_padding = 0)  spatPlot(visium_lungcancer, cell_color = 'leiden_clus', point_size = 2.5, show_grid = T, grid_color = 'red', spatial_grid_name = 'spatial_grid')"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"spatial-network","dir":"Articles","previous_headings":"","what":"8. Spatial Network","title":"Visium CytAssist Human Lung Cancer","text":"","code":"## Delaunay network: stats + creation plotStatDelaunayNetwork(gobject = visium_lungcancer, maximum_distance = 400) visium_lungcancer = createSpatialNetwork(gobject = visium_lungcancer, minimum_k = 0) showNetworks(visium_lungcancer) spatPlot(gobject = visium_lungcancer, show_network = T, network_color = 'blue', spatial_network_name = 'Delaunay_network')"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"spatial-genes","dir":"Articles","previous_headings":"","what":"9. Spatial Genes","title":"Visium CytAssist Human Lung Cancer","text":"","code":"# kmeans binarization kmtest = binSpect(visium_lungcancer) spatFeatPlot2D(visium_lungcancer, expression_values = 'scaled',                feats = kmtest$feats[1:6], cow_n_col = 2, point_size = 1.5) ## rank binarization ranktest = binSpect(visium_lungcancer, bin_method = 'rank') spatFeatPlot2D(visium_lungcancer, expression_values = 'scaled',                feats = ranktest$feats[1:6], cow_n_col = 2, point_size = 1.5) ## spatially correlated genes ## ext_spatial_genes = kmtest[1:500]$feats  # 1. calculate gene spatial correlation and single-cell correlation # create spatial correlation object spat_cor_netw_DT = detectSpatialCorFeats(visium_lungcancer,                                          method = 'network',                                          spatial_network_name = 'Delaunay_network',                                          subset_feats = ext_spatial_genes)  # 2. identify most similar spatially correlated genes for one gene DNAI1_top10_genes = showSpatialCorFeats(spat_cor_netw_DT, feats = 'DNAI1', show_top_feats = 10)  spatFeatPlot2D(visium_lungcancer, expression_values = 'scaled',                feats = c('RSPH1', 'C20orf85', 'DNAAF1','TEKT2'), point_size = 3) spatFeatPlot2D(visium_lungcancer, expression_values = 'scaled',                feats = c('TEKT2', 'CFAP157', 'MAPK15', 'MS4A8', 'CDHR3', 'C9orf24'), point_size = 3) # 3. cluster correlated genes & visualize spat_cor_netw_DT = clusterSpatialCorFeats(spat_cor_netw_DT, name = ‘spat_netw_clus’, k = 10)  heatmSpatialCorFeats(visium_lungcancer, spatCorObject = spat_cor_netw_DT, use_clus_name = ‘spat_netw_clus’, save_param = c(save_name = ‘22-z1-heatmap_correlated_genes’, save_format = ‘pdf’, base_height = 6, base_width = 8, units = ‘cm’), heatmap_legend_param = list(title = NULL)) # 4. rank spatial correlated clusters and show genes for selected clusters netw_ranks = rankSpatialCorGroups(visium_lungcancer,                                   spatCorObject = spat_cor_netw_DT,                                   use_clus_name = 'spat_netw_clus',                                   save_param = c(save_name = '22-z2-rank_correlated_groups',                                                  base_height = 3, base_width = 5))  top_netw_spat_cluster = showSpatialCorFeats(spat_cor_netw_DT, use_clus_name = 'spat_netw_clus',                                             selected_clusters = 6, show_top_feats = 1) # 5. create metagene enrichment score for clusters cluster_genes_DT = showSpatialCorFeats(spat_cor_netw_DT, use_clus_name = 'spat_netw_clus', show_top_feats = 1) cluster_genes = cluster_genes_DT$clus; names(cluster_genes) = cluster_genes_DT$feat_ID  visium_lungcancer = createMetafeats(visium_lungcancer, feat_clusters = cluster_genes, name = 'cluster_metagene')  showGiottoSpatEnrichments(visium_lungcancer)  spatCellPlot(visium_lungcancer,              spat_enr_names = 'cluster_metagene',              cell_annotation_values = netw_ranks$clusters,              point_size = 1.5, cow_n_col = 4)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_cytassist_lungcancer.html","id":"hmrf-domains","dir":"Articles","previous_headings":"","what":"10. HMRF Domains","title":"Visium CytAssist Human Lung Cancer","text":"","code":"# HMRF requires a fully connected network! visium_lungcancer = createSpatialNetwork(gobject = visium_lungcancer, minimum_k = 2, name = 'Delaunay_full')  # spatial genes my_spatial_genes <- kmtest[1:100]$feats  # do HMRF with different betas hmrf_folder = paste0(results_folder,'/','HMRF_results/') if(!file.exists(hmrf_folder)) dir.create(hmrf_folder, recursive = T)  # if Rscript is not found, you might have to create a symbolic link, e.g. # cd /usr/local/bin # sudo ln -s /Library/Frameworks/R.framework/Resources/Rscript Rscript HMRF_spatial_genes = doHMRF(gobject = visium_lungcancer,                             expression_values = 'scaled',                             spatial_network_name = 'Delaunay_full',                             spatial_genes = my_spatial_genes,                             k = 5,                             betas = c(0, 10, 3),                             output_folder = paste0(hmrf_folder, '/', 'Spatial_genes/SG_topgenes_k5_scaled'))  ## alternative way to view HMRF results # results = writeHMRFresults(gobject = ST_test, #                            HMRFoutput = HMRF_spatial_genes, #                            k = 5, betas_to_view = seq(0, 25, by = 5)) # ST_test = addCellMetadata(ST_test, new_metadata = results, by_column = T, column_cell_ID = 'cell_ID')  ## add HMRF of interest to giotto object visium_lungcancer = addHMRF(gobject = visium_lungcancer,                             HMRFoutput = HMRF_spatial_genes,                             k = 5, betas_to_add = c(0,10,20),                             hmrf_name = 'HMRF')  showGiottoSpatEnrichments(visium_lungcancer)  ## visualize spatPlot(gobject = visium_lungcancer, cell_color = 'HMRF_k5_b.0', point_size = 3) spatPlot(gobject = visium_lungcancer, cell_color = 'HMRF_k5_b.10', point_size = 3) sessionInfo()  R version 4.2.2 (2022-10-31) Platform: aarch64-apple-darwin20 (64-bit) Running under: macOS Monterey 12.5.1  Matrix products: default LAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib  locale: [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8  attached base packages: [1] stats     graphics  grDevices utils     datasets  methods   base  other attached packages: [1] Giotto_3.0.1  loaded via a namespace (and not attached):  [1] bitops_1.0-7                matrixStats_0.63.0          fs_1.5.2  [4] usethis_2.1.6               devtools_2.4.5              GenomeInfoDb_1.34.3  [7] tools_4.2.2                 profvis_0.3.7               utf8_1.2.2 [10] R6_2.5.1                    irlba_2.3.5.1               BiocGenerics_0.44.0 [13] colorspace_2.0-3            urlchecker_1.0.1            tidyselect_1.2.0 [16] prettyunits_1.1.1           processx_3.8.0              compiler_4.2.2 [19] cli_3.4.1                   Biobase_2.58.0              BiocNeighbors_1.16.0 [22] DelayedArray_0.24.0         scales_1.2.1                callr_3.7.3 [25] stringr_1.4.1               digest_0.6.30               XVector_0.38.0 [28] pkgconfig_2.0.3             htmltools_0.5.3             sessioninfo_1.2.2 [31] sparseMatrixStats_1.10.0    MatrixGenerics_1.10.0       fastmap_1.1.0 [34] limma_3.54.0                htmlwidgets_1.5.4           rlang_1.0.6 [37] rstudioapi_0.14             shiny_1.7.3                 DelayedMatrixStats_1.20.0 [40] generics_0.1.3              BiocParallel_1.32.1         dplyr_1.0.10 [43] RCurl_1.98-1.9              magrittr_2.0.3              BiocSingular_1.14.0 [46] GenomeInfoDbData_1.2.9      Matrix_1.5-3                Rcpp_1.0.9 [49] munsell_0.5.0               S4Vectors_0.36.0            fansi_1.0.3 [52] lifecycle_1.0.3             stringi_1.7.8               SummarizedExperiment_1.28.0 [55] zlibbioc_1.44.0             pkgbuild_1.3.1              grid_4.2.2 [58] parallel_4.2.2              promises_1.2.0.1            dqrng_0.3.0 [61] crayon_1.5.2                miniUI_0.1.1.1              lattice_0.20-45 [64] beachmat_2.14.0             locfit_1.5-9.6              ps_1.7.2 [67] pillar_1.8.1                igraph_1.3.5                GenomicRanges_1.50.1 [70] codetools_0.2-18            ScaledMatrix_1.6.0          stats4_4.2.2 [73] pkgload_1.3.2               glue_1.6.2                  data.table_1.14.6 [76] remotes_2.4.2               BiocManager_1.30.19         vctrs_0.5.1 [79] httpuv_1.6.6                gtable_0.3.1                purrr_0.3.5 [82] cachem_1.0.6                ggplot2_3.4.0               rsvd_1.0.5 [85] mime_0.12                   xtable_1.8-4                later_1.3.0 [88] SingleCellExperiment_1.20.0 tibble_3.1.8                memoise_2.0.1 [91] IRanges_2.32.0              cluster_2.1.4               bluster_1.8.0 [94] ellipsis_0.3.2"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"set-up-giotto-environment","dir":"Articles","previous_headings":"","what":"Set up Giotto Environment","title":"Visium Mouse Brain","text":"","code":"# Ensure Giotto Suite is installed. if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") }  # Ensure GiottoData, a small, helper module for tutorials, is installed. if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") }  library(Giotto)  # Ensure the Python environment for Giotto has been installed. genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment.   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"Dataset explanation","title":"Visium Mouse Brain","text":"10X genomics recently launched new platform obtain spatial expression data using Visium Spatial Gene Expression slide. Visium brain data run tutorial can found Visium technology:  High resolution png original tissue: []images/general_figs/mouse_brain_highres.png)","code":""},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-1-create-giotto-visium-object-and-visualize","dir":"Articles","previous_headings":"","what":"Part 1: Create Giotto Visium Object and visualize","title":"Visium Mouse Brain","text":"","code":"library(Giotto) library(GiottoData)  # 1. set working directory results_folder = 'path/to/result'  # Optional: Specify a path to a Python executable within a conda or miniconda  # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired.  # 3. Create Giotto Instructions instrs = createGiottoInstructions(save_dir = results_folder,                                   save_plot = TRUE,                                   show_plot = FALSE,                                   python_path = my_python_path) ## provide path to visium folder data_path = '/path/to/Brain_data/'  ## directly from visium folder visium_brain = createGiottoVisiumObject(visium_dir = data_path,                                         expr_data = 'raw',                                         png_name = 'tissue_lowres_image.png',                                         gene_column_index = 2,                                         instructions = instrs)  ## show associated images with giotto object showGiottoImageNames(visium_brain) # \"image\" is the default name  ## check metadata pDataDT(visium_brain)  ## show plot spatPlot2D(gobject = visium_brain,             cell_color = 'in_tissue',             point_size = 2,            cell_color_code = c('0' = 'lightgrey', '1' = 'blue'),             show_image = T,             image_name = 'image')"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-2-process-giotto-visium-object","dir":"Articles","previous_headings":"","what":"Part 2: Process Giotto Visium Object","title":"Visium Mouse Brain","text":"","code":"## subset on spots that were covered by tissue metadata = pDataDT(visium_brain) in_tissue_barcodes = metadata[in_tissue == 1]$cell_ID visium_brain = subsetGiotto(visium_brain,                              cell_ids = in_tissue_barcodes)  ## filter visium_brain <- filterGiotto(gobject = visium_brain,                              expression_threshold = 1,                              feat_det_in_min_cells = 50,                              min_det_feats_per_cell = 1000,                              expression_values = c('raw'),                              verbose = T)  ## normalize visium_brain <- normalizeGiotto(gobject = visium_brain,                                  scalefactor = 6000,                                  verbose = T)  ## add gene & cell statistics visium_brain <- addStatistics(gobject = visium_brain)  ## visualize spatPlot2D(gobject = visium_brain,             show_image = T,             point_alpha = 0.7,            cell_color = 'nr_feats',             color_as_factor = F)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-3-dimension-reduction","dir":"Articles","previous_headings":"","what":"Part 3: Dimension Reduction","title":"Visium Mouse Brain","text":"","code":"## highly variable features / genes (HVF) visium_brain <- calculateHVF(gobject = visium_brain,                               save_plot = TRUE) ## run PCA on expression values (default) gene_metadata = fDataDT(visium_brain) featgenes = gene_metadata[hvf == 'yes' & perc_cells > 3 & mean_expr_det > 0.4]$feat_ID  ## run PCA on expression values (default) visium_brain <- runPCA(gobject = visium_brain,                        feats_to_use = featgenes)  screePlot(visium_brain, ncp = 30) dimPlot2D(gobject = visium_brain,           dim_reduction_to_use = \"pca\") ## run UMAP and tSNE on PCA space (default) visium_brain <- runUMAP(visium_brain,                          dimensions_to_use = 1:10) plotUMAP(gobject = visium_brain) visium_brain <- runtSNE(visium_brain,                          dimensions_to_use = 1:10) plotTSNE(gobject = visium_brain)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-4-cluster","dir":"Articles","previous_headings":"","what":"Part 4: Cluster","title":"Visium Mouse Brain","text":"Plot group :  Highlight one groups:","code":"## sNN network (default) visium_brain <- createNearestNetwork(gobject = visium_brain,                                       dimensions_to_use = 1:10,                                       k = 15)  ## Leiden clustering visium_brain <- doLeidenCluster(gobject = visium_brain,                                  resolution = 0.4,                                  n_iterations = 1000)  plotUMAP(gobject = visium_brain,          cell_color = 'leiden_clus',           show_NN_network = T,           point_size = 2.5) # spatial and dimension plots spatDimPlot(gobject = visium_brain,              cell_color = 'leiden_clus',             dim_point_size = 2,              spat_point_size = 2.5) spatDimPlot(gobject = visium_brain,              cell_color = 'nr_feats',              color_as_factor = F,             dim_point_size = 2,              spat_point_size = 2.5) # dimension plots grouped by cluster spatPlot2D(visium_brain,             cell_color = 'leiden_clus',            coord_fix_ratio = 1) spatPlot2D(visium_brain,             cell_color = 'leiden_clus',            group_by = 'leiden_clus',             coord_fix_ratio = 1,            cow_n_col = 6,             show_legend = F,            save_param = list(base_width = 14, base_height = 14)) spatPlot2D(visium_brain,             cell_color = 'leiden_clus',            select_cell_groups = '8',             coord_fix_ratio = 1,             show_other_cells = TRUE,            cell_color_code = c('8' = 'red'),             other_cell_color = \"grey\",             other_point_size = 1.5,            save_param = list(base_width = 7, base_height = 7))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-5-subset-data","dir":"Articles","previous_headings":"","what":"Part 5: subset data","title":"Visium Mouse Brain","text":"","code":"# create and show subset DG_subset = subsetGiottoLocs(visium_brain,                              x_max = 6500, x_min = 3000,                              y_max = -2500, y_min = -5500,                              return_gobject = TRUE)  spatDimPlot(gobject = DG_subset,             cell_color = 'leiden_clus',              spat_point_size = 5)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-6-marker-gene-detection-for-clusters","dir":"Articles","previous_headings":"","what":"Part 6: marker gene detection for clusters","title":"Visium Mouse Brain","text":"","code":"## ------------------ ## ## Gini markers gini_markers_subclusters = findMarkers_one_vs_all(gobject = visium_brain,                                                   method = 'gini',                                                   expression_values = 'normalized',                                                   cluster_column = 'leiden_clus',                                                   min_feats = 20,                                                   min_expr_gini_score = 0.5,                                                   min_det_gini_score = 0.5)  topgenes_gini = gini_markers_subclusters[, head(.SD, 2), by = 'cluster']$feats  # violinplot violinPlot(visium_brain,             feats = unique(topgenes_gini),             cluster_column = 'leiden_clus',            strip_text = 8,             strip_position = 'right',            save_param = list(base_width = 5, base_height = 10)) # cluster heatmap plotMetaDataHeatmap(visium_brain,                      selected_feats = unique(topgenes_gini),                     metadata_cols = c('leiden_clus'),                     x_text_size = 10, y_text_size = 10) # umap plots dimFeatPlot2D(visium_brain,                expression_values = 'scaled',               feats = gini_markers_subclusters[, head(.SD, 1), by = 'cluster']$feats,               cow_n_col = 4,                point_size = 0.75,               save_param = list(base_width = 8, base_height = 8)) ## ------------------ ## # Scran Markers scran_markers_subclusters = findMarkers_one_vs_all(gobject = visium_brain,                                                    method = 'scran',                                                    expression_values = 'normalized',                                                    cluster_column = 'leiden_clus')  topgenes_scran = scran_markers_subclusters[, head(.SD, 2), by = 'cluster']$feats  # violinplot violinPlot(visium_brain,             feats = unique(topgenes_scran),             cluster_column = 'leiden_clus',            strip_text = 10, strip_position = 'right',            save_param = list(base_width = 5)) # cluster heatmap plotMetaDataHeatmap(visium_brain,                      selected_feats = topgenes_scran,                     metadata_cols = c('leiden_clus')) # umap plots dimFeatPlot2D(visium_brain,                expression_values = 'scaled',               feats = scran_markers_subclusters[, head(.SD, 1), by = 'cluster']$feats,               cow_n_col = 3,                point_size = 1,               save_param = list(base_width = 8, base_height = 8))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-7-cell-type-enrichment","dir":"Articles","previous_headings":"","what":"Part 7: Cell type enrichment","title":"Visium Mouse Brain","text":"Visium spatial transcriptomics provide single-cell resolution, making cell type annotation harder problem. Giotto provides several ways calculate enrichment specific cell-type signature gene lists: PAGE hypergeometric test Rank DWLS Deconvolution Corresponded Single cell dataset can generated . Giotto_SC processed downsampled Loom file can also downloaded GiottoData::getSpatialDataset().","code":"# download data to results directory #### # if wget is installed, set method = 'wget' # if you run into authentication issues with wget, then add \" extra = '--no-check-certificate' \" GiottoData::getSpatialDataset(dataset = 'scRNA_mouse_brain', directory = results_folder)  sc_expression = paste0(results_folder, \"/brain_sc_expression_matrix.txt.gz\") sc_metadata = paste0(results_folder,\"/brain_sc_metadata.csv\")  giotto_SC = createGiottoObject(expression = sc_expression,                                instructions = instrs)  giotto_SC = addCellMetadata(giotto_SC,                              new_metadata = data.table::fread(sc_metadata))  giotto_SC = normalizeGiotto(giotto_SC)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"page-enrichment","dir":"Articles","previous_headings":"Part 7: Cell type enrichment","what":"7.1 PAGE enrichment","title":"Visium Mouse Brain","text":"","code":"# Create PAGE matrix # PAGE matrix should be a binary matrix with each row represent a gene marker and each column represent a cell type # There are several ways to create PAGE matrix # 1.1 create binary matrix of cell signature genes # small example # gran_markers = c(\"Nr3c2\", \"Gabra5\", \"Tubgcp2\", \"Ahcyl2\",                  \"Islr2\", \"Rasl10a\", \"Tmem114\", \"Bhlhe22\",                   \"Ntf3\", \"C1ql2\")  oligo_markers = c(\"Efhd1\", \"H2-Ab1\", \"Enpp6\", \"Ninj2\",                   \"Bmp4\", \"Tnr\", \"Hapln2\", \"Neu4\",                   \"Wfdc18\", \"Ccp110\")          di_mesench_markers = c(\"Cartpt\", \"Scn1a\", \"Lypd6b\",  \"Drd5\",                        \"Gpr88\", \"Plcxd2\", \"Cpne7\", \"Pou4f1\",                        \"Ctxn2\", \"Wnt4\")  PAGE_matrix_1 = makeSignMatrixPAGE(sign_names = c('Granule_neurons',                                                   'Oligo_dendrocytes',                                                   'di_mesenchephalon'),                                    sign_list = list(gran_markers,                                                     oligo_markers,                                                     di_mesench_markers))    # ----  # 1.2 [shortcut] fully pre-prepared matrix for all cell types sign_matrix_path = system.file(\"extdata\", \"sig_matrix.txt\", package = 'GiottoData') brain_sc_markers = data.table::fread(sign_matrix_path)  PAGE_matrix_2 = as.matrix(brain_sc_markers[,-1]) rownames(PAGE_matrix_2) = brain_sc_markers$Event   # ---  # 1.3 make PAGE matrix from single cell dataset markers_scran = findMarkers_one_vs_all(gobject=giotto_SC,                                         method=\"scran\",                                        expression_values=\"normalized\",                                        cluster_column = \"Class\",                                         min_feats=3)  top_markers = markers_scran[, head(.SD, 10), by=\"cluster\"] celltypes = levels(factor(markers_scran$cluster))   sign_list = list()  for (i in 1:length(celltypes)){   sign_list[[i]] = top_markers[which(top_markers$cluster == celltypes[i]),]$feats }  PAGE_matrix_3 = makeSignMatrixPAGE(sign_names = celltypes,                                    sign_list = sign_list)  # 1.4 enrichment test with PAGE  # runSpatialEnrich() can also be used as a wrapper for all currently provided enrichment options visium_brain = runPAGEEnrich(gobject = visium_brain,                               sign_matrix = PAGE_matrix_2)  # 1.5 heatmap of enrichment versus annotation (e.g. clustering result) cell_types_PAGE = colnames(PAGE_matrix_2)  plotMetaDataCellsHeatmap(gobject = visium_brain,                          metadata_cols = 'leiden_clus',                          value_cols = cell_types_PAGE,                          spat_enr_names = 'PAGE',                          x_text_size = 8,                          y_text_size = 8) # 1.6 visualizations spatCellPlot2D(gobject = visium_brain,                spat_enr_names = 'PAGE',                cell_annotation_values = cell_types_PAGE[1:4],                cow_n_col = 2,                coord_fix_ratio = 1,                 point_size = 1.25,                 show_legend = T) spatDimCellPlot2D(gobject = visium_brain,                   spat_enr_names = 'PAGE',                   cell_annotation_values = cell_types_PAGE[1:4],                   cow_n_col = 1,                    spat_point_size = 1,                   plot_alignment = 'horizontal',                   save_param = list(base_width=7, base_height=10))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"hypergeometric-test","dir":"Articles","previous_headings":"Part 7: Cell type enrichment","what":"7.2 HyperGeometric test","title":"Visium Mouse Brain","text":"","code":"visium_brain = runHyperGeometricEnrich(gobject = visium_brain,                                        expression_values = \"normalized\",                                        sign_matrix = PAGE_matrix_2)  cell_types_HyperGeometric = colnames(PAGE_matrix_2)  spatCellPlot(gobject = visium_brain,              spat_enr_names = 'hypergeometric',              cell_annotation_values = cell_types_HyperGeometric[1:4],              cow_n_col = 2,              coord_fix_ratio = NULL,               point_size = 1.75)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"rank-enrichment","dir":"Articles","previous_headings":"Part 7: Cell type enrichment","what":"7.3 Rank Enrichment","title":"Visium Mouse Brain","text":"","code":"# Create rank matrix, not that rank matrix is different from PAGE # A count matrix and a vector for all cell labels will be needed rank_matrix = makeSignMatrixRank(sc_matrix = getExpression(giotto_SC,                                                            values = \"normalized\",                                                            output = \"matrix\"),                                  sc_cluster_ids = pDataDT(giotto_SC)$Class)  colnames(rank_matrix) = levels(factor(pDataDT(giotto_SC)$Class))  visium_brain = runRankEnrich(gobject = visium_brain,                               sign_matrix = rank_matrix,                              expression_values = \"normalized\")  # Plot Rank enrichment result spatCellPlot2D(gobject = visium_brain,                spat_enr_names = 'rank',                cell_annotation_values = colnames(rank_matrix)[1:4],                cow_n_col = 2,                coord_fix_ratio = 1,                 point_size = 1,                save_param = list(save_name = \"spat_enr_Rank_plot\"))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"dwls-spatial-deconvolution","dir":"Articles","previous_headings":"Part 7: Cell type enrichment","what":"7.4 DWLS spatial deconvolution","title":"Visium Mouse Brain","text":"","code":"# Create DWLS matrix, not that DWLS matrix is different from PAGE and rank # A count matrix a vector for a list of gene signatures and a vector for all cell labels will be needed DWLS_matrix = makeSignMatrixDWLSfromMatrix(matrix = getExpression(giotto_SC,                                                                   values = \"normalized\",                                                                   output = \"matrix\"),                                            cell_type = pDataDT(giotto_SC)$Class,                                            sign_gene = top_markers$feats)  visium_brain = runDWLSDeconv(gobject = visium_brain,                               sign_matrix = DWLS_matrix)   # Plot DWLS deconvolution result spatCellPlot2D(gobject = visium_brain,                spat_enr_names = 'DWLS',                cell_annotation_values = levels(factor(pDataDT(giotto_SC)$Class))[1:4],                cow_n_col = 2,                coord_fix_ratio = 1,                 point_size = 1,                save_param = list(save_name = \"DWLS_plot\")) # Plot DWLS deconvolution result with Pie plots spatDeconvPlot(visium_brain,                 show_image = T,                radius = 50,                save_param = list(save_name = \"spat_DWLS_pie_plot\"))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-8-spatial-grid","dir":"Articles","previous_headings":"","what":"Part 8: Spatial Grid","title":"Visium Mouse Brain","text":"","code":"visium_brain = createSpatialGrid(gobject = visium_brain,                                  sdimx_stepsize = 400,                                  sdimy_stepsize = 400,                                  minimum_padding = 0)  showGiottoSpatGrids(visium_brain)  spatPlot2D(visium_brain,             cell_color = 'leiden_clus',             show_grid = T,            grid_color = 'red',             spatial_grid_name = 'spatial_grid')"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-9-spatial-network","dir":"Articles","previous_headings":"","what":"Part 9: spatial network","title":"Visium Mouse Brain","text":"","code":"visium_brain = createSpatialNetwork(gobject = visium_brain,                                     method = 'kNN',                                      k = 5,                                     maximum_distance_knn = 400,                                     name = 'spatial_network')  showGiottoSpatNetworks(visium_brain)  spatPlot2D(gobject = visium_brain,              show_network= T,            network_color = 'blue',             spatial_network_name = 'spatial_network')"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-10-spatial-genes","dir":"Articles","previous_headings":"","what":"Part 10: Spatial Genes","title":"Visium Mouse Brain","text":"","code":"## rank binarization ranktest = binSpect(visium_brain,                      bin_method = 'rank',                     calc_hub = T,                      hub_min_int = 5,                     spatial_network_name = 'spatial_network')  spatFeatPlot2D(visium_brain,                 expression_values = 'scaled',                feats = ranktest$feats[1:6],                 cow_n_col = 2,                 point_size = 1.5)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-11-spatial-co-expression-modules","dir":"Articles","previous_headings":"","what":"Part 11: Spatial Co-Expression modules","title":"Visium Mouse Brain","text":"","code":"# cluster the top 500 spatial genes into 20 clusters ext_spatial_genes = ranktest[1:1500,]$feats  # here we use existing detectSpatialCorGenes function to calculate pairwise distances between genes (but set network_smoothing=0 to use default clustering) spat_cor_netw_DT = detectSpatialCorFeats(visium_brain,                                          method = 'network',                                          spatial_network_name = 'spatial_network',                                          subset_feats = ext_spatial_genes)  # 2. identify most similar spatially correlated genes for one gene top10_genes = showSpatialCorFeats(spat_cor_netw_DT,                                    feats = 'Ptprn',                                    show_top_feats = 10)  spatFeatPlot2D(visium_brain,                 expression_values = 'scaled',                feats = top10_genes$variable[1:4],                 point_size = 3) # cluster spatial genes spat_cor_netw_DT = clusterSpatialCorFeats(spat_cor_netw_DT,                                            name = 'spat_netw_clus',                                            k = 20)  # visualize clusters heatmSpatialCorFeats(visium_brain,                      spatCorObject = spat_cor_netw_DT,                      use_clus_name = 'spat_netw_clus',                      heatmap_legend_param = list(title = NULL),                      save_param = list(base_height = 6, base_width = 8, units = 'cm')) # 4. rank spatial correlated clusters and show genes for selected clusters netw_ranks = rankSpatialCorGroups(visium_brain,                                   spatCorObject = spat_cor_netw_DT,                                    use_clus_name = 'spat_netw_clus',                                   save_param = list(  base_height = 3, base_width = 5))  top_netw_spat_cluster = showSpatialCorFeats(spat_cor_netw_DT,                                              use_clus_name = 'spat_netw_clus',                                             selected_clusters = 6,                                              show_top_feats = 1) # 5. create metagene enrichment score for clusters cluster_genes_DT = showSpatialCorFeats(spat_cor_netw_DT,                                         use_clus_name = 'spat_netw_clus',                                         show_top_feats = 1) cluster_genes = cluster_genes_DT$clus  names(cluster_genes) = cluster_genes_DT$feat_ID  visium_brain = createMetafeats(visium_brain,                                 feat_clusters = cluster_genes,                                 name = 'cluster_metagene')  #showGiottoSpatEnrichments(visium_brain)  spatCellPlot(visium_brain,              spat_enr_names = 'cluster_metagene',              cell_annotation_values = netw_ranks$clusters,              point_size = 1,               cow_n_col = 5,               save_param = list(base_width = 15))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-12-spatially-informed-clusters","dir":"Articles","previous_headings":"","what":"Part 12: Spatially informed clusters","title":"Visium Mouse Brain","text":"","code":"# top 30 genes per spatial co-expression cluster table(spat_cor_netw_DT$cor_clusters$spat_netw_clus)  coexpr_dt = data.table::data.table(genes = names(spat_cor_netw_DT$cor_clusters$spat_netw_clus),                                    cluster = spat_cor_netw_DT$cor_clusters$spat_netw_clus)  data.table::setorder(coexpr_dt, cluster) top30_coexpr_dt = coexpr_dt[, head(.SD, 30) , by = cluster] my_spatial_genes = top30_coexpr_dt$genes   visium_brain = runPCA(gobject = visium_brain,                       feats_to_use = my_spatial_genes,                       name = 'custom_pca')  visium_brain = runUMAP(visium_brain,                         dim_reduction_name = 'custom_pca',                         dimensions_to_use = 1:20,                        name = 'custom_umap')  visium_brain = createNearestNetwork(gobject = visium_brain,                                     dim_reduction_name = 'custom_pca',                                     dimensions_to_use = 1:20,                                      k = 5,                                     name = 'custom_NN')  visium_brain = doLeidenCluster(gobject = visium_brain,                                 network_name = 'custom_NN',                                resolution = 0.15,                                 n_iterations = 1000,                                name = 'custom_leiden')  cell_meta = pDataDT(visium_brain) cell_clusters = unique(cell_meta$custom_leiden)  selected_colors = getDistinctColors(length(cell_clusters)) names(selected_colors) = cell_clusters  spatPlot2D(visium_brain,             cell_color = 'custom_leiden',             cell_color_code = selected_colors,             coord_fix_ratio = 1) plotUMAP(gobject = visium_brain,           cell_color = 'custom_leiden',           cell_color_code = selected_colors,           point_size = 1.5)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_brain.html","id":"part-13-spatial-domains-with-hmrf","dir":"Articles","previous_headings":"","what":"Part 13: Spatial domains with HMRF","title":"Visium Mouse Brain","text":"","code":"# do HMRF with different betas on top 30 genes per spatial co-expression module hmrf_folder = paste0(results_folder,'/','11_HMRF/') if(!file.exists(hmrf_folder)) dir.create(hmrf_folder, recursive = T)  HMRF_spatial_genes = doHMRF(gobject = visium_brain,                             expression_values = 'scaled',                             spatial_genes = my_spatial_genes,                              k = 20,                             spatial_network_name=\"spatial_network\",                             betas = c(0, 10, 5),                             output_folder = paste0(hmrf_folder, '/', 'Spatial_genes/SG_topgenes_k20_scaled'))  visium_brain = addHMRF(gobject = visium_brain,                         HMRFoutput = HMRF_spatial_genes,                        k = 20,                         betas_to_add = c(0, 10, 20, 30, 40),                        hmrf_name = 'HMRF')  spatPlot2D(gobject = visium_brain,             cell_color = 'HMRF_k20_b.40')"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"Dataset explanation","title":"Visium Mouse Kidney","text":"10X genomics recently launched new platform obtain spatial expression data using Visium Spatial Gene Expression slide. Visium kidney data run tutorial can found Visium technology:  High resolution png original tissue:","code":""},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"giotto-global-instructions-and-preparations","dir":"Articles","previous_headings":"","what":"1. Giotto global instructions and preparations","title":"Visium Mouse Kidney","text":"","code":"## create instructions instrs = createGiottoInstructions(save_dir = results_folder,                                   save_plot = TRUE,                                   show_plot = FALSE,                                   python_path = python_path)  ## provide path to visium folder data_path = '/path/to/Kidney_data/'"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"create-giotto-object-process-data","dir":"Articles","previous_headings":"","what":"2. Create Giotto object & process data","title":"Visium Mouse Kidney","text":"","code":"## directly from visium folder visium_kidney = createGiottoVisiumObject(visium_dir = data_path,                                          expr_data = 'raw',                                          png_name = 'tissue_lowres_image.png',                                          gene_column_index = 2,                                          instructions = instrs)  ## check metadata pDataDT(visium_kidney)  # check available image names showGiottoImageNames(visium_kidney) # \"image\" is the default name  ## show aligned image spatPlot(gobject = visium_kidney, cell_color = 'in_tissue', show_image = T, point_alpha = 0.7) ## subset on spots that were covered by tissue metadata = pDataDT(visium_kidney) in_tissue_barcodes = metadata[in_tissue == 1]$cell_ID visium_kidney = subsetGiotto(visium_kidney, cell_ids = in_tissue_barcodes)  ## filter visium_kidney <- filterGiotto(gobject = visium_kidney,                               expression_threshold = 1,                               feat_det_in_min_cells = 50,                               min_det_feats_per_cell = 1000,                               expression_values = c('raw'),                               verbose = T)  ## normalize visium_kidney <- normalizeGiotto(gobject = visium_kidney, scalefactor = 6000, verbose = T)  ## add gene & cell statistics visium_kidney <- addStatistics(gobject = visium_kidney)  ## visualize spatPlot2D(gobject = visium_kidney, show_image = T, point_alpha = 0.7) spatPlot2D(gobject = visium_kidney, show_image = T, point_alpha = 0.7,            cell_color = 'nr_feats', color_as_factor = F)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"dimension-reduction","dir":"Articles","previous_headings":"","what":"3. Dimension reduction","title":"Visium Mouse Kidney","text":"","code":"## highly variable features (genes) visium_kidney <- calculateHVF(gobject = visium_kidney) ## run PCA on expression values (default) visium_kidney <- runPCA(gobject = visium_kidney) screePlot(visium_kidney, ncp = 30) plotPCA(gobject = visium_kidney) ## run UMAP and tSNE on PCA space (default) visium_kidney <- runUMAP(visium_kidney, dimensions_to_use = 1:10) plotUMAP(gobject = visium_kidney) visium_kidney <- runtSNE(visium_kidney, dimensions_to_use = 1:10) plotTSNE(gobject = visium_kidney)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"clustering","dir":"Articles","previous_headings":"","what":"4. Clustering","title":"Visium Mouse Kidney","text":"","code":"## sNN network (default) visium_kidney <- createNearestNetwork(gobject = visium_kidney, dimensions_to_use = 1:10, k = 15) ## Leiden clustering visium_kidney <- doLeidenCluster(gobject = visium_kidney, resolution = 0.4, n_iterations = 1000) plotUMAP(gobject = visium_kidney, cell_color = 'leiden_clus', show_NN_network = T, point_size = 2.5)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"co-visualize","dir":"Articles","previous_headings":"","what":"5. Co-visualize","title":"Visium Mouse Kidney","text":"","code":"# expression and spatial spatDimPlot(gobject = visium_kidney, cell_color = 'leiden_clus',             dim_point_size = 2, spat_point_size = 2.5) spatDimPlot(gobject = visium_kidney, cell_color = 'nr_feats', color_as_factor = F,             dim_point_size = 2, spat_point_size = 2.5)"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"gini","dir":"Articles","previous_headings":"6. Cell type marker gene detection","what":"gini","title":"Visium Mouse Kidney","text":"","code":"gini_markers_subclusters = findMarkers_one_vs_all(gobject = visium_kidney,                                                   method = 'gini',                                                   expression_values = 'normalized',                                                   cluster_column = 'leiden_clus',                                                   min_featss = 20,                                                   min_expr_gini_score = 0.5,                                                   min_det_gini_score = 0.5) topgenes_gini = gini_markers_subclusters[, head(.SD, 2), by = 'cluster']$feats  # violinplot violinPlot(visium_kidney, feats = unique(topgenes_gini), cluster_column = 'leiden_clus',            strip_text = 8, strip_position = 'right') violinPlot(visium_kidney, feats = unique(topgenes_gini), cluster_column = 'leiden_clus',            strip_text = 8, strip_position = 'right',            save_param = c(save_name = '11-z1-violinplot_gini', base_width = 5, base_height = 10)) # cluster heatmap plotMetaDataHeatmap(visium_kidney,                     selected_feats = topgenes_gini,                     metadata_cols = c('leiden_clus'),                     x_text_size = 10, y_text_size = 10) # umap plots dimFeatPlot2D(visium_kidney,               expression_values = 'scaled',               feats = gini_markers_subclusters[, head(.SD, 1), by = 'cluster']$feats,               cow_n_col = 3, point_size = 1)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"scran","dir":"Articles","previous_headings":"6. Cell type marker gene detection","what":"scran","title":"Visium Mouse Kidney","text":"","code":"scran_markers_subclusters = findMarkers_one_vs_all(gobject = visium_kidney,                                                    method = 'scran',                                                    expression_values = 'normalized',                                                    cluster_column = 'leiden_clus') topgenes_scran = scran_markers_subclusters[, head(.SD, 2), by = 'cluster']$feats  violinPlot(visium_kidney, feats = unique(topgenes_scran),            cluster_column = 'leiden_clus',            strip_text = 10, strip_position = 'right') # cluster heatmap plotMetaDataHeatmap(visium_kidney, selected_feats = topgenes_scran,                     metadata_cols = c('leiden_clus')) # umap plots dimFeatPlot2D(visium_kidney, expression_values = 'scaled',               feats = scran_markers_subclusters[, head(.SD, 1), by = 'cluster']$feats,               cow_n_col = 3, point_size = 1)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"cell-type-annotation","dir":"Articles","previous_headings":"","what":"7. cell-type annotation","title":"Visium Mouse Kidney","text":"Visium spatial transcriptomics provide single-cell resolution, making cell type annotation harder problem. Giotto provides 3 ways calculate enrichment specific cell-type signature gene list: PAGE rank hypergeometric test","code":""},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"spatial-grid","dir":"Articles","previous_headings":"","what":"8. Spatial grid","title":"Visium Mouse Kidney","text":"","code":"visium_kidney <- createSpatialGrid(gobject = visium_kidney,                                    sdimx_stepsize = 400,                                    sdimy_stepsize = 400,                                    minimum_padding = 0) spatPlot(visium_kidney, cell_color = 'leiden_clus', show_grid = T,          grid_color = 'red', spatial_grid_name = 'spatial_grid')"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"spatial-network","dir":"Articles","previous_headings":"","what":"9. spatial network","title":"Visium Mouse Kidney","text":"","code":"## delaunay network: stats + creation plotStatDelaunayNetwork(gobject = visium_kidney, maximum_distance = 400) visium_kidney = createSpatialNetwork(gobject = visium_kidney, minimum_k = 0) showNetworks(visium_kidney) spatPlot(gobject = visium_kidney, show_network = T,          network_color = 'blue', spatial_network_name = 'Delaunay_network')"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"spatial-genes-1","dir":"Articles","previous_headings":"10. Spatial genes","what":"Spatial genes","title":"Visium Mouse Kidney","text":"","code":"## kmeans binarization kmtest = binSpect(visium_kidney) spatFeatPlot2D(visium_kidney, expression_values = 'scaled',                feats = kmtest$feats[1:6], cow_n_col = 2, point_size = 1.5) ## rank binarization ranktest = binSpect(visium_kidney, bin_method = 'rank') spatFeatPlot2D(visium_kidney, expression_values = 'scaled',                feats = ranktest$feats[1:6], cow_n_col = 2, point_size = 1.5)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"spatial-co-expression-patterns","dir":"Articles","previous_headings":"10. Spatial genes","what":"Spatial co-expression patterns","title":"Visium Mouse Kidney","text":"","code":"## spatially correlated genes ## ext_spatial_genes = kmtest[1:500]$feats  # 1. calculate gene spatial correlation and single-cell correlation  # create spatial correlation object spat_cor_netw_DT = detectSpatialCorFeats(visium_kidney,                                          method = 'network',                                          spatial_network_name = 'Delaunay_network',                                          subset_feats = ext_spatial_genes)  # 2. identify most similar spatially correlated genes for one gene Napsa_top10_genes = showSpatialCorFeats(spat_cor_netw_DT, feats = 'Napsa', show_top_feats = 10)  spatFeatPlot2D(visium_kidney, expression_values = 'scaled',                feats = c('Napsa', 'Kap', 'Defb29', 'Prdx1'), point_size = 3) # 3. cluster correlated genes & visualize spat_cor_netw_DT = clusterSpatialCorFeats(spat_cor_netw_DT,                                            name = 'spat_netw_clus', k = 8)  heatmSpatialCorFeats(visium_kidney,                       spatCorObject = spat_cor_netw_DT,                       use_clus_name = 'spat_netw_clus',                      save_param = c(save_name = '22-z1-heatmap_correlated_genes',                                      save_format = 'pdf',                                     base_height = 6,                                      base_width = 8, units = 'cm'),                      heatmap_legend_param = list(title = NULL)) # 4. rank spatial correlated clusters and show genes for selected clusters netw_ranks = rankSpatialCorGroups(visium_kidney,                                    spatCorObject = spat_cor_netw_DT,                                   use_clus_name = 'spat_netw_clus',                                   save_param = c(save_name = '22-z2-rank_correlated_groups',                                                  base_height = 3,                                                  base_width = 5)) top_netw_spat_cluster = showSpatialCorFeats(spat_cor_netw_DT,                                              use_clus_name = 'spat_netw_clus',                                             selected_clusters = 6,                                              show_top_feats = 1)  # 5. create metagene enrichment score for clusters cluster_genes_DT = showSpatialCorFeats(spat_cor_netw_DT,                                         use_clus_name = 'spat_netw_clus',                                         show_top_feats = 1) cluster_genes = cluster_genes_DT$clus  names(cluster_genes) = cluster_genes_DT$feat_ID  visium_kidney = createMetafeats(visium_kidney,                                  feat_clusters = cluster_genes,                                  name = 'cluster_metagene')  showGiottoSpatEnrichments(visium_kidney)  spatCellPlot(visium_kidney,              spat_enr_names = 'cluster_metagene',              cell_annotation_values = netw_ranks$clusters,              point_size = 1.5, cow_n_col = 4)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"hmrf-domains","dir":"Articles","previous_headings":"","what":"11. HMRF domains","title":"Visium Mouse Kidney","text":"","code":"# HMRF requires a fully connected network! visium_kidney = createSpatialNetwork(gobject = visium_kidney,                                       minimum_k = 2,                                       name = 'Delaunay_full')  # spatial genes my_spatial_genes <- kmtest[1:100]$feats  # do HMRF with different betas hmrf_folder = paste0(results_folder,'/','HMRF_results/') if(!file.exists(hmrf_folder)) dir.create(hmrf_folder, recursive = T)  # if Rscript is not found, you might have to create a symbolic link, e.g. # cd /usr/local/bin # sudo ln -s /Library/Frameworks/R.framework/Resources/Rscript Rscript HMRF_spatial_genes = doHMRF(gobject = visium_kidney,                             expression_values = 'scaled',                             spatial_network_name = 'Delaunay_full',                             spatial_genes = my_spatial_genes,                             k = 5,                             betas = c(0, 1, 6),                             output_folder = paste0(hmrf_folder, '/', 'Spatial_genes/SG_topgenes_k5_scaled')) ## alternative way to view HMRF results #results = writeHMRFresults(gobject = ST_test, #                           HMRFoutput = HMRF_spatial_genes, #                           k = 5, betas_to_view = seq(0, 25, by = 5)) #ST_test = addCellMetadata(ST_test, new_metadata = results, by_column = T, column_cell_ID = 'cell_ID')   ## add HMRF of interest to giotto object visium_kidney = addHMRF(gobject = visium_kidney,                         HMRFoutput = HMRF_spatial_genes,                         k = 5, betas_to_add = c(0, 2),                         hmrf_name = 'HMRF')  ## visualize spatPlot(gobject = visium_kidney,           cell_color = 'HMRF_k5_b.0',           point_size = 5) spatPlot(gobject = visium_kidney,           cell_color = 'HMRF_k5_b.2',           point_size = 5)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_mouse_kidney.html","id":"export-and-create-giotto-viewers","dir":"Articles","previous_headings":"","what":"Export and create Giotto Viewers","title":"Visium Mouse Kidney","text":"","code":"# check which annotations are available combineMetadata(visium_kidney)  # select annotations, reductions and expression values to view in Giotto Viewer viewer_folder = paste0(results_folder, '/', 'mouse_visium_kidney_viewer')  exportGiottoViewer(gobject = visium_kidney,                    output_directory = viewer_folder,                    factor_annotations = c('in_tissue',                                           'leiden_clus'),                    numeric_annotations = c('nr_feats'),                    dim_reductions = c('tsne', 'umap'),                    dim_reduction_names = c('tsne', 'umap'),                    expression_values = 'scaled',                    expression_rounding = 2,                    overwrite_dir = T)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"1 Start Giotto","title":"Visium Prostate Integration","text":"","code":"# Ensure Giotto Suite is installed if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") } library(Giotto)  # Ensure Giotto Data is installed if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") } library(GiottoData)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment   installGiottoEnvironment() } # 1. set working directory results_directory = getwd()  # 2. set giotto python path # set python path to your preferred python version path # set python path to NULL if you want to automatically install (only the 1st time) and use the giotto miniconda environment python_path = NULL if(is.null(python_path)) {   installGiottoEnvironment() } # 3. create giotto instructions instrs = createGiottoInstructions(save_dir = results_directory,                                   save_plot = TRUE,                                   show_plot = TRUE,                                   python_path = python_path)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"2 Dataset explanation","title":"Visium Prostate Integration","text":"10X genomics recently launched new platform obtain spatial expression data using Visium Spatial Gene Expression slide. Visium Cancer Prostate data run tutorial can found Visium Normal Prostate data run tutorial can found Visium technology:  High resolution png original tissue:","code":""},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"create-giotto-objects-and-join","dir":"Articles","previous_headings":"","what":"3 Create Giotto objects and join","title":"Visium Prostate Integration","text":"","code":"# This dataset must be downlaoded manually; please do so and change the path below as appropriate data_directory <- getwd()  ## obese upper N_pros = createGiottoVisiumObject(     visium_dir = paste0(data_directory,'/Visium_FFPE_Human_Normal_Prostate'),     expr_data = 'raw',     png_name = 'tissue_lowres_image.png',     gene_column_index = 2,     instructions = instrs ) ## obese lower C_pros = createGiottoVisiumObject(     visium_dir = paste0(data_directory,'/Visium_FFPE_Human_Prostate_Cancer/'),     expr_data = 'raw',     png_name = 'tissue_lowres_image.png',     gene_column_index = 2,     instructions = instrs ) # join giotto objects # joining with x_shift has the advantage that you can join both 2D and 3D data # x_padding determines how much distance is between each dataset # if x_shift = NULL, then the total shift will be guessed from the giotto image testcombo = joinGiottoObjects(gobject_list = list(N_pros, C_pros),     gobject_names = c('NP', 'CP'),     join_method = 'shift', x_padding = 1000) # join info is stored in this slot # simple list for now testcombo@join_info # check joined Giotto object fDataDT(testcombo) pDataDT(testcombo) showGiottoImageNames(testcombo) showGiottoSpatLocs(testcombo) showGiottoExpression(testcombo) # this plots all the images by list_ID spatPlot2D(gobject = testcombo, cell_color = 'in_tissue',     show_image = T, image_name = c(\"NP-image\", \"CP-image\"),     group_by = 'list_ID', point_alpha = 0.5,     save_param = list(save_name = \"1a_plot\")) # this plots one selected image spatPlot2D(gobject = testcombo, cell_color = 'in_tissue',     show_image = T, image_name = c(\"NP-image\"), point_alpha = 0.3,     save_param = list(save_name = \"1b_plot\")) # this plots two selected images spatPlot2D(gobject = testcombo, cell_color = 'in_tissue',     show_image = T, image_name = c( \"NP-image\", \"CP-image\"),     point_alpha = 0.3,     save_param = list(save_name = \"1c_plot\"))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"process-giotto-objects","dir":"Articles","previous_headings":"","what":"4 Process Giotto Objects","title":"Visium Prostate Integration","text":"","code":"# subset on in-tissue spots metadata = pDataDT(testcombo) in_tissue_barcodes = metadata[in_tissue == 1]$cell_ID testcombo = subsetGiotto(testcombo, cell_ids = in_tissue_barcodes) ## filter testcombo <- filterGiotto(gobject = testcombo,     expression_threshold = 1,     feat_det_in_min_cells = 50,     min_det_feats_per_cell = 500,     expression_values = c('raw'),     verbose = T) ## normalize testcombo <- normalizeGiotto(gobject = testcombo, scalefactor = 6000) ## add gene & cell statistics testcombo <- addStatistics(gobject = testcombo, expression_values = 'raw')  fmeta = fDataDT(testcombo) testfeats = fmeta[perc_cells > 20 & perc_cells < 50][100:110]$feat_ID  violinPlot(testcombo, feats = testfeats, cluster_column = 'list_ID', save_param = list(save_name = \"2a_plot\")) plotMetaDataHeatmap(testcombo, selected_feats = testfeats, metadata_cols = 'list_ID', save_param = list(save_name = \"2b_plot\")) ## visualize spatPlot2D(gobject = testcombo, group_by = 'list_ID', cell_color = 'nr_feats', color_as_factor = F, point_size = 0.75, save_param = list(save_name = \"2c_plot\"))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"dimention-reduction","dir":"Articles","previous_headings":"","what":"5 Dimention Reduction","title":"Visium Prostate Integration","text":"","code":"## PCA ## testcombo <- calculateHVF(gobject = testcombo) testcombo <- runPCA(gobject = testcombo, center = TRUE, scale_unit = TRUE) screePlot(testcombo, ncp = 30, save_param = list(save_name = \"3a_screeplot\"))"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"without-integration","dir":"Articles","previous_headings":"6 Clustering","what":"6.1 Without Integration","title":"Visium Prostate Integration","text":"Integration usually needed dataset different conditions minimize batch effects. Without integration means without using integration methods.","code":"## cluster and run UMAP ## # sNN network (default) testcombo <- createNearestNetwork(gobject = testcombo,     dim_reduction_to_use = 'pca', dim_reduction_name = 'pca',     dimensions_to_use = 1:10, k = 15)  # Leiden clustering testcombo <- doLeidenCluster(gobject = testcombo, resolution = 0.2, n_iterations = 1000)  # UMAP testcombo = runUMAP(testcombo)  plotUMAP(gobject = testcombo,     cell_color = 'leiden_clus', show_NN_network = T, point_size = 1.5,     save_param = list(save_name = \"4.1a_plot\")) spatPlot2D(gobject = testcombo, group_by = 'list_ID',     cell_color = 'leiden_clus',     point_size = 1.5,     save_param = list(save_name = \"4.1b_plot\")) spatDimPlot2D(gobject = testcombo,     cell_color = 'leiden_clus',     save_param = list(save_name = \"4.1c_plot\"))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"with-harmony-integration","dir":"Articles","previous_headings":"6 Clustering","what":"6.2 With Harmony integration","title":"Visium Prostate Integration","text":"Harmony integration algorithm developed Korsunsky, . et al.. designed integration single cell data also work well spatial datasets.","code":"## data integration, cluster and run UMAP ##  # harmony #library(devtools) #install_github(\"immunogenomics/harmony\") library(harmony) ## run harmony integration testcombo = runGiottoHarmony(testcombo, vars_use = 'list_ID', do_pca = F) ## sNN network (default) testcombo <- createNearestNetwork(gobject = testcombo,     dim_reduction_to_use = 'harmony', dim_reduction_name = 'harmony', name = 'NN.harmony',     dimensions_to_use = 1:10, k = 15)  ## Leiden clustering testcombo <- doLeidenCluster(gobject = testcombo,     network_name = 'NN.harmony', resolution = 0.2, n_iterations = 1000, name = 'leiden_harmony')  # UMAP dimension reduction testcombo = runUMAP(testcombo, dim_reduction_name = 'harmony', dim_reduction_to_use = 'harmony', name = 'umap_harmony')   plotUMAP(gobject = testcombo,     dim_reduction_name = 'umap_harmony',     cell_color = 'leiden_harmony',      show_NN_network = F,      point_size = 1.5,     save_param = list(save_name = \"4.2a_plot\")) # If you want to show NN network information, you will need to specify these arguments in the plotUMAP function # show_NN_network = T, nn_network_to_use = 'sNN' , network_name = 'NN.harmony' spatPlot2D(gobject = testcombo, group_by = 'list_ID',     cell_color = 'leiden_harmony',     point_size = 1.5,     save_param = list(save_name = \"4.2b_plot\")) spatDimPlot2D(gobject = testcombo,     dim_reduction_to_use = 'umap', dim_reduction_name = 'umap_harmony',     cell_color = 'leiden_harmony',     save_param = list(save_name = \"4.2c_plot\")) # compare to previous results spatPlot2D(gobject = testcombo,     cell_color = 'leiden_clus',      save_param = list(save_name = \"4_w_o_integration_plot\")) spatPlot2D(gobject = testcombo,     cell_color = 'leiden_harmony',     save_param = list(save_name = \"4_w_integration_plot\"))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"cell-type-annotation","dir":"Articles","previous_headings":"","what":"7 Cell type annotation","title":"Visium Prostate Integration","text":"Visium spatial transcriptomics provide single-cell resolution, making cell type annotation harder problem. Giotto provides several ways calculate enrichment specific cell-type signature gene list: PAGE hypergeometric test Rank DWLS Deconvolution also easiest way integrate Visium datasets single cell data. Example shown Ma et al. two prostate cancer patients. raw dataset can found Giotto_SC processed variable single cell RNAseq tutorial. can also get access processed files dataset using getSpatialDataset","code":"# download data to results directory #### # if wget is installed, set method = 'wget' # if you run into authentication issues with wget, then add \" extra = '--no-check-certificate' \" getSpatialDataset(dataset = 'scRNA_prostate', directory = data_directory) sc_expression = paste0(data_directory, \"/prostate_sc_expression_matrix.csv.gz\") sc_metadata = paste0(data_directory, \"/prostate_sc_metadata.csv\")  giotto_SC <- createGiottoObject(   expression = sc_expression,   instructions = instrs ) giotto_SC <- addCellMetadata(giotto_SC,                               new_metadata = data.table::fread(sc_metadata))  giotto_SC<- normalizeGiotto(giotto_SC)"},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"page-enrichment","dir":"Articles","previous_headings":"7 Cell type annotation","what":"7.1 PAGE enrichment","title":"Visium Prostate Integration","text":"","code":"# Create PAGE matrix # PAGE matrix should be a binary matrix with each row represent a gene marker and each column represent a cell type # markers_scran is generated from single cell analysis () markers_scran = findMarkers_one_vs_all(gobject=giotto_SC,                                         method=\"scran\",                                        expression_values=\"normalized\",                                         cluster_column='prostate_labels',                                        min_feats=3) top_markers <- markers_scran[, head(.SD, 10), by=\"cluster\"] celltypes<-levels(factor(markers_scran$cluster)) sign_list<-list()  for (i in 1:length(celltypes)){   sign_list[[i]]<-top_markers[which(top_markers$cluster == celltypes[i]),]$feats }  PAGE_matrix = makeSignMatrixPAGE(sign_names = celltypes,                                  sign_list = sign_list) testcombo = runPAGEEnrich(gobject = testcombo,                           sign_matrix = PAGE_matrix,                           min_overlap_genes = 2)  cell_types_subset = colnames(PAGE_matrix)  # Plot PAGE enrichment result spatCellPlot(gobject = testcombo,              spat_enr_names = 'PAGE',              cell_annotation_values = cell_types_subset[1:4],              cow_n_col = 2,coord_fix_ratio = NULL, point_size = 1.25,              save_param = list(save_name = \"5a_PAGE_plot\"))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"hypergeometric-test","dir":"Articles","previous_headings":"7 Cell type annotation","what":"7.2 Hypergeometric test","title":"Visium Prostate Integration","text":"","code":"testcombo = runHyperGeometricEnrich(gobject = testcombo,                                     expression_values = \"normalized\",                                     sign_matrix = PAGE_matrix) cell_types_subset = colnames(PAGE_matrix) spatCellPlot(gobject = testcombo,               spat_enr_names = 'hypergeometric',              cell_annotation_values = cell_types_subset[1:4],              cow_n_col = 2,coord_fix_ratio = NULL, point_size = 1.75,              save_param = list(save_name = \"5b_HyperGeometric_plot\"))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"rank-enrichment","dir":"Articles","previous_headings":"7 Cell type annotation","what":"7.3 Rank Enrichment","title":"Visium Prostate Integration","text":"","code":"# Create rank matrix, not that rank matrix is different from PAGE # A count matrix and a vector for all cell labels will be needed sc_expression_norm = getExpression(giotto_SC,                                   values = \"normalized\",                                   output = \"matrix\")  prostate_feats = pDataDT(giotto_SC)$prostate_label  rank_matrix = makeSignMatrixRank(sc_matrix = sc_expression_norm,                                  sc_cluster_ids = prostate_feats) colnames(rank_matrix)<-levels(factor(prostate_feats)) testcombo = runRankEnrich(gobject = testcombo, sign_matrix = rank_matrix,expression_values = \"normalized\")  # Plot Rank enrichment result spatCellPlot2D(gobject = testcombo,                spat_enr_names = 'rank',                cell_annotation_values = cell_types_subset[1:4],                cow_n_col = 2,coord_fix_ratio = NULL, point_size = 1,                save_param = list(save_name = \"5c_Rank_plot\"))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"dwls-deconvolution","dir":"Articles","previous_headings":"7 Cell type annotation","what":"7.4 DWLS Deconvolution","title":"Visium Prostate Integration","text":"","code":"# Create DWLS matrix, not that DWLS matrix is different from PAGE and rank # A count matrix a vector for a list of gene signatures and a vector for all cell labels will be needed DWLS_matrix<-makeSignMatrixDWLSfromMatrix(matrix = sc_expression_norm,                                           cell_type = prostate_feats,                                           sign_gene = top_markers$feats) testcombo = runDWLSDeconv(gobject = testcombo, sign_matrix = DWLS_matrix)   # Plot DWLS deconvolution result spatCellPlot2D(gobject = testcombo,                spat_enr_names = 'DWLS',                cell_annotation_values = levels(factor(prostate_feats))[1:4],                cow_n_col = 2,coord_fix_ratio = NULL, point_size = 1,                save_param = list(save_name = \"5d_DWLS_plot\"))"},{"path":"https://drieslab.github.io/Giotto/articles/visium_prostate_integration.html","id":"session-info","dir":"Articles","previous_headings":"","what":"8 Session Info","title":"Visium Prostate Integration","text":"","code":"sessionInfo()  R version 4.2.2 (2022-10-31 ucrt)     Platform: x86_64-w64-mingw32/x64 (64-bit)     Running under: Windows 10 x64 (build 22621)      Matrix products: default      locale:     [1] LC_COLLATE=English_United States.utf8      [2] LC_CTYPE=English_United States.utf8        [3] LC_MONETARY=English_United States.utf8     [4] LC_NUMERIC=C                               [5] LC_TIME=English_United States.utf8          attached base packages:     [1] stats     graphics  grDevices utils     datasets  methods   base           other attached packages:     [1] harmony_0.1.1    Rcpp_1.0.10      GiottoData_0.2.1 Giotto_3.3.0         [5] testthat_3.1.5        loaded via a namespace (and not attached):       [1] systemfonts_1.0.4           plyr_1.8.8                        [3] igraph_1.4.1                lazyeval_0.2.2                    [5] sp_1.6-0                    BiocParallel_1.32.6               [7] listenv_0.9.0               usethis_2.1.6                     [9] GenomeInfoDb_1.34.6         ggplot2_3.4.2                    [11] digest_0.6.30               htmltools_0.5.4                  [13] magick_2.7.4                fansi_1.0.4                      [15] magrittr_2.0.3              memoise_2.0.1                    [17] ScaledMatrix_1.6.0          cluster_2.1.4                    [19] limma_3.54.2                remotes_2.4.2                    [21] globals_0.16.2              matrixStats_0.63.0               [23] R.utils_2.12.2              prettyunits_1.1.1                [25] colorspace_2.1-0            rappdirs_0.3.3                   [27] ggrepel_0.9.2               textshaping_0.3.6                [29] xfun_0.38                   dplyr_1.1.1                      [31] callr_3.7.3                 crayon_1.5.2                     [33] RCurl_1.98-1.9              jsonlite_1.8.3                   [35] progressr_0.13.0            glue_1.6.2                       [37] gtable_0.3.3                zlibbioc_1.44.0                  [39] XVector_0.38.0              DelayedArray_0.24.0              [41] pkgbuild_1.4.0              BiocSingular_1.14.0              [43] RcppZiggurat_0.1.6          future.apply_1.10.0              [45] SingleCellExperiment_1.20.0 BiocGenerics_0.44.0              [47] scales_1.2.1                edgeR_3.40.1                     [49] miniUI_0.1.1.1              viridisLite_0.4.2                [51] xtable_1.8-4                dqrng_0.3.0                      [53] reticulate_1.26             rsvd_1.0.5                       [55] stats4_4.2.2                profvis_0.3.7                    [57] metapod_1.6.0               htmlwidgets_1.6.2                [59] httr_1.4.5                  RColorBrewer_1.1-3               [61] ellipsis_0.3.2              scuttle_1.8.3                    [63] urlchecker_1.0.1            pkgconfig_2.0.3                  [65] R.methodsS3_1.8.2           farver_2.1.1                     [67] uwot_0.1.14                 deldir_1.0-6                     [69] locfit_1.5-9.7              utf8_1.2.3                       [71] here_1.0.1                  tidyselect_1.2.0                 [73] labeling_0.4.2              rlang_1.1.0                      [75] reshape2_1.4.4              later_1.3.0                      [77] munsell_0.5.0               tools_4.2.2                      [79] cachem_1.0.6                cli_3.4.1                        [81] dbscan_1.1-11               generics_0.1.3                   [83] devtools_2.4.5              evaluate_0.20                    [85] stringr_1.5.0               fastmap_1.1.0                    [87] yaml_2.3.7                  ragg_1.2.4                       [89] processx_3.8.0              knitr_1.42                       [91] fs_1.5.2                    purrr_1.0.1                      [93] future_1.32.0               sparseMatrixStats_1.10.0         [95] mime_0.12                   scran_1.26.1                     [97] R.oo_1.25.0                 brio_1.1.3                       [99] compiler_4.2.2              rstudioapi_0.14                 [101] plotly_4.10.1               png_0.1-7                       [103] statmod_1.4.37              tibble_3.2.1                    [105] stringi_1.7.8               ps_1.7.2                        [107] desc_1.4.2                  bluster_1.8.0                   [109] lattice_0.20-45             Matrix_1.5-1                    [111] vctrs_0.6.1                 pillar_1.9.0                    [113] lifecycle_1.0.3             BiocNeighbors_1.16.0            [115] RcppAnnoy_0.0.20            data.table_1.14.6               [117] cowplot_1.1.1               bitops_1.0-7                    [119] irlba_2.3.5.1               httpuv_1.6.6                    [121] GenomicRanges_1.50.2        R6_2.5.1                        [123] promises_1.2.0.1            IRanges_2.32.0                  [125] parallelly_1.35.0           sessioninfo_1.2.2               [127] codetools_0.2-18            pkgload_1.3.2                   [129] SummarizedExperiment_1.28.0 rprojroot_2.0.3                 [131] withr_2.5.0                 S4Vectors_0.36.2                [133] GenomeInfoDbData_1.2.9      parallel_4.2.2                  [135] terra_1.7-18                quadprog_1.5-8                  [137] grid_4.2.2                  beachmat_2.14.0                 [139] tidyr_1.3.0                 Rfast_2.0.6                     [141] DelayedMatrixStats_1.20.0   rmarkdown_2.21                  [143] MatrixGenerics_1.10.0       Rtsne_0.16                      [145] Biobase_2.58.0              shiny_1.7.4"},{"path":"https://drieslab.github.io/Giotto/articles/visualizations.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"1. Dataset explanation","title":"Visualizations","text":"tutorial walks visualization capabilities Giotto. clustering dimension reduction methods focused within dimension reduction tutorial revisited utilized create heatmaps, violin plots, visualizations unique Giotto: spatial maps networks. tutorial uses merFISH dataset mouse hypothalamic preoptic regions Moffitt et al.. complete walkthrough dataset can found . download data used create Giotto Object , please ensure wget installed locally.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/visualizations.html","id":"start-giotto","dir":"Articles","previous_headings":"","what":"2. Start Giotto","title":"Visualizations","text":"","code":"# Ensure Giotto Suite is installed if(!\"Giotto\" %in% installed.packages()) {   devtools::install_github(\"drieslab/Giotto@suite\") }  library(Giotto)  # Ensure Giotto Data is installed if(!\"GiottoData\" %in% installed.packages()) {   devtools::install_github(\"drieslab/GiottoData\") }  library(GiottoData)  # Ensure the Python environment for Giotto has been installed genv_exists = checkGiottoEnvironment() if(!genv_exists){   # The following command need only be run once to install the Giotto environment   installGiottoEnvironment() }"},{"path":"https://drieslab.github.io/Giotto/articles/visualizations.html","id":"create-a-giotto-object","dir":"Articles","previous_headings":"","what":"3. Create a Giotto object","title":"Visualizations","text":"","code":"# Specify path from which data may be retrieved/stored data_directory = paste0(getwd(),'/gobject_visual_data/') # alternatively, \"/path/to/where/the/data/lives/\"  # Specify path to which results may be saved results_directory = paste0(getwd(),'/gobject_visual_results/')  # alternatively, \"/path/to/store/the/results/\"  # Optional: Specify a path to a Python executable within a conda or miniconda  # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired.  # Get the dataset getSpatialDataset(dataset = 'merfish_preoptic',                    directory = data_directory,                    method = 'wget') ### Giotto instructions and data preparation # Optional: Set Giotto instructions instrs = createGiottoInstructions(save_plot = TRUE,                                    show_plot = TRUE,                                   save_dir = results_directory,                                    python_path = my_python_path) # Create file paths to feed data into Giotto object  expr_path = paste0(data_directory, \"merFISH_3D_data_expression.txt.gz\") loc_path = paste0(data_directory, \"merFISH_3D_data_cell_locations.txt\") meta_path = paste0(data_directory, \"merFISH_3D_metadata.txt\")  ### Create Giotto object testobj <- createGiottoObject(expression = expr_path,                               spatial_locs = loc_path,                               instructions = instrs) # Add additional metadata metadata = data.table::fread(meta_path)  testobj = addCellMetadata(testobj,                            new_metadata = metadata$layer_ID,                            vector_name = 'layer_ID')  testobj = addCellMetadata(testobj,                            new_metadata = metadata$orig_cell_types,                            vector_name = 'orig_cell_types')  ### Process the Giotto Object # Note that for the purposes of this tutorial, the entire dataset will be visualized.  # Thus, filter parameters are set to 0, so as to not remove any cells. # Note that since adjustment is not required, adjust_params is set to NULL.  testobj <- processGiotto(testobj,                          filter_params = list(expression_threshold = 0,                                               feat_det_in_min_cells = 0,                                                min_det_feats_per_cell = 0),                          norm_params = list(norm_methods = 'standard',                                              scale_feats = TRUE,                                              scalefactor = 1000),                          stat_params = list(expression_values = 'normalized'),                          adjust_params = NULL)"},{"path":"https://drieslab.github.io/Giotto/articles/visualizations.html","id":"visualize-the-dataset","dir":"Articles","previous_headings":"","what":"4. Visualize the Dataset","title":"Visualizations","text":"dataset includes eight sequential slices. can visualized 2D 3D. 2D:  3D:","code":"spatPlot(gobject = testobj, point_size = 1.5) spatPlot3D(gobject = testobj, point_size = 1, axis_scale = 'real')"},{"path":"https://drieslab.github.io/Giotto/articles/visualizations.html","id":"create-and-visualize-clusters","dir":"Articles","previous_headings":"","what":"5. Create and Visualize Clusters","title":"Visualizations","text":"First, run PCA data. purposes tutorial, highly variable genes identified used reduction simplicity. data simply undergo dimension reduction PCA. , run UMAP data pre-clustering visualization. UMAP may also plotted 2D 3D.   Now, data may clustered. Create nearest network, create Leiden clusters. clusters may visualized 2D 3D, well upon UMAP within tissue.  Visualize Leiden clusters within tissue creating Spatial Plot, grouping layer_ID.  Visualize expression levels within tissue creating Spatial Plot, grouping layer_ID, specifying cell_color number features detected per cell.","code":"# Run PCA testobj <- runPCA(gobject = testobj, feats_to_use = NULL, scale_unit = FALSE, center = TRUE) # Run UMAP testobj <- runUMAP(gobject = testobj, dimensions_to_use = 1:8, n_components = 3, n_threads = 4) # Plot UMAP in 2D plotUMAP_2D(gobject = testobj, point_size = 1.5) # Plot UMAP 3D plotUMAP_3D(gobject = testobj, point_size = 1.5) # Create a k Nearest Network for clustering testobj <- createNearestNetwork(gobject = testobj, dimensions_to_use = 1:8, k = 10) # Preform Leiden clustering testobj <- doLeidenCluster(gobject = testobj,                             resolution = 0.25,                             n_iterations = 200,                             name = 'leiden_0.25.200')  # Plot the clusters upon the UMAP plotUMAP_3D(gobject = testobj, cell_color = 'leiden_0.25.200', point_size = 1.5,             show_center_label = F, save_param = list(save_name = 'leiden_0.25.200_UMAP_3D')) spatPlot2D(gobject = testobj,             point_size = 1.0,             cell_color = 'leiden_0.25.200',             group_by = 'layer_ID',             cow_n_col = 2,             group_by_subset = c(260, 160, 60, -40, -140, -240)) # Plot cell_color as a representation of the number of features/ cell (\"nr_feats\") spatPlot2D(gobject = testobj, point_size = 1.5,             cell_color = 'nr_feats', color_as_factor = F,            group_by = 'layer_ID', cow_n_col = 2, group_by_subset = c(260, 160, 60, -40, -140, -240))"},{"path":"https://drieslab.github.io/Giotto/articles/visualizations.html","id":"compare-clusters","dir":"Articles","previous_headings":"","what":"6. Compare Clusters","title":"Visualizations","text":"can compare clusters using heatmap:  can plot dendogram explore cluster similarity:","code":"showClusterHeatmap(gobject = testobj, cluster_column = 'leiden_0.25.200', save_plot = T) showClusterDendrogram(testobj, h = 0.5, rotate = T, cluster_column = 'leiden_0.25.200')"},{"path":"https://drieslab.github.io/Giotto/articles/visualizations.html","id":"visualize-cell-markers","dir":"Articles","previous_headings":"","what":"7 Visualize Cell Markers","title":"Visualizations","text":"Marker features may identified calling findMarkers_one_vs_all. function detects differentially expressed features comparing single cluster others. Currently, three methods supported: “scran”, “gini”, “mast”. , “gini” method employed; details gini method may found . Create violinplot:  Create heatmap top gini genes cluster:","code":"markers = findMarkers_one_vs_all(gobject = testobj,                                  method = 'gini',                                  expression_values = 'normalized',                                  cluster_column = 'leiden_0.25.200',                                  min_feats = 1, rank_score = 2) topgini_genes = unique(markers[, head(.SD, 2), by = 'cluster']$feats) violinPlot(testobj, feats = topgini_genes, cluster_column = 'leiden_0.25.200', strip_position = 'right') plotMetaDataHeatmap(testobj, expression_values = 'scaled',                     metadata_cols = c('leiden_0.25.200'),                     selected_feats = topgini_genes)"},{"path":"https://drieslab.github.io/Giotto/articles/visualizations.html","id":"visualize-cell-types-in-tissue","dir":"Articles","previous_headings":"","what":"8. Visualize Cell Types in Tissue","title":"Visualizations","text":", Leiden clusters must annotated. Leveraging provided cell metadata Giotto Spatial Plots, Leiden clusters may manually assigned cell type. Alternative approaches (.e. absence cell metadata cell type identification ) involve analysis cluster enrichment cell-specific marker genes. Since cell type annotations included within metadata loaded Giotto Object, UMAP may plotted cell-type annotations. cell types known, Leiden clusters may manually assigned cell type, done .  Manually assign cell types clusters via inspection UMAP plots. Specifically, UMAP plots saved “leiden_0.25.200_UMAP3D” “Original_Cell_Types_UMAP3D” compared assignment.  Now Leiden cluster associated cell type, cell types may viewed tissue 2D 3D within Spatial Plot specifying cell_color parameter name annotation, ‘cell_types’.   plots may subset cell type 2D 3D.","code":"# Plot the UMAP, annotated by cell type.  plotUMAP_3D(testobj,              cell_color = 'orig_cell_types',              save_param = list(save_name = 'Original_Cell_Types_UMAP_3D')) # Manually assign Leiden clusters to a cell type cluster_range = unique(testobj@cell_metadata$cell$rna$leiden_0.25.200)  # Note that cell types were condensed (i.e. \"Endothelial 1\", \"Endothelial 2\", ... were # combined into one cell type \"Endothelial\") manual_cluster = c('Inhibitory', 'Excitatory', 'Inhibitory', 'Astrocyte', 'OD Mature',                     'Endothelial', 'Microglia', 'OD Mature', 'OD Immature', 'Astrocyte',                    'Ependymal', 'Pericytes', 'Ambiguous', 'Microglia', 'Inhibitory', 'Inhibitory')  names(manual_cluster) = as.character(sort(cluster_range))  testobj = annotateGiotto(gobject = testobj,                           annotation_vector = manual_cluster,                          cluster_column = 'leiden_0.25.200',                           name = 'cell_types')  cell_types_in_plot = c('Inhibitory', 'Excitatory','OD Mature', 'OD Immature',                         'Astrocyte', 'Microglia', 'Ependymal','Endothelial',                        'Pericytes', 'Ambiguous')  # This Giotto function will provide a distinct color palette. Colors  # may change each time the function is run.  mycolorcode = getDistinctColors(length(cell_types_in_plot))  names(mycolorcode) = cell_types_in_plot  # Visualize the assigned types in the UMAP plotUMAP_3D(testobj, cell_color = 'cell_types', point_size = 1.5,              cell_color_code = mycolorcode,             save_param = list(save_name = 'manual_cluster_typing_UMAP_3D')) spatPlot2D(gobject = testobj, point_size = 1.0,           cell_color = 'cell_types', group_by = 'layer_ID',            cell_color_code = mycolorcode, cow_n_col = 2,            group_by_subset = c(seq(260, -290, -100))) spatPlot3D(testobj,            cell_color = 'cell_types', axis_scale = 'real',            sdimx = 'sdimx', sdimy = 'sdimy', sdimz = 'sdimz',            show_grid = F, cell_color_code = mycolorcode) spatPlot2D(gobject = testobj, point_size = 1.0,             cell_color = 'cell_types', cell_color_code = mycolorcode,            select_cell_groups = c('Microglia', 'Ependymal', 'Endothelial'), show_other_cells = F,            group_by = 'layer_ID', cow_n_col = 2, group_by_subset = c(seq(260, -290, -100))) spatPlot3D(testobj,            cell_color = 'cell_types', axis_scale = 'real',            sdimx = 'sdimx', sdimy = 'sdimy', sdimz = 'sdimz',            show_grid = F, cell_color_code = mycolorcode,            select_cell_groups = c('Microglia', 'Ependymal', 'Endothelial'), show_other_cells = F)"},{"path":"https://drieslab.github.io/Giotto/articles/visualizations.html","id":"visualize-cell-networks","dir":"Articles","previous_headings":"","what":"9. Visualize Cell Networks","title":"Visualizations","text":"preferred use Delaunay geometry create spatial networks. cases, k-nearest neighbor may used create spatial network. Specifying method parameter within createSpatialNetwork accomplish . default, function runs Delaunay method. , methods, well potential modifications k-nearest networks, shown.","code":"### Spatial Networks # The following function provides insight to the Delaunay Network. It will be shown in-console # if this command is run as written. plotStatDelaunayNetwork(gobject= testobj,                          method = 'delaunayn_geometry',                          maximum_distance = 50,                          show_plot = T,                          save_plot = F) # Create Spatial Network using Delaunay geometry testobj = createSpatialNetwork(gobject = testobj,                                 delaunay_method = 'delaunayn_geometry',                                 minimum_k = 2,                                 maximum_distance_delaunay = 50)  # Create Spatial Networks using k-nearest neighbor with varying specifications testobj <- createSpatialNetwork(gobject = testobj,                                  method = 'kNN',                                  k = 5,                                  name = 'spatial_network')  testobj <- createSpatialNetwork(gobject = testobj,                                  method = 'kNN',                                  k = 10,                                  name = 'large_network')  testobj <- createSpatialNetwork(gobject = testobj,                                  method = 'kNN',                                  k = 100,                                  maximum_distance_knn = 200,                                  minimum_k = 2,                                  name = 'distance_network')  # Now, visualize the different spatial networks in one layer of the dataset # Here layer 260 is selected, and only high expressing cells are included cell_metadata = getCellMetadata(testobj)[] highexp_ids = cell_metadata[layer_ID==260][total_expr>=100]$cell_ID subtestobj = subsetGiotto(testobj, cell_ids = highexp_ids) # Re-annotate the subset Giotto Object subtestobj = annotateGiotto(gobject = subtestobj,                              annotation_vector = manual_cluster,                             cluster_column = 'leiden_0.25.200',                              name = 'cell_types') spatPlot(gobject = subtestobj, show_network = T,          network_color = 'blue', spatial_network_name = 'Delaunay_network',          point_size = 1.5, cell_color = 'cell_types',          save_param = list(save_name = 'Delaunay_network_spatPlot')) spatPlot(gobject = subtestobj, show_network = T,          network_color = 'blue', spatial_network_name = 'spatial_network',          point_size = 2.5, cell_color = 'cell_types',          save_param = list(save_name = 'spatial_network_spatPlot')) spatPlot(gobject = subtestobj, show_network = T,          network_color = 'blue', spatial_network_name = 'large_network',          point_size = 2.5, cell_color = 'cell_types',          save_param = list(save_name = 'large_network_spatPlot')) spatPlot(gobject = subtestobj, show_network = T,          network_color = 'blue', spatial_network_name = 'distance_network',          point_size = 2.5, cell_color = 'cell_types',          save_param = list(save_name = 'distance_network_spatPlot'))"},{"path":"https://drieslab.github.io/Giotto/articles/visualizations.html","id":"session-info","dir":"Articles","previous_headings":"","what":"10. Session Info","title":"Visualizations","text":"","code":"sessionInfo() R version 4.2.2 (2022-10-31 ucrt)     Platform: x86_64-w64-mingw32/x64 (64-bit)     Running under: Windows 10 x64 (build 22621)      Matrix products: default      locale:     [1] LC_COLLATE=English_United States.utf8      [2] LC_CTYPE=English_United States.utf8        [3] LC_MONETARY=English_United States.utf8     [4] LC_NUMERIC=C                               [5] LC_TIME=English_United States.utf8          attached base packages:     [1] stats     graphics  grDevices utils     datasets  methods   base           other attached packages:     [1] GiottoData_0.2.1 Giotto_3.2.1          loaded via a namespace (and not attached):       [1] matrixStats_0.63.0    RcppAnnoy_0.0.20      doParallel_1.0.17           [4] RColorBrewer_1.1-3    httr_1.4.5            rprojroot_2.0.3             [7] tools_4.2.2           utf8_1.2.3            R6_2.5.1                   [10] irlba_2.3.5.1         uwot_0.1.14           lazyeval_0.2.2             [13] BiocGenerics_0.44.0   colorspace_2.1-0      GetoptLong_1.0.5           [16] withr_2.5.0           tidyselect_1.2.0      compiler_4.2.2             [19] progressr_0.13.0      textshaping_0.3.6     cli_3.4.1                  [22] ggdendro_0.1.23       DelayedArray_0.24.0   plotly_4.10.1              [25] labeling_0.4.2        scales_1.2.1          rappdirs_0.3.3             [28] systemfonts_1.0.4     digest_0.6.30         dbscan_1.1-11              [31] rmarkdown_2.21        R.utils_2.12.2        pkgconfig_2.0.3            [34] htmltools_0.5.4       MatrixGenerics_1.10.0 fastmap_1.1.0              [37] htmlwidgets_1.6.2     rlang_1.1.0           GlobalOptions_0.1.2        [40] rstudioapi_0.14       shape_1.4.6           farver_2.1.1               [43] generics_0.1.3        jsonlite_1.8.3        crosstalk_1.2.0            [46] BiocParallel_1.32.6   dplyr_1.1.1           R.oo_1.25.0                [49] magrittr_2.0.3        BiocSingular_1.14.0   Matrix_1.5-1               [52] Rcpp_1.0.10           munsell_0.5.0         S4Vectors_0.36.2           [55] fansi_1.0.4           abind_1.4-5           reticulate_1.26            [58] lifecycle_1.0.3       R.methodsS3_1.8.2     terra_1.7-18               [61] yaml_2.3.7            MASS_7.3-58.1         grid_4.2.2                 [64] parallel_4.2.2        crayon_1.5.2          lattice_0.20-45            [67] cowplot_1.1.1         beachmat_2.14.0       circlize_0.4.15            [70] magick_2.7.4          knitr_1.42            ComplexHeatmap_2.14.0      [73] pillar_1.9.0          igraph_1.4.1          rjson_0.2.21               [76] codetools_0.2-18      ScaledMatrix_1.6.0    stats4_4.2.2               [79] magic_1.6-1           glue_1.6.2            evaluate_0.20              [82] data.table_1.14.6     png_0.1-7             vctrs_0.6.1                [85] foreach_1.5.2         gtable_0.3.3          purrr_1.0.1                [88] tidyr_1.3.0           clue_0.3-63           ggplot2_3.4.1              [91] xfun_0.38             rsvd_1.0.5            ragg_1.2.4                 [94] viridisLite_0.4.1     geometry_0.4.7        tibble_3.2.1               [97] iterators_1.0.14      IRanges_2.32.0        cluster_2.1.4             [100] ellipsis_0.3.2        here_1.0.1"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"set-up-giotto","dir":"Articles","previous_headings":"","what":"1. Set up Giotto","title":"Vizgen Mouse Brain Receptor Map","text":"","code":"library(Giotto) library(GiottoData)  # 1. set working directory where project outputs will be saved to results_folder = '/path/to/save/directory/'  # Optional: Specify a path to a Python executable within a conda or miniconda  # environment. If set to NULL (default), the Python executable within the previously # installed Giotto environment will be used. my_python_path = NULL # alternatively, \"/local/python/path/python\" if desired."},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"2. Dataset explanation","title":"Vizgen Mouse Brain Receptor Map","text":"vignette covers Giotto object creation simple exploratory analysis subcellular MERFISH Mouse Brain Receptor Map dataset provided Vizgen MERSCOPE platform. Transcripts captured single-molecule level subcellular spatial resolution (≤100nm). dataset includes information 9 full coronal mouse brain slices (3 positions 3 biological replicates) profiled 483 genes. vignette works slice 1, replicate 1. Provided Outputs: List detected transcripts spatial locations three dimensions (CSV) Show first 4 rows Output cell segmentation analysis: transcripts (cols) per cell (rows) aggregated count matrix (CSV) Show first 4 rows columns cell metadata (CSV) Show first 4 rows cell boundaries (HDF5) DAPI Poly T mosaic images (TIFF) Vizgen Data Release V1.0. May 2021","code":""},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"giotto-global-instructions-and-preparations","dir":"Articles","previous_headings":"","what":"3. Giotto global instructions and preparations","title":"Vizgen Mouse Brain Receptor Map","text":"Define plot saving behavior project data paths","code":"# Directly saving plots to the working directory without rendering them in the editor saves time. instrs = createGiottoInstructions(save_dir = results_folder,                                   save_plot = TRUE,                                   show_plot = FALSE,                                   return_plot = FALSE,                                   python_path = my_python_path)  # Add Needed paths below: # provide path to pre-aggregated information expr_path = '/path/to/datasets_mouse_brain_map_BrainReceptorShowcase_Slice1_Replicate1_cell_by_gene_S1R1.csv' # provide path to metadata (includes spatial locations of aggregated expression) meta_path = '/path/to/datasets_mouse_brain_map_BrainReceptorShowcase_Slice1_Replicate1_cell_metadata_S1R1.csv' # provide path to the detected transcripts (single molecule level transcript spatial information) tx_path = '/path/to/datasets_mouse_brain_map_BrainReceptorShowcase_Slice1_Replicate1_detected_transcripts_S1R1.csv' # define path to cell boundaries folder bound_path = '/path/to/cell_boundaries' # path to image scale conversion values img_scale_path = 'path/to/micron_to_mosaic_pixel_transform.csv' # provide path to the dapi image of slice 1 replicate 1 img_path = 'path/to/mosaic_DAPI_z0.tif'"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"create-giotto-object-from-aggregated-data","dir":"Articles","previous_headings":"","what":"4. Create Giotto object from aggregated data","title":"Vizgen Mouse Brain Receptor Map","text":"Vizgen provides cell transcript output matrix (cell_by_gene.csv) subcellular spatial transcript information already aggregated provided polygon cell annotations count matrix. Along count matrix, metadata information field view (FOV), spatial location, volume cell (annotation polygons) also provided cell_metadata.csv. Pre-aggregated information can loaded Giotto usual generic createGiottoObject() function. starting raw subcellular information, skip Section 10. create Giotto object, cell_by_gene expression matrix cell_metadata information first read R. Since Giotto accepts expression information features (case genes/transcript counts) rows cells columns, expression matrix must first transposed create object. Additionally dataset, y values inverted loaded match included images. information consult ths standard workflow getting_started_images section.","code":"# read expression matrix and metadata expr_matrix = readExprMatrix(expr_path) meta_dt = data.table::fread(meta_path)  # create giotto object vizgen <- createGiottoObject(expression = Giottot_flex(expr_matrix),                              spatial_locs = meta_dt[,.(center_x, -center_y, V1)],                              instructions = instrs) # add metadata of fov and volume vizgen <- addCellMetadata(vizgen,                           new_metadata = meta_dt[,.(fov, volume)])"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"visualize-cells-in-space-","dir":"Articles","previous_headings":"4. Create Giotto object from aggregated data","what":"4.1 Visualize cells in space.","title":"Vizgen Mouse Brain Receptor Map","text":"","code":"spatPlot2D(vizgen,            point_size = 0.5)"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"visualize-cells-by-fov-","dir":"Articles","previous_headings":"4. Create Giotto object from aggregated data","what":"4.2 Visualize cells by FOV.","title":"Vizgen Mouse Brain Receptor Map","text":"","code":"# FOVs as a factor spatPlot2D(vizgen, point_size = 0.5,            cell_color = 'fov',            show_legend = F)  # FOVs sequentially spatPlot2D(vizgen, point_size = 0.5,            cell_color = 'fov',            color_as_factor = F,            cell_color_gradient = c('white', 'pink', 'red'),            show_legend = F)"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"attaching-images","dir":"Articles","previous_headings":"","what":"5. Attaching images","title":"Vizgen Mouse Brain Receptor Map","text":"Images confocal planes z0 z6 provided DAPI (cell nucleus staining) polyT datasets. micron_to_mosaic_pixel_transform.csv included within images folder provides scaling factors map image spatial coordinates. dataset: micron_to_mosaic_pixel_transform.csv attach z0 dapi image Giotto object. Note: recommended image files local. Placing images cloud network may slow.  Attaching giottoLargeImage Giotto object (provided list 1) updating map image spatial coordinates microns.","code":"# Load in image as a giottoLargeImage object that maps spatial coordinates 1:1 with pixel coordinates dapi0 = createGiottoLargeImage(raster_object = img_path,                                name = 'image')  # Preview image plot(dapi0) # Adds the giottoLargeImage object to giotto object while also shifting values into the negatives vizgen = addGiottoImage(gobject = vizgen,                         largeImages = list(dapi0),                         negative_y = TRUE)  # Read in image scale transform values img_scale_DT = data.table::fread(img_scale_path) x_scale = img_scale_DT$V1[[1]] y_scale = img_scale_DT$V2[[2]] x_shift = img_scale_DT$V3[[1]] y_shift = -img_scale_DT$V3[[2]]  # Update image to reverse the above transformations to convert mosaic pixel to micron # 'first_adj' means that the xy shifts are applied before the subsequent scaling vizgen = updateGiottoLargeImage(gobject = vizgen,                                 largeImage_name = 'image',                                 x_shift = -x_shift,                                 y_shift = -y_shift,                                 scale_x = 1/x_scale,                                 scale_y = 1/y_scale,                                 order = 'first_adj')"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"check-image-alignment","dir":"Articles","previous_headings":"5. Attaching images","what":"5.1 Check image alignment","title":"Vizgen Mouse Brain Receptor Map","text":"","code":"spatPlot2D(gobject = vizgen,            largeImage_name = 'image',            point_size = 0.5,            show_image = TRUE)"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"zooming-in-by-subsetting-the-dataset","dir":"Articles","previous_headings":"5. Attaching images","what":"5.2 Zooming in by subsetting the dataset","title":"Vizgen Mouse Brain Receptor Map","text":"","code":"zoom = subsetGiottoLocs(gobject = vizgen,                         x_min = 2000,                         x_max = 2500,                         y_min = -2500,                         y_max = -2000)  spatPlot2D(gobject = zoom,            largeImage_name = 'image',            point_size = 1,            show_image = TRUE)"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"data-processing","dir":"Articles","previous_headings":"","what":"6. Data processing","title":"Vizgen Mouse Brain Receptor Map","text":"","code":"vizgen <- filterGiotto(gobject = vizgen,                        expression_threshold = 1,                        feat_det_in_min_cells = 100,                        min_det_feats_per_cell = 20)  vizgen <- normalizeGiotto(gobject = vizgen,                           scalefactor = 1000,                           verbose = TRUE)  # add gene and cell statistics vizgen <- addStatistics(gobject = vizgen)"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"visualize-the-number-of-features-per-cell-","dir":"Articles","previous_headings":"6. Data processing","what":"6.1 Visualize the number of features per cell.","title":"Vizgen Mouse Brain Receptor Map","text":"","code":"spatPlot2D(gobject = vizgen,            show_image = F,            point_alpha = 0.7,            cell_color = 'nr_feats',            color_as_factor = F,            point_border_col = 'grey',            point_border_stroke = 0.01,            point_size = 0.5)"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"dimension-reduction","dir":"Articles","previous_headings":"","what":"7. Dimension reduction","title":"Vizgen Mouse Brain Receptor Map","text":"Skipping highly variable feature (HVF) detection. PCA calculated based available genes.","code":"vizgen <- runPCA(gobject = vizgen,                  center = TRUE,                  scale_unit = TRUE) # visualize variance explained per component  screePlot(vizgen,           ncp = 30) plotPCA(gobject = vizgen,         point_size = 0.5) vizgen = runUMAP(vizgen,                  dimensions_to_use = 1:10)  plotUMAP(gobject = vizgen,          point_size = 0.5)"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"leiden-clustering","dir":"Articles","previous_headings":"","what":"8. Leiden Clustering","title":"Vizgen Mouse Brain Receptor Map","text":"Calculate nearest neighbor network perform Leiden clustering. Cell Metadata Preview Visualize Leiden clustering results (‘leiden_clus’) mapped onto UMAP dimension reduction.  Visualize leiden clustering mapped onto spatial data.","code":"vizgen <- createNearestNetwork(vizgen,                                dimensions_to_use = 1:10,                                k = 15)  # Default name for the results is 'leiden_clus' which is then appended to the cell metadata vizgen <- doLeidenCluster(vizgen,                           resolution = 0.2,                           n_iterations = 100) print(pDataDT(vizgen)) cell_ID  fov    volume leiden_clus 1: 110883424764611924400221639916314253469    0  432.1414           9 2: 135188247894899244046039873973964001182    0 1351.8026           9 3: 164766962839370328502017156371562646881    0 1080.6533           9 4: 165747897693809971960756442245389760838    0 1652.0007           9 5: 260943245639750847364278545493286724628    0 1343.3786           9 ---                                                                      78258: 165273009496786595275688065919008183969 1225 1159.6232           9 78259: 250474226357477911702383283537224741401 1225 1058.0623           9 78260:  66106840181174834341279408890707577820 1225 1155.3068           9 78261:  66165211106933093510165165316573672348 1225  394.8081           9 78262:  71051447268015582817266088343399517927 1225  798.6088           9 plotUMAP(vizgen,          cell_color = 'leiden_clus',          point_size = 0.5) spatPlot2D(gobject = vizgen,            cell_color = 'leiden_clus',            point_size = 0.5,            background_color = 'black')"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"spatial-expression-patterns","dir":"Articles","previous_headings":"","what":"9. Spatial expression patterns","title":"Vizgen Mouse Brain Receptor Map","text":"Spatially interesting gene expression can detected first generating spatial network performing Binary Spatial Extraction genes. Preview km_spatialgenes","code":"# create spatial network based on physical distance of cell centroids vizgen = createSpatialNetwork(gobject = vizgen,                               minimum_k = 2,                               maximum_distance_delaunay = 50)  # perform Binary Spatial Extraction of genes km_spatialgenes = binSpect(vizgen) print(km_spatialgenes$feats[1:30]) [1] \"Slc47a1\"   \"Chat\"      \"Th\"        \"Insrr\"     \"Slc17a7\"   \"Pln\"       [7] \"Lmod1\"     \"Blank-119\" \"Hcar1\"     \"Glp1r\"     \"Ptgdr\"     \"Avpr2\"     [13] \"Gpr20\"     \"Myh11\"     \"Glp2r\"     \"Npy2r\"     \"Gpr182\"    \"Chrm1\"     [19] \"Adgrd1\"    \"Mrgprf\"    \"Trhr\"      \"Gfap\"      \"Slc17a8\"   \"Nmbr\"      [25] \"Pth2r\"     \"Rxfp1\"     \"Musk\"      \"F2rl1\"     \"Dgkk\"      \"Chrm5\" # visualize spatial expression of select genes obtained from binSpect spatFeatPlot2D(vizgen,                expression_values = 'scaled',                feats = km_spatialgenes$feats[c(1,2,3,5,16,22)],                cell_color_gradient = c('blue', 'white', 'red'),                point_shape = 'border',                point_border_col = 'grey',                point_border_stroke = 0.01,                point_size = 0.2,                cow_n_col = 2)"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"sec-subcellular","dir":"Articles","previous_headings":"","what":"10. Working with subcellular information","title":"Vizgen Mouse Brain Receptor Map","text":"steps may require strong computer. Vizgen provides raw information used generate aggregated data detected_transcripts.csv cell_boundaries hdf5 files. Giotto can also work directly information.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"optional-define-region-of-interest-and-find-fovs-needed","dir":"Articles","previous_headings":"10. Working with subcellular information","what":"10.1 (Optional) Define region of interest and find FOVs needed","title":"Vizgen Mouse Brain Receptor Map","text":"Loading information grabbing needed FOVs can cut computational requirements. FOVs needed Note: following steps assuming step run.","code":"subsetFOVs = meta_dt[center_x > 2000 & center_x < 3100 &                        center_y > 2500 & center_y < 3500]$fov subsetFOVs = unique(subsetFOVs) print(subsetFOVs) [1] 220 221 222 223 224 225 245 246 247 248 249 250 275 276 277 278 279 280 302 [20] 303 304 305 306 307 330 331 332 333 334 335 358 359 360 361 362 363"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"creating-a-giottopolygon-object","dir":"Articles","previous_headings":"10. Working with subcellular information","what":"10.2 Creating a giottoPolygon object","title":"Vizgen Mouse Brain Receptor Map","text":"Cell boundary annotations represented Giotto giottoPolygon objects can previewed directly plotting .","code":"# read polygons and add them to Giotto # fovs param is optional # polygon_feat_types determines which Vizgen polygon z slices are loaded (There are 0 - 6) polys = readPolygonFilesVizgenHDF5(boundaries_path = bound_path,                                    polygon_feat_types = c(0,6),                                    flip_y_axis = TRUE,                                    fovs = subsetFOVs)  # polys is produced as a list of 2 giottoPolygon objects (z0 and z6) # previewing the first one... plot(polys[[1]])"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"creating-a-giottopoints-object","dir":"Articles","previous_headings":"10. Working with subcellular information","what":"10.3 Creating a giottoPoints object","title":"Vizgen Mouse Brain Receptor Map","text":"Giotto represents single-molecule transcript level spatial data giottoPoints objects.","code":"tx_dt = data.table::fread(tx_path) # select transcripts in FOVs tx_dt_selected = tx_dt[fov %in% subsetFOVs] tx_dt_selected$global_y = -tx_dt_selected$global_y # (note the inverted y is the same as when spatial locations were loaded)  # create Giotto points from transcripts  gpoints = createGiottoPoints(x = tx_dt_selected[,.(global_x, global_y, gene, global_z)])  # preview the giottoPoints object (Including specific feats to plot is highly recommended) # Not providing the feats param will plot ALL features detected plot(gpoints,      feats = c('Gfap', 'Ackr1'),      point_size = 0.1)"},{"path":"https://drieslab.github.io/Giotto/articles/vizgen_mouse_brain.html","id":"creating-a-subcellular-giotto-object","dir":"Articles","previous_headings":"10. Working with subcellular information","what":"10.4 Creating a subcellular Giotto object","title":"Vizgen Mouse Brain Receptor Map","text":"Alternatively append subcellular data existing giotto object. subcellular information can also attached giotto objects built pre-aggregated information. Visualize subset","code":"# Create new giotto instructions to set different save directory if desired # instrs_sub = createGiottoInstructions(show_plot = FALSE, #                                       return_plot = FALSE, #                                       save_plot = TRUE, #                                       save_dir = \"path/to/subcellular/save/folder\")  vizgen_subcellular = createGiottoObjectSubcellular(gpoints = list(rna = gpoints),                                                    gpolygons = polys,                                                    # instructions = instrs_sub )  # Find polygon centroids and generate associated spatial locations vizgen_subcellular = addSpatialCentroidLocations(vizgen_subcellular,                                                  poly_info = c('z0', 'z6'))   # Append images **(Details about these functions can be found in step 5)** # Run following two commented lines if skipping to this step # dapi0 = createGiottoLargeImage(raster_object = img_path, name = 'image') # img_scale_DT = data.table::fread(img_scale_path) vizgen_subcellular = addGiottoImage(gobject = vizgen_subcellular,                                     largeImages = list(dapi0), negative_y = TRUE) x_scale = img_scale_DT$V1[[1]] ; y_scale = img_scale_DT$V2[[2]] x_shift = img_scale_DT$V3[[1]] ; y_shift = -img_scale_DT$V3[[2]] vizgen_subcellular = updateGiottoLargeImage(gobject = vizgen_subcellular,                                             largeImage_name = 'image', x_shift = -x_shift, y_shift = -y_shift,                                             scale_x = 1/x_scale, scale_y = 1/y_scale, order = 'first_adj') # Subset dataset to work with smaller area vizgen_subset = subsetGiottoLocs(vizgen,                                  x_min = 2000, x_max = 3000,                                  y_min = -3500, y_max = -2500)  # add points to Giotto object vizgen_subset = addGiottoPoints(gobject = vizgen_subset,                                 gpoints = list(rna = gpoints)) # There will be a warning that 14 features are not present in vizgen_subset # (They were previously removed during data processing in step 6)  # add polygons to Giotto object vizgen_subset = addGiottoPolygons(gobject = vizgen_subset,                                   gpolygons = polys) # If the polygons had not already been read readPolygonFilesVizgen() should be used instead # vizgen_subset = readPolygonFilesVizgen(gobject = vizgen_subset, # boundaries_path = bound_path, # polygon_feat_types = c(0,6)) # Defines which z slices (polys) are read in  # Calculate centroid locations vizgen_subset = addSpatialCentroidLocations(vizgen_subset,                                             poly_info = c('z0', 'z6')) spatPlot2D(gobject = vizgen_subset,            show_image = TRUE,            largeImage_name = 'image',            cell_color = 'leiden_clus',            point_size = 2.5) # identify genes for visualization gene_meta = fDataDT(vizgen_subset) data.table::setorder(gene_meta, perc_cells) gene_meta[perc_cells > 25 & perc_cells < 50]  # visualize points with z0 polygons (confocal plane) spatInSituPlotPoints(vizgen_subset,                      feats = list('rna' = c(\"Oxgr1\", \"Htr1a\", \"Gjc3\", \"Axl\",                                             'Gfap', \"Olig1\", \"Epha7\")),                      polygon_feat_type = 'z0',                      use_overlap = FALSE,                      point_size = 0.1,                      polygon_line_size = 1,                      show_polygon = TRUE,                      polygon_bg_color = 'white',                      polygon_color = 'white') # visualize select genes with z0 polygons (confocal plane) spatInSituPlotPoints(vizgen_subcellular,                      feats = list('rna' = c(\"Oxgr1\", \"Htr1a\", \"Gjc3\", \"Axl\",                                             'Gfap', \"Olig1\", \"Epha7\")),                      polygon_feat_type = 'z0',                      use_overlap = FALSE,                      point_size = 0.1,                      polygon_line_size = 0.1,                      show_polygon = TRUE,                      polygon_bg_color = 'white',                      polygon_color = 'white',                      coord_fix_ratio = TRUE,                      save_param = list(base_height = 10,                                        base_width = 10)) # Zoom in further and visualize with image vizgen_subcellular_zoom = subsetGiottoLocs(vizgen_subcellular,                                            poly_info = c('z0','z6'),                                            x_min = 2400, x_max = 2600,                                            y_min = -3200, y_max = -3000)  spatInSituPlotPoints(vizgen_subcellular_zoom,                      feats = list('rna' = c(\"Oxgr1\", \"Htr1a\", \"Gjc3\", \"Axl\",                                             'Gfap', \"Olig1\", \"Epha7\")),                      polygon_feat_type = 'z0',                      use_overlap = FALSE,                      point_size = 0.5,                      polygon_line_size = 0.2,                      show_polygon = TRUE,                      polygon_bg_color = 'white',                      polygon_color = 'white',                      polygon_alpha = 0.1,                      show_image = TRUE,                      largeImage_name = 'image',                      coord_fix_ratio = TRUE,                      save_param = list(base_height = 10,                                        base_width = 10)) spatInSituPlotPoints(vizgen_subcellular_zoom,                      feats = list('rna' = c(\"Oxgr1\", \"Htr1a\", \"Gjc3\", \"Axl\",                                             'Gfap', \"Olig1\", \"Epha7\")),                      polygon_feat_type = 'z6', # Use polygon from z slice 6 this time                      use_overlap = FALSE,                      point_size = 0.5,                      polygon_line_size = 0.2,                      show_polygon = TRUE,                      polygon_bg_color = 'white',                      polygon_color = 'white',                      polygon_alpha = 0.1,                      show_image = TRUE,                      largeImage_name = 'image',                      coord_fix_ratio = TRUE,                      save_param = list(base_height = 10,                                        base_width = 10))"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"set-up-giotto-environment","dir":"Articles","previous_headings":"","what":"1. Set up Giotto environment","title":"Xenium Human Breast Cancer Pre-Release","text":"","code":"# 1. ** SET WORKING DIRECTORY WHERE PROJECT OUPUTS WILL SAVE TO ** results_folder = '/path/to/save/directory/'  # 2. set giotto python path # set python path to your preferred python version path # set python path to NULL if you want to automatically install (only the 1st time) and use the giotto miniconda environment python_path = NULL  if(is.null(python_path)) {   installGiottoEnvironment() }  # 3. Create Giotto instructions # Directly saving plots to the working directory without rendering them in the editor saves time. instrs = createGiottoInstructions(save_dir = results_folder,                                   save_plot = TRUE,                                   show_plot = FALSE,                                   return_plot = FALSE)"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"dataset-explanation","dir":"Articles","previous_headings":"","what":"2. Dataset explanation","title":"Xenium Human Breast Cancer Pre-Release","text":"vignette covers Giotto object creation simple exploratory analysis 10x Genomics’ subcellular Xenium Situ platform data using Human Breast Cancer Dataset provided recent bioRxiv pre-print. data first tissue replicate worked :","code":""},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"project-data-paths","dir":"Articles","previous_headings":"","what":"3. Project data paths","title":"Xenium Human Breast Cancer Pre-Release","text":"Xenium’s exact output folder structure file/formats available final release still subject change. tutorial updated differences release. Note: cell_feature_matrix.tar.gz must unpacked subdirectory within xenium working directory starting.","code":"# ** SET PATH TO FOLDER CONTAINING XENIUM DATA ** xenium_folder = '/path/to/xenium/data/outputs'  # general files (some are supplemental files) settings_path = paste0(xenium_folder, 'experiment.xenium') he_img_path = paste0(xenium_folder, 'Xenium_FFPE_Human_Breast_Cancer_Rep1_he_image.tif') if_img_path = paste0(xenium_folder, 'Xenium_FFPE_Human_Breast_Cancer_Rep1_if_image.tif') panel_meta_path = paste0(xenium_folder, 'Xenium_FFPE_Human_Breast_Cancer_Rep1_panel.tsv') # (optional)  # files (SUBCELLULAR): (tutorial focuses on working with these files) cell_bound_path = paste0(xenium_folder, 'cell_boundaries.csv.gz') nuc_bound_path = paste0(xenium_folder, 'nucleus_boundaries.csv.gz') tx_path = paste0(xenium_folder, 'transcripts.csv.gz') feat_meta_path = paste0(xenium_folder, 'cell_feature_matrix/features.tsv.gz') # (also used in aggregate)  # files (AGGREGATE): expr_mat_path = paste0(xenium_folder, 'cell_feature_matrix') cell_meta_path = paste0(xenium_folder, 'cells.csv.gz') # contains spatlocs"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"xenium-feature-types-exploration","dir":"Articles","previous_headings":"","what":"4. Xenium feature types exploration","title":"Xenium Human Breast Cancer Pre-Release","text":"features.tsv.gz within cell_feature_matrix.tar.gz provides information different feature types available within Xenium’s two types expression outputs: aggregated cell feature matrix transcript detections transcripts.csv.gz four types probes used, represented exports: gene expression: Gene expression detection blank codeword: Unused codeword - probes generate codeword negative control codeword: Valid codewords probes yield code, can used assess specificity decoding algorithm negative control probe: Probes exist panel, target ERCC non-biological sequences, can used assess specificity assay dataset 313 probes dedicated gene expression transcript detection.","code":"# load features metadata # (make sure cell_feature_matrix folder is unpacked) feature_dt = data.table::fread(feat_meta_path, header = FALSE) colnames(feature_dt) = c('ensembl_ID','feat_name','feat_type')  # find the feature IDs that belong to each feature type feature_dt[, table(feat_type)] feat_types = names(feature_dt[, table(feat_type)])  feat_types_IDs = lapply(   feat_types, function(type) feature_dt[feat_type == type, unique(feat_name)] ) names(feat_types_IDs) = feat_types # feat_type #            Blank Codeword           Gene Expression #                       159                       313 #            Negative Control Codeword    Negative Control Probe  #                                   41                        28 #   [1] \"ABCC11\"   \"ACTA2\"    \"ACTG2\"    \"ADAM9\"    \"ADGRE5\"   \"ADH1B\"    #   [7] \"ADIPOQ\"   \"AGR3\"     \"AHSP\"     \"AIF1\"     \"AKR1C1\"   \"AKR1C3\"   #  [13] \"ALDH1A3\"  \"ANGPT2\"   \"ANKRD28\"  \"ANKRD29\"  \"ANKRD30A\" \"APOBEC3A\" #  [19] \"APOBEC3B\" \"APOC1\"    \"AQP1\"     \"AQP3\"     \"AR\"       \"AVPR1A\"   #  [25] \"BACE2\"    \"BANK1\"    \"BASP1\"    \"BTNL9\"    \"C15orf48\" \"C1QA\"     #  [31] \"C1QC\"     \"C2orf42\"  \"C5orf46\"  \"C6orf132\" \"CAV1\"     \"CAVIN2\"   #  [37] \"CCDC6\"    \"CCDC80\"   \"CCL20\"    \"CCL5\"     \"CCL8\"     \"CCND1\"    #  [43] \"CCPG1\"    \"CCR7\"     \"CD14\"     \"CD163\"    \"CD19\"     \"CD1C\"     #  [49] \"CD247\"    \"CD27\"     \"CD274\"    \"CD3D\"     \"CD3E\"     \"CD3G\"     #  [55] \"CD4\"      \"CD68\"     \"CD69\"     \"CD79A\"    \"CD79B\"    \"CD80\"     #  [61] \"CD83\"     \"CD86\"     \"CD8A\"     \"CD8B\"     \"CD9\"      \"CD93\"     #  [67] \"CDC42EP1\" \"CDH1\"     \"CEACAM6\"  \"CEACAM8\"  \"CENPF\"    \"CLCA2\"    #  [73] \"CLDN4\"    \"CLDN5\"    \"CLEC14A\"  \"CLEC9A\"   \"CLECL1\"   \"CLIC6\"    #  [79] \"CPA3\"     \"CRHBP\"    \"CRISPLD2\" \"CSF3\"     \"CTH\"      \"CTLA4\"    #  [85] \"CTSG\"     \"CTTN\"     \"CX3CR1\"   \"CXCL12\"   \"CXCL16\"   \"CXCL5\"    #  [91] \"CXCR4\"    \"CYP1A1\"   \"CYTIP\"    \"DAPK3\"    \"DERL3\"    \"DMKN\"     #  [97] \"DNAAF1\"   \"DNTTIP1\"  \"DPT\"      \"DSC2\"     \"DSP\"      \"DST\"      # [103] \"DUSP2\"    \"DUSP5\"    \"EDN1\"     \"EDNRB\"    \"EGFL7\"    \"EGFR\"     # [109] \"EIF4EBP1\" \"ELF3\"     \"ELF5\"     \"ENAH\"     \"EPCAM\"    \"ERBB2\"    # [115] \"ERN1\"     \"ESM1\"     \"ESR1\"     \"FAM107B\"  \"FAM49A\"   \"FASN\"     # [121] \"FBLIM1\"   \"FBLN1\"    \"FCER1A\"   \"FCER1G\"   \"FCGR3A\"   \"FGL2\"     # [127] \"FLNB\"     \"FOXA1\"    \"FOXC2\"    \"FOXP3\"    \"FSTL3\"    \"GATA3\"    # [133] \"GJB2\"     \"GLIPR1\"   \"GNLY\"     \"GPR183\"   \"GZMA\"     \"GZMB\"     # [139] \"GZMK\"     \"HAVCR2\"   \"HDC\"      \"HMGA1\"    \"HOOK2\"    \"HOXD8\"    # [145] \"HOXD9\"    \"HPX\"      \"IGF1\"     \"IGSF6\"    \"IL2RA\"    \"IL2RG\"    # [151] \"IL3RA\"    \"IL7R\"     \"ITGAM\"    \"ITGAX\"    \"ITM2C\"    \"JUP\"      # [157] \"KARS\"     \"KDR\"      \"KIT\"      \"KLF5\"     \"KLRB1\"    \"KLRC1\"    # [163] \"KLRD1\"    \"KLRF1\"    \"KRT14\"    \"KRT15\"    \"KRT16\"    \"KRT23\"    # [169] \"KRT5\"     \"KRT6B\"    \"KRT7\"     \"KRT8\"     \"LAG3\"     \"LARS\"     # [175] \"LDHB\"     \"LEP\"      \"LGALSL\"   \"LIF\"      \"LILRA4\"   \"LPL\"      # [181] \"LPXN\"     \"LRRC15\"   \"LTB\"      \"LUM\"      \"LY86\"     \"LYPD3\"    # [187] \"LYZ\"      \"MAP3K8\"   \"MDM2\"     \"MEDAG\"    \"MKI67\"    \"MLPH\"     # [193] \"MMP1\"     \"MMP12\"    \"MMP2\"     \"MMRN2\"    \"MNDA\"     \"MPO\"      # [199] \"MRC1\"     \"MS4A1\"    \"MUC6\"     \"MYBPC1\"   \"MYH11\"    \"MYLK\"     # [205] \"MYO5B\"    \"MZB1\"     \"NARS\"     \"NCAM1\"    \"NDUFA4L2\" \"NKG7\"     # [211] \"NOSTRIN\"  \"NPM3\"     \"OCIAD2\"   \"OPRPN\"    \"OXTR\"     \"PCLAF\"    # [217] \"PCOLCE\"   \"PDCD1\"    \"PDCD1LG2\" \"PDE4A\"    \"PDGFRA\"   \"PDGFRB\"   # [223] \"PDK4\"     \"PECAM1\"   \"PELI1\"    \"PGR\"      \"PIGR\"     \"PIM1\"     # [229] \"PLD4\"     \"POLR2J3\"  \"POSTN\"    \"PPARG\"    \"PRDM1\"    \"PRF1\"     # [235] \"PTGDS\"    \"PTN\"      \"PTPRC\"    \"PTRHD1\"   \"QARS\"     \"RAB30\"    # [241] \"RAMP2\"    \"RAPGEF3\"  \"REXO4\"    \"RHOH\"     \"RORC\"     \"RTKN2\"    # [247] \"RUNX1\"    \"S100A14\"  \"S100A4\"   \"S100A8\"   \"SCD\"      \"SCGB2A1\"  # [253] \"SDC4\"     \"SEC11C\"   \"SEC24A\"   \"SELL\"     \"SERHL2\"   \"SERPINA3\" # [259] \"SERPINB9\" \"SFRP1\"    \"SFRP4\"    \"SH3YL1\"   \"SLAMF1\"   \"SLAMF7\"   # [265] \"SLC25A37\" \"SLC4A1\"   \"SLC5A6\"   \"SMAP2\"    \"SMS\"      \"SNAI1\"    # [271] \"SOX17\"    \"SOX18\"    \"SPIB\"     \"SQLE\"     \"SRPK1\"    \"SSTR2\"    # [277] \"STC1\"     \"SVIL\"     \"TAC1\"     \"TACSTD2\"  \"TCEAL7\"   \"TCF15\"    # [283] \"TCF4\"     \"TCF7\"     \"TCIM\"     \"TCL1A\"    \"TENT5C\"   \"TFAP2A\"   # [289] \"THAP2\"    \"TIFA\"     \"TIGIT\"    \"TIMP4\"    \"TMEM147\"  \"TNFRSF17\" # [295] \"TOMM7\"    \"TOP2A\"    \"TPD52\"    \"TPSAB1\"   \"TRAC\"     \"TRAF4\"    # [301] \"TRAPPC3\"  \"TRIB1\"    \"TUBA4A\"   \"TUBB2B\"   \"TYROBP\"   \"UCP1\"     # [307] \"USP53\"    \"VOPP1\"    \"VWF\"      \"WARS\"     \"ZEB1\"     \"ZEB2\"     # [313] \"ZNF562\" #   [1] \"BLANK_0006\" \"BLANK_0013\" \"BLANK_0037\" \"BLANK_0069\" \"BLANK_0072\" #   [6] \"BLANK_0087\" \"BLANK_0110\" \"BLANK_0114\" \"BLANK_0120\" \"BLANK_0147\" #  [11] \"BLANK_0180\" \"BLANK_0186\" \"BLANK_0272\" \"BLANK_0278\" \"BLANK_0319\" #  [16] \"BLANK_0321\" \"BLANK_0337\" \"BLANK_0350\" \"BLANK_0351\" \"BLANK_0352\" #  [21] \"BLANK_0353\" \"BLANK_0354\" \"BLANK_0355\" \"BLANK_0356\" \"BLANK_0357\" #  [26] \"BLANK_0358\" \"BLANK_0359\" \"BLANK_0360\" \"BLANK_0361\" \"BLANK_0362\" #  [31] \"BLANK_0363\" \"BLANK_0364\" \"BLANK_0365\" \"BLANK_0366\" \"BLANK_0367\" #  [36] \"BLANK_0368\" \"BLANK_0369\" \"BLANK_0370\" \"BLANK_0371\" \"BLANK_0372\" #  [41] \"BLANK_0373\" \"BLANK_0374\" \"BLANK_0375\" \"BLANK_0376\" \"BLANK_0377\" #  [46] \"BLANK_0378\" \"BLANK_0379\" \"BLANK_0380\" \"BLANK_0381\" \"BLANK_0382\" #  [51] \"BLANK_0383\" \"BLANK_0384\" \"BLANK_0385\" \"BLANK_0386\" \"BLANK_0387\" #  [56] \"BLANK_0388\" \"BLANK_0389\" \"BLANK_0390\" \"BLANK_0391\" \"BLANK_0392\" #  [61] \"BLANK_0393\" \"BLANK_0394\" \"BLANK_0395\" \"BLANK_0396\" \"BLANK_0397\" #  [66] \"BLANK_0398\" \"BLANK_0399\" \"BLANK_0400\" \"BLANK_0401\" \"BLANK_0402\" #  [71] \"BLANK_0403\" \"BLANK_0404\" \"BLANK_0405\" \"BLANK_0406\" \"BLANK_0407\" #  [76] \"BLANK_0408\" \"BLANK_0409\" \"BLANK_0410\" \"BLANK_0411\" \"BLANK_0412\" #  [81] \"BLANK_0413\" \"BLANK_0414\" \"BLANK_0415\" \"BLANK_0416\" \"BLANK_0417\" #  [86] \"BLANK_0418\" \"BLANK_0419\" \"BLANK_0420\" \"BLANK_0421\" \"BLANK_0422\" #  [91] \"BLANK_0423\" \"BLANK_0424\" \"BLANK_0425\" \"BLANK_0426\" \"BLANK_0427\" #  [96] \"BLANK_0428\" \"BLANK_0429\" \"BLANK_0430\" \"BLANK_0431\" \"BLANK_0432\" # [101] \"BLANK_0433\" \"BLANK_0434\" \"BLANK_0435\" \"BLANK_0436\" \"BLANK_0437\" # [106] \"BLANK_0438\" \"BLANK_0439\" \"BLANK_0440\" \"BLANK_0441\" \"BLANK_0442\" # [111] \"BLANK_0443\" \"BLANK_0444\" \"BLANK_0445\" \"BLANK_0446\" \"BLANK_0447\" # [116] \"BLANK_0448\" \"BLANK_0449\" \"BLANK_0450\" \"BLANK_0451\" \"BLANK_0452\" # [121] \"BLANK_0453\" \"BLANK_0454\" \"BLANK_0455\" \"BLANK_0456\" \"BLANK_0457\" # [126] \"BLANK_0458\" \"BLANK_0459\" \"BLANK_0460\" \"BLANK_0461\" \"BLANK_0462\" # [131] \"BLANK_0463\" \"BLANK_0464\" \"BLANK_0465\" \"BLANK_0466\" \"BLANK_0467\" # [136] \"BLANK_0468\" \"BLANK_0469\" \"BLANK_0470\" \"BLANK_0471\" \"BLANK_0472\" # [141] \"BLANK_0473\" \"BLANK_0474\" \"BLANK_0475\" \"BLANK_0476\" \"BLANK_0477\" # [146] \"BLANK_0478\" \"BLANK_0479\" \"BLANK_0480\" \"BLANK_0481\" \"BLANK_0482\" # [151] \"BLANK_0483\" \"BLANK_0484\" \"BLANK_0485\" \"BLANK_0486\" \"BLANK_0487\" # [156] \"BLANK_0488\" \"BLANK_0489\" \"BLANK_0497\" \"BLANK_0499\" #  [1] \"NegControlCodeword_0500\" \"NegControlCodeword_0501\" #  [3] \"NegControlCodeword_0502\" \"NegControlCodeword_0503\" #  [5] \"NegControlCodeword_0504\" \"NegControlCodeword_0505\" #  [7] \"NegControlCodeword_0506\" \"NegControlCodeword_0507\" #  [9] \"NegControlCodeword_0508\" \"NegControlCodeword_0509\" # [11] \"NegControlCodeword_0510\" \"NegControlCodeword_0511\" # [13] \"NegControlCodeword_0512\" \"NegControlCodeword_0513\" # [15] \"NegControlCodeword_0514\" \"NegControlCodeword_0515\" # [17] \"NegControlCodeword_0516\" \"NegControlCodeword_0517\" # [19] \"NegControlCodeword_0518\" \"NegControlCodeword_0519\" # [21] \"NegControlCodeword_0520\" \"NegControlCodeword_0521\" # [23] \"NegControlCodeword_0522\" \"NegControlCodeword_0523\" # [25] \"NegControlCodeword_0524\" \"NegControlCodeword_0525\" # [27] \"NegControlCodeword_0526\" \"NegControlCodeword_0527\" # [29] \"NegControlCodeword_0528\" \"NegControlCodeword_0529\" # [31] \"NegControlCodeword_0530\" \"NegControlCodeword_0531\" # [33] \"NegControlCodeword_0532\" \"NegControlCodeword_0533\" # [35] \"NegControlCodeword_0534\" \"NegControlCodeword_0535\" # [37] \"NegControlCodeword_0536\" \"NegControlCodeword_0537\" # [39] \"NegControlCodeword_0538\" \"NegControlCodeword_0539\" # [41] \"NegControlCodeword_0540\" #  [1] \"NegControlProbe_00042\" \"NegControlProbe_00041\" \"NegControlProbe_00039\" #  [4] \"NegControlProbe_00035\" \"NegControlProbe_00034\" \"NegControlProbe_00033\" #  [7] \"NegControlProbe_00031\" \"NegControlProbe_00025\" \"NegControlProbe_00024\" # [10] \"NegControlProbe_00022\" \"NegControlProbe_00019\" \"NegControlProbe_00017\" # [13] \"NegControlProbe_00016\" \"NegControlProbe_00014\" \"NegControlProbe_00013\" # [16] \"NegControlProbe_00012\" \"NegControlProbe_00009\" \"NegControlProbe_00004\" # [19] \"NegControlProbe_00003\" \"NegControlProbe_00002\" \"antisense_PROKR2\"      # [22] \"antisense_ULK3\"        \"antisense_SCRIB\"       \"antisense_TRMU\"        # [25] \"antisense_MYLIP\"       \"antisense_LGI3\"        \"antisense_BCL2L15\"     # [28] \"antisense_ADCY4\""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"manual-method","dir":"Articles","previous_headings":"5. Loading Xenium data","what":"5.1 Manual Method","title":"Xenium Human Breast Cancer Pre-Release","text":"Giotto objects can manually assembled feeding data subobjects creation function. convenience function automatically loading xenium data directory generating giotto object also available. (See Section 5.2]) Xenium outputs can analyzed either subcellular information aggregated data detected cell’s subcellular data spatially assigned cell centroid. tutorial work mainly subcellular data work , however workflow load just aggregated data also available convenience function.","code":""},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"load-transcript-level-data","dir":"Articles","previous_headings":"5. Loading Xenium data > 5.1 Manual Method","what":"5.1.1 Load transcript-level data","title":"Xenium Human Breast Cancer Pre-Release","text":"transcripts.csv.gz file containing x, y, z coordinates individual transcript molecules detected Xenium run. also contains QC Phred score tutorial set cutoff 20, 10x uses. Giotto loads filtered subcellular detections giottoPoints object determines correct columns looking columns named 'feat_ID', 'x', 'y'. , use list data.tables generated previous step create list giottoPoints objects. previewing objects using plot(), default behavior plot points within object. objects contain many feature points, highly recommended specify subset features plot using feats param.","code":"tx_dt = data.table::fread(tx_path) data.table::setnames(x = tx_dt,                      old = c('feature_name', 'x_location', 'y_location'),                      new = c('feat_ID', 'x', 'y')) cat('Transcripts info available:\\n ', paste0('\"', colnames(tx_dt), '\"'), '\\n',     'with', tx_dt[,.N], 'unfiltered detections\\n')  # filter by qv (Phred score) tx_dt_filtered = tx_dt[qv >= 20] cat('and', tx_dt_filtered[,.N], 'filtered detections\\n\\n')  # separate detections by feature type tx_dt_types = lapply(   feat_types_IDs, function(types) tx_dt_filtered[feat_ID %in% types] )  invisible(lapply(seq_along(tx_dt_types), function(x) {   cat(names(tx_dt_types)[[x]], 'detections: ', tx_dt_types[[x]][,.N], '\\n') })) # Transcripts info available: #   \"transcript_id\" \"cell_id\" \"overlaps_nucleus\" \"feat_ID\" \"x\" \"y\" \"z_location\" \"qv\"  #  with 43664530 unfiltered detections #  and 34813341 filtered detections #  # Blank Codeword detections: 8805  # Gene Expression detections: 34764833  # Negative Control Codeword detections: 1855  # Negative Control Probe detections: 37848 gpoints_list = lapply(   tx_dt_types, function(x) createGiottoPoints(x = x) ) # 208.499 sec elapsed  # preview QC probe detections plot(gpoints_list$`Blank Codeword`,      point_size = 0.3,      main = 'Blank Codeword') plot(gpoints_list$`Negative Control Codeword`,      point_size = 0.3,      main = 'Negative Control Codeword') plot(gpoints_list$`Negative Control Probe`,      point_size = 0.3,      main = 'Negative Control Probe')  # preview two genes (slower) plot(gpoints_list$`Gene Expression`,  # 77.843 sec elapsed      feats = c('KRT8', 'MS4A1')) tx_dt_types$`Gene Expression`[feat_ID %in% c('KRT8', 'MS4A1'), table(feat_ID)] # feat_ID #   KRT8  MS4A1  # 530190  20926"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"load-polygon-data","dir":"Articles","previous_headings":"5. Loading Xenium data > 5.1 Manual Method","what":"5.1.2 Load polygon data","title":"Xenium Human Breast Cancer Pre-Release","text":"Xenium output provides segmentation/cell boundary information .csv.gz files. represented within Giotto giottoPolygon objects can also directly plotted. function also determines correct columns use looking columns named 'poly_ID', 'x', 'y'. giottoPolygon objects can directly plotted plot(), field view large take long time details lost. , plot polygon centroids cell nucleus polygons accessing calculated results within giottoPolygon’s spatVectorCentroids slot.","code":"cellPoly_dt = data.table::fread(cell_bound_path) nucPoly_dt = data.table::fread(nuc_bound_path)  data.table::setnames(cellPoly_dt,                      old = c('cell_id', 'vertex_x', 'vertex_y'),                      new = c('poly_ID', 'x', 'y')) data.table::setnames(nucPoly_dt,                      old = c('cell_id', 'vertex_x', 'vertex_y'),                      new = c('poly_ID', 'x', 'y'))  gpoly_cells = createGiottoPolygonsFromDfr(segmdfr = cellPoly_dt,                                           name = 'cell',                                           calc_centroids = TRUE) gpoly_nucs = createGiottoPolygonsFromDfr(segmdfr = nucPoly_dt,                                          name = 'nucleus',                                          calc_centroids = TRUE) plot(x = gpoly_nucs, point_size = 0.1, type = 'centroid')"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"create-giotto-object","dir":"Articles","previous_headings":"5. Loading Xenium data > 5.1 Manual Method","what":"5.1.3 Create Giotto Object","title":"Xenium Human Breast Cancer Pre-Release","text":"Now feature data boundaries loaded , subcellular Giotto object can created.","code":"xenium_gobj = createGiottoObjectSubcellular(   gpoints = list(rna = gpoints_list$`Gene Expression`,                  blank_code = gpoints_list$`Blank Codeword`,                  neg_code = gpoints_list$`Negative Control Codeword`,                  neg_probe = gpoints_list$`Negative Control Probe`),   gpolygons = list(cell = gpoly_cells,                    nucleus = gpoly_nucs),   instructions = instrs )"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"sec-autoload","dir":"Articles","previous_headings":"5. Loading Xenium data","what":"5.2 Load dataset - Convenience Function","title":"Xenium Human Breast Cancer Pre-Release","text":"dataset can also loaded convenience function.","code":"subcellular = createGiottoXeniumObject(xenium_dir = xenium_folder,                                        data_to_use = 'subcellular',                                        bounds_to_load = c('cell', 'nucleus'),                                        qv_threshold = 20,                                        h5_expression = F,                                        instructions = instrs,                                        cores = NA) # set number of cores to use # A structured Xenium directory will be used #  # Checking directory contents... #    > analysis info found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_analysis.tar.gz #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_analysis.zarr.zip #    > boundary info found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cell_boundaries.csv.gz #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cell_boundaries.parquet #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_nucleus_boundaries.csv.gz #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_nucleus_boundaries.parquet #    > cell feature matrix found #       └──cell_feature_matrix #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cell_feature_matrix.h5 #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cell_feature_matrix.zarr.zip #    > cell metadata found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cells.csv.gz #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cells.parquet #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cells.zarr.zip #    > image info found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_he_image.tif #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_morphology_focus.ome.tif #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_morphology_mip.ome.tif #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_morphology.ome.tif #    > panel metadata found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_panel.tsv #    > raw transcript info found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_transcripts.csv.gz #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_transcripts.parquet #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_transcripts.zarr.zip #    > experiment info found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_experiment.xenium # Directory check done # Loading feature metadata... # Loading transcript level info... # |--------------------------------------------------| # |==================================================| # Loading boundary info... # Loading cell metadata... # Building subcellular giotto object... # > points data... #   Selecting col \"feature_name\" as feat_ID column #   Selecting cols \"x_location\" and \"y_location\" as x and y respectively # > polygons data... #   [cell] bounds... #   Selecting col \"cell_id\" as poly_ID column #   Selecting cols \"vertex_x\" and \"vertex_y\" as x and y respectively #   [nucleus] bounds... #   Selecting col \"cell_id\" as poly_ID column #   Selecting cols \"vertex_x\" and \"vertex_y\" as x and y respectively # 1. Start extracting polygon information  # 2. Finished extracting polygon information  # 3. Add centroid / spatial locations if available  # 3. Finish adding centroid / spatial locations  # 3. Start extracting spatial feature information  # 4. Finished extracting spatial feature information  # Calculating polygon centroids... # Start centroid calculation for polygon information layer:  cell  # Start centroid calculation for polygon information layer:  nucleus aggregate = createGiottoXeniumObject(xenium_dir = xenium_folder,                                      data_to_use = 'aggregate',                                      h5_expression = F,                                      instructions = instrs,                                      cores = NA) # set number of cores to use # A structured Xenium directory will be used #  # Checking directory contents... #    > analysis info found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_analysis.tar.gz #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_analysis.zarr.zip #    > boundary info found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cell_boundaries.csv.gz #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cell_boundaries.parquet #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_nucleus_boundaries.csv.gz #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_nucleus_boundaries.parquet #    > cell feature matrix found #       └──cell_feature_matrix #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cell_feature_matrix.h5 #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cell_feature_matrix.zarr.zip #    > cell metadata found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cells.csv.gz #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cells.parquet #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_cells.zarr.zip #    > image info found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_he_image.tif #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_morphology_focus.ome.tif #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_morphology_mip.ome.tif #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_morphology.ome.tif #    > panel metadata found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_panel.tsv #    > raw transcript info found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_transcripts.csv.gz #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_transcripts.parquet #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_transcripts.zarr.zip #    > experiment info found #       └──Xenium_FFPE_Human_Breast_Cancer_Rep1_experiment.xenium # Directory check done # Loading feature metadata... # Loading cell metadata... # Loading aggregated expression... # Building aggregate giotto object... # Consider to install these (optional) packages to run all possible # Giotto commands for spatial analyses: trendsceek multinet RTriangle # Giotto does not automatically install all these packages as they are # not absolutely required and this reduces the number of dependencies # List of 4 #  $ raw                      :Formal class 'dgTMatrix' [package \"Matrix\"] with 6 slots #   .. ..@ i       : int [1:10663545] 1 2 29 30 36 37 39 42 44 47 ... #   .. ..@ j       : int [1:10663545] 0 0 0 0 0 0 0 0 0 0 ... #   .. ..@ Dim     : int [1:2] 313 167782 #   .. ..@ Dimnames:List of 2 #   .. .. ..$ : Named chr [1:313] \"ABCC11\" \"ACTA2\" \"ACTG2\" \"ADAM9\" ... #   .. .. .. ..- attr(*, \"names\")= chr [1:313] \"1\" \"2\" \"3\" \"4\" ... #   .. .. ..$ : chr [1:167782] \"1\" \"2\" \"3\" \"4\" ... #   .. ..@ x       : num [1:10663545] 3 1 1 3 1 1 1 1 1 1 ... #   .. ..@ factors : list() #  $ Negative_Control_Probe   :Formal class 'dgTMatrix' [package \"Matrix\"] with 6 slots #   .. ..@ i       : int [1:24312] 18 20 22 22 22 22 20 25 26 20 ... #   .. ..@ j       : int [1:24312] 48 79 79 130 175 205 214 215 223 248 ... #   .. ..@ Dim     : int [1:2] 28 167782 #   .. ..@ Dimnames:List of 2 #   .. .. ..$ : Named chr [1:28] \"NegControlProbe_00042\" \"NegControlProbe_00041\" \"NegControlProbe_00039\" \"NegControlProbe_00035\" ... #   .. .. .. ..- attr(*, \"names\")= chr [1:28] \"314\" \"315\" \"316\" \"317\" ... #   .. .. ..$ : chr [1:167782] \"1\" \"2\" \"3\" \"4\" ... #   .. ..@ x       : num [1:24312] 1 1 1 1 1 1 1 1 1 1 ... #   .. ..@ factors : list() #  $ Negative_Control_Codeword:Formal class 'dgTMatrix' [package \"Matrix\"] with 6 slots #   .. ..@ i       : int [1:1777] 33 14 3 31 3 8 24 10 22 27 ... #   .. ..@ j       : int [1:1777] 177 373 381 583 605 673 733 850 924 1033 ... #   .. ..@ Dim     : int [1:2] 41 167782 #   .. ..@ Dimnames:List of 2 #   .. .. ..$ : Named chr [1:41] \"NegControlCodeword_0500\" \"NegControlCodeword_0501\" \"NegControlCodeword_0502\" \"NegControlCodeword_0503\" ... #   .. .. .. ..- attr(*, \"names\")= chr [1:41] \"342\" \"343\" \"344\" \"345\" ... #   .. .. ..$ : chr [1:167782] \"1\" \"2\" \"3\" \"4\" ... #   .. ..@ x       : num [1:1777] 1 1 1 1 1 1 1 1 1 1 ... #   .. ..@ factors : list() #  $ Blank_Codeword           :Formal class 'dgTMatrix' [package \"Matrix\"] with 6 slots #   .. ..@ i       : int [1:8404] 114 76 33 7 34 8 119 91 6 116 ... #   .. ..@ j       : int [1:8404] 83 111 114 138 183 245 312 322 338 354 ... #   .. ..@ Dim     : int [1:2] 159 167782 #   .. ..@ Dimnames:List of 2 #   .. .. ..$ : Named chr [1:159] \"BLANK_0006\" \"BLANK_0013\" \"BLANK_0037\" \"BLANK_0069\" ... #   .. .. .. ..- attr(*, \"names\")= chr [1:159] \"383\" \"384\" \"385\" \"386\" ... #   .. .. ..$ : chr [1:167782] \"1\" \"2\" \"3\" \"4\" ... #   .. ..@ x       : num [1:8404] 1 1 1 1 1 1 1 1 1 1 ... #   .. ..@ factors : list() # NULL # list depth of 1  # finished expression data # List of 1 #  $ raw:Classes ‘data.table’ and 'data.frame': 167782 obs. of  3 variables: #   ..$ x_centroid: num [1:167782] 378 382 320 259 371 ... #   ..$ y_centroid: num [1:167782] 844 859 869 852 865 ... #   ..$ cell_ID   : chr [1:167782] \"1\" \"2\" \"3\" \"4\" ... #   ..- attr(*, \".internal.selfref\")=<externalptr>  # NULL # list depth of 1  # There are non numeric or integer columns for the spatial location input at column position(s): 3 #  The first non-numeric column will be considered as a cell ID to test for consistency with the expression matrix #  Other non numeric columns will be removed # finished spatial location data # finished cell metadata # No spatial networks are provided # No spatial enrichment results are provided # No dimension reduction results are provided # No nearest network results are provided"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"spatial-info","dir":"Articles","previous_headings":"6. Visualize Giotto object and cells","what":"6.1 Spatial info","title":"Xenium Human Breast Cancer Pre-Release","text":"Print available spatial cell nucleus boundary information (polygons) within Giotto object spatial_info slot.","code":"showGiottoSpatialInfo(xenium_gobj) # For Spatial info:  cell  #  # An object of class \"giottoPolygon\" # Slot \"name\": # [1] \"cell\" #  # Slot \"spatVector\": #  class       : SpatVector  #  geometry    : polygons  #  dimensions  : 167782, 1  (geometries, attributes) #  extent      : 0, 7525.9, 0, 5478.038  (xmin, xmax, ymin, ymax) #  coord. ref. :   #  # Slot \"spatVectorCentroids\": #  class       : SpatVector  #  geometry    : points  #  dimensions  : 167782, 1  (geometries, attributes) #  extent      : 2.189156, 7523.163, 1.406448, 5476.467  (xmin, xmax, ymin, ymax) #  coord. ref. :   #  # Slot \"overlaps\": # NULL #  # ----------------------------- #   # For Spatial info:  nucleus  #  # An object of class \"giottoPolygon\" # Slot \"name\": # [1] \"nucleus\" #  # Slot \"spatVector\": #  class       : SpatVector  #  geometry    : polygons  #  dimensions  : 167782, 1  (geometries, attributes) #  extent      : 1.4875, 7524.413, 0, 5478.038  (xmin, xmax, ymin, ymax) #  coord. ref. :   #  # Slot \"spatVectorCentroids\": #  class       : SpatVector  #  geometry    : points  #  dimensions  : 167782, 1  (geometries, attributes) #  extent      : 2.596845, 7523.503, 0.8111559, 5477.374  (xmin, xmax, ymin, ymax) #  coord. ref. :   #  # Slot \"overlaps\": # NULL #  # -----------------------------"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"spatial-locations","dir":"Articles","previous_headings":"6. Visualize Giotto object and cells","what":"6.2 Spatial locations","title":"Xenium Human Breast Cancer Pre-Release","text":"Print available spatial locations within Giotto object’s spatial_locs slot. generated centroids calculation polygons, used generated aggregate information.","code":"showGiottoSpatLocs(xenium_gobj) # ├──Spatial unit \"cell\" # │  └──S4 spatLocsObj \"raw\" coordinates:   (167782 rows) # │        An object of class spatLocsObj  # │        provenance: cell # │            ------------------------ # │           cell_ID    sdimx    sdimy # │        1:       1 377.6355 843.5235 # │        2:       2 382.0902 858.9148 # │        3:       3 319.8592 869.1546 # │        4:       4 259.2721 851.8312 # │         # │        ranges: # │                   sdimx       sdimy # │        [1,]    2.189156    1.406448 # │        [2,] 7523.162860 5476.466538 # │         # │         # │      # └──Spatial unit \"nucleus\" #    └──S4 spatLocsObj \"raw\" coordinates:   (167782 rows) #          An object of class spatLocsObj  #          provenance: nucleus #              ------------------------ #             cell_ID    sdimx    sdimy #          1:       1 377.8125 842.8358 #          2:       2 384.3298 858.9976 #          3:       3 321.9175 869.2366 #          4:       4 257.3259 851.5493 #           #          ranges: #                     sdimx        sdimy #          [1,]    2.596845    0.8111559 #          [2,] 7523.503184 5477.3741650"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"plot-the-generated-centroids-information","dir":"Articles","previous_headings":"6. Visualize Giotto object and cells","what":"6.3 Plot the generated centroids information","title":"Xenium Human Breast Cancer Pre-Release","text":"","code":"spatPlot2D(xenium_gobj,            spat_unit = 'cell',            point_shape = 'no_border',            point_size = 0.5,            point_alpha = 0.4,            save_param = list(              base_width = 7,              base_height = 7,              save_name = '1_spatplot'))"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"calculate-the-overlaps-of-the-rna-feature-data-within-the-cell-polygon-boundary-info-","dir":"Articles","previous_headings":"7. Generate aggregated expression based on feature and boundary (polygon) information","what":"7.1 Calculate the overlaps of the 'rna' feature data within the 'cell' polygon boundary info.","title":"Xenium Human Breast Cancer Pre-Release","text":"updates 'cell' giottoPolygon overlaps slot features overlapping 'cell' polygons.","code":"xenium_gobj = calculateOverlapRaster(xenium_gobj,                                      spatial_info = 'cell',                                      feat_info = 'rna')  showGiottoSpatialInfo(xenium_gobj) # For Spatial info:  cell  #  # An object of class \"giottoPolygon\" # Slot \"name\": # [1] \"cell\" #  # Slot \"spatVector\": #  class       : SpatVector  #  geometry    : polygons  #  dimensions  : 167782, 1  (geometries, attributes) #  extent      : 0, 7525.9, 0, 5478.038  (xmin, xmax, ymin, ymax) #  coord. ref. :   #  names       : poly_ID #  type        :   <chr> #  values      :       1 #                      2 #                      3 #  # Slot \"spatVectorCentroids\": #  class       : SpatVector  #  geometry    : points  #  dimensions  : 167782, 1  (geometries, attributes) #  extent      : 2.189156, 7523.163, 1.406448, 5476.467  (xmin, xmax, ymin, ymax) #  coord. ref. :   #  names       : poly_ID #  type        :   <chr> #  values      :       1 #                      2 #                      3 #  # Slot \"overlaps\": # $rna #  class       : SpatVector  #  geometry    : points  #  dimensions  : 43664530, 3  (geometries, attributes) #  extent      : -1.874261, 7522.837, 4.415276, 5473.721  (xmin, xmax, ymin, ymax) #  coord. ref. :   #  names       : poly_ID    feat_ID feat_ID_uniq #  type        :   <chr>      <chr>        <int> #  values      :   18790 BLANK_0180            1 #                    370        LUM            2 #                  18183     CLECL1            3 #  #  # ----------------------------- #   # For Spatial info:  nucleus  #         ...  #      truncated"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"assign-polygon-overlaps-information-to-expression-matrix","dir":"Articles","previous_headings":"7. Generate aggregated expression based on feature and boundary (polygon) information","what":"7.2 Assign polygon overlaps information to expression matrix","title":"Xenium Human Breast Cancer Pre-Release","text":"order create aggregated expression matrix, 'rna' features overlapped 'cell' polygon boundaries sent combined cell/feature matrix (named 'raw') Giotto object’s expression slot.","code":"xenium_gobj = overlapToMatrix(xenium_gobj,                               poly_info = 'cell',                               feat_info = 'rna',                               name = 'raw')  showGiottoExpression(xenium_gobj) # └──Spatial unit \"cell\" #    └──Feature type \"rna\" #       └──Expression data \"raw\" values: #             An object of class exprObj  #             for spatial unit: \"cell\" and feature type: \"rna\"  #               Provenance:  cell  #              #             contains: #             313 x 167782 sparse Matrix of class \"dgCMatrix\" #                                                     #             LUM   2 . 3 . 1 1  2 . . 2 . 5 . ...... #             TCIM  1 1 . 4 1 1 13 . . . . . . ...... #             RUNX1 . . . . . .  . . . . 1 . . ...... #              #              .............................. #              ........suppressing 167769 columns and 307 rows  #              .............................. #                                                     #             CD1C   1 . . . . . . . . . . . . ...... #             CYP1A1 . . . . . . . . . . . . . ...... #             CRHBP  . . . . . . . . . . . . . ...... #              #              First four colnames: #              1 2 3 4"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"feature-metadata","dir":"Articles","previous_headings":"7. Generate aggregated expression based on feature and boundary (polygon) information","what":"7.3 Feature metadata","title":"Xenium Human Breast Cancer Pre-Release","text":"Append features metadata panel.tsv includes information cell types features commonly markers . 313 rows file. One gene expression probes, thus metadata appended feat_type ‘rna’.","code":"panel_meta = data.table::fread(panel_meta_path) data.table::setnames(panel_meta, 'Name', 'feat_ID')  # Append this metadata xenium_gobj = addFeatMetadata(gobject = xenium_gobj,                               feat_type = 'rna',                               spat_unit = 'cell',                               new_metadata = panel_meta,                               by_column = TRUE,                               column_feat_ID = 'feat_ID') xenium_gobj = addFeatMetadata(gobject = xenium_gobj,                               feat_type = 'rna',                               spat_unit = 'nucleus',                               new_metadata = panel_meta,                               by_column = TRUE,                               column_feat_ID = 'feat_ID')  # to return a specific metadata as data.table  # (spat_unit = 'cell', feat_type = 'rna' are default) # fDataDT(xenium_gobj)  # Print a preview of all available features metadata showGiottoFeatMetadata(xenium_gobj) # ├──Spatial unit \"cell\" # │  ├──Feature type \"rna\" # │  │     An object of class featMetaObj  # │  │     Provenance: cell  # │  │        feat_ID      Ensembl ID             Annotation # │  │     1:     LUM ENSG00000139329            Fibroblasts # │  │     2:    TCIM ENSG00000176907 Breast glandular cells # │  │     3:   RUNX1 ENSG00000159216          Breast cancer # │  │     4: RAPGEF3 ENSG00000079337             Adipocytes # │  │   # │  ├──Feature type \"blank_code\" # │  │     An object of class featMetaObj  # │  │     Provenance: cell  # │  │           feat_ID # │  │     1: BLANK_0424 # │  │     2: BLANK_0401 # │  │     3: BLANK_0447 # │  │     4: BLANK_0449 # │  │   # │  ├──Feature type \"neg_code\" # │  │     An object of class featMetaObj  # │  │     Provenance: cell  # │  │                        feat_ID # │  │     1: NegControlCodeword_0503 # │  │     2: NegControlCodeword_0514 # │  │     3: NegControlCodeword_0535 # │  │     4: NegControlCodeword_0519 # │  │   # │  └──Feature type \"neg_probe\" # │        An object of class featMetaObj  # │        Provenance: cell  # │                         feat_ID # │        1: NegControlProbe_00003 # │        2:       antisense_SCRIB # │        3: NegControlProbe_00012 # │        4:        antisense_LGI3 # │      # └──Spatial unit \"nucleus\" #    ├──Feature type \"rna\" #    │     An object of class featMetaObj  #    │     Provenance: nucleus  #    │        feat_ID      Ensembl ID             Annotation #    │     1:     LUM ENSG00000139329            Fibroblasts #    │     2:    TCIM ENSG00000176907 Breast glandular cells #    │     3:   RUNX1 ENSG00000159216          Breast cancer #    │     4: RAPGEF3 ENSG00000079337             Adipocytes #    │   #    ├──Feature type \"blank_code\" #    │     An object of class featMetaObj  #    │     Provenance: nucleus  #    │           feat_ID #    │     1: BLANK_0424 #    │     2: BLANK_0401 #    │     3: BLANK_0447 #    │     4: BLANK_0449 #    │   #    ├──Feature type \"neg_code\" #    │     An object of class featMetaObj  #    │     Provenance: nucleus  #    │                        feat_ID #    │     1: NegControlCodeword_0503 #    │     2: NegControlCodeword_0514 #    │     3: NegControlCodeword_0535 #    │     4: NegControlCodeword_0519 #    │   #    └──Feature type \"neg_probe\" #          An object of class featMetaObj  #          Provenance: nucleus  #                           feat_ID #          1: NegControlProbe_00003 #          2:       antisense_SCRIB #          3: NegControlProbe_00012 #          4:        antisense_LGI3"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"data-filtering","dir":"Articles","previous_headings":"7. Generate aggregated expression based on feature and boundary (polygon) information","what":"7.4 Data filtering","title":"Xenium Human Breast Cancer Pre-Release","text":"Now aggregated expression matrix generated usual data filtering processing can applied start setting count 1 minimum consider feature expressed. feature must detected least 3 cells included. Lastly, cell must minimum 5 features detected included.","code":"xenium_gobj = filterGiotto(gobject = xenium_gobj,                            spat_unit = 'cell',                            poly_info = 'cell',                            expression_threshold = 1,                            feat_det_in_min_cells = 3,                            min_det_feats_per_cell = 5) #    truncated #      ... # Feature type:  rna  # Number of cells removed:  2945  out of  167782  # Number of feats removed:  0  out of  313"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"add-data-statistics","dir":"Articles","previous_headings":"7. Generate aggregated expression based on feature and boundary (polygon) information","what":"7.5 Add data statistics","title":"Xenium Human Breast Cancer Pre-Release","text":"","code":"xenium_gobj = addStatistics(xenium_gobj, expression_values = 'raw')  showGiottoCellMetadata(xenium_gobj) showGiottoFeatMetadata(xenium_gobj) # ├──Spatial unit \"cell\" # │  ├──Feature type \"rna\" # │  │     An object of class cellMetaObj  # │  │     Provenance: cell  # │  │        cell_ID nr_feats perc_feats total_expr # │  │     1:       1       62   19.80831        156 # │  │     2:       2       41   13.09904         63 # │  │     3:       3       38   12.14058         54 # │  │     4:       4       47   15.01597        114 # │  │   # │  ├──Feature type \"blank_code\" # │  │     An object of class cellMetaObj  # │  │     Provenance: cell  # │  │        cell_ID # │  │     1:       1 # │  │     2:       2 # │  │     3:       3 # │  │     4:       4 # │  │   # │  ├──Feature type \"neg_code\" # │  │     An object of class cellMetaObj  # │  │     Provenance: cell  # │  │        cell_ID # │  │     1:       1 # │  │     2:       2 # │  │     3:       3 # │  │     4:       4 # │  │   # │  └──Feature type \"neg_probe\" # │        An object of class cellMetaObj  # │        Provenance: cell  # │           cell_ID # │        1:       1 # │        2:       2 # │        3:       3 # │        4:       4 # │      # └──Spatial unit \"nucleus\" #    ├──Feature type \"rna\" #    │     An object of class cellMetaObj  #    │     Provenance: nucleus  #    │        cell_ID #    │     1:       1 #    │     2:       2 #    │     3:       3 #    │     4:       4 #    │   #    ├──Feature type \"blank_code\" #    │     An object of class cellMetaObj  #    │     Provenance: nucleus  #    │        cell_ID #    │     1:       1 #    │     2:       2 #    │     3:       3 #    │     4:       4 #    │   #    ├──Feature type \"neg_code\" #    │     An object of class cellMetaObj  #    │     Provenance: nucleus  #    │        cell_ID #    │     1:       1 #    │     2:       2 #    │     3:       3 #    │     4:       4 #    │   #    └──Feature type \"neg_probe\" #          An object of class cellMetaObj  #          Provenance: nucleus  #             cell_ID #          1:       1 #          2:       2 #          3:       3 #          4:       4 # ├──Spatial unit \"cell\" # │  ├──Feature type \"rna\" # │  │     An object of class featMetaObj  # │  │     Provenance: cell  # │  │        feat_ID      Ensembl ID             Annotation nr_cells perc_cells # │  │     1:     LUM ENSG00000139329            Fibroblasts   101666  61.676687 # │  │     2:    TCIM ENSG00000176907 Breast glandular cells    84842  51.470240 # │  │     3:   RUNX1 ENSG00000159216          Breast cancer    94086  57.078205 # │  │     4: RAPGEF3 ENSG00000079337             Adipocytes    13286   8.060084 # │  │        total_expr mean_expr mean_expr_det # │  │     1:     946217 5.7403192      9.307113 # │  │     2:     300377 1.8222668      3.540428 # │  │     3:     229633 1.3930914      2.440671 # │  │     4:      16645 0.1009785      1.252823 # │  │   # │  ├──Feature type \"blank_code\" # │  │     An object of class featMetaObj  # │  │     Provenance: cell  # │  │           feat_ID # │  │     1: BLANK_0424 # │  │     2: BLANK_0401 # │  │     3: BLANK_0447 # │  │     4: BLANK_0449 # │  │   # │  ├──Feature type \"neg_code\" # │  │     An object of class featMetaObj  # │  │     Provenance: cell  # │  │                        feat_ID # │  │     1: NegControlCodeword_0503 # │  │     2: NegControlCodeword_0514 # │  │     3: NegControlCodeword_0535 # │  │     4: NegControlCodeword_0519 # │  │   # │  └──Feature type \"neg_probe\" # │        An object of class featMetaObj  # │        Provenance: cell  # │                         feat_ID # │        1: NegControlProbe_00003 # │        2:       antisense_SCRIB # │        3: NegControlProbe_00012 # │        4:        antisense_LGI3 # │      # └──Spatial unit \"nucleus\" #    ├──Feature type \"rna\" #    │     An object of class featMetaObj  #    │     Provenance: nucleus  #    │        feat_ID      Ensembl ID             Annotation #    │     1:     LUM ENSG00000139329            Fibroblasts #    │     2:    TCIM ENSG00000176907 Breast glandular cells #    │     3:   RUNX1 ENSG00000159216          Breast cancer #    │     4: RAPGEF3 ENSG00000079337             Adipocytes #    │   #    ├──Feature type \"blank_code\" #    │     An object of class featMetaObj  #    │     Provenance: nucleus  #    │           feat_ID #    │     1: BLANK_0424 #    │     2: BLANK_0401 #    │     3: BLANK_0447 #    │     4: BLANK_0449 #    │   #    ├──Feature type \"neg_code\" #    │     An object of class featMetaObj  #    │     Provenance: nucleus  #    │                        feat_ID #    │     1: NegControlCodeword_0503 #    │     2: NegControlCodeword_0514 #    │     3: NegControlCodeword_0535 #    │     4: NegControlCodeword_0519 #    │   #    └──Feature type \"neg_probe\" #          An object of class featMetaObj  #          Provenance: nucleus  #                           feat_ID #          1: NegControlProbe_00003 #          2:       antisense_SCRIB #          3: NegControlProbe_00012 #          4:        antisense_LGI3"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"normalize-expression","dir":"Articles","previous_headings":"7. Generate aggregated expression based on feature and boundary (polygon) information","what":"7.6 Normalize expression","title":"Xenium Human Breast Cancer Pre-Release","text":"","code":"xenium_gobj = normalizeGiotto(gobject = xenium_gobj,                               spat_unit = 'cell',                               scalefactor = 5000,                               verbose = T)"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"calculate-highly-variable-features","dir":"Articles","previous_headings":"7. Generate aggregated expression based on feature and boundary (polygon) information","what":"7.7 Calculate highly variable features","title":"Xenium Human Breast Cancer Pre-Release","text":"Basing clustering 22 highly variable genes helpful. using 313 genes clustering.","code":"xenium_gobj = calculateHVF(gobject = xenium_gobj,                            spat_unit = 'cell',                            save_param = list(                              save_name = '2_HVF'))  cat(fDataDT(xenium_gobj)[, sum(hvf == 'yes')], 'hvf found') # 22 hvf found"},{"path":[]},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"pca","dir":"Articles","previous_headings":"8. Dimension reduction and clustering","what":"8.1 PCA","title":"Xenium Human Breast Cancer Pre-Release","text":"default, runPCA() uses subset genes discovered highly variable assigned feature metadata. Instead, time, using genes desireable, feats_to_use set NULL.","code":"xenium_gobj = runPCA(gobject = xenium_gobj,                      spat_unit = 'cell',                      expression_values = 'scaled',                      feats_to_use = NULL,                      scale_unit = F,                      center = F)  # Visualize Screeplot and PCA screePlot(xenium_gobj,           ncp = 20,           save_param = list(             save_name = '3a_screePlot')) showGiottoDimRed(xenium_gobj) plotPCA(xenium_gobj,         spat_unit = 'cell',         dim_reduction_name = 'pca',         dim1_to_use = 1,         dim2_to_use = 2) # Dim reduction on cells: #  -------------------------  #  # . # └──Spatial unit \"cell\" #    └──Feature type \"rna\" #       └──Dim reduction type \"pca\" #          └──S4 dimObj \"pca\" coordinates:   (165019 rows 21 cols) #                      Dim.1     Dim.2 #                1 -2.459551 -0.418277 #                2 -2.002147 -3.239184 #                3 -1.588884 -2.195826"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"tsne-and-umap","dir":"Articles","previous_headings":"8. Dimension reduction and clustering","what":"8.2 tSNE and UMAP","title":"Xenium Human Breast Cancer Pre-Release","text":"","code":"xenium_gobj = runtSNE(xenium_gobj,                       dimensions_to_use = 1:10,                       spat_unit = 'cell') xenium_gobj = runUMAP(xenium_gobj,                       dimensions_to_use = 1:10,                       spat_unit = 'cell')  plotTSNE(xenium_gobj,          point_size = 0.01,          save_param = list(            save_name = '4a_tSNE')) plotUMAP(xenium_gobj,          point_size = 0.01,          save_param = list(            save_name = '4b_UMAP'))"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"snn-and-leiden-clustering","dir":"Articles","previous_headings":"8. Dimension reduction and clustering","what":"8.3 sNN and Leiden clustering","title":"Xenium Human Breast Cancer Pre-Release","text":"","code":"xenium_gobj = createNearestNetwork(xenium_gobj,                                    dimensions_to_use = 1:10,                                    k = 10,                                    spat_unit = 'cell') xenium_gobj = doLeidenCluster(xenium_gobj,                               resolution = 0.25,                               n_iterations = 100,                               spat_unit = 'cell')  # visualize UMAP cluster results plotUMAP(gobject = xenium_gobj,          spat_unit = 'cell',          cell_color = 'leiden_clus',          show_legend = FALSE,          point_size = 0.01,          point_shape = 'no_border',          save_param = list(save_name = '5_umap_leiden'))"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"visualize-umap-and-spatial-results","dir":"Articles","previous_headings":"8. Dimension reduction and clustering","what":"8.4 Visualize UMAP and spatial results","title":"Xenium Human Breast Cancer Pre-Release","text":"","code":"spatPlot2D(gobject = xenium_gobj,            spat_unit = 'cell',            cell_color = 'leiden_clus',            point_size = 0.1,            point_shape = 'no_border',            background_color = 'black',            show_legend = TRUE,            save_param = list(              save_name = '6_spat_leiden',              base_width = 15,              base_height = 15))"},{"path":"https://drieslab.github.io/Giotto/articles/xenium_breast_cancer.html","id":"subcellular-visualization","dir":"Articles","previous_headings":"","what":"9. Subcellular visualization","title":"Xenium Human Breast Cancer Pre-Release","text":"dataset large visualize subcellular polygons features clearly spatial subset needed.","code":"spatInSituPlotPoints(xenium_gobj,                      show_image = FALSE,                      feats = NULL,                      point_size = 0.05,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_alpha = 1,                      polygon_color = 'black',                      polygon_line_size = 0.01,                      polygon_fill = 'leiden_clus',                      polygon_fill_as_factor = TRUE,                      coord_fix_ratio = TRUE,                      save_para = list(                        save_name = '7_polys')) xenium_gobj_subset = subsetGiottoLocs(xenium_gobj,                                       x_max = 4500,                                       x_min = 3500,                                       y_max = 5500,                                       y_min = 4500)  spatInSituPlotPoints(xenium_gobj_subset,                      show_image = FALSE,                      feats = list('rna' = c(                        \"LUM\", \"CXCR4\", \"ITGAX\")),                      feats_color_code = c(                        \"LUM\" = 'green',                        'CXCR4' = 'blue',                        'ITGAX' = 'red'),                      point_size = 0.05,                      show_polygon = TRUE,                      polygon_feat_type = 'cell',                      polygon_color = 'black',                      polygon_line_size = 0.01,                      polygon_fill = 'leiden_clus',                      polygon_fill_as_factor = TRUE,                      coord_fix_ratio = TRUE,                      save_param = list(                        save_name = '8_subset_in_situ'))"},{"path":"https://drieslab.github.io/Giotto/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ruben Dries. Author, maintainer. Jiaji George Chen. Author. Natalie Del Rossi. Author. Guo-Cheng Yuan. Author. Matthew O'Brien. Author. Joselyn C. Chávez-Fuentes. Author. Edward Ruiz. Author.","code":""},{"path":"https://drieslab.github.io/Giotto/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Dries et al. Giotto, toolbox integrative analysis visualization spatial expression data. bioRxiv (2020).","code":"@Article{,   author = {Ruben Dries and Qian Zhu and Rui Dong and Chee-Huat Linus Eng and Huipeng Li and Kan Liu and Yuntian Fu and Tianxiao Zhao and Arpan Sarkar and Rani E George and Nico Pierson and Long Cai and Guo-Cheng Yuan},   title = {Giotto, a toolbox for integrative analysis and visualization of spatial expression data},   journal = {bioRxiv},   year = {2020},   doi = {10.1101/701680},   url = {https://doi.org/10.1101/701680}, }"},{"path":"https://drieslab.github.io/Giotto/index.html","id":"giotto-suite-","dir":"","previous_headings":"","what":"Spatial Single-Cell Transcriptomics Toolbox","title":"Spatial Single-Cell Transcriptomics Toolbox","text":"Default branch change! release v3.3.0 default branch Giotto moved @master @suite. want install original master version use devtools::install_github(\"drieslab/Giotto@master\"). Visit Giotto Discussions page information. Github Repository changes! Giotto github repository moved https://github.com/drieslab/Giotto associated spatial datasets moved https://github.com/drieslab/spatial-datasets. Website change! created new readthedocs website improve simplify Giotto documentation make easier use Giotto. aggregates information original Giotto package extended Giotto Suite, extended work--development version. - www.spatialgiotto.com links original master version. old master pkgdown documentation can still found https://rubd.github.io/Giotto_site/ - www.giottosuite.com links extended suite version. old suite pkgdown documentation can still found https://drieslab.github.io/Giotto_site_suite/ Giotto Suite major upgrade Giotto package provides tools process, analyze visualize spatial multi-omics data scales multiple resolutions. underlying framework generalizable virtually current emerging spatial technologies. Giotto Suite prototype pipeline generally applicable various different datasets, created state---art spatial technologies, including situ hybridization (seqFISH+, merFISH, osmFISH, CosMx), sequencing (Slide-seq, Visium, STARmap, Seq-Scope, Stereo-Seq) imaging-based multiplexing/proteomics (CyCIF, MIBI, CODEX). technologies differ terms resolution (subcellular, single cell multiple cells), spatial dimension (2D vs 3D), molecular modality (protein, RNA, DNA, …), throughput (number cells analytes). package heavy development. Please check back often! version history/changelog, please see NEWS file.","code":""},{"path":"https://drieslab.github.io/Giotto/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Spatial Single-Cell Transcriptomics Toolbox","text":"Dries, R., Zhu, Q. et al. Giotto: toolbox integrative analysis visualization spatial expression data. Genome Biology (2021). Dries, R., Chen, J. et al. Advances spatial transcriptomic data analysis. Genome Research (2021). Del Rossi, N., Chen, J. et al. Analyzing Spatial Transcriptomics Data Using Giotto. Current Protocols (2022).","code":""},{"path":"https://drieslab.github.io/Giotto/reference/FSV_show.html","id":null,"dir":"Reference","previous_headings":"","what":"FSV_show — FSV_show","title":"FSV_show — FSV_show","text":"Visualize spatial variable genes calculated spatial_DE","code":""},{"path":"https://drieslab.github.io/Giotto/reference/FSV_show.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"FSV_show — FSV_show","text":"","code":"FSV_show(   results,   ms_results = NULL,   size = c(4, 2, 1),   color = c(\"blue\", \"green\", \"red\"),   sig_alpha = 0.5,   unsig_alpha = 0.5 )"},{"path":"https://drieslab.github.io/Giotto/reference/FSV_show.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"FSV_show — FSV_show","text":"results results calculated spatial_DE ms_results ms_results calculated spatial_DE size indicate different levels qval color indicate different SV features sig_alpha transparency significant genes unsig_alpha transparency unsignificant genes","code":""},{"path":"https://drieslab.github.io/Giotto/reference/FSV_show.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"FSV_show — FSV_show","text":"ggplot object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/OR_test_fnc.html","id":null,"dir":"Reference","previous_headings":"","what":"OR_test_fnc — OR_test_fnc","title":"OR_test_fnc — OR_test_fnc","text":"calculate odds-ratio 2x2 matrix","code":""},{"path":"https://drieslab.github.io/Giotto/reference/OR_test_fnc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"OR_test_fnc — OR_test_fnc","text":"","code":"OR_test_fnc(matrix)"},{"path":"https://drieslab.github.io/Giotto/reference/PAGEEnrich.html","id":null,"dir":"Reference","previous_headings":"","what":"PAGEEnrich — PAGEEnrich","title":"PAGEEnrich — PAGEEnrich","text":"Function calculate gene signature enrichment scores per spatial position using PAGE.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/PAGEEnrich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PAGEEnrich — PAGEEnrich","text":"","code":"PAGEEnrich(...)"},{"path":"https://drieslab.github.io/Giotto/reference/PAGEEnrich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PAGEEnrich — PAGEEnrich","text":"... Arguments passed runPAGEEnrich gobject Giotto object spat_unit spatial unit feat_type feature type sign_matrix Matrix signature genes cell type / process expression_values expression values use min_overlap_genes minimum number overlapping genes sign_matrix required calculate enrichment reverse_log_scale reverse expression values log scale logbase log base use reverse_log_scale = TRUE output_enrichment return enrichment output p_value calculate p-values (boolean, default = FALSE) include_depletion calculate enrichment depletion n_times number permutations calculate p_value max_block number lines process together (default = 20e6) name give spatial enrichment results, default = PAGE verbose verbose return_gobject return giotto object","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/PAGE_DT_method.html","id":null,"dir":"Reference","previous_headings":"","what":"PAGE_DT_method — PAGE_DT_method","title":"PAGE_DT_method — PAGE_DT_method","text":"PAGE data.table method","code":""},{"path":"https://drieslab.github.io/Giotto/reference/PAGE_DT_method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PAGE_DT_method — PAGE_DT_method","text":"","code":"PAGE_DT_method(   sign_matrix,   expr_values,   min_overlap_genes = 5,   logbase = 2,   reverse_log_scale = TRUE,   output_enrichment = c(\"original\", \"zscore\"),   p_value = FALSE,   include_depletion = FALSE,   n_times = 1000,   max_block = 2e+07,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/PAGE_DT_method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PAGE_DT_method — PAGE_DT_method","text":"expr_values matrix expression values","code":""},{"path":"https://drieslab.github.io/Giotto/reference/adapt_aspect_ratio.html","id":null,"dir":"Reference","previous_headings":"","what":"adapt_aspect_ratio — adapt_aspect_ratio","title":"adapt_aspect_ratio — adapt_aspect_ratio","text":"adapt aspact ratio inserting cross section mesh grid lines","code":""},{"path":"https://drieslab.github.io/Giotto/reference/adapt_aspect_ratio.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"adapt_aspect_ratio — adapt_aspect_ratio","text":"","code":"adapt_aspect_ratio(   current_ratio,   cell_locations,   sdimx = NULL,   sdimy = NULL,   sdimz = NULL,   mesh_obj = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/adapt_aspect_ratio.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"adapt_aspect_ratio — adapt_aspect_ratio","text":"current_ratio current_ratio cell_locations cell_locations sdimx sdimx sdimy sdimy sdimz sdimz mesh_obj mesh_obj","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addCellIntMetadata.html","id":null,"dir":"Reference","previous_headings":"","what":"addCellIntMetadata — addCellIntMetadata","title":"addCellIntMetadata — addCellIntMetadata","text":"Creates additional metadata column information interacting non-interacting cell types selected cell-cell interaction.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addCellIntMetadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"addCellIntMetadata — addCellIntMetadata","text":"","code":"addCellIntMetadata(   gobject,   spat_unit = NULL,   feat_type = NULL,   spatial_network = \"spatial_network\",   cluster_column,   cell_interaction,   name = \"select_int\",   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/addCellIntMetadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"addCellIntMetadata — addCellIntMetadata","text":"gobject giotto object spat_unit spatial unit feat_type feature type spatial_network name spatial network use cluster_column column cell types cell_interaction cell-cell interaction use name name new metadata column return_gobject return updated giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addCellIntMetadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"addCellIntMetadata — addCellIntMetadata","text":"Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addCellIntMetadata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"addCellIntMetadata — addCellIntMetadata","text":"function create additional metadata column selects interacting cell types specific cell-cell interaction. example, want color interacting astrocytes oligodendrocytes create new metadata column values \"select_astrocytes\", \"select_oligodendrocytes\", \"other_astrocytes\", \"other_oligodendroyctes\" \"\". \"\" cell types found within selected cell type column.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addCellStatistics.html","id":null,"dir":"Reference","previous_headings":"","what":"addCellStatistics — addCellStatistics","title":"addCellStatistics — addCellStatistics","text":"adds cells statistics giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addCellStatistics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"addCellStatistics — addCellStatistics","text":"","code":"addCellStatistics(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   detection_threshold = 0,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/addCellStatistics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"addCellStatistics — addCellStatistics","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values expression values use detection_threshold detection threshold consider gene detected return_gobject boolean: return giotto object (default = TRUE)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addCellStatistics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"addCellStatistics — addCellStatistics","text":"giotto object return_gobject = TRUE","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addCellStatistics.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"addCellStatistics — addCellStatistics","text":"function add following statistics cell metadata: nr_feats: Denotes many features detected per cell perc_feats: Denotes percentage features detected per cell total_expr: Shows total sum feature expression per cell","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addFeatStatistics.html","id":null,"dir":"Reference","previous_headings":"","what":"Add feature statistics — addFeatStatistics","title":"Add feature statistics — addFeatStatistics","text":"Adds feature statistics giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addFeatStatistics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add feature statistics — addFeatStatistics","text":"","code":"addFeatStatistics(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   detection_threshold = 0,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/addFeatStatistics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add feature statistics — addFeatStatistics","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values expression values use detection_threshold detection threshold consider gene detected return_gobject boolean: return giotto object (default = TRUE)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addFeatStatistics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add feature statistics — addFeatStatistics","text":"giotto object return_gobject = TRUE","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addFeatStatistics.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add feature statistics — addFeatStatistics","text":"function add following statistics feature metadata: nr_cells: Denotes many cells feature detected per_cells: Denotes percentage cells feature detected total_expr: Shows total sum feature expression cells mean_expr: Average feature expression cells mean_expr_det: Average feature expression cells detectable levels gene","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addFeatsPerc.html","id":null,"dir":"Reference","previous_headings":"","what":"addFeatsPerc — addFeatsPerc","title":"addFeatsPerc — addFeatsPerc","text":"Calculates total percentage (normalized) counts subset selected genes","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addFeatsPerc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"addFeatsPerc — addFeatsPerc","text":"","code":"addFeatsPerc(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   feats = NULL,   vector_name = \"feat_perc\",   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/addFeatsPerc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"addFeatsPerc — addFeatsPerc","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use feats vector selected features vector_name column name seen pDataDT return_gobject boolean: return giotto object (default = TRUE)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addFeatsPerc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"addFeatsPerc — addFeatsPerc","text":"giotto object return_gobject = TRUE, else vector ","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addHMRF.html","id":null,"dir":"Reference","previous_headings":"","what":"addHMRF — addHMRF","title":"addHMRF — addHMRF","text":"Add selected results doHMRF giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addHMRF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"addHMRF — addHMRF","text":"","code":"addHMRF(   gobject,   spat_unit = NULL,   feat_type = NULL,   HMRFoutput,   k = NULL,   betas_to_add = NULL,   hmrf_name = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/addHMRF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"addHMRF — addHMRF","text":"gobject giotto object spat_unit spatial unit feat_type feature type HMRFoutput HMRF output doHMRF() k number domains betas_to_add results different betas want add hmrf_name specify custom name","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addHMRF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"addHMRF — addHMRF","text":"giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addHMRF_V2.html","id":null,"dir":"Reference","previous_headings":"","what":"addHMRF_V2 — addHMRF_V2","title":"addHMRF_V2 — addHMRF_V2","text":"function add HMRF Domain Type cell meta data","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addHMRF_V2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"addHMRF_V2 — addHMRF_V2","text":"","code":"addHMRF_V2(gobject, HMRFoutput, name = \"hmrf\")"},{"path":"https://drieslab.github.io/Giotto/reference/addHMRF_V2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"addHMRF_V2 — addHMRF_V2","text":"gobject giotto object HMRFoutput result object HMRF model name name HMRF models","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addHMRF_V2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"addHMRF_V2 — addHMRF_V2","text":"function appends HMRF domain clusters corresponding cell meta data beta values, given HMRF model names. example, name = ‘hmrf1’ name result HMRFoutput ‘k=8 b=0.00’, appended cell meta data column named ‘hmrf1 k=8 b=0.00’","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addPolygonCells.html","id":null,"dir":"Reference","previous_headings":"","what":"Add corresponding polygon IDs to cell metadata — addPolygonCells","title":"Add corresponding polygon IDs to cell metadata — addPolygonCells","text":"Add corresponding polygon IDs cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addPolygonCells.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add corresponding polygon IDs to cell metadata — addPolygonCells","text":"","code":"addPolygonCells(   gobject,   polygon_name = \"selections\",   spat_unit = \"cell\",   spat_loc_name = \"raw\",   feat_type = \"rna\",   polygons = NULL,   na.label = \"no_polygon\" )"},{"path":"https://drieslab.github.io/Giotto/reference/addPolygonCells.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add corresponding polygon IDs to cell metadata — addPolygonCells","text":"gobject Giotto object polygon_name name polygon selections spat_unit spatial unit spat_loc_name name spatial locations use feat_type feature name metadata added polygons polygon names plot (e.g. 'polygon_1'). NULL, plots available polygons na.label polygon label cells located outside polygons area. Default = \"no_polygon\"","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addPolygonCells.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add corresponding polygon IDs to cell metadata — addPolygonCells","text":"Giotto object modified cell_metadata slot includes polygon name cell located no_polygon label cell located within polygon area","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addPolygonCells.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add corresponding polygon IDs to cell metadata — addPolygonCells","text":"","code":"if (FALSE) { ## Plot interactive polygons my_polygon_coords <- plotInteractivePolygons(my_spatPlot)  ## Add polygon coordinates to Giotto object my_giotto_polygons <- createGiottoPolygonsFromDfr(my_polygon_coords) my_giotto_object <- addGiottoPolygons(gobject = my_giotto_object,                                       gpolygons = list(my_giotto_polygons))  ## Add polygon IDs to cell metadata my_giotto_object <- addPolygonCells(my_giotto_object) }"},{"path":"https://drieslab.github.io/Giotto/reference/addStatistics.html","id":null,"dir":"Reference","previous_headings":"","what":"addStatistics — addStatistics","title":"addStatistics — addStatistics","text":"Adds feature cell statistics giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addStatistics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"addStatistics — addStatistics","text":"","code":"addStatistics(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   detection_threshold = 0,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/addStatistics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"addStatistics — addStatistics","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values expression values use detection_threshold detection threshold consider feature detected return_gobject boolean: return giotto object (default = TRUE)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addStatistics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"addStatistics — addStatistics","text":"giotto object return_gobject = TRUE, else list results","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addStatistics.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"addStatistics — addStatistics","text":"See addFeatStatistics addCellStatistics","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addVisiumPolygons.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Visium Polygons to Giotto Object — addVisiumPolygons","title":"Add Visium Polygons to Giotto Object — addVisiumPolygons","text":"Add Visium Polygons Giotto Object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addVisiumPolygons.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Visium Polygons to Giotto Object — addVisiumPolygons","text":"","code":"addVisiumPolygons(gobject, scalefactor_path = NULL)"},{"path":"https://drieslab.github.io/Giotto/reference/addVisiumPolygons.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Visium Polygons to Giotto Object — addVisiumPolygons","text":"gobject Giotto Object created visium data, containing spatial location corresponding spots scalefactor_path path scalefactors_json.json Visium output","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addVisiumPolygons.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add Visium Polygons to Giotto Object — addVisiumPolygons","text":"Giotto Object circular polygons added spatial location","code":""},{"path":"https://drieslab.github.io/Giotto/reference/addVisiumPolygons.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add Visium Polygons to Giotto Object — addVisiumPolygons","text":"Adds circular giottoPolygons spatial_info slot Giotto Object \"cell\" spaital unit.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/adjustGiottoMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Adjust expression values — adjustGiottoMatrix","title":"Adjust expression values — adjustGiottoMatrix","text":"Adjust expression values account known batch effects technological covariates.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/adjustGiottoMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adjust expression values — adjustGiottoMatrix","text":"","code":"adjustGiottoMatrix(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   batch_columns = NULL,   covariate_columns = NULL,   return_gobject = TRUE,   update_slot = c(\"custom\") )"},{"path":"https://drieslab.github.io/Giotto/reference/adjustGiottoMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adjust expression values — adjustGiottoMatrix","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") expression_values expression values use batch_columns metadata columns represent different batch (max = 2) covariate_columns metadata columns represent covariates regress return_gobject boolean: return giotto object (default = TRUE) update_slot expression slot updated (default = custom)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/adjustGiottoMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adjust expression values — adjustGiottoMatrix","text":"giotto object exprObj","code":""},{"path":"https://drieslab.github.io/Giotto/reference/adjustGiottoMatrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Adjust expression values — adjustGiottoMatrix","text":"function implements removeBatchEffect function remove known batch effects adjust expression values according provided covariates.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/average_feat_feat_expression_in_groups.html","id":null,"dir":"Reference","previous_headings":"","what":"average_feat_feat_expression_in_groups — average_feat_feat_expression_in_groups","title":"average_feat_feat_expression_in_groups — average_feat_feat_expression_in_groups","text":"calculate average expression per cluster","code":""},{"path":"https://drieslab.github.io/Giotto/reference/average_feat_feat_expression_in_groups.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"average_feat_feat_expression_in_groups — average_feat_feat_expression_in_groups","text":"","code":"average_feat_feat_expression_in_groups(   gobject,   spat_unit = NULL,   feat_type = NULL,   cluster_column = \"cell_types\",   feat_set_1,   feat_set_2 )"},{"path":"https://drieslab.github.io/Giotto/reference/average_feat_feat_expression_in_groups.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"average_feat_feat_expression_in_groups — average_feat_feat_expression_in_groups","text":"gobject giotto object use spat_unit spatial unit feat_type feature type cluster_column cluster column cell type information feat_set_1 first specific feat set feat pairs feat_set_2 second specific feat set feat pairs","code":""},{"path":"https://drieslab.github.io/Giotto/reference/average_feat_feat_expression_in_groups.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"average_feat_feat_expression_in_groups — average_feat_feat_expression_in_groups","text":"data.table average expression scores cluster","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpect.html","id":null,"dir":"Reference","previous_headings":"","what":"binSpect — binSpect","title":"binSpect — binSpect","text":"Previously: binGetSpatialGenes. BinSpect (Binary Spatial Extraction genes) fast computational method identifies genes spatially coherent expression pattern.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"binSpect — binSpect","text":"","code":"binSpect(   gobject,   spat_unit = NULL,   feat_type = NULL,   bin_method = c(\"kmeans\", \"rank\"),   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   subset_feats = NULL,   subset_genes = NULL,   spatial_network_name = \"Delaunay_network\",   spatial_network_k = NULL,   reduce_network = FALSE,   kmeans_algo = c(\"kmeans\", \"kmeans_arma\", \"kmeans_arma_subset\"),   nstart = 3,   iter_max = 10,   extreme_nr = 50,   sample_nr = 50,   percentage_rank = 30,   do_fisher_test = TRUE,   adjust_method = \"fdr\",   calc_hub = FALSE,   hub_min_int = 3,   get_av_expr = TRUE,   get_high_expr = TRUE,   implementation = c(\"data.table\", \"simple\", \"matrix\"),   group_size = \"automatic\",   do_parallel = TRUE,   cores = NA,   verbose = T,   knn_params = NULL,   set.seed = NULL,   bin_matrix = NULL,   summarize = c(\"p.value\", \"adj.p.value\"),   return_gobject = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/binSpect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"binSpect — binSpect","text":"gobject giotto object spat_unit spatial unit feat_type feature type bin_method method binarize gene expression expression_values expression values use subset_feats select subset features test subset_genes deprecated, use subset_feats spatial_network_name name spatial network use (default = 'spatial_network') spatial_network_k different k's spatial kNN evaluate reduce_network default uses full network kmeans_algo kmeans algorithm use (kmeans, kmeans_arma, kmeans_arma_subset) nstart kmeans: nstart parameter iter_max kmeans: iter.max parameter extreme_nr number top bottom cells (see details) sample_nr total number cells sample (see details) percentage_rank percentage top cells binarization do_fisher_test perform fisher test adjust_method p-value adjusted method use (see p.adjust) calc_hub calculate number hub cells hub_min_int minimum number cell-cell interactions hub cell get_av_expr calculate average expression per gene high expressing cells get_high_expr calculate number high expressing cells  per gene implementation enrichment implementation (data.table, simple, matrix) group_size number genes process together data.table implementation (default = automatic) do_parallel run calculations parallel mclapply cores number cores use do_parallel = TRUE verbose verbose knn_params list parameters create spatial kNN network set.seed set seed kmeans binarization bin_matrix binarized matrix, provided skip binarization process summarize summarize p-values adjusted p-values return_gobject whether return values attached gobject separately (default)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"binSpect — binSpect","text":"data.table results (see details)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpect.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"binSpect — binSpect","text":"provide two ways identify spatial genes based gene expression binarization. methods identicial except binarization performed. 1. binarize: gene binarized (0 1) cell kmeans (k = 2) based rank percentile 2. network: Alll cells connected spatial network based physical coordinates 3. contingency table: contingency table calculated based edges neighboring cells binarized expression (0-0, 0-1, 1-0 1-1) 4. gene odds-ratio () fisher.test (optional) calculated Three different kmeans algorithmes implemented: 1. kmeans: default, see kmeans 2. kmeans_arma: ClusterR, see KMeans_arma 3. kmeans_arma_subst: ClusterR, see KMeans_arma,    random subsetting vector gene increase speed. Change extreme_nr sample_nr control. statistics provided (optional): Number cells high expression (binary = 1) Average expression gene within high expressing cells Number hub cells, high expressing cells user defined number high expressing neighbors selecting subset likely spatial genes (e.g. soft thresholding highly variable genes) can accelerate speed. simple implementation usually faster, lacks possibility run parallel calculate hub cells. data.table implementation might appropriate large datasets setting group_size (number genes) parameter divide workload.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectMulti.html","id":null,"dir":"Reference","previous_headings":"","what":"binSpectMulti — binSpectMulti","title":"binSpectMulti — binSpectMulti","text":"binSpect multiple spatial kNN networks","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectMulti.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"binSpectMulti — binSpectMulti","text":"","code":"binSpectMulti(   gobject,   feat_type = NULL,   spat_unit = NULL,   bin_method = c(\"kmeans\", \"rank\"),   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   subset_feats = NULL,   subset_genes = NULL,   spatial_network_k = c(5, 10, 20),   reduce_network = FALSE,   kmeans_algo = c(\"kmeans\", \"kmeans_arma\", \"kmeans_arma_subset\"),   nstart = 3,   iter_max = 10,   extreme_nr = 50,   sample_nr = 50,   percentage_rank = c(10, 30),   do_fisher_test = TRUE,   adjust_method = \"fdr\",   calc_hub = FALSE,   hub_min_int = 3,   get_av_expr = TRUE,   get_high_expr = TRUE,   implementation = c(\"data.table\", \"simple\", \"matrix\"),   group_size = \"automatic\",   do_parallel = TRUE,   cores = NA,   verbose = T,   knn_params = NULL,   set.seed = NULL,   summarize = c(\"adj.p.value\", \"p.value\") )"},{"path":"https://drieslab.github.io/Giotto/reference/binSpectMulti.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"binSpectMulti — binSpectMulti","text":"gobject giotto object feat_type feature type spat_unit spatial unit bin_method method binarize gene expression expression_values expression values use subset_feats select subset features test subset_genes deprecated, use subset_feats spatial_network_k different k's spatial kNN evaluate reduce_network default uses full network kmeans_algo kmeans algorithm use (kmeans, kmeans_arma, kmeans_arma_subset) nstart kmeans: nstart parameter iter_max kmeans: iter.max parameter extreme_nr number top bottom cells (see details) sample_nr total number cells sample (see details) percentage_rank percentage top cells binarization do_fisher_test perform fisher test adjust_method p-value adjusted method use (see p.adjust) calc_hub calculate number hub cells hub_min_int minimum number cell-cell interactions hub cell get_av_expr calculate average expression per gene high expressing cells get_high_expr calculate number high expressing cells  per gene implementation enrichment implementation (data.table, simple, matrix) group_size number genes process together data.table implementation (default = automatic) do_parallel run calculations parallel mclapply cores number cores use do_parallel = TRUE verbose verbose knn_params list parameters create spatial kNN network set.seed set seed kmeans binarization summarize summarize p-values adjusted p-values","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectMulti.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"binSpectMulti — binSpectMulti","text":"data.table results (see details)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectMulti.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"binSpectMulti — binSpectMulti","text":"provide two ways identify spatial genes based gene expression binarization. methods identicial except binarization performed. 1. binarize: gene binarized (0 1) cell kmeans (k = 2) based rank percentile 2. network: Alll cells connected spatial network based physical coordinates 3. contingency table: contingency table calculated based edges neighboring cells binarized expression (0-0, 0-1, 1-0 1-1) 4. gene odds-ratio () fisher.test (optional) calculated Three different kmeans algorithmes implemented: 1. kmeans: default, see kmeans 2. kmeans_arma: ClusterR, see KMeans_arma 3. kmeans_arma_subst: ClusterR, see KMeans_arma,    random subsetting vector gene increase speed. Change extreme_nr sample_nr control. statistics provided (optional): Number cells high expression (binary = 1) Average expression gene within high expressing cells Number hub cells, high expressing cells user defined number high expressing neighbors selecting subset likely spatial genes (e.g. soft thresholding highly variable genes) can accelerate speed. simple implementation usually faster, lacks possibility run parallel calculate hub cells. data.table implementation might appropriate large datasets setting group_size (number genes) parameter divide workload.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectMultiMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"binSpectMultiMatrix — binSpectMultiMatrix","title":"binSpectMultiMatrix — binSpectMultiMatrix","text":"binSpect single spatial network provided expression matrix","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectMultiMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"binSpectMultiMatrix — binSpectMultiMatrix","text":"","code":"binSpectMultiMatrix(   expression_matrix,   spatial_networks,   bin_method = c(\"kmeans\", \"rank\"),   subset_feats = NULL,   kmeans_algo = c(\"kmeans\", \"kmeans_arma\", \"kmeans_arma_subset\"),   nstart = 3,   iter_max = 10,   extreme_nr = 50,   sample_nr = 50,   percentage_rank = c(10, 30),   do_fisher_test = TRUE,   adjust_method = \"fdr\",   calc_hub = FALSE,   hub_min_int = 3,   get_av_expr = TRUE,   get_high_expr = TRUE,   implementation = c(\"data.table\", \"simple\", \"matrix\"),   group_size = \"automatic\",   do_parallel = TRUE,   cores = NA,   verbose = T,   knn_params = NULL,   set.seed = NULL,   summarize = c(\"adj.p.value\", \"p.value\") )"},{"path":"https://drieslab.github.io/Giotto/reference/binSpectMultiMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"binSpectMultiMatrix — binSpectMultiMatrix","text":"expression_matrix expression matrix spatial_networks list spatial networks data.table format bin_method method binarize gene expression subset_feats select subset features test kmeans_algo kmeans algorithm use (kmeans, kmeans_arma, kmeans_arma_subset) nstart kmeans: nstart parameter iter_max kmeans: iter.max parameter extreme_nr number top bottom cells (see details) sample_nr total number cells sample (see details) percentage_rank vector percentages top cells binarization do_fisher_test perform fisher test adjust_method p-value adjusted method use (see p.adjust) calc_hub calculate number hub cells hub_min_int minimum number cell-cell interactions hub cell get_av_expr calculate average expression per gene high expressing cells get_high_expr calculate number high expressing cells  per gene implementation enrichment implementation (data.table, simple, matrix) group_size number genes process together data.table implementation (default = automatic) do_parallel run calculations parallel mclapply cores number cores use do_parallel = TRUE verbose verbose knn_params list parameters create spatial kNN network set.seed set seed kmeans binarization summarize summarize p-values adjusted p-values","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectMultiMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"binSpectMultiMatrix — binSpectMultiMatrix","text":"data.table results","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectSingle.html","id":null,"dir":"Reference","previous_headings":"","what":"binSpectSingle — binSpectSingle","title":"binSpectSingle — binSpectSingle","text":"binSpect single spatial network","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectSingle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"binSpectSingle — binSpectSingle","text":"","code":"binSpectSingle(   gobject,   spat_unit = NULL,   feat_type = NULL,   bin_method = c(\"kmeans\", \"rank\"),   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   subset_feats = NULL,   subset_genes = NULL,   spatial_network_name = \"Delaunay_network\",   reduce_network = FALSE,   kmeans_algo = c(\"kmeans\", \"kmeans_arma\", \"kmeans_arma_subset\"),   nstart = 3,   iter_max = 10,   extreme_nr = 50,   sample_nr = 50,   percentage_rank = 30,   do_fisher_test = TRUE,   adjust_method = \"fdr\",   calc_hub = FALSE,   hub_min_int = 3,   get_av_expr = TRUE,   get_high_expr = TRUE,   implementation = c(\"data.table\", \"simple\", \"matrix\"),   group_size = \"automatic\",   do_parallel = TRUE,   cores = NA,   verbose = TRUE,   set.seed = NULL,   bin_matrix = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/binSpectSingle.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"binSpectSingle — binSpectSingle","text":"gobject giotto object spat_unit spatial unit feat_type feature type bin_method method binarize gene expression expression_values expression values use subset_feats select subset features test subset_genes deprecated, use subset_feats spatial_network_name name spatial network use (default = 'spatial_network') reduce_network default uses full network kmeans_algo kmeans algorithm use (kmeans, kmeans_arma, kmeans_arma_subset) nstart kmeans: nstart parameter iter_max kmeans: iter.max parameter extreme_nr number top bottom cells (see details) sample_nr total number cells sample (see details) percentage_rank percentage top cells binarization do_fisher_test perform fisher test adjust_method p-value adjusted method use (see p.adjust) calc_hub calculate number hub cells hub_min_int minimum number cell-cell interactions hub cell get_av_expr calculate average expression per gene high expressing cells get_high_expr calculate number high expressing cells  per gene implementation enrichment implementation (data.table, simple, matrix) group_size number genes process together data.table implementation (default = automatic) do_parallel run calculations parallel mclapply cores number cores use do_parallel = TRUE verbose verbose set.seed set seed kmeans binarization bin_matrix binarized matrix, provided skip binarization process","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectSingle.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"binSpectSingle — binSpectSingle","text":"data.table results (see details)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectSingle.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"binSpectSingle — binSpectSingle","text":"provide two ways identify spatial genes based gene expression binarization. methods identicial except binarization performed. 1. binarize: gene binarized (0 1) cell kmeans (k = 2) based rank percentile 2. network: Alll cells connected spatial network based physical coordinates 3. contingency table: contingency table calculated based edges neighboring cells binarized expression (0-0, 0-1, 1-0 1-1) 4. gene odds-ratio () fisher.test (optional) calculated Three different kmeans algorithmes implemented: 1. kmeans: default, see kmeans 2. kmeans_arma: ClusterR, see KMeans_arma 3. kmeans_arma_subst: ClusterR, see KMeans_arma,    random subsetting vector gene increase speed. Change extreme_nr sample_nr control. statistics provided (optional): Number cells high expression (binary = 1) Average expression gene within high expressing cells Number hub cells, high expressing cells user defined number high expressing neighbors selecting subset likely spatial genes (e.g. soft thresholding highly variable genes) can accelerate speed. simple implementation usually faster, lacks possibility run parallel calculate hub cells. data.table implementation might appropriate large datasets setting group_size (number genes) parameter divide workload.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectSingleMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"binSpectSingleMatrix — binSpectSingleMatrix","title":"binSpectSingleMatrix — binSpectSingleMatrix","text":"binSpect single spatial network provided expression matrix","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectSingleMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"binSpectSingleMatrix — binSpectSingleMatrix","text":"","code":"binSpectSingleMatrix(   expression_matrix,   spatial_network = NULL,   bin_matrix = NULL,   bin_method = c(\"kmeans\", \"rank\"),   subset_feats = NULL,   kmeans_algo = c(\"kmeans\", \"kmeans_arma\", \"kmeans_arma_subset\"),   nstart = 3,   iter_max = 10,   extreme_nr = 50,   sample_nr = 50,   percentage_rank = 30,   do_fisher_test = TRUE,   adjust_method = \"fdr\",   calc_hub = FALSE,   hub_min_int = 3,   get_av_expr = TRUE,   get_high_expr = TRUE,   implementation = c(\"data.table\", \"simple\", \"matrix\"),   group_size = \"automatic\",   do_parallel = TRUE,   cores = NA,   verbose = FALSE,   set.seed = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/binSpectSingleMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"binSpectSingleMatrix — binSpectSingleMatrix","text":"expression_matrix expression matrix spatial_network spatial network data.table format bin_matrix binarized matrix, provided skip binarization process bin_method method binarize gene expression subset_feats select subset features test kmeans_algo kmeans algorithm use (kmeans, kmeans_arma, kmeans_arma_subset) nstart kmeans: nstart parameter iter_max kmeans: iter.max parameter extreme_nr number top bottom cells (see details) sample_nr total number cells sample (see details) percentage_rank percentage top cells binarization do_fisher_test perform fisher test adjust_method p-value adjusted method use (see p.adjust) calc_hub calculate number hub cells hub_min_int minimum number cell-cell interactions hub cell get_av_expr calculate average expression per gene high expressing cells get_high_expr calculate number high expressing cells  per gene implementation enrichment implementation (data.table, simple, matrix) group_size number genes process together data.table implementation (default = automatic) do_parallel run calculations parallel mclapply cores number cores use do_parallel = TRUE verbose verbose set.seed set seed kmeans binarization","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectSingleMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"binSpectSingleMatrix — binSpectSingleMatrix","text":"data.table results (see details)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/binSpectSingleMatrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"binSpectSingleMatrix — binSpectSingleMatrix","text":"provide two ways identify spatial genes based gene expression binarization. methods identicial except binarization performed. 1. binarize: gene binarized (0 1) cell kmeans (k = 2) based rank percentile 2. network: Alll cells connected spatial network based physical coordinates 3. contingency table: contingency table calculated based edges neighboring cells binarized expression (0-0, 0-1, 1-0 1-1) 4. gene odds-ratio () fisher.test (optional) calculated Three different kmeans algorithmes implemented: 1. kmeans: default, see kmeans 2. kmeans_arma: ClusterR, see KMeans_arma 3. kmeans_arma_subst: ClusterR, see KMeans_arma,    random subsetting vector gene increase speed. Change extreme_nr sample_nr control. statistics provided (optional): Number cells high expression (binary = 1) Average expression gene within high expressing cells Number hub cells, high expressing cells user defined number high expressing neighbors selecting subset likely spatial genes (e.g. soft thresholding highly variable genes) can accelerate speed. simple implementation usually faster, lacks possibility run parallel calculate hub cells. data.table implementation might appropriate large datasets setting group_size (number genes) parameter divide workload.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cal_diff_per_interaction.html","id":null,"dir":"Reference","previous_headings":"","what":"cal_diff_per_interaction — cal_diff_per_interaction","title":"cal_diff_per_interaction — cal_diff_per_interaction","text":"calculate correlation expression residual cell proximity score selected cell spots","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cal_diff_per_interaction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cal_diff_per_interaction — cal_diff_per_interaction","text":"","code":"cal_diff_per_interaction(   sel_int,   other_ints,   select_ind,   other_ind,   proximityMat,   expr_residual )"},{"path":"https://drieslab.github.io/Giotto/reference/cal_expr_residual.html","id":null,"dir":"Reference","previous_headings":"","what":"cal_expr_residual — cal_expr_residual","title":"cal_expr_residual — cal_expr_residual","text":"Calculate feature expression residual (observed_exp - DWLS_predicted)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cal_expr_residual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cal_expr_residual — cal_expr_residual","text":"","code":"cal_expr_residual(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   ave_celltype_exp )"},{"path":"https://drieslab.github.io/Giotto/reference/cal_expr_residual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cal_expr_residual — cal_expr_residual","text":"gobject giotto object spat_unit spatial unit (e.g. 'cell') feat_type feature type (e.g. 'rna') expression_values expression values use (e.g. 'normalized', 'scaled', 'custom') ave_celltype_exp average expression matrix cell types","code":""},{"path":"https://drieslab.github.io/Giotto/reference/calc_cov_group_HVF.html","id":null,"dir":"Reference","previous_headings":"","what":"calc_cov_group_HVF — calc_cov_group_HVF","title":"calc_cov_group_HVF — calc_cov_group_HVF","text":"calc_cov_group_HVF","code":""},{"path":"https://drieslab.github.io/Giotto/reference/calc_cov_group_HVF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calc_cov_group_HVF — calc_cov_group_HVF","text":"","code":"calc_cov_group_HVF(   feat_in_cells_detected,   nr_expression_groups = 20,   zscore_threshold = 1,   show_plot = NA,   return_plot = NA,   save_plot = NA )"},{"path":"https://drieslab.github.io/Giotto/reference/calc_cov_loess_HVF.html","id":null,"dir":"Reference","previous_headings":"","what":"calc_cov_loess_HVF — calc_cov_loess_HVF","title":"calc_cov_loess_HVF — calc_cov_loess_HVF","text":"calc_cov_loess_HVF","code":""},{"path":"https://drieslab.github.io/Giotto/reference/calc_cov_loess_HVF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calc_cov_loess_HVF — calc_cov_loess_HVF","text":"","code":"calc_cov_loess_HVF(   feat_in_cells_detected,   difference_in_cov = 0.1,   show_plot = NA,   return_plot = NA,   save_plot = NA )"},{"path":"https://drieslab.github.io/Giotto/reference/calc_spatial_enrichment_DT.html","id":null,"dir":"Reference","previous_headings":"","what":"calc_spatial_enrichment_DT — calc_spatial_enrichment_DT","title":"calc_spatial_enrichment_DT — calc_spatial_enrichment_DT","text":"calculate spatial enrichment using data.table implementation","code":""},{"path":"https://drieslab.github.io/Giotto/reference/calc_spatial_enrichment_DT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calc_spatial_enrichment_DT — calc_spatial_enrichment_DT","text":"","code":"calc_spatial_enrichment_DT(   bin_matrix,   spatial_network,   calc_hub = F,   hub_min_int = 3,   group_size = \"automatic\",   do_fisher_test = TRUE,   adjust_method = \"fdr\",   cores = NA )"},{"path":"https://drieslab.github.io/Giotto/reference/calc_spatial_enrichment_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"calc_spatial_enrichment_matrix — calc_spatial_enrichment_matrix","title":"calc_spatial_enrichment_matrix — calc_spatial_enrichment_matrix","text":"calculate spatial enrichment using matrix approach","code":""},{"path":"https://drieslab.github.io/Giotto/reference/calc_spatial_enrichment_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calc_spatial_enrichment_matrix — calc_spatial_enrichment_matrix","text":"","code":"calc_spatial_enrichment_matrix(   spatial_network,   bin_matrix,   adjust_method = \"fdr\",   do_fisher_test = TRUE,   do_parallel = TRUE,   cores = NA,   calc_hub = FALSE,   hub_min_int = 3,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/calc_spatial_enrichment_minimum.html","id":null,"dir":"Reference","previous_headings":"","what":"calc_spatial_enrichment_minimum — calc_spatial_enrichment_minimum","title":"calc_spatial_enrichment_minimum — calc_spatial_enrichment_minimum","text":"calculate spatial enrichment using simple efficient loop","code":""},{"path":"https://drieslab.github.io/Giotto/reference/calc_spatial_enrichment_minimum.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calc_spatial_enrichment_minimum — calc_spatial_enrichment_minimum","text":"","code":"calc_spatial_enrichment_minimum(   spatial_network,   bin_matrix,   adjust_method = \"fdr\",   do_fisher_test = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/calc_var_HVF.html","id":null,"dir":"Reference","previous_headings":"","what":"calc_var_HVF — calc_var_HVF","title":"calc_var_HVF — calc_var_HVF","text":"calc_var_HVF","code":""},{"path":"https://drieslab.github.io/Giotto/reference/calc_var_HVF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calc_var_HVF — calc_var_HVF","text":"","code":"calc_var_HVF(   scaled_matrix,   var_threshold = 1.5,   var_number = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA )"},{"path":"https://drieslab.github.io/Giotto/reference/calculateHVF.html","id":null,"dir":"Reference","previous_headings":"","what":"calculateHVF — calculateHVF","title":"calculateHVF — calculateHVF","text":"compute highly variable features","code":""},{"path":"https://drieslab.github.io/Giotto/reference/calculateHVF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculateHVF — calculateHVF","text":"","code":"calculateHVF(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   method = c(\"cov_groups\", \"cov_loess\", \"var_p_resid\"),   reverse_log_scale = FALSE,   logbase = 2,   expression_threshold = 0,   nr_expression_groups = 20,   zscore_threshold = 1.5,   HVFname = \"hvf\",   difference_in_cov = 0.1,   var_threshold = 1.5,   var_number = NULL,   cell_ids = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"HVFplot\",   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/calculateHVF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculateHVF — calculateHVF","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use method method calculate highly variable features reverse_log_scale reverse log-scale expression values (default = FALSE) logbase reverse_log_scale TRUE, log base used? expression_threshold expression threshold consider gene detected nr_expression_groups [cov_groups] number expression groups cov_groups zscore_threshold [cov_groups] zscore select hvg cov_groups HVFname name highly variable features cell metadata difference_in_cov [cov_loess] minimum difference coefficient variance required var_threshold [var_p_resid] variance threshold features var_p_resid method var_number [var_p_resid] number top variance features var_p_resid method cell_ids Specific cell_IDs (`spatIDs()`) HVF detection performed . Passing NULL (default) runs HVF cells. show_plot show plot return_plot return ggplot object (overridden `return_gobject`) save_plot directly save plot [boolean] save_param list saving parameters GiottoVisuals::all_plots_save_function default_save_name default save name saving, change, change save_name save_param return_gobject boolean: return giotto object (default = TRUE)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/calculateHVF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculateHVF — calculateHVF","text":"giotto object highly variable features appended feature metadata (`fDataDT()`)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/calculateHVF.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"calculateHVF — calculateHVF","text":"Currently provide 2 ways calculate highly variable genes: 1. high coeff variance (COV) within groups:   First genes binned (nr_expression_groups) average expression groups COV feature converted z-score within bin. Features z-score higher threshold (zscore_threshold) considered highly variable. 2. high COV based loess regression prediction:   predicted COV calculated feature using loess regression (COV~log(mean expression)) Features show higher predicted COV (difference_in_cov) considered highly variable.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/callSpdep.html","id":null,"dir":"Reference","previous_headings":"","what":"Call the spdep function with required parameters — callSpdep","title":"Call the spdep function with required parameters — callSpdep","text":"Call spdep function required parameters","code":""},{"path":"https://drieslab.github.io/Giotto/reference/callSpdep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Call the spdep function with required parameters — callSpdep","text":"","code":"callSpdep(method, ...)"},{"path":"https://drieslab.github.io/Giotto/reference/callSpdep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Call the spdep function with required parameters — callSpdep","text":"method Specify method name call spdep required parameters. ... Additional parameters function. See spdep documentation relevant parameters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/callSpdep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Call the spdep function with required parameters — callSpdep","text":"Computed statistics specified method.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityBarplot.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximityBarplot — cellProximityBarplot","title":"cellProximityBarplot — cellProximityBarplot","text":"Create barplot cell-cell proximity scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityBarplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximityBarplot — cellProximityBarplot","text":"","code":"cellProximityBarplot(   gobject,   CPscore,   min_orig_ints = 5,   min_sim_ints = 5,   p_val = 0.05,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"cellProximityBarplot\" )"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityBarplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cellProximityBarplot — cellProximityBarplot","text":"gobject giotto object CPscore CPscore, output cellProximityEnrichment() min_orig_ints filter minimum original cell-cell interactions min_sim_ints filter minimum simulated cell-cell interactions p_val p-value show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityBarplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cellProximityBarplot — cellProximityBarplot","text":"ggplot barplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityBarplot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cellProximityBarplot — cellProximityBarplot","text":"function creates barplot shows  spatial proximity  enrichment depletion cell type pairs.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximityEnrichment — cellProximityEnrichment","title":"cellProximityEnrichment — cellProximityEnrichment","text":"Compute cell-cell interaction enrichment (observed vs expected)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximityEnrichment — cellProximityEnrichment","text":"","code":"cellProximityEnrichment(   gobject,   spat_unit = NULL,   feat_type = NULL,   spatial_network_name = \"Delaunay_network\",   cluster_column,   number_of_simulations = 1000,   adjust_method = c(\"none\", \"fdr\", \"bonferroni\", \"BH\", \"holm\", \"hochberg\", \"hommel\",     \"BY\"),   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cellProximityEnrichment — cellProximityEnrichment","text":"gobject giotto object spat_unit spatial unit feat_type feature type spatial_network_name name spatial network use cluster_column name column use clusters number_of_simulations number simulations create expected observations adjust_method method adjust p.values set_seed use seed seed_number seed number use","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cellProximityEnrichment — cellProximityEnrichment","text":"List cell Proximity scores (CPscores) data.table format. first data.table (raw_sim_table) shows raw observations original simulated networks. second data.table (enrichm_res) shows enrichment results.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichment.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cellProximityEnrichment — cellProximityEnrichment","text":"Spatial proximity enrichment depletion pairs cell types calculated calculating observed expected frequency cell-cell proximity interactions. expected frequency average frequency calculated number spatial network simulations. individual simulation obtained reshuffling cell type labels node (cell) spatial network.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichmentEachSpot.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximityEnrichmentEachSpot — cellProximityEnrichmentEachSpot","title":"cellProximityEnrichmentEachSpot — cellProximityEnrichmentEachSpot","text":"Compute cell-cell interaction enrichment spot interacted spots (observed)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichmentEachSpot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximityEnrichmentEachSpot — cellProximityEnrichmentEachSpot","text":"","code":"cellProximityEnrichmentEachSpot(   gobject,   spat_unit = NULL,   feat_type = NULL,   spatial_network_name = \"spatial_network\",   cluster_column = \"cell_ID\" )"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichmentEachSpot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cellProximityEnrichmentEachSpot — cellProximityEnrichmentEachSpot","text":"gobject giotto object spat_unit spatial unit (e.g. 'cell') feat_type feature type (e.g. 'rna') spatial_network_name name spatial network use cluster_column name column use clusters","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichmentEachSpot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cellProximityEnrichmentEachSpot — cellProximityEnrichmentEachSpot","text":"matrix rownames cell-cell interaction pairs colnames cell_IDs","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichmentSpots.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximityEnrichmentSpots — cellProximityEnrichmentSpots","title":"cellProximityEnrichmentSpots — cellProximityEnrichmentSpots","text":"Compute cell-cell interaction enrichment spots (observed vs expected)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichmentSpots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximityEnrichmentSpots — cellProximityEnrichmentSpots","text":"","code":"cellProximityEnrichmentSpots(   gobject,   spat_unit = NULL,   feat_type = NULL,   spatial_network_name = \"spatial_network\",   cluster_column = \"cell_ID\",   cells_in_spot = 1,   number_of_simulations = 100,   adjust_method = c(\"none\", \"fdr\", \"bonferroni\", \"BH\", \"holm\", \"hochberg\", \"hommel\",     \"BY\"),   set_seed = TRUE,   seed_number = 1234,   verbose = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichmentSpots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cellProximityEnrichmentSpots — cellProximityEnrichmentSpots","text":"gobject giotto object spat_unit spatial unit (e.g. 'cell') feat_type feature type (e.g. 'rna') spatial_network_name name spatial network use cluster_column name column use clusters cells_in_spot cell number spot number_of_simulations number simulations create expected observations adjust_method method adjust p.values (e.g. \"none\", \"fdr\", \"bonferroni\",\"BH\",\"holm\", \"hochberg\", \"hommel\",\"\") set_seed use seed. Default = TRUE seed_number seed number use. Default = 1234 verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichmentSpots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cellProximityEnrichmentSpots — cellProximityEnrichmentSpots","text":"List cell Proximity scores (CPscores) data.table format. first data.table (raw_sim_table) shows raw observations original simulated networks. second data.table (enrichm_res) shows enrichment results.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityEnrichmentSpots.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cellProximityEnrichmentSpots — cellProximityEnrichmentSpots","text":"Spatial proximity enrichment depletion pairs cell types calculated calculating observed expected frequency cell-cell proximity interactions. expected frequency average frequency calculated number spatial network simulations. individual simulation obtained reshuffling cell type labels node (spot) spatial network.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityHeatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximityHeatmap — cellProximityHeatmap","title":"cellProximityHeatmap — cellProximityHeatmap","text":"Create heatmap cell-cell proximity scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityHeatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximityHeatmap — cellProximityHeatmap","text":"","code":"cellProximityHeatmap(   gobject,   CPscore,   scale = T,   order_cell_types = T,   color_breaks = NULL,   color_names = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"cellProximityHeatmap\" )"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityHeatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cellProximityHeatmap — cellProximityHeatmap","text":"gobject giotto object CPscore CPscore, output cellProximityEnrichment() scale scale cell-cell proximity interaction scores order_cell_types order cell types based enrichment correlation color_breaks numerical vector length 3 represent min, mean maximum color_names character color vector length 3 show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityHeatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cellProximityHeatmap — cellProximityHeatmap","text":"ggplot heatmap","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityHeatmap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cellProximityHeatmap — cellProximityHeatmap","text":"function creates heatmap shows  spatial proximity  enrichment depletion cell type pairs.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityNetwork.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximityNetwork — cellProximityNetwork","title":"cellProximityNetwork — cellProximityNetwork","text":"Create network cell-cell proximity scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityNetwork.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximityNetwork — cellProximityNetwork","text":"","code":"cellProximityNetwork(   gobject,   CPscore,   remove_self_edges = FALSE,   self_loop_strength = 0.1,   color_depletion = \"lightgreen\",   color_enrichment = \"red\",   rescale_edge_weights = TRUE,   edge_weight_range_depletion = c(0.1, 1),   edge_weight_range_enrichment = c(1, 5),   layout = c(\"Fruchterman\", \"DrL\", \"Kamada-Kawai\"),   only_show_enrichment_edges = F,   edge_width_range = c(0.1, 2),   node_size = 4,   node_color_code = NULL,   node_text_size = 6,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"cellProximityNetwork\" )"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityNetwork.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cellProximityNetwork — cellProximityNetwork","text":"gobject giotto object CPscore CPscore, output cellProximityEnrichment() remove_self_edges remove enrichment/depletion edges self_loop_strength size self-loops color_depletion color depleted cell-cell interactions color_enrichment color enriched cell-cell interactions rescale_edge_weights rescale edge weights (boolean) edge_weight_range_depletion numerical vector length 2 rescale depleted edge weights edge_weight_range_enrichment numerical vector length 2 rescale enriched edge weights layout layout algorithm use draw nodes edges only_show_enrichment_edges show enriched pairwise scores edge_width_range range edge width node_size size nodes node_color_code color code nodes (e.g. cell labels) node_text_size size node labels show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityNetwork.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cellProximityNetwork — cellProximityNetwork","text":"igraph plot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityNetwork.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cellProximityNetwork — cellProximityNetwork","text":"function creates network shows  spatial proximity  enrichment depletion cell type pairs.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximitySpatPlot — cellProximitySpatPlot","title":"cellProximitySpatPlot — cellProximitySpatPlot","text":"Visualize 2D cell-cell interactions according spatial coordinates ggplot mode","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximitySpatPlot — cellProximitySpatPlot","text":"","code":"cellProximitySpatPlot(gobject, ...)"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cellProximitySpatPlot — cellProximitySpatPlot","text":"gobject giotto object ... Arguments passed cellProximitySpatPlot2D spat_loc_name spatial locations use interaction_name cell-cell interaction name cluster_column cluster column cell clusters sdimx x-axis dimension name (default = 'sdimx') sdimy y-axis dimension name (default = 'sdimy') show_other_cells decide show cells network show_network show spatial network selected cells show_other_network show spatial network selected cells network_color color spatial network show_grid show spatial grid grid_color color spatial grid spatial_grid_name name spatial grid use coord_fix_ratio fix ratio x y-axis point_size_select size selected points point_select_border_col border color selected points point_select_border_stroke stroke size selected points point_size_other size points point_alpha_other opacity points point_other_border_col border color points point_other_border_stroke stroke size points spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param cell_color character. color cells (e.g. metadata col spatial enrichment col) color_as_factor logical. convert color column factor. discrete colors used TRUE. continuous colors FALSE. cell_color_code character. discrete colors use. palette use named vector colors spatial_network_name name spatial network use show_legend logical. show legend","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cellProximitySpatPlot — cellProximitySpatPlot","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cellProximitySpatPlot — cellProximitySpatPlot","text":"Description parameters.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot2D.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximitySpatPlot2D — cellProximitySpatPlot2D","title":"cellProximitySpatPlot2D — cellProximitySpatPlot2D","text":"Visualize 2D cell-cell interactions according spatial coordinates ggplot mode","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot2D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximitySpatPlot2D — cellProximitySpatPlot2D","text":"","code":"cellProximitySpatPlot2D(   gobject,   spat_unit = NULL,   feat_type = NULL,   spat_loc_name = NULL,   interaction_name = NULL,   cluster_column = NULL,   sdimx = \"sdimx\",   sdimy = \"sdimy\",   cell_color = NULL,   cell_color_code = NULL,   color_as_factor = T,   show_other_cells = F,   show_network = F,   show_other_network = F,   network_color = NULL,   spatial_network_name = \"Delaunay_network\",   show_grid = F,   grid_color = NULL,   spatial_grid_name = \"spatial_grid\",   coord_fix_ratio = 1,   show_legend = T,   point_size_select = 2,   point_select_border_col = \"black\",   point_select_border_stroke = 0.05,   point_size_other = 1,   point_alpha_other = 0.3,   point_other_border_col = \"lightgrey\",   point_other_border_stroke = 0.01,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"cellProximitySpatPlot2D\" )"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot2D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cellProximitySpatPlot2D — cellProximitySpatPlot2D","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") spat_loc_name spatial locations use interaction_name cell-cell interaction name cluster_column cluster column cell clusters sdimx x-axis dimension name (default = 'sdimx') sdimy y-axis dimension name (default = 'sdimy') cell_color character. color cells (e.g. metadata col spatial enrichment col) cell_color_code character. discrete colors use. palette use named vector colors color_as_factor logical. convert color column factor. discrete colors used TRUE. continuous colors FALSE. show_other_cells decide show cells network show_network show spatial network selected cells show_other_network show spatial network selected cells network_color color spatial network spatial_network_name name spatial network use show_grid show spatial grid grid_color color spatial grid spatial_grid_name name spatial grid use coord_fix_ratio fix ratio x y-axis show_legend logical. show legend point_size_select size selected points point_select_border_col border color selected points point_select_border_stroke stroke size selected points point_size_other size points point_alpha_other opacity points point_other_border_col border color points point_other_border_stroke stroke size points show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot2D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cellProximitySpatPlot2D — cellProximitySpatPlot2D","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot2D.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cellProximitySpatPlot2D — cellProximitySpatPlot2D","text":"Description parameters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot3D.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximitySpatPlot3D — cellProximitySpatPlot3D","title":"cellProximitySpatPlot3D — cellProximitySpatPlot3D","text":"Visualize 3D cell-cell interactions according spatial coordinates plotly mode","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot3D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximitySpatPlot3D — cellProximitySpatPlot3D","text":"","code":"cellProximitySpatPlot3D(   gobject,   interaction_name = NULL,   cluster_column = NULL,   sdimx = \"sdimx\",   sdimy = \"sdimy\",   sdimz = \"sdimz\",   cell_color = NULL,   cell_color_code = NULL,   color_as_factor = TRUE,   show_other_cells = TRUE,   show_network = TRUE,   show_other_network = FALSE,   network_color = NULL,   spatial_network_name = \"Delaunay_network\",   show_grid = FALSE,   grid_color = NULL,   spatial_grid_name = \"spatial_grid\",   show_legend = TRUE,   point_size_select = 4,   point_size_other = 2,   point_alpha_other = 0.5,   axis_scale = c(\"cube\", \"real\", \"custom\"),   custom_ratio = NULL,   x_ticks = NULL,   y_ticks = NULL,   z_ticks = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"cellProximitySpatPlot3D\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot3D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cellProximitySpatPlot3D — cellProximitySpatPlot3D","text":"gobject giotto object interaction_name cell-cell interaction name cluster_column cluster column cell clusters sdimx x-axis dimension name (default = 'sdimx') sdimy y-axis dimension name (default = 'sdimy') sdimz z-axis dimension name (default = 'sdimz') cell_color character. color cells (e.g. metadata col spatial enrichment col) cell_color_code character. discrete colors use. palette use named vector colors color_as_factor logical. convert color column factor. discrete colors used TRUE. continuous colors FALSE. show_other_cells decide show cells network show_network show spatial network selected cells show_other_network show spatial network selected cells network_color color spatial network spatial_network_name name spatial network use show_grid show spatial grid grid_color color spatial grid spatial_grid_name name spatial grid use show_legend logical. show legend point_size_select size selected points point_size_other size points point_alpha_other opacity points axis_scale scale axis custom_ratio custom ratio axes x_ticks ticks x-axis y_ticks ticks y-axis z_ticks ticks z-axis show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param ... additional parameters","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot3D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cellProximitySpatPlot3D — cellProximitySpatPlot3D","text":"plotly","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximitySpatPlot3D.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cellProximitySpatPlot3D — cellProximitySpatPlot3D","text":"Description parameters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximityVisPlot — cellProximityVisPlot","title":"cellProximityVisPlot — cellProximityVisPlot","text":"Visualize cell-cell interactions according spatial coordinates","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximityVisPlot — cellProximityVisPlot","text":"","code":"cellProximityVisPlot(   gobject,   interaction_name = NULL,   cluster_column = NULL,   sdimx = NULL,   sdimy = NULL,   sdimz = NULL,   cell_color = NULL,   cell_color_code = NULL,   color_as_factor = T,   show_other_cells = F,   show_network = F,   show_other_network = F,   network_color = NULL,   spatial_network_name = \"Delaunay_network\",   show_grid = F,   grid_color = NULL,   spatial_grid_name = \"spatial_grid\",   coord_fix_ratio = 1,   show_legend = T,   point_size_select = 2,   point_select_border_col = \"black\",   point_select_border_stroke = 0.05,   point_size_other = 1,   point_alpha_other = 0.3,   point_other_border_col = \"lightgrey\",   point_other_border_stroke = 0.01,   axis_scale = c(\"cube\", \"real\", \"custom\"),   custom_ratio = NULL,   x_ticks = NULL,   y_ticks = NULL,   z_ticks = NULL,   plot_method = c(\"ggplot\", \"plotly\"),   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cellProximityVisPlot — cellProximityVisPlot","text":"gobject giotto object interaction_name cell-cell interaction name cluster_column cluster column cell clusters sdimx x-axis dimension name (default = 'sdimx') sdimy y-axis dimension name (default = 'sdimy') sdimz z-axis dimension name (default = 'sdimz') cell_color color cells (see details) cell_color_code named vector colors color_as_factor convert color column factor show_other_cells show selected cells show_network show underlying spatial network show_other_network show underlying spatial network cells network_color color spatial network spatial_network_name name spatial network use show_grid show spatial grid grid_color color spatial grid spatial_grid_name name spatial grid use coord_fix_ratio fix ratio x y-axis show_legend show legend point_size_select size selected points point_select_border_col border color selected points point_select_border_stroke stroke size selected points point_size_other size points point_alpha_other alpha points point_other_border_col border color points point_other_border_stroke stroke size points axis_scale scale axis custom_ratio custom ratio scales x_ticks x ticks y_ticks y ticks z_ticks z ticks plot_method method plot ... additional parameters","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cellProximityVisPlot — cellProximityVisPlot","text":"ggplot plotly","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cellProximityVisPlot — cellProximityVisPlot","text":"Description parameters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot_2D_ggplot.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximityVisPlot_2D_ggplot — cellProximityVisPlot_2D_ggplot","title":"cellProximityVisPlot_2D_ggplot — cellProximityVisPlot_2D_ggplot","text":"Visualize 2D cell-cell interactions according spatial coordinates ggplot mode","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot_2D_ggplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximityVisPlot_2D_ggplot — cellProximityVisPlot_2D_ggplot","text":"","code":"cellProximityVisPlot_2D_ggplot(   gobject,   interaction_name = NULL,   cluster_column = NULL,   sdimx = NULL,   sdimy = NULL,   cell_color = NULL,   cell_color_code = NULL,   color_as_factor = TRUE,   show_other_cells = FALSE,   show_network = FALSE,   show_other_network = FALSE,   network_color = NULL,   spatial_network_name = \"Delaunay_network\",   show_grid = FALSE,   grid_color = NULL,   spatial_grid_name = \"spatial_grid\",   coord_fix_ratio = 1,   show_legend = TRUE,   point_size_select = 2,   point_select_border_col = \"black\",   point_select_border_stroke = 0.05,   point_size_other = 1,   point_alpha_other = 0.3,   point_other_border_col = \"lightgrey\",   point_other_border_stroke = 0.01,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot_2D_ggplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cellProximityVisPlot_2D_ggplot — cellProximityVisPlot_2D_ggplot","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot_2D_ggplot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"cellProximityVisPlot_2D_ggplot — cellProximityVisPlot_2D_ggplot","text":"Description parameters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot_2D_plotly.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximityVisPlot_2D_plotly — cellProximityVisPlot_2D_plotly","title":"cellProximityVisPlot_2D_plotly — cellProximityVisPlot_2D_plotly","text":"Visualize 2D cell-cell interactions according spatial coordinates plotly mode","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot_2D_plotly.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximityVisPlot_2D_plotly — cellProximityVisPlot_2D_plotly","text":"","code":"cellProximityVisPlot_2D_plotly(   gobject,   interaction_name = NULL,   cluster_column = NULL,   sdimx = NULL,   sdimy = NULL,   cell_color = NULL,   cell_color_code = NULL,   color_as_factor = T,   show_other_cells = F,   show_network = F,   show_other_network = F,   network_color = NULL,   spatial_network_name = \"Delaunay_network\",   show_grid = F,   grid_color = NULL,   spatial_grid_name = \"spatial_grid\",   show_legend = T,   point_size_select = 2,   point_size_other = 1,   point_alpha_other = 0.3,   axis_scale = c(\"cube\", \"real\", \"custom\"),   custom_ratio = NULL,   x_ticks = NULL,   y_ticks = NULL,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot_3D_plotly.html","id":null,"dir":"Reference","previous_headings":"","what":"cellProximityVisPlot_3D_plotly — cellProximityVisPlot_3D_plotly","title":"cellProximityVisPlot_3D_plotly — cellProximityVisPlot_3D_plotly","text":"Visualize 3D cell-cell interactions according spatial coordinates plotly mode","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cellProximityVisPlot_3D_plotly.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cellProximityVisPlot_3D_plotly — cellProximityVisPlot_3D_plotly","text":"","code":"cellProximityVisPlot_3D_plotly(   gobject,   interaction_name = NULL,   cluster_column = NULL,   sdimx = NULL,   sdimy = NULL,   sdimz = NULL,   cell_color = NULL,   cell_color_code = NULL,   color_as_factor = T,   show_other_cells = F,   show_network = F,   show_other_network = F,   network_color = NULL,   spatial_network_name = \"Delaunay_network\",   show_grid = F,   grid_color = NULL,   spatial_grid_name = \"spatial_grid\",   show_legend = T,   point_size_select = 2,   point_size_other = 1,   point_alpha_other = 0.5,   axis_scale = c(\"cube\", \"real\", \"custom\"),   custom_ratio = NULL,   x_ticks = NULL,   y_ticks = NULL,   z_ticks = NULL,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots.html","id":null,"dir":"Reference","previous_headings":"","what":"cell_proximity_spots — cell_proximity_spots","title":"cell_proximity_spots — cell_proximity_spots","text":"Compute cell-cell interactions observed value internal external spots","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cell_proximity_spots — cell_proximity_spots","text":"","code":"cell_proximity_spots(cell_IDs, pairs_external, dwls_values)"},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cell_proximity_spots — cell_proximity_spots","text":"cell_IDs cell_IDs calculate internal cell-type/cell-type interactions dwls_values data.table cell type enrichment spot multiply cell number spot pairs data.table paired spots. Format: cell_ID1, cell_ID2, N","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cell_proximity_spots — cell_proximity_spots","text":"List cell proximity observed value data.table format. Columns: unified_int, type_int, V1, external, internal.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots_external.html","id":null,"dir":"Reference","previous_headings":"","what":"cell_proximity_spots_external — cell_proximity_spots_external","title":"cell_proximity_spots_external — cell_proximity_spots_external","text":"Compute cell-cell interactions observed value interacted spots","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots_external.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cell_proximity_spots_external — cell_proximity_spots_external","text":"","code":"cell_proximity_spots_external(pairs, dwls_values)"},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots_external.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cell_proximity_spots_external — cell_proximity_spots_external","text":"pairs data.table paired spots. Format: cell_ID1, cell_ID2, N dwls_values data.table cell type enrichment spot multiply cell number spot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots_external.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cell_proximity_spots_external — cell_proximity_spots_external","text":"List cell proximity observed value data.table format. Columns: unified_int, internal value, type_int.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots_internal.html","id":null,"dir":"Reference","previous_headings":"","what":"cell_proximity_spots_internal — cell_proximity_spots_internal","title":"cell_proximity_spots_internal — cell_proximity_spots_internal","text":"Compute cell-cell interactions observed value inner spot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots_internal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cell_proximity_spots_internal — cell_proximity_spots_internal","text":"","code":"cell_proximity_spots_internal(cell_IDs, dwls_values)"},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots_internal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cell_proximity_spots_internal — cell_proximity_spots_internal","text":"cell_IDs cell_IDs dwls_values data.table cell type enrichment spot multiply cell number spot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cell_proximity_spots_internal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cell_proximity_spots_internal — cell_proximity_spots_internal","text":"List cell proximity observed value data.table format. Columns: unified_int, internal value, type_int.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/checkAndFixSpatialGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"checkAndFixSpatialGenes — checkAndFixSpatialGenes","title":"checkAndFixSpatialGenes — checkAndFixSpatialGenes","text":"function check selected test name spatial gene set Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/checkAndFixSpatialGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"checkAndFixSpatialGenes — checkAndFixSpatialGenes","text":"","code":"checkAndFixSpatialGenes(   gobject,   spat_unit = NULL,   feat_type = NULL,   use_spatial_genes,   use_score = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/checkAndFixSpatialGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"checkAndFixSpatialGenes — checkAndFixSpatialGenes","text":"gobject Giotto object spat_unit spatial unit feat_type feature type use_spatial_genes test name spatial gene set check use_score logical variable select silhouetteRank score","code":""},{"path":"https://drieslab.github.io/Giotto/reference/checkAndFixSpatialGenes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"checkAndFixSpatialGenes — checkAndFixSpatialGenes","text":"function checks user specified test name spatial gene set Giotto object. SilhouetteRank works score, SilhouetteRankTest works pval. Use parameter use_score specify.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/chooseAvailableSpatialGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"chooseAvailableSpatialGenes — chooseAvailableSpatialGenes","title":"chooseAvailableSpatialGenes — chooseAvailableSpatialGenes","text":"function find test name existing spatial gene sets Giotto","code":""},{"path":"https://drieslab.github.io/Giotto/reference/chooseAvailableSpatialGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"chooseAvailableSpatialGenes — chooseAvailableSpatialGenes","text":"","code":"chooseAvailableSpatialGenes(gobject, spat_unit = NULL, feat_type = NULL)"},{"path":"https://drieslab.github.io/Giotto/reference/chooseAvailableSpatialGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"chooseAvailableSpatialGenes — chooseAvailableSpatialGenes","text":"gobject Giotto object spat_unit spatial unit feat_type feature type","code":""},{"path":"https://drieslab.github.io/Giotto/reference/chooseAvailableSpatialGenes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"chooseAvailableSpatialGenes — chooseAvailableSpatialGenes","text":"function outputs available test name existing spatial gene sets Giotto, used parameter ‘name’ `filterSpatialGenes`. Priorities showing spatial gene test names ‘binSpect’ > ‘silhouetteRankTest’ > ‘silhouetteRank’.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/clusterCells.html","id":null,"dir":"Reference","previous_headings":"","what":"clusterCells — clusterCells","title":"clusterCells — clusterCells","text":"cluster cells using variety different methods","code":""},{"path":"https://drieslab.github.io/Giotto/reference/clusterCells.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"clusterCells — clusterCells","text":"","code":"clusterCells(   gobject,   cluster_method = c(\"leiden\", \"louvain_community\", \"louvain_multinet\", \"randomwalk\",     \"sNNclust\", \"kmeans\", \"hierarchical\"),   name = \"cluster_name\",   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   pyth_leid_resolution = 1,   pyth_leid_weight_col = \"weight\",   pyth_leid_part_type = c(\"RBConfigurationVertexPartition\", \"ModularityVertexPartition\"),   pyth_leid_init_memb = NULL,   pyth_leid_iterations = 1000,   pyth_louv_resolution = 1,   pyth_louv_weight_col = NULL,   python_louv_random = F,   python_path = NULL,   louvain_gamma = 1,   louvain_omega = 1,   walk_steps = 4,   walk_clusters = 10,   walk_weights = NA,   sNNclust_k = 20,   sNNclust_eps = 4,   sNNclust_minPts = 16,   borderPoints = TRUE,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   feats_to_use = NULL,   dim_reduction_to_use = c(\"cells\", \"pca\", \"umap\", \"tsne\"),   dim_reduction_name = \"pca\",   dimensions_to_use = 1:10,   distance_method = c(\"original\", \"pearson\", \"spearman\", \"euclidean\", \"maximum\",     \"manhattan\", \"canberra\", \"binary\", \"minkowski\"),   km_centers = 10,   km_iter_max = 100,   km_nstart = 1000,   km_algorithm = \"Hartigan-Wong\",   hc_agglomeration_method = c(\"ward.D2\", \"ward.D\", \"single\", \"complete\", \"average\",     \"mcquitty\", \"median\", \"centroid\"),   hc_k = 10,   hc_h = NULL,   return_gobject = TRUE,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/clusterCells.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"clusterCells — clusterCells","text":"gobject giotto object cluster_method community cluster method use name name new clustering result nn_network_to_use type NN network use (kNN vs sNN) network_name name NN network use pyth_leid_resolution resolution leiden pyth_leid_weight_col column use weights pyth_leid_part_type partition type use pyth_leid_init_memb initial membership pyth_leid_iterations number iterations pyth_louv_resolution resolution louvain pyth_louv_weight_col python louvain param: weight column python_louv_random python louvain param: random python_path specify specific path python required louvain_gamma louvain param: gamma resolution louvain_omega louvain param: omega walk_steps randomwalk: number steps walk_clusters randomwalk: number clusters walk_weights randomwalk: weight column sNNclust_k SNNclust: k neighbors use sNNclust_eps SNNclust: epsilon sNNclust_minPts SNNclust: min points borderPoints SNNclust: border points expression_values expression values use feats_to_use features use clustering, dim_reduction_to_use dimension reduction use dim_reduction_name name reduction 'pca', dimensions_to_use dimensions use distance_method distance method km_centers kmeans centers km_iter_max kmeans iterations km_nstart kmeans random starting points km_algorithm kmeans algorithm hc_agglomeration_method hierarchical clustering method hc_k hierachical number clusters hc_h hierarchical tree cutoff return_gobject boolean: return giotto object (default = TRUE) set_seed set seed seed_number number seed","code":""},{"path":"https://drieslab.github.io/Giotto/reference/clusterCells.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"clusterCells — clusterCells","text":"giotto object new clusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/clusterCells.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"clusterCells — clusterCells","text":"Wrapper different clustering methods.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/clusterSpatialCorFeats.html","id":null,"dir":"Reference","previous_headings":"","what":"clusterSpatialCorFeats — clusterSpatialCorFeats","title":"clusterSpatialCorFeats — clusterSpatialCorFeats","text":"Cluster based spatially correlated features","code":""},{"path":"https://drieslab.github.io/Giotto/reference/clusterSpatialCorFeats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"clusterSpatialCorFeats — clusterSpatialCorFeats","text":"","code":"clusterSpatialCorFeats(   spatCorObject,   name = \"spat_clus\",   hclust_method = \"ward.D\",   k = 10,   return_obj = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/clusterSpatialCorFeats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"clusterSpatialCorFeats — clusterSpatialCorFeats","text":"spatCorObject spatial correlation object name name spatial clustering results hclust_method method hierarchical clustering k number clusters extract return_obj return spatial correlation object (spatCorObject)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/clusterSpatialCorFeats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"clusterSpatialCorFeats — clusterSpatialCorFeats","text":"spatCorObject cluster results","code":""},{"path":"https://drieslab.github.io/Giotto/reference/clusterSpatialCorGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"clusterSpatialCorGenes — clusterSpatialCorGenes","title":"clusterSpatialCorGenes — clusterSpatialCorGenes","text":"Cluster based spatially correlated genes","code":""},{"path":"https://drieslab.github.io/Giotto/reference/clusterSpatialCorGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"clusterSpatialCorGenes — clusterSpatialCorGenes","text":"","code":"clusterSpatialCorGenes(   spatCorObject,   name = \"spat_clus\",   hclust_method = \"ward.D\",   k = 10,   return_obj = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/clusterSpatialCorGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"clusterSpatialCorGenes — clusterSpatialCorGenes","text":"spatCorObject spatial correlation object name name spatial clustering results hclust_method method hierarchical clustering k number clusters extract return_obj return spatial correlation object (spatCorObject)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/clusterSpatialCorGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"clusterSpatialCorGenes — clusterSpatialCorGenes","text":"spatCorObject cluster results","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cluster_enrich_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"cluster_enrich_analysis — cluster_enrich_analysis","title":"cluster_enrich_analysis — cluster_enrich_analysis","text":"Rui fill ","code":""},{"path":"https://drieslab.github.io/Giotto/reference/cluster_enrich_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cluster_enrich_analysis — cluster_enrich_analysis","text":"","code":"cluster_enrich_analysis(exp_matrix, cluster_info, enrich_sig_matrix)"},{"path":"https://drieslab.github.io/Giotto/reference/combCCcom.html","id":null,"dir":"Reference","previous_headings":"","what":"combCCcom — combCCcom","title":"combCCcom — combCCcom","text":"Combine spatial expression based cell-cell communication data.tables","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combCCcom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"combCCcom — combCCcom","text":"","code":"combCCcom(   spatialCC,   exprCC,   min_lig_nr = 3,   min_rec_nr = 3,   min_padj_value = 1,   min_log2fc = 0,   min_av_diff = 0,   detailed = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/combCCcom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"combCCcom — combCCcom","text":"spatialCC spatial cell-cell communication scores exprCC expression cell-cell communication scores min_lig_nr minimum number ligand cells min_rec_nr minimum number receptor cells min_padj_value minimum adjusted p-value min_log2fc minimum log2 fold-change min_av_diff minimum average expression difference detailed detailed option used spatCellCellcom (default = FALSE)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combCCcom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"combCCcom — combCCcom","text":"combined data.table spatial expression communication data","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineCPG.html","id":null,"dir":"Reference","previous_headings":"","what":"combineCPG — combineCPG","title":"combineCPG — combineCPG","text":"Combine ICF scores pairwise manner.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineCPG.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"combineCPG — combineCPG","text":"","code":"combineCPG(...)"},{"path":"https://drieslab.github.io/Giotto/reference/combineCPG.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"combineCPG — combineCPG","text":"... Arguments passed combineICF icfObject ICF (interaction changed feat) score object selected_ints subset selected cell-cell interactions (optional) selected_feats subset selected Feats (optional) specific_feats_1 specific Featset combo (need position match specific_genes_2) specific_feats_2 specific Featset combo (need position match specific_genes_1) min_cells minimum number target cell type min_int_cells minimum number interacting cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum absolute log2 fold-change do_parallel run calculations parallel mclapply verbose verbose","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/combineCellProximityGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"combineCellProximityGenes — combineCellProximityGenes","title":"combineCellProximityGenes — combineCellProximityGenes","text":"Combine ICF scores pairwise manner.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineCellProximityGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"combineCellProximityGenes — combineCellProximityGenes","text":"","code":"combineCellProximityGenes(...)"},{"path":"https://drieslab.github.io/Giotto/reference/combineCellProximityGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"combineCellProximityGenes — combineCellProximityGenes","text":"... Arguments passed combineInteractionChangedFeats icfObject ICF (interaction changed feat) score object selected_ints subset selected cell-cell interactions (optional) selected_feats subset selected Features (optional) specific_feats_1 specific Featureset combo (need position match specific_feats_2) specific_feats_2 specific Featureset combo (need position match specific_feats_1) min_cells minimum number target cell type min_int_cells minimum number interacting cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum absolute log2 fold-change do_parallel run calculations parallel mclapply verbose verbose","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/combineICF.html","id":null,"dir":"Reference","previous_headings":"","what":"combineICF — combineICF","title":"combineICF — combineICF","text":"Combine ICF scores pairwise manner.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineICF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"combineICF — combineICF","text":"","code":"combineICF(   icfObject,   selected_ints = NULL,   selected_feats = NULL,   specific_feats_1 = NULL,   specific_feats_2 = NULL,   min_cells = 5,   min_int_cells = 3,   min_fdr = 0.05,   min_spat_diff = 0,   min_log2_fc = 0.5,   do_parallel = TRUE,   verbose = T )"},{"path":"https://drieslab.github.io/Giotto/reference/combineICF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"combineICF — combineICF","text":"icfObject ICF (interaction changed feat) score object selected_ints subset selected cell-cell interactions (optional) selected_feats subset selected Feats (optional) specific_feats_1 specific Featset combo (need position match specific_genes_2) specific_feats_2 specific Featset combo (need position match specific_genes_1) min_cells minimum number target cell type min_int_cells minimum number interacting cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum absolute log2 fold-change do_parallel run calculations parallel mclapply verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineICF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"combineICF — combineICF","text":"icfObject contains filtered differential feats scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineICG.html","id":null,"dir":"Reference","previous_headings":"","what":"combineICG — combineICG","title":"combineICG — combineICG","text":"Combine ICF scores pairwise manner.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineICG.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"combineICG — combineICG","text":"","code":"combineICG(...)"},{"path":"https://drieslab.github.io/Giotto/reference/combineICG.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"combineICG — combineICG","text":"... Arguments passed combineICF icfObject ICF (interaction changed feat) score object selected_ints subset selected cell-cell interactions (optional) selected_feats subset selected Feats (optional) specific_feats_1 specific Featset combo (need position match specific_genes_2) specific_feats_2 specific Featset combo (need position match specific_genes_1) min_cells minimum number target cell type min_int_cells minimum number interacting cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum absolute log2 fold-change do_parallel run calculations parallel mclapply verbose verbose","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/combineInteractionChangedFeats.html","id":null,"dir":"Reference","previous_headings":"","what":"combineInteractionChangedFeats — combineInteractionChangedFeats","title":"combineInteractionChangedFeats — combineInteractionChangedFeats","text":"Combine ICF scores pairwise manner.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineInteractionChangedFeats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"combineInteractionChangedFeats — combineInteractionChangedFeats","text":"","code":"combineInteractionChangedFeats(   icfObject,   selected_ints = NULL,   selected_feats = NULL,   specific_feats_1 = NULL,   specific_feats_2 = NULL,   min_cells = 5,   min_int_cells = 3,   min_fdr = 0.05,   min_spat_diff = 0,   min_log2_fc = 0.5,   do_parallel = TRUE,   verbose = T )"},{"path":"https://drieslab.github.io/Giotto/reference/combineInteractionChangedFeats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"combineInteractionChangedFeats — combineInteractionChangedFeats","text":"icfObject ICF (interaction changed feat) score object selected_ints subset selected cell-cell interactions (optional) selected_feats subset selected Features (optional) specific_feats_1 specific Featureset combo (need position match specific_feats_2) specific_feats_2 specific Featureset combo (need position match specific_feats_1) min_cells minimum number target cell type min_int_cells minimum number interacting cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum absolute log2 fold-change do_parallel run calculations parallel mclapply verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineInteractionChangedFeats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"combineInteractionChangedFeats — combineInteractionChangedFeats","text":"combIcfObject contains filtered differential feature scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineInteractionChangedFeatures_per_interaction.html","id":null,"dir":"Reference","previous_headings":"","what":"combineInteractionChangedFeatures_per_interaction — combineInteractionChangedFeatures_per_interaction","title":"combineInteractionChangedFeatures_per_interaction — combineInteractionChangedFeatures_per_interaction","text":"Combine ICF scores per interaction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineInteractionChangedFeatures_per_interaction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"combineInteractionChangedFeatures_per_interaction — combineInteractionChangedFeatures_per_interaction","text":"","code":"combineInteractionChangedFeatures_per_interaction(   icfObject,   sel_int,   selected_feats = NULL,   specific_feats_1 = NULL,   specific_feats_2 = NULL,   min_cells = 5,   min_int_cells = 3,   min_fdr = 0.05,   min_spat_diff = 0,   min_log2_fc = 0.5 )"},{"path":"https://drieslab.github.io/Giotto/reference/combineInteractionChangedGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"combineInteractionChangedGenes — combineInteractionChangedGenes","title":"combineInteractionChangedGenes — combineInteractionChangedGenes","text":"Combine ICF scores pairwise manner.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/combineInteractionChangedGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"combineInteractionChangedGenes — combineInteractionChangedGenes","text":"","code":"combineInteractionChangedGenes(...)"},{"path":"https://drieslab.github.io/Giotto/reference/combineInteractionChangedGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"combineInteractionChangedGenes — combineInteractionChangedGenes","text":"... Arguments passed combineInteractionChangedFeats icfObject ICF (interaction changed feat) score object selected_ints subset selected cell-cell interactions (optional) selected_feats subset selected Features (optional) specific_feats_1 specific Featureset combo (need position match specific_feats_2) specific_feats_2 specific Featureset combo (need position match specific_feats_1) min_cells minimum number target cell type min_int_cells minimum number interacting cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum absolute log2 fold-change do_parallel run calculations parallel mclapply verbose verbose","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/compareCellAbundance.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare cell types percent per polygon — compareCellAbundance","title":"Compare cell types percent per polygon — compareCellAbundance","text":"Compare cell types percent per polygon","code":""},{"path":"https://drieslab.github.io/Giotto/reference/compareCellAbundance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare cell types percent per polygon — compareCellAbundance","text":"","code":"compareCellAbundance(   gobject,   polygon_name = \"selections\",   spat_unit = \"cell\",   feat_type = \"rna\",   cell_type_column = \"leiden_clus\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/compareCellAbundance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare cell types percent per polygon — compareCellAbundance","text":"gobject Giotto object polygon_name name polygon selections spat_unit spatial unit. Default = \"cell\" feat_type feature type. Default =  \"rna\" cell_type_column column name within cell metadata table use ... Additional parameters passed ComplexHeatmap::Heatmap","code":""},{"path":"https://drieslab.github.io/Giotto/reference/compareCellAbundance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare cell types percent per polygon — compareCellAbundance","text":"ComplexHeatmap::Heatmap","code":""},{"path":"https://drieslab.github.io/Giotto/reference/comparePolygonExpression.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare gene expression between polygon areas — comparePolygonExpression","title":"Compare gene expression between polygon areas — comparePolygonExpression","text":"Compare gene expression polygon areas","code":""},{"path":"https://drieslab.github.io/Giotto/reference/comparePolygonExpression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare gene expression between polygon areas — comparePolygonExpression","text":"","code":"comparePolygonExpression(   gobject,   polygon_name = \"selections\",   spat_unit = \"cell\",   feat_type = \"rna\",   selected_feats = \"top_genes\",   expression_values = \"normalized\",   method = \"scran\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/comparePolygonExpression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare gene expression between polygon areas — comparePolygonExpression","text":"gobject Giotto object polygon_name name polygon selections spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") selected_feats vector selected features plot expression_values gene expression values use (\"normalized\", \"scaled\", \"custom\") method method use detect differentially expressed feats (\"scran\", \"gini\", \"mast\") ... Arguments passed Heatmap","code":""},{"path":"https://drieslab.github.io/Giotto/reference/comparePolygonExpression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare gene expression between polygon areas — comparePolygonExpression","text":"ComplexHeatmap::Heatmap object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/convertEnsemblToGeneSymbol.html","id":null,"dir":"Reference","previous_headings":"","what":"convertEnsemblToGeneSymbol — convertEnsemblToGeneSymbol","title":"convertEnsemblToGeneSymbol — convertEnsemblToGeneSymbol","text":"function convert ensembl gene IDs matrix official gene symbols","code":""},{"path":"https://drieslab.github.io/Giotto/reference/convertEnsemblToGeneSymbol.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convertEnsemblToGeneSymbol — convertEnsemblToGeneSymbol","text":"","code":"convertEnsemblToGeneSymbol(matrix, species = c(\"mouse\", \"human\"))"},{"path":"https://drieslab.github.io/Giotto/reference/convertEnsemblToGeneSymbol.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convertEnsemblToGeneSymbol — convertEnsemblToGeneSymbol","text":"matrix expression matrix ensembl gene IDs rownames species species use gene symbol conversion","code":""},{"path":"https://drieslab.github.io/Giotto/reference/convertEnsemblToGeneSymbol.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convertEnsemblToGeneSymbol — convertEnsemblToGeneSymbol","text":"expression matrix gene symbols rownames","code":""},{"path":"https://drieslab.github.io/Giotto/reference/convertEnsemblToGeneSymbol.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"convertEnsemblToGeneSymbol — convertEnsemblToGeneSymbol","text":"function requires biomaRt library installed","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createArchRProj.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an ArchR project and run LSI dimension reduction — createArchRProj","title":"Create an ArchR project and run LSI dimension reduction — createArchRProj","text":"Create ArchR project run LSI dimension reduction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createArchRProj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an ArchR project and run LSI dimension reduction — createArchRProj","text":"","code":"createArchRProj(   fragmentsPath,   genome = c(\"hg19\", \"hg38\", \"mm9\", \"mm10\"),   createArrowFiles_params = list(sampleNames = \"sample1\", minTSS = 0, minFrags = 0,     maxFrags = 1e+07, minFragSize = 10, maxFragSize = 2000, offsetPlus = 0, offsetMinus =     0, TileMatParams = list(tileSize = 5000)),   ArchRProject_params = list(outputDirectory = getwd(), copyArrows = FALSE),   addIterativeLSI_params = list(),   threads = getArchRThreads(),   force = FALSE,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/createArchRProj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an ArchR project and run LSI dimension reduction — createArchRProj","text":"fragmentsPath character vector containing paths input files use generate ArrowFiles. files can one following formats: () scATAC tabix files, (ii) fragment files, (iii) bam files. genome string indicating default genome used ArchR functions. Currently supported values include \"hg19\",\"hg38\",\"mm9\", \"mm10\". value stored global environment variable, part ArchRProject. can overwritten per-function basis using given function's geneAnnotationand genomeAnnotation parameter. something one currently supported, see createGeneAnnnotation() createGenomeAnnnotation() createArrowFiles_params list parameters passed `ArchR::createArrowFiles` ArchRProject_params list parameters passed `ArchR::ArchRProject` addIterativeLSI_params list parameters passed `ArchR::addIterativeLSI` threads number threads use. Default = `ArchR::getArchRThreads()` force Default = FALSE verbose Default = TRUE","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createArchRProj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an ArchR project and run LSI dimension reduction — createArchRProj","text":"ArchR project GeneScoreMatrix, TileMatrix, TileMatrix-based LSI","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createCrossSection.html","id":null,"dir":"Reference","previous_headings":"","what":"createCrossSection — createCrossSection","title":"createCrossSection — createCrossSection","text":"Create virtual 2D cross section.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createCrossSection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"createCrossSection — createCrossSection","text":"","code":"createCrossSection(   gobject,   spat_loc_name = \"raw\",   name = \"cross_section\",   spatial_network_name = \"Delaunay_network\",   thickness_unit = c(\"cell\", \"natural\"),   slice_thickness = 2,   cell_distance_estimate_method = \"mean\",   extend_ratio = 0.2,   method = c(\"equation\", \"3 points\", \"point and norm vector\",     \"point and two plane vectors\"),   equation = NULL,   point1 = NULL,   point2 = NULL,   point3 = NULL,   normVector = NULL,   planeVector1 = NULL,   planeVector2 = NULL,   mesh_grid_n = 20,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/createCrossSection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"createCrossSection — createCrossSection","text":"gobject giotto object spat_loc_name name spatial locations name name cress section object. (default = cross_sectino) spatial_network_name name spatial network object. (default = Delaunay_network) thickness_unit unit virtual section thickness. \"cell\", average size observed cells used length unit. \"natural\", unit cell location coordinates used.(default = cell) slice_thickness thickness slice. default = 2 cell_distance_estimate_method method estimate average distance neighobring cells. (default = mean) extend_ratio deciding span cross section meshgrid, ratio extension compared borders vitural tissue section. (default = 0.2) method method define cross section plane. equation, plane defined four element numerical vector (equation) form c(,B,C,D), corresponding plane equation Ax++Cz=D. 3 points, plane define coordinates 3 points, given point1, point2, point3. point norm vector, plane defined coordinates one point (point1) plane coordinates one norm vector (normVector) plane. point two plane vector, plane defined coordinates one point (point1) plane coordinates two vectors (planeVector1, planeVector2) plane. (default = equation) equation equation required method \"equation\".equations needs numerical vector length 4, form c(,B,C,D), defines plane Ax++Cz=D. point1 coordinates first point required method \"3 points\",\"point norm vector\", \"point two plane vectors\". point2 coordinates second point required method \"3 points\" point3 coordinates third point required method \"3 points\" normVector coordinates norm vector required method \"point norm vector\" planeVector1 coordinates first plane vector required method \"point two plane vectors\" planeVector2 coordinates second plane vector required method \"point two plane vectors\" mesh_grid_n numer meshgrid lines generate along directions cross section plane. return_gobject boolean: return giotto object (default = TRUE)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createCrossSection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"createCrossSection — createCrossSection","text":"giotto object updated spatial network slot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createCrossSection.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"createCrossSection — createCrossSection","text":"Creates virtual 2D cross section object given spatial network object. users need provide definition cross section plane (see method).","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Nanostring CosMx Giotto Object — createGiottoCosMxObject","title":"Create Nanostring CosMx Giotto Object — createGiottoCosMxObject","text":"Given path CosMx experiment directory, creates Giotto object.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Nanostring CosMx Giotto Object — createGiottoCosMxObject","text":"","code":"createGiottoCosMxObject(   cosmx_dir = NULL,   data_to_use = c(\"all\", \"subcellular\", \"aggregate\"),   remove_background_polygon = TRUE,   background_algo = c(\"range\"),   remove_unvalid_polygons = TRUE,   FOVs = NULL,   instructions = NULL,   cores = determine_cores(),   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Nanostring CosMx Giotto Object — createGiottoCosMxObject","text":"cosmx_dir full path exported cosmx directory data_to_use type(s) expression data build gobject Default '' information available. 'subcellular' loads transcript coordinates . 'aggregate' loads provided aggregated expression matrix. remove_background_polygon try remove background polygon (default: FALSE) background_algo algorithm remove background polygon remove_unvalid_polygons remove unvalid polygons (default: TRUE) FOVs field views load (affects subcellular data images) instructions list instructions output result createGiottoInstructions cores many cores threads use read data paths provided verbose verbose building Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Nanostring CosMx Giotto Object — createGiottoCosMxObject","text":"giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create Nanostring CosMx Giotto Object — createGiottoCosMxObject","text":"[Expected Directory] function generates giotto object given link cosmx output directory. expects following items within directory bolded portions function matches : CellComposite (folder images) CellLabels (folder images) CellOverlay (folder images) CompartmentLabels (folder images) experimentname_exprMat_file.csv (file) experimentname_fov_positions_file.csv (file) experimentname_metadata_file.csv (file) experimentname_tx_file.csv (file) [Workflows] Workflow use accessed data_to_use param '' - loads requires subcellular information tx_file fov_positions_file   also existing aggregated information (expression, spatial locations, metadata)   exprMat_file metadata_file. 'subcellular' - loads requires subcellular information tx_file   fov_positions_file . 'aggregate' - loads requires existing aggregate information (expression,   spatial locations, metadata) exprMat_file metadata_file. [Images] Images default CellComposite, CellLabels, CompartmentLabels, CellOverlay folders loaded giotto largeImage objects workflows long available. Additionally, CellComposite images converted giotto image objects, making plotting image objects responsive accessing server. showGiottoImageNames can used see available images.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject_aggregate.html","id":null,"dir":"Reference","previous_headings":"","what":"Load and create a CosMx Giotto object from aggregate info — createGiottoCosMxObject_aggregate","title":"Load and create a CosMx Giotto object from aggregate info — createGiottoCosMxObject_aggregate","text":"Load create CosMx Giotto object aggregate info","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject_aggregate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load and create a CosMx Giotto object from aggregate info — createGiottoCosMxObject_aggregate","text":"","code":"createGiottoCosMxObject_aggregate(   dir_items,   cores,   verbose = TRUE,   instructions = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject_aggregate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load and create a CosMx Giotto object from aggregate info — createGiottoCosMxObject_aggregate","text":"cores many cores threads use read data paths provided verbose verbose building Giotto object instructions list instructions output result createGiottoInstructions","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject_all.html","id":null,"dir":"Reference","previous_headings":"","what":"Load and create a CosMx Giotto object from subcellular and aggregate info — createGiottoCosMxObject_all","title":"Load and create a CosMx Giotto object from subcellular and aggregate info — createGiottoCosMxObject_all","text":"Load create CosMx Giotto object subcellular aggregate info","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject_all.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load and create a CosMx Giotto object from subcellular and aggregate info — createGiottoCosMxObject_all","text":"","code":"createGiottoCosMxObject_all(   dir_items,   FOVs,   remove_background_polygon = TRUE,   background_algo = c(\"range\"),   remove_unvalid_polygons = TRUE,   cores,   verbose = TRUE,   instructions = NULL,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject_all.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load and create a CosMx Giotto object from subcellular and aggregate info — createGiottoCosMxObject_all","text":"dir_items list full directory paths read_cosmx_folder FOVs field views load (affects subcellular data images) remove_background_polygon try remove background polygon (default: FALSE) background_algo algorithm remove background polygon remove_unvalid_polygons remove unvalid polygons (default: TRUE) cores many cores threads use read data paths provided verbose verbose building Giotto object instructions list instructions output result createGiottoInstructions","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject_all.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load and create a CosMx Giotto object from subcellular and aggregate info — createGiottoCosMxObject_all","text":"subcellular (subellular transcript detection information) aggregate (aggregated detection count matrices cell polygon NanoString) data loaded . two separated 'cell' 'cell_agg' spatial units order denote difference origin two.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject_subcellular.html","id":null,"dir":"Reference","previous_headings":"","what":"Load and create a CosMx Giotto object from subcellular info — createGiottoCosMxObject_subcellular","title":"Load and create a CosMx Giotto object from subcellular info — createGiottoCosMxObject_subcellular","text":"Load create CosMx Giotto object subcellular info","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject_subcellular.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load and create a CosMx Giotto object from subcellular info — createGiottoCosMxObject_subcellular","text":"","code":"createGiottoCosMxObject_subcellular(   dir_items,   FOVs = NULL,   remove_background_polygon = TRUE,   background_algo = c(\"range\"),   remove_unvalid_polygons = TRUE,   cores,   verbose = TRUE,   instructions = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoCosMxObject_subcellular.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load and create a CosMx Giotto object from subcellular info — createGiottoCosMxObject_subcellular","text":"FOVs field views load (affects subcellular data images) remove_background_polygon try remove background polygon (default: FALSE) background_algo algorithm remove background polygon remove_unvalid_polygons remove unvalid polygons (default: TRUE) cores many cores threads use read data paths provided verbose verbose building Giotto object instructions list instructions output result createGiottoInstructions","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoMerscopeObject.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Vizgen MERSCOPE Giotto Object — createGiottoMerscopeObject","title":"Create Vizgen MERSCOPE Giotto Object — createGiottoMerscopeObject","text":"Given path MERSCOPE experiment directory, creates Giotto object.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoMerscopeObject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Vizgen MERSCOPE Giotto Object — createGiottoMerscopeObject","text":"","code":"createGiottoMerscopeObject(   merscope_dir,   data_to_use = c(\"subcellular\", \"aggregate\"),   FOVs = NULL,   poly_z_indices = 1:7,   calculate_overlap = TRUE,   overlap_to_matrix = TRUE,   aggregate_stack = TRUE,   aggregate_stack_param = list(summarize_expression = \"sum\", summarize_locations =     \"mean\", new_spat_unit = \"cell\"),   instructions = NULL,   cores = NA,   verbose = TRUE )  createGiottoMerscopeObject_subcellular(   data_list,   calculate_overlap = TRUE,   overlap_to_matrix = TRUE,   aggregate_stack = TRUE,   aggregate_stack_param = list(summarize_expression = \"sum\", summarize_locations =     \"mean\", new_spat_unit = \"cell\"),   cores = NA,   verbose = TRUE )  createGiottoMerscopeObject_aggregate(data_list, cores = NA, verbose = TRUE)"},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoMerscopeObject.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Vizgen MERSCOPE Giotto Object — createGiottoMerscopeObject","text":"merscope_dir full path exported merscope directory data_to_use either 'subcellular' 'aggregate' information use object creation FOVs FOVs use building subcellular object. (default NULL) NULL loads FOVs (slow) calculate_overlap whether run calculateOverlapRaster overlap_to_matrix whether run overlapToMatrix aggregate_stack whether run aggregateStacks aggregate_stack_param params pass aggregateStacks instructions list instructions output result createGiottoInstructions cores many cores threads use read data paths provided verbose verbose building Giotto object data_list list loaded data load_merscope_folder","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoMerscopeObject.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Vizgen MERSCOPE Giotto Object — createGiottoMerscopeObject","text":"giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoMerscopeObject.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create Vizgen MERSCOPE Giotto Object — createGiottoMerscopeObject","text":"[Expected Directory] function generates giotto object given link MERSCOPE output directory. expects following items within directory bolded portions function matches : cell_boundaries (folder .hdf5 files) images (folder .tif images scalefactor/transfrom table) cell_by_gene.csv (file) cell_metadatafov_positions_file.csv (file) detected_transcriptsmetadata_file.csv (file)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoMerscopeObject.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Create Vizgen MERSCOPE Giotto Object — createGiottoMerscopeObject","text":"createGiottoMerscopeObject_subcellular(): Create giotto object 'subcellular' workflow createGiottoMerscopeObject_aggregate(): Create giotto object 'aggregate' workflow","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoObjectfromArchR.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Giotto object from an ArchR project — createGiottoObjectfromArchR","title":"Create a Giotto object from an ArchR project — createGiottoObjectfromArchR","text":"Create Giotto object ArchR project","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoObjectfromArchR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Giotto object from an ArchR project — createGiottoObjectfromArchR","text":"","code":"createGiottoObjectfromArchR(   archRproj,   expression = NULL,   expression_feat = \"atac\",   spatial_locs = NULL,   sampleNames = \"sample1\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoObjectfromArchR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Giotto object from an ArchR project — createGiottoObjectfromArchR","text":"archRproj ArchR project expression expression information expression_feat Giotto object available features (e.g. atac, rna, ...) spatial_locs data.table data.frame coordinates cell centroids sampleNames character vector containing ArchR project sample name ... additional arguments passed `createGiottoObject`","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoObjectfromArchR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Giotto object from an ArchR project — createGiottoObjectfromArchR","text":"Giotto object least atac epigenetic modality","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoVisiumObject.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a giotto object from 10x visium data — createGiottoVisiumObject","title":"Create a giotto object from 10x visium data — createGiottoVisiumObject","text":"Create Giotto object directly 10X visium folder. Also accepts visium H5 outputs.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoVisiumObject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a giotto object from 10x visium data — createGiottoVisiumObject","text":"","code":"createGiottoVisiumObject(   visium_dir = NULL,   expr_data = c(\"raw\", \"filter\"),   gene_column_index = 1,   h5_visium_path = NULL,   h5_gene_ids = c(\"symbols\", \"ensembl\"),   h5_tissue_positions_path = NULL,   h5_image_png_path = NULL,   h5_json_scalefactors_path = NULL,   png_name = NULL,   do_manual_adj = FALSE,   xmax_adj = 0,   xmin_adj = 0,   ymax_adj = 0,   ymin_adj = 0,   instructions = NULL,   expression_matrix_class = c(\"dgCMatrix\", \"DelayedArray\"),   h5_file = NULL,   cores = NA,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoVisiumObject.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a giotto object from 10x visium data — createGiottoVisiumObject","text":"visium_dir path 10X visium directory [required] expr_data raw filtered data (see details) gene_column_index column index select (see details) h5_visium_path path visium 10X .h5 file h5_gene_ids gene names symbols (default) ensemble gene ids h5_tissue_positions_path path tissue locations (.csv file) h5_image_png_path path tissue .png file (optional). Image autoscaling looks matches filename either 'hires' 'lowres' h5_json_scalefactors_path path .json scalefactors (optional) png_name select name png use (see details) do_manual_adj flag use manual adj values instead automatic image alignment xmax_adj adjustment maximum x-value align image xmin_adj adjustment minimum x-value align image ymax_adj adjustment maximum y-value align image ymin_adj adjustment minimum y-value align image instructions list instructions output result createGiottoInstructions expression_matrix_class class expression matrix use (e.g. 'dgCMatrix', 'DelayedArray') h5_file optional path create -disk h5 file cores many cores threads use read data paths provided verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoVisiumObject.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a giotto object from 10x visium data — createGiottoVisiumObject","text":"giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoVisiumObject.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a giotto object from 10x visium data — createGiottoVisiumObject","text":"starting Visium 10X directory: expr_data: raw take expression data raw_feature_bc_matrix filter filtered_feature_bc_matrix gene_column_index: gene identifiers (names) use multiple columns (e.g. ensemble gene symbol) png_name: default first png selected, provide png name override (e.g. myimage.png) file scalefactors_json.json detected automaticated used attempt align data starting Visium 10X .h5 file h5_visium_path: full path .h5 file: //path//visium_file.h5 h5_tissue_positions_path: full path spatial locations file: //path//tissue_positions_list.csv h5_image_png_path: full path png: //path//images/tissue_lowres_image.png h5_json_scalefactors_path: full path .json file: //path//scalefactors_json.json","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoXeniumObject.html","id":null,"dir":"Reference","previous_headings":"","what":"Create 10x Xenium Giotto Object — createGiottoXeniumObject","title":"Create 10x Xenium Giotto Object — createGiottoXeniumObject","text":"Given path Xenium experiment output folder, creates Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoXeniumObject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create 10x Xenium Giotto Object — createGiottoXeniumObject","text":"","code":"createGiottoXeniumObject(   xenium_dir,   data_to_use = c(\"subcellular\", \"aggregate\"),   load_format = \"csv\",   h5_expression = TRUE,   h5_gene_ids = c(\"symbols\", \"ensembl\"),   gene_column_index = 1,   bounds_to_load = c(\"cell\"),   qv_threshold = 20,   key_list = NULL,   instructions = NULL,   cores = NA,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoXeniumObject.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create 10x Xenium Giotto Object — createGiottoXeniumObject","text":"xenium_dir full path exported xenium directory data_to_use type(s) expression data build gobject (e.g. default: 'subcellular', 'aggregate', '') load_format files formats load data. Either `csv` `parquet` currently supported. h5_expression (boolean) whether load cell_feature_matrix .h5 file. Default TRUE h5_gene_ids use gene symbols (default) ensembl ids .h5 gene expression matrix gene_column_index column features genes .tsv file use row ids bounds_to_load vector boundary information load (e.g. 'cell' 'nucleus' c('cell', 'nucleus') load time.) qv_threshold Minimum Phred-scaled quality score cutoff included subcellular transcript detection (default = 20) key_list (advanced) list grep-based keywords split subcellular feature detections feature type. See details instructions list instructions output result createGiottoInstructions cores many cores threads use read data paths provided verbose verbose building Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoXeniumObject.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create 10x Xenium Giotto Object — createGiottoXeniumObject","text":"[QC feature types] Xenium provides info feature detections include Gene Expression specific probes. Additional probes QC included: blank codeword, negative control codeword, negative control probe. additional QC probes occupy treated feature types can largely remain independent gene expression information. [key_list] Related data_to_use = 'subcellular' workflow : Additional QC probe information subcellular feature detections information must separated gene expression information processing. QC probes prefixes allow selected rest feature IDs. Giotto uses named list keywords (key_list) select QC probes, list names names assigned feature type feature detections. default list used key_list = NULL. Default list: Gene expression subset accepted subset feat_IDs map keys.","code":"list(blank_code = 'BLANK_',       neg_code = 'NegControlCodeword_',       neg_probe = c('NegControlProbe_|antisense_'))"},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoXeniumObject_aggregate.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Xenium Giotto object from aggregate info — createGiottoXeniumObject_aggregate","title":"Create a Xenium Giotto object from aggregate info — createGiottoXeniumObject_aggregate","text":"Aggregate workflow createGiottoXeniumObject","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoXeniumObject_aggregate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Xenium Giotto object from aggregate info — createGiottoXeniumObject_aggregate","text":"","code":"createGiottoXeniumObject_aggregate(   data_list,   instructions = NULL,   cores = NA,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoXeniumObject_aggregate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Xenium Giotto object from aggregate info — createGiottoXeniumObject_aggregate","text":"data_list list data loaded load_xenium_folder instructions list instructions output result createGiottoInstructions cores many cores threads use read data paths provided verbose verbose building Giotto object","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoXeniumObject_subcellular.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Xenium Giotto object from subcellular info — createGiottoXeniumObject_subcellular","title":"Create a Xenium Giotto object from subcellular info — createGiottoXeniumObject_subcellular","text":"Subcellular workflow createGiottoXeniumObject","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoXeniumObject_subcellular.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Xenium Giotto object from subcellular info — createGiottoXeniumObject_subcellular","text":"","code":"createGiottoXeniumObject_subcellular(   data_list,   key_list = NULL,   qv_threshold = 20,   instructions = NULL,   cores = NA,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/createGiottoXeniumObject_subcellular.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Xenium Giotto object from subcellular info — createGiottoXeniumObject_subcellular","text":"data_list list data loaded load_xenium_folder key_list regex-based search keys feature IDs allow separation separate giottoPoints objects feat_type qv_threshold Minimum Phred-scaled quality score cutoff included subcellular transcript detection (default = 20) instructions list instructions output result createGiottoInstructions cores many cores threads use read data paths provided verbose verbose building Giotto object","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/createMerscopeLargeImage.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Vizgen MERSCOPE largeImage — createMerscopeLargeImage","title":"Create Vizgen MERSCOPE largeImage — createMerscopeLargeImage","text":"Read MERSCOPE stitched images giottoLargeImage. Images also transformed match spatial coordinate reference system paired points polygon data.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createMerscopeLargeImage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Vizgen MERSCOPE largeImage — createMerscopeLargeImage","text":"","code":"createMerscopeLargeImage(image_file, transforms_file, name = \"image\")"},{"path":"https://drieslab.github.io/Giotto/reference/createMerscopeLargeImage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Vizgen MERSCOPE largeImage — createMerscopeLargeImage","text":"image_file character. Path one MERSCOPE images load transforms_file character. Path MERSCOPE transforms file. Usually folder images named 'micron_to_mosaic_pixel_transform.csv' name character. name assign image. Multiple provided image_file list.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createSpatialEnrich.html","id":null,"dir":"Reference","previous_headings":"","what":"createSpatialEnrich — createSpatialEnrich","title":"createSpatialEnrich — createSpatialEnrich","text":"Function calculate gene signature enrichment scores per spatial position using enrichment test.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createSpatialEnrich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"createSpatialEnrich — createSpatialEnrich","text":"","code":"createSpatialEnrich(...)"},{"path":"https://drieslab.github.io/Giotto/reference/createSpatialEnrich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"createSpatialEnrich — createSpatialEnrich","text":"... Arguments passed runSpatialEnrich gobject Giotto object spat_unit spatial unit feat_type feature type enrich_method method gene signature enrichment calculation sign_matrix Matrix signature genes cell type / process expression_values expression values use reverse_log_scale reverse expression values log scale min_overlap_genes minimum number overlapping genes sign_matrix required calculate enrichment (PAGE) logbase log base use reverse_log_scale = TRUE p_value calculate p-value (default = FALSE) n_times (page/rank) number permutation iterations calculate p-value rbp_p (rank) fractional binarization threshold (default = 0.99) num_agg (rank) number top genes aggregate (default = 100) max_block number lines process together (default = 20e6) top_percentage (hyper) percentage cells considered gene expression matrix binarization output_enrichment return enrichment output name give spatial enrichment results, default = PAGE verbose verbose return_gobject return giotto object","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/createSpatialGenomicsObject.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Spatial Genomics Giotto Object — createSpatialGenomicsObject","title":"Create Spatial Genomics Giotto Object — createSpatialGenomicsObject","text":"Given path Spatial Genomics data directory, creates Giotto object.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/createSpatialGenomicsObject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Spatial Genomics Giotto Object — createSpatialGenomicsObject","text":"","code":"createSpatialGenomicsObject(sg_dir = NULL, instructions = NULL)"},{"path":"https://drieslab.github.io/Giotto/reference/createSpatialGenomicsObject.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Spatial Genomics Giotto Object — createSpatialGenomicsObject","text":"sg_dir full path exported Spatial Genomics directory instructions new instructions (e.g. result createGiottoInstructions)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_2d_mesh_grid_line_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"create_2d_mesh_grid_line_obj — create_2d_mesh_grid_line_obj","title":"create_2d_mesh_grid_line_obj — create_2d_mesh_grid_line_obj","text":"create 2d mesh grid line object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_2d_mesh_grid_line_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"create_2d_mesh_grid_line_obj — create_2d_mesh_grid_line_obj","text":"","code":"create_2d_mesh_grid_line_obj(x_min, x_max, y_min, y_max, mesh_grid_n)"},{"path":"https://drieslab.github.io/Giotto/reference/create_2d_mesh_grid_line_obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"create_2d_mesh_grid_line_obj — create_2d_mesh_grid_line_obj","text":"x_min x_min x_max x_max y_min y_min y_max y_max mesh_grid_n mesh_grid_n","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_cell_type_random_cell_IDs.html","id":null,"dir":"Reference","previous_headings":"","what":"create_cell_type_random_cell_IDs — create_cell_type_random_cell_IDs","title":"create_cell_type_random_cell_IDs — create_cell_type_random_cell_IDs","text":"creates randomized cell ids within selection cell types","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_cell_type_random_cell_IDs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"create_cell_type_random_cell_IDs — create_cell_type_random_cell_IDs","text":"","code":"create_cell_type_random_cell_IDs(   gobject,   feat_type = NULL,   spat_unit = NULL,   cluster_column = \"cell_types\",   needed_cell_types,   set_seed = FALSE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/create_cell_type_random_cell_IDs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"create_cell_type_random_cell_IDs — create_cell_type_random_cell_IDs","text":"gobject giotto object use feat_type feature type cluster_column cluster column cell type information needed_cell_types vector cell type names random id found set_seed set seed reproducibility seed_number seed number","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_cell_type_random_cell_IDs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"create_cell_type_random_cell_IDs — create_cell_type_random_cell_IDs","text":"list randomly sampled cell ids cell type composition","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_crossSection_object.html","id":null,"dir":"Reference","previous_headings":"","what":"create_crossSection_object — create_crossSection_object","title":"create_crossSection_object — create_crossSection_object","text":"create crossSection object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_crossSection_object.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"create_crossSection_object — create_crossSection_object","text":"","code":"create_crossSection_object(   name = NULL,   method = NULL,   thickness_unit = NULL,   slice_thickness = NULL,   cell_distance_estimate_method = NULL,   extend_ratio = NULL,   plane_equation = NULL,   mesh_grid_n = NULL,   mesh_obj = NULL,   cell_subset = NULL,   cell_subset_spatial_locations = NULL,   cell_subset_projection_locations = NULL,   cell_subset_projection_PCA = NULL,   cell_subset_projection_coords = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/create_crossSection_object.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"create_crossSection_object — create_crossSection_object","text":"name name cross section object. (default = cross_section) method method define cross section plane. thickness_unit unit virtual section thickness. \"cell\", average size observed cells used length unit. \"natural\", unit cell location coordinates used.(default = cell) slice_thickness thickness slice cell_distance_estimate_method method estimate average distance neighobring cells. (default = mean) extend_ratio deciding span cross section meshgrid, ratio extension compared borders virtual tissue section. (default = 0.2) plane_equation numerical vector length 4, form c(,B,C,D), defines plane Ax++Cz=D. mesh_grid_n number meshgrid lines generate along directions cross section plane. mesh_obj object stores cross section meshgrid information. cell_subset cells selected cross section cell_subset_spatial_locations locations cells selected cross section cell_subset_projection_locations 3D projection coordinates selected cells onto cross section plane cell_subset_projection_PCA pca projection coordinates cell_subset_projection_coords 2D PCA coordinates selected cells cross section plane","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_genes_to_use_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"create_genes_to_use_matrix — create_genes_to_use_matrix","title":"create_genes_to_use_matrix — create_genes_to_use_matrix","text":"subsets matrix based vector genes hvf column","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_genes_to_use_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"create_genes_to_use_matrix — create_genes_to_use_matrix","text":"","code":"create_feats_to_use_matrix(   gobject,   feat_type = NULL,   spat_unit = NULL,   sel_matrix,   feats_to_use,   verbose = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/create_genes_to_use_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"create_genes_to_use_matrix — create_genes_to_use_matrix","text":"gobject giotto object feat_type feature type spat_unit spatial unit sel_matrix selected expression matrix feats_to_use feats use, character vector features verbose verbosity","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_genes_to_use_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"create_genes_to_use_matrix — create_genes_to_use_matrix","text":"subsetted matrix based selected genes","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_jackstrawplot.html","id":null,"dir":"Reference","previous_headings":"","what":"create_jackstrawplot — create_jackstrawplot","title":"create_jackstrawplot — create_jackstrawplot","text":"create jackstrawplot ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_jackstrawplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"create_jackstrawplot — create_jackstrawplot","text":"","code":"create_jackstrawplot(   jackstraw_data,   ncp = 20,   ylim = c(0, 1),   threshold = 0.01 )"},{"path":"https://drieslab.github.io/Giotto/reference/create_jackstrawplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"create_jackstrawplot — create_jackstrawplot","text":"jackstraw_data result jackstraw function (`testresult$p`) ncp number principal components calculate ylim y-axis limits jackstraw plot threshold p.value threshold call PC significant","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_jackstrawplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"create_jackstrawplot — create_jackstrawplot","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_mesh_grid_lines.html","id":null,"dir":"Reference","previous_headings":"","what":"create_mesh_grid_lines — create_mesh_grid_lines","title":"create_mesh_grid_lines — create_mesh_grid_lines","text":"create mesh grid lines cross section","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_mesh_grid_lines.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"create_mesh_grid_lines — create_mesh_grid_lines","text":"","code":"create_mesh_grid_lines(   cell_subset_projection_locations,   extend_ratio,   mesh_grid_n )"},{"path":"https://drieslab.github.io/Giotto/reference/create_mesh_grid_lines.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"create_mesh_grid_lines — create_mesh_grid_lines","text":"cell_subset_projection_locations cell_subset_projection_locations extend_ratio extend_ratio mesh_grid_n mesh_grid_n","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_screeplot.html","id":null,"dir":"Reference","previous_headings":"","what":"create_screeplot — create_screeplot","title":"create_screeplot — create_screeplot","text":"create screeplot ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_screeplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"create_screeplot — create_screeplot","text":"","code":"create_screeplot(eigs, ncp = 20, ylim = c(0, 20))"},{"path":"https://drieslab.github.io/Giotto/reference/create_screeplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"create_screeplot — create_screeplot","text":"eigs numeric. Vector pca eigenvalues ncp numeric. max number principal components plot ylim numeric. y-axis limits scree plot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_screeplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"create_screeplot — create_screeplot","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_screeplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"create_screeplot — create_screeplot","text":"","code":"if (FALSE) { dr = GiottoData::loadSubObjectMini('dimObj') scree = create_screeplot(methods::slot(dr, 'misc')$eigenvalues) scree }"},{"path":"https://drieslab.github.io/Giotto/reference/create_switch_string_unequal.html","id":null,"dir":"Reference","previous_headings":"","what":"create_switch_string_unequal — create_switch_string_unequal","title":"create_switch_string_unequal — create_switch_string_unequal","text":"create_switch_string_unequal","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_switch_string_unequal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"create_switch_string_unequal — create_switch_string_unequal","text":"","code":"create_switch_string_unequal(   num_first = NULL,   num_second = NULL,   switch_strs = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/create_switch_string_unequal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"create_switch_string_unequal — create_switch_string_unequal","text":"num_first sorted vector cluster numbers outer loop num_second sorted vector cluster numbers inner loop","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_switch_string_unequal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"create_switch_string_unequal — create_switch_string_unequal","text":"switch_str, vector corresponding cluster numbers strings","code":""},{"path":"https://drieslab.github.io/Giotto/reference/create_switch_string_unequal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"create_switch_string_unequal — create_switch_string_unequal","text":"creates string format c(\"x_1-y_1\", \"x_2-y_2\"...\"x_n, y_m\") :    x_n cluster number original spatial unit    y_m cluster number resized spatial unit    n number clusters original spatial unit    m number clusters new spatial unit","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionGenePlot.html","id":null,"dir":"Reference","previous_headings":"","what":"crossSectionGenePlot — crossSectionGenePlot","title":"crossSectionGenePlot — crossSectionGenePlot","text":"Visualize cells gene expression virtual cross section according spatial coordinates","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionGenePlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"crossSectionGenePlot — crossSectionGenePlot","text":"","code":"crossSectionGenePlot(   gobject = NULL,   spat_loc_name = \"raw\",   crossSection_obj = NULL,   name = NULL,   spatial_network_name = \"Delaunay_network\",   default_save_name = \"crossSectionGenePlot\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionGenePlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"crossSectionGenePlot — crossSectionGenePlot","text":"gobject giotto object spat_loc_name name spatial locations crossSection_obj crossSection object name name virtual cross section use spatial_network_name name spatial network use default_save_name default save name saving, change, change save_name save_param ... parameters spatFeatPlot2D","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionGenePlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"crossSectionGenePlot — crossSectionGenePlot","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionGenePlot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"crossSectionGenePlot — crossSectionGenePlot","text":"Description parameters.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionGenePlot3D.html","id":null,"dir":"Reference","previous_headings":"","what":"crossSectionGenePlot3D — crossSectionGenePlot3D","title":"crossSectionGenePlot3D — crossSectionGenePlot3D","text":"Visualize cells gene expression virtual cross section according spatial coordinates","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionGenePlot3D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"crossSectionGenePlot3D — crossSectionGenePlot3D","text":"","code":"crossSectionGenePlot3D(   gobject,   crossSection_obj = NULL,   name = NULL,   spatial_network_name = \"Delaunay_network\",   other_cell_color = alpha(\"lightgrey\", 0),   default_save_name = \"crossSectionGenePlot3D\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionGenePlot3D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"crossSectionGenePlot3D — crossSectionGenePlot3D","text":"gobject giotto object crossSection_obj cross section object alternative input. default = NULL. name name virtual cross section use spatial_network_name name spatial network use other_cell_color color cells outside cross section. default = transparent. default_save_name default save name saving, change, change save_name save_param ... parameters spatGenePlot3D","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionGenePlot3D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"crossSectionGenePlot3D — crossSectionGenePlot3D","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionGenePlot3D.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"crossSectionGenePlot3D — crossSectionGenePlot3D","text":"Description parameters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"crossSectionPlot — crossSectionPlot","title":"crossSectionPlot — crossSectionPlot","text":"Visualize cells virtual cross section according spatial coordinates","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"crossSectionPlot — crossSectionPlot","text":"","code":"crossSectionPlot(   gobject,   spat_loc_name = \"raw\",   feat_type = NULL,   crossSection_obj = NULL,   name = NULL,   spatial_network_name = \"Delaunay_network\",   default_save_name = \"crossSectionPlot\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"crossSectionPlot — crossSectionPlot","text":"gobject giotto object spat_loc_name name spatial locations feat_type feature type crossSection_obj cross section object alternative input. default = NULL. name name virtual cross section use spatial_network_name name spatial network use default_save_name default save name saving, change, change save_name save_param ... parameters spatPlot2D","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"crossSectionPlot — crossSectionPlot","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionPlot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"crossSectionPlot — crossSectionPlot","text":"Description parameters.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionPlot3D.html","id":null,"dir":"Reference","previous_headings":"","what":"crossSectionPlot3D — crossSectionPlot3D","title":"crossSectionPlot3D — crossSectionPlot3D","text":"Visualize cells virtual cross section according spatial coordinates","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionPlot3D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"crossSectionPlot3D — crossSectionPlot3D","text":"","code":"crossSectionPlot3D(   gobject,   crossSection_obj = NULL,   name = NULL,   spatial_network_name = \"Delaunay_network\",   show_other_cells = T,   other_cell_color = alpha(\"lightgrey\", 0),   default_save_name = \"crossSection3D\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionPlot3D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"crossSectionPlot3D — crossSectionPlot3D","text":"gobject giotto object crossSection_obj cross section object alternative input. default = NULL. name name virtual cross section use spatial_network_name name spatial network use show_other_cells display selected cells other_cell_color color cells outside cross section. default = transparent. default_save_name default save name saving, change, change save_name save_param ... parameters spatPlot3D","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionPlot3D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"crossSectionPlot3D — crossSectionPlot3D","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/crossSectionPlot3D.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"crossSectionPlot3D — crossSectionPlot3D","text":"Description parameters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/data_access_params.html","id":null,"dir":"Reference","previous_headings":"","what":"data_access_params — data_access_params","title":"data_access_params — data_access_params","text":"data_access_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/data_access_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"data_access_params — data_access_params","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") return_uniques return unique nesting names (ignores final object exists/correct class) output format get information (e.g. \"data.table\") set_defaults set default spat_unit feat_type. Change FALSE expression spat_info expected exist. copy_obj whether deep copy/duplicate getting object (default = TRUE) initialize (default = FALSE) whether initialize gobject returning","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorFeats.html","id":null,"dir":"Reference","previous_headings":"","what":"detectSpatialCorFeats — detectSpatialCorFeats","title":"detectSpatialCorFeats — detectSpatialCorFeats","text":"Detect features spatially correlated","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorFeats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"detectSpatialCorFeats — detectSpatialCorFeats","text":"","code":"detectSpatialCorFeats(   gobject,   spat_unit = NULL,   feat_type = NULL,   spat_loc_name = \"raw\",   method = c(\"grid\", \"network\"),   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   subset_feats = NULL,   spatial_network_name = \"Delaunay_network\",   network_smoothing = NULL,   spatial_grid_name = \"spatial_grid\",   min_cells_per_grid = 4,   cor_method = c(\"pearson\", \"kendall\", \"spearman\") )"},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorFeats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"detectSpatialCorFeats — detectSpatialCorFeats","text":"gobject giotto object spat_unit spatial unit feat_type feature type spat_loc_name name spatial locations method method use spatial averaging expression_values gene expression values use subset_feats subset feats use spatial_network_name name spatial network use network_smoothing smoothing factor beteen 0 1 (default: automatic) spatial_grid_name name spatial grid use min_cells_per_grid minimum number cells consider grid cor_method correlation method","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorFeats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"detectSpatialCorFeats — detectSpatialCorFeats","text":"returns spatial correlation object: \"spatCorObject\"","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorFeats.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"detectSpatialCorFeats — detectSpatialCorFeats","text":"method = network, expects fully connected spatial network. can make sure create fully connected network setting minimal_k > 0 createSpatialNetwork function. 1. grid-averaging: average gene expression values within predefined spatial grid 2. network-averaging: smoothens gene expression matrix averaging expression within one cell  using neighbours within predefined spatial network. b smoothening factor  defaults 1 - 1/k, k median number  k-neighbors  selected spatial network. Setting b = 0 means smoothing b = 1 means contribution  expression. spatCorObject can explored showSpatialCorFeats()","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorFeatsMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"detectSpatialCorFeatsMatrix — detectSpatialCorFeatsMatrix","title":"detectSpatialCorFeatsMatrix — detectSpatialCorFeatsMatrix","text":"Detect genes spatially correlated","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorFeatsMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"detectSpatialCorFeatsMatrix — detectSpatialCorFeatsMatrix","text":"","code":"detectSpatialCorFeatsMatrix(   expression_matrix,   method = c(\"grid\", \"network\"),   spatial_network,   spatial_grid,   spatial_locs,   subset_feats = NULL,   network_smoothing = NULL,   min_cells_per_grid = 4,   cor_method = c(\"pearson\", \"kendall\", \"spearman\") )"},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorFeatsMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"detectSpatialCorFeatsMatrix — detectSpatialCorFeatsMatrix","text":"expression_matrix provided expression matrix method method use spatial averaging spatial_network provided spatial network spatial_grid provided spatial grid spatial_locs provided spatial locations subset_feats subset features use network_smoothing smoothing factor beteen 0 1 (default: automatic) min_cells_per_grid minimum number cells consider grid cor_method correlation method","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorFeatsMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"detectSpatialCorFeatsMatrix — detectSpatialCorFeatsMatrix","text":"returns spatial correlation object: \"spatCorObject\"","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorFeatsMatrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"detectSpatialCorFeatsMatrix — detectSpatialCorFeatsMatrix","text":"method = network, expects fully connected spatial network. can make sure create fully connected network setting minimal_k > 0 createSpatialNetwork function. 1. grid-averaging: average gene expression values within predefined spatial grid 2. network-averaging: smoothens gene expression matrix averaging expression within one cell  using neighbours within predefined spatial network. b smoothening factor  defaults 1 - 1/k, k median number  k-neighbors  selected spatial network. Setting b = 0 means smoothing b = 1 means contribution  expression. spatCorObject can explored showSpatialCorGenes()","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"detectSpatialCorGenes — detectSpatialCorGenes","title":"detectSpatialCorGenes — detectSpatialCorGenes","text":"Detect genes spatially correlated","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"detectSpatialCorGenes — detectSpatialCorGenes","text":"","code":"detectSpatialCorGenes(   gobject,   feat_type = NULL,   spat_unit = NULL,   method = c(\"grid\", \"network\"),   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   subset_feats = NULL,   subset_genes = NULL,   spatial_network_name = \"Delaunay_network\",   network_smoothing = NULL,   spatial_grid_name = \"spatial_grid\",   min_cells_per_grid = 4,   cor_method = c(\"pearson\", \"kendall\", \"spearman\") )"},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"detectSpatialCorGenes — detectSpatialCorGenes","text":"gobject giotto object feat_type feature type spat_unit spatial unit method method use spatial averaging expression_values gene expression values use subset_feats subset feats use subset_genes deprecated, use subset_feats spatial_network_name name spatial network use network_smoothing smoothing factor beteen 0 1 (default: automatic) spatial_grid_name name spatial grid use min_cells_per_grid minimum number cells consider grid cor_method correlation method","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"detectSpatialCorGenes — detectSpatialCorGenes","text":"returns spatial correlation object: \"spatCorObject\"","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialCorGenes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"detectSpatialCorGenes — detectSpatialCorGenes","text":"method = network, expects fully connected spatial network. can make sure create fully connected network setting minimal_k > 0 createSpatialNetwork function. 1. grid-averaging: average gene expression values within predefined spatial grid 2. network-averaging: smoothens gene expression matrix averaging expression within one cell  using neighbours within predefined spatial network. b smoothening factor  defaults 1 - 1/k, k median number  k-neighbors  selected spatial network. Setting b = 0 means smoothing b = 1 means contribution  expression. spatCorObject can explored showSpatialCorGenes()","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialPatterns.html","id":null,"dir":"Reference","previous_headings":"","what":"detectSpatialPatterns — detectSpatialPatterns","title":"detectSpatialPatterns — detectSpatialPatterns","text":"Identify spatial patterns PCA average expression spatial grid.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialPatterns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"detectSpatialPatterns — detectSpatialPatterns","text":"","code":"detectSpatialPatterns(   gobject,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   spatial_grid_name = \"spatial_grid\",   min_cells_per_grid = 4,   scale_unit = F,   ncp = 100,   show_plot = T,   PC_zscore = 1.5 )"},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialPatterns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"detectSpatialPatterns — detectSpatialPatterns","text":"gobject giotto object expression_values expression values use spatial_grid_name name spatial grid use (default = 'spatial_grid') min_cells_per_grid minimum number cells grid considered scale_unit scale features ncp number principal components calculate show_plot show plots PC_zscore minimum z-score variance explained PC","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialPatterns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"detectSpatialPatterns — detectSpatialPatterns","text":"spatial pattern object 'spatPatObj'","code":""},{"path":"https://drieslab.github.io/Giotto/reference/detectSpatialPatterns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"detectSpatialPatterns — detectSpatialPatterns","text":"Steps identify spatial patterns: 1. average gene expression cells within grid, see createSpatialGrid 2. perform PCA average grid expression profiles 3. convert variance principlal components (PCs) z-scores select PCs based z-score threshold","code":""},{"path":"https://drieslab.github.io/Giotto/reference/determine_switch_string_equal.html","id":null,"dir":"Reference","previous_headings":"","what":"determine_switch_string_equal — determine_switch_string_equal","title":"determine_switch_string_equal — determine_switch_string_equal","text":"determine_switch_string_equal","code":""},{"path":"https://drieslab.github.io/Giotto/reference/determine_switch_string_equal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"determine_switch_string_equal — determine_switch_string_equal","text":"","code":"determine_switch_string_equal(   cell_meta = NULL,   cell_meta_new = NULL,   clus_name = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/determine_switch_string_equal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"determine_switch_string_equal — determine_switch_string_equal","text":"cell_meta cell_metadata original spatial_unit cell_meta_new cell_metadata resized spatial unit clus_name name cluster type, likely \"kmeans\"","code":""},{"path":"https://drieslab.github.io/Giotto/reference/determine_switch_string_equal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"determine_switch_string_equal — determine_switch_string_equal","text":"switch_str, vector corresponding cluster numbers strings","code":""},{"path":"https://drieslab.github.io/Giotto/reference/determine_switch_string_equal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"determine_switch_string_equal — determine_switch_string_equal","text":"creates string format c(\"x_1-y_1\", \"x_2-y_2\"...\"x_n, y_n\") :    x_n cluster number original spatial unit    y_m cluster number resized spatial unit    n number clusters Clusters determined corresponding based ","code":""},{"path":"https://drieslab.github.io/Giotto/reference/determine_switch_string_unequal.html","id":null,"dir":"Reference","previous_headings":"","what":"determine_switch_string_unequal — determine_switch_string_unequal","title":"determine_switch_string_unequal — determine_switch_string_unequal","text":"determine_switch_string_unequal","code":""},{"path":"https://drieslab.github.io/Giotto/reference/determine_switch_string_unequal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"determine_switch_string_unequal — determine_switch_string_unequal","text":"","code":"determine_switch_string_unequal(num_orig = NULL, num_new = NULL)"},{"path":"https://drieslab.github.io/Giotto/reference/determine_switch_string_unequal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"determine_switch_string_unequal — determine_switch_string_unequal","text":"num_orig sorted vector cluster numbers original metadata num_new sorted vector cluster numbers new, resized metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/determine_switch_string_unequal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"determine_switch_string_unequal — determine_switch_string_unequal","text":"switch_str, vector corresponding cluster numbers strings","code":""},{"path":"https://drieslab.github.io/Giotto/reference/determine_switch_string_unequal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"determine_switch_string_unequal — determine_switch_string_unequal","text":"determines create string format c(\"x_1-y_1\", \"x_2-y_2\"...\"x_n, y_m\") :    x_n cluster number original spatial unit    y_m cluster number resized spatial unit    n number clusters original spatial unit    m number clusters new spatial unit Essentially determines iteration order create_switch_string_unequal()","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doCellSegmentation.html","id":null,"dir":"Reference","previous_headings":"","what":"doCellSegmentation — doCellSegmentation","title":"doCellSegmentation — doCellSegmentation","text":"segment cells Dapi image","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doCellSegmentation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doCellSegmentation — doCellSegmentation","text":"","code":"doCellSegmentation(   raster_img,   folder_path,   reduce_resolution = 4,   overlapping_pixels = 50,   python_path = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/doCellSegmentation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doCellSegmentation — doCellSegmentation","text":"raster_img raster image; Dapi image cells folder_path character; save file reduce_resolution numeric; original Dapi image Vizgen works better Mesmer algorithm resolution reduced 4 times. overlapping_pixels numeric; number pixels overlap calculating rolling window python_path specify specific path python required","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doCellSegmentation.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doCellSegmentation — doCellSegmentation","text":"function wrapper Mesmer algorithm implemented python. segments cells tissue applying rolling window complete image. saves files specified folder coordinates tile: sx (start x), ex (end x), sy, ey.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doClusterProjection.html","id":null,"dir":"Reference","previous_headings":"","what":"Projection of cluster labels — doClusterProjection","title":"Projection of cluster labels — doClusterProjection","text":"Use fast KNN classifier predict labels smaller giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doClusterProjection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Projection of cluster labels — doClusterProjection","text":"","code":"doClusterProjection(   target_gobject,   target_cluster_label_name = \"knn_labels\",   spat_unit = NULL,   feat_type = NULL,   source_gobject,   source_cluster_labels = NULL,   reduction = \"cells\",   reduction_method = \"pca\",   reduction_name = \"pca\",   dimensions_to_use = 1:10,   knn_k = 10,   prob = FALSE,   algorithm = c(\"kd_tree\", \"cover_tree\", \"brute\"),   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/doClusterProjection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Projection of cluster labels — doClusterProjection","text":"target_gobject target giotto object target_cluster_label_name name predicted clusters spat_unit spatial unit feat_type feature type source_gobject source giotto object annotation data source_cluster_labels annotation/labels use train KNN classifier reduction reduction cells features (default = cells) reduction_method shared reduction method (default = pca space) reduction_name name shared reduction space (default name = 'pca') dimensions_to_use dimensions use shared reduction space (default = 1:10) knn_k number k-neighbors train KNN classifier prob output probabilities together label predictions algorithm nearest neighbor search algorithm return_gobject return giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doClusterProjection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Projection of cluster labels — doClusterProjection","text":"giotto object (default) data.table cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doClusterProjection.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Projection of cluster labels — doClusterProjection","text":"Function train KNN knn. training data obtained source giotto object (source_gobject) using existing annotations within cell metadata. Cells without annotation/labels target giotto object (target_gobject) receive predicted labels (optional probabilities prob = TRUE). **IMPORTANT** projection assumes using dimension reduction space (e.g. PCA) number dimensions (e.g. first 10 PCs) train KNN classifier used create initial annotations/labels source Giotto object. Altogether convenience function allow work big data can predict cell labels smaller & subsetted Giotto object project cell labels remaining cells target Giotto object.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doFeatureSetEnrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"doFeatureSetEnrichment — doFeatureSetEnrichment","title":"doFeatureSetEnrichment — doFeatureSetEnrichment","text":"Preform Gene Set Enrichment Analysis using marker genes","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doFeatureSetEnrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doFeatureSetEnrichment — doFeatureSetEnrichment","text":"","code":"doFeatureSetEnrichment(   dryrun = TRUE,   path_to_GSEA = NULL,   GSEA_dataset = NULL,   GSEA_ranked_file = NULL,   output_folder = NULL,   name_analysis_folder = \"my_GSEA_analysis\",   collapse = \"false\",   mode = c(\"Abs_max_of_probes\", \"Max_probe\", \"Median_of_probes\", \"Mean_of_probes\",     \"Sum_of_probes\"),   norm = \"meandiv\",   nperm = 1000,   scoring_scheme = \"weighted\",   plot_top_x = 20,   set_max = 500,   set_min = 15 )"},{"path":"https://drieslab.github.io/Giotto/reference/doFeatureSetEnrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doFeatureSetEnrichment — doFeatureSetEnrichment","text":"dryrun dry run, default TRUE. path_to_GSEA path GSEA command line executable, e.g. gsea-XXX.jar. See details (1.) information. GSEA_dataset path Human/Mouse collection GSEA, e.g. Hallmarks C1. See details (2.) information. GSEA_ranked_file path .rnk file GSEA. See details (3.) information output_folder path GSEA results saved. Default current working directory. name_analysis_folder default output subdirectory prefix results saved. live within output_folder; equivalent \"Analysis Name\" GSEA Application. collapse 'false' supported. use dataset -, original format. mode option selected Advanced Field \"Collapsing Mode Probe Sets => 1 gene\" norm normalization mode; meandiv supported. nperm number permutations, default 1000 scoring_scheme Default \"weighted\", equivalent \"enrichment statistic\" GSEA Application plot_top_x Default 20, number enrichment plots produce. set_max default 500, equivalent \"max size; exclude larger sets\" Basic Fields GSEA Application set_min default 15, equivalent \"min size; exclude smaller sets\" Basic Fields GSEA Application","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doFeatureSetEnrichment.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doFeatureSetEnrichment — doFeatureSetEnrichment","text":"NECESSARY PREREQUISITES 1. download install COMMAND line (platforms) gsea-XXX.jar https://www.gsea-msigdb.org/gsea/downloads.jsp 1.1. download zip file 1.2. unzip move known location (e.g. path///applications/gsea/GSEA_4.3.2) 2. download Human Mouse collections https://www.gsea-msigdb.org/gsea/msigdb/index.jsp zipped folder https://www.gsea-msigdb.org/gsea/downloads.jsp (downloaded) 3. create ranked gene lists format: data.table data.frame 2 columns column 1 = gene symbols, column 2 = weight rank metric details, see: https://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Data_formats#RNK:_Ranked_list_file_format_.28.2A.rnk.29 information parameter convetions, please reference GSEA's documentation : https://www.gsea-msigdb.org/gsea/doc/GSEAUserGuideTEXT.htm#_Syntax","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doGiottoClustree.html","id":null,"dir":"Reference","previous_headings":"","what":"doGiottoClustree — doGiottoClustree","title":"doGiottoClustree — doGiottoClustree","text":"cluster cells using leiden methodology visualize different resolutions","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doGiottoClustree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doGiottoClustree — doGiottoClustree","text":"","code":"doGiottoClustree(   gobject,   res_vector = NULL,   res_seq = NULL,   return_gobject = FALSE,   show_plot = NA,   save_plot = NA,   return_plot = NA,   save_param = list(),   default_save_name = \"clustree\",   verbose = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/doGiottoClustree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doGiottoClustree — doGiottoClustree","text":"gobject giotto object res_vector vector different resolutions test res_seq list float numbers indicating start, end, step size resolution testing, .e. (0.1, 0.6, 0.1) return_gobject default FALSE. See details info. show_plot default, pulls provided gobject instructions save_plot default, pulls provided gobject instructions return_plot default, pulls provided gobject instructions save_param list saving parameters GiottoVisuals::all_plots_save_function default_save_name name saved plot, default \"clustree\" verbose verbose ... Arguments passed clustree::clustree","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doGiottoClustree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doGiottoClustree — doGiottoClustree","text":"plot object (default), giotto object (specified)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doGiottoClustree.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doGiottoClustree — doGiottoClustree","text":"function tests different resolutions Leiden clustering provides visualization cluster sizing resolution varies. default, tested leiden clusters saved Giotto object, plot returned. return_gobject set TRUE, giotto object ** tested leiden cluster information returned.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/doHMRF.html","id":null,"dir":"Reference","previous_headings":"","what":"doHMRF — doHMRF","title":"doHMRF — doHMRF","text":"Run HMRF","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doHMRF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doHMRF — doHMRF","text":"","code":"doHMRF(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   spatial_network_name = \"Delaunay_network\",   spat_loc_name = \"raw\",   spatial_genes = NULL,   spatial_dimensions = c(\"sdimx\", \"sdimy\", \"sdimz\"),   dim_reduction_to_use = NULL,   dim_reduction_name = \"pca\",   dimensions_to_use = 1:10,   seed = 100,   name = \"test\",   k = 10,   betas = c(0, 2, 50),   tolerance = 1e-10,   zscore = c(\"none\", \"rowcol\", \"colrow\"),   numinit = 100,   python_path = NULL,   output_folder = NULL,   overwrite_output = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/doHMRF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doHMRF — doHMRF","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use spatial_network_name name spatial network use HMRF spat_loc_name name spatial locations spatial_genes spatial genes use HMRF spatial_dimensions select spatial dimensions use, default possible dimensions dim_reduction_to_use use another dimension reduction set input dim_reduction_name name dimension reduction set use dimensions_to_use number dimensions use input seed seed fix random number generator (creating initialization HMRF) (-1 fixing) name name HMRF run k number HMRF domains betas betas test . three numbers: start_beta, beta_increment, num_betas e.g. c(0, 2.0, 50) tolerance tolerance zscore zscore numinit number initializations python_path python path use output_folder output folder save results overwrite_output overwrite output folder","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doHMRF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doHMRF — doHMRF","text":"Creates directory results can viewed viewHMRFresults","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doHMRF.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doHMRF — doHMRF","text":"Description HMRF parameters ...","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doHMRF_V2.html","id":null,"dir":"Reference","previous_headings":"","what":"doHMRF_V2 — doHMRF_V2","title":"doHMRF_V2 — doHMRF_V2","text":"function run HMRF model","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doHMRF_V2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doHMRF_V2 — doHMRF_V2","text":"","code":"doHMRF_V2(HMRF_init_obj, betas = NULL)"},{"path":"https://drieslab.github.io/Giotto/reference/doHMRF_V2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doHMRF_V2 — doHMRF_V2","text":"HMRF_init_obj initialization object list returned initHMRF() function betas beta value HMRF model, controlling smoothness clustering. NULL value beta provide default values based feature numbers, otherwise, vector three values: initial beta, beta increment, number betas","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doHMRF_V2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doHMRF_V2 — doHMRF_V2","text":"function run HMRF model initialization HMRF. note beta parameter, smoothing parameter. users interested selecting results different smoothness, recommend running range betas, hence betas specify range . example, betas=c(0,10,5) run following betas: 0, 10, 20, 30, 40. betas=c(0,5,2) run betas: 0, 5, 10. Setting beta can use following guideline: number features N 10<N<50, set betas=c(0, 1, 20) 50<N<100, set betas=c(0, 2, 25) 100<N<500, set betas=c(0, 5, 20) Returns list results betas, spat_unit feat_type. Result beta list probability(normalized non-normalized), class, model log-likelihood value.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doHclust.html","id":null,"dir":"Reference","previous_headings":"","what":"doHclust — doHclust","title":"doHclust — doHclust","text":"cluster cells using hierarchical clustering algorithm","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doHclust.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doHclust — doHclust","text":"","code":"doHclust(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   feats_to_use = NULL,   dim_reduction_to_use = c(\"cells\", \"pca\", \"umap\", \"tsne\"),   dim_reduction_name = \"pca\",   dimensions_to_use = 1:10,   distance_method = c(\"pearson\", \"spearman\", \"original\", \"euclidean\", \"maximum\",     \"manhattan\", \"canberra\", \"binary\", \"minkowski\"),   agglomeration_method = c(\"ward.D2\", \"ward.D\", \"single\", \"complete\", \"average\",     \"mcquitty\", \"median\", \"centroid\"),   k = 10,   h = NULL,   name = \"hclust\",   return_gobject = TRUE,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/doHclust.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doHclust — doHclust","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use feats_to_use subset features use dim_reduction_to_use dimension reduction use dim_reduction_name dimensions reduction name dimensions_to_use dimensions use distance_method distance method agglomeration_method agglomeration method hclust k number final clusters h cut hierarchical tree height = h name name hierarchical clustering return_gobject boolean: return giotto object (default = TRUE) set_seed set seed seed_number number seed","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doHclust.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doHclust — doHclust","text":"giotto object new clusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doHclust.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doHclust — doHclust","text":"Description use Kmeans clustering method.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/doKmeans.html","id":null,"dir":"Reference","previous_headings":"","what":"doKmeans — doKmeans","title":"doKmeans — doKmeans","text":"cluster cells using kmeans algorithm","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doKmeans.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doKmeans — doKmeans","text":"","code":"doKmeans(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   feats_to_use = NULL,   dim_reduction_to_use = c(\"cells\", \"pca\", \"umap\", \"tsne\"),   dim_reduction_name = \"pca\",   dimensions_to_use = 1:10,   distance_method = c(\"original\", \"pearson\", \"spearman\", \"euclidean\", \"maximum\",     \"manhattan\", \"canberra\", \"binary\", \"minkowski\"),   centers = 10,   iter_max = 100,   nstart = 1000,   algorithm = \"Hartigan-Wong\",   name = \"kmeans\",   return_gobject = TRUE,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/doKmeans.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doKmeans — doKmeans","text":"gobject giotto object feat_type feature type (e.g. \"cell\") spat_unit spatial unit (e.g. \"rna\", \"dna\", \"protein\") expression_values expression values use (e.g. \"normalized\", \"scaled\", \"custom\") feats_to_use subset features use dim_reduction_to_use dimension reduction use (e.g. \"cells\", \"pca\", \"umap\", \"tsne\") dim_reduction_name dimensions reduction name, default \"pca\" dimensions_to_use dimensions use, default = 1:10 distance_method distance method (e.g. \"original\", \"pearson\", \"spearman\", \"euclidean\", \"maximum\", \"manhattan\", \"canberra\", \"binary\", \"minkowski\") centers number final clusters, default = 10 iter_max kmeans maximum iterations, default = 100 nstart kmeans nstart, default = 1000 algorithm kmeans algorithm, default \"Hartigan-Wong\" name name kmeans clustering, default \"kmeans\" return_gobject boolean: return giotto object (default = TRUE) set_seed set seed (default = TRUE) seed_number number seed","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doKmeans.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doKmeans — doKmeans","text":"giotto object new clusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doKmeans.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doKmeans — doKmeans","text":"Description use Kmeans clustering method.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenCluster.html","id":null,"dir":"Reference","previous_headings":"","what":"doLeidenCluster — doLeidenCluster","title":"doLeidenCluster — doLeidenCluster","text":"cluster cells using NN-network Leiden community detection algorithm","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenCluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doLeidenCluster — doLeidenCluster","text":"","code":"doLeidenCluster(   gobject,   spat_unit = NULL,   feat_type = NULL,   name = \"leiden_clus\",   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   python_path = NULL,   resolution = 1,   weight_col = \"weight\",   partition_type = c(\"RBConfigurationVertexPartition\", \"ModularityVertexPartition\"),   init_membership = NULL,   n_iterations = 1000,   return_gobject = TRUE,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenCluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doLeidenCluster — doLeidenCluster","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") name name cluster, default \"leiden_clus\" nn_network_to_use type NN network use (kNN vs sNN), default \"sNN\" network_name name NN network use, default \"sNN.pca\" python_path specify specific path python required resolution resolution, default = 1 weight_col weight column use edges, default \"weight\" partition_type type partition use optimisation. (e.g. \"RBConfigurationVertexPartition\", \"ModularityVertexPartition\") init_membership initial membership cells partition n_iterations number interations run Leiden algorithm. number iterations negative, Leiden algorithm run iteration improvement. return_gobject boolean: return giotto object (default = TRUE) set_seed set seed seed_number number seed","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenCluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doLeidenCluster — doLeidenCluster","text":"giotto object new clusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenCluster.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doLeidenCluster — doLeidenCluster","text":"function wrapper Leiden algorithm implemented python, can detect communities graphs millions nodes (cells), long can fit memory. See https://github.com/vtraag/leidenalgleidenalg github page https://leidenalg.readthedocs.io/en/stable/index.htmlreadthedocs page information. Partition types available information: RBConfigurationVertexPartition: Implements Reichardt Bornholdt’s Potts model    configuration null model. quality function well-defined positive edge weights.     quality function uses linear resolution parameter. ModularityVertexPartition: Implements modularity.    quality function well-defined positive edge weights. use resolution parameter Set weight_col = NULL give equal weight (=1) edge.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenClusterIgraph.html","id":null,"dir":"Reference","previous_headings":"","what":"doLeidenClusterIgraph — doLeidenClusterIgraph","title":"doLeidenClusterIgraph — doLeidenClusterIgraph","text":"cluster cells using NN-network Leiden community detection algorithm implemented igraph","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenClusterIgraph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doLeidenClusterIgraph — doLeidenClusterIgraph","text":"","code":"doLeidenClusterIgraph(   gobject,   spat_unit = NULL,   feat_type = NULL,   name = \"leiden_clus\",   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   objective_function = c(\"modularity\", \"CPM\"),   weights = NULL,   resolution_parameter = 1,   beta = 0.01,   initial_membership = NULL,   n_iterations = 1000,   return_gobject = TRUE,   set_seed = TRUE,   seed_number = 1234,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenClusterIgraph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doLeidenClusterIgraph — doLeidenClusterIgraph","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") name name cluster, default \"leiden_clus\" nn_network_to_use type NN network use (kNN vs sNN), default \"sNN\" network_name name NN network use, default \"sNN.pca\" objective_function objective function leiden algo weights weights edges resolution_parameter resolution, default = 1 beta leiden randomness initial_membership initial membership cells partition n_iterations number interations run Leiden algorithm. return_gobject boolean: return giotto object (default = TRUE) set_seed set seed seed_number number seed ... Arguments passed igraph::cluster_leiden vertex_weights vertex weights used Leiden algorithm. provided, automatically determined basis objective_function. Please see details function interpret vertex weights.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenClusterIgraph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doLeidenClusterIgraph — doLeidenClusterIgraph","text":"giotto object new clusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenClusterIgraph.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doLeidenClusterIgraph — doLeidenClusterIgraph","text":"function wrapper Leiden algorithm implemented igraph, can detect communities graphs millions nodes (cells), long can fit memory. See cluster_leiden information. Set weights = NULL use vertices weights associated igraph network. Set weights = NA want use vertices weights","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenSubCluster.html","id":null,"dir":"Reference","previous_headings":"","what":"doLeidenSubCluster — doLeidenSubCluster","title":"doLeidenSubCluster — doLeidenSubCluster","text":"subcluster cells using NN-network Leiden algorithm","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenSubCluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doLeidenSubCluster — doLeidenSubCluster","text":"","code":"doLeidenSubCluster(   gobject,   feat_type = NULL,   name = \"sub_pleiden_clus\",   cluster_column = NULL,   selected_clusters = NULL,   hvf_param = list(reverse_log_scale = TRUE, difference_in_cov = 1, expression_values =     \"normalized\"),   hvg_param = NULL,   hvf_min_perc_cells = 5,   hvg_min_perc_cells = NULL,   hvf_mean_expr_det = 1,   hvg_mean_expr_det = NULL,   use_all_feats_as_hvf = FALSE,   use_all_genes_as_hvg = NULL,   min_nr_of_hvf = 5,   min_nr_of_hvg = NULL,   pca_param = list(expression_values = \"normalized\", scale_unit = TRUE),   nn_param = list(dimensions_to_use = 1:20),   k_neighbors = 10,   resolution = 0.5,   n_iterations = 500,   python_path = NULL,   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   return_gobject = TRUE,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenSubCluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doLeidenSubCluster — doLeidenSubCluster","text":"gobject giotto object feat_type feature type name name new clustering result cluster_column cluster column subcluster selected_clusters subclustering clusters hvf_param parameters calculateHVf hvg_param deprecatd, use hvf_param hvf_min_perc_cells threshold detection min percentage cells hvg_min_perc_cells deprecated, use hvf_min_perc_cells hvf_mean_expr_det threshold mean expression level cells detection hvg_mean_expr_det deprecated, use hvf_mean_expr_det use_all_feats_as_hvf forces features HVF used input PCA use_all_genes_as_hvg deprecated, use use_all_feats_as_hvf min_nr_of_hvf minimum number HVF, features used input PCA min_nr_of_hvg deprecated, use min_nr_of_hvf pca_param parameters runPCA nn_param parameters parameters createNearestNetwork k_neighbors number k createNearestNetwork resolution resolution Leiden clustering n_iterations number interations run Leiden algorithm. python_path specify specific path python required nn_network_to_use type NN network use (kNN vs sNN) network_name name NN network use return_gobject boolean: return giotto object (default = TRUE) verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenSubCluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doLeidenSubCluster — doLeidenSubCluster","text":"giotto object new subclusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLeidenSubCluster.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doLeidenSubCluster — doLeidenSubCluster","text":"function performs subclustering using Leiden algorithm selected clusters. systematic steps : 1. subset Giotto object 2. identify highly variable fetures 3. run PCA 4. create nearest neighbouring network 5. Leiden clustering","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster.html","id":null,"dir":"Reference","previous_headings":"","what":"doLouvainCluster — doLouvainCluster","title":"doLouvainCluster — doLouvainCluster","text":"cluster cells using NN-network Louvain algorithm.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doLouvainCluster — doLouvainCluster","text":"","code":"doLouvainCluster(   gobject,   spat_unit = NULL,   feat_type = NULL,   version = c(\"community\", \"multinet\"),   name = \"louvain_clus\",   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   python_path = NULL,   resolution = 1,   weight_col = NULL,   gamma = 1,   omega = 1,   louv_random = FALSE,   return_gobject = TRUE,   set_seed = FALSE,   seed_number = 1234,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doLouvainCluster — doLouvainCluster","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") version implemented version Louvain clustering use name name cluster, default \"louvain_clus\" nn_network_to_use type NN network use (kNN vs sNN), default \"sNN\" network_name name NN network use, default \"sNN.pca\" python_path [community] specify specific path python required resolution [community] resolution, default = 1 weight_col weight column name gamma [multinet] Resolution parameter modularity generalized louvain method, default = 1 omega [multinet] Inter-layer weight parameter generalized louvain method, default = 1 louv_random [community] randomize node evaluation order community evaluation order get different partitions call (default = FALSE) return_gobject boolean: return giotto object (default = TRUE) set_seed set seed (default = FALSE) seed_number number seed ... arguments passed doLouvainCluster_community doLouvainCluster_multinet","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doLouvainCluster — doLouvainCluster","text":"giotto object new clusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doLouvainCluster — doLouvainCluster","text":"Louvain clustering using community multinet implementation louvain clustering algorithm.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster_community.html","id":null,"dir":"Reference","previous_headings":"","what":"doLouvainCluster_community — doLouvainCluster_community","title":"doLouvainCluster_community — doLouvainCluster_community","text":"cluster cells using NN-network Louvain algorithm community module Python","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster_community.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doLouvainCluster_community — doLouvainCluster_community","text":"","code":"doLouvainCluster_community(   gobject,   spat_unit = NULL,   feat_type = NULL,   name = \"louvain_clus\",   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   python_path = NULL,   resolution = 1,   weight_col = NULL,   louv_random = FALSE,   return_gobject = TRUE,   set_seed = FALSE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster_community.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doLouvainCluster_community — doLouvainCluster_community","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") name name cluster, default \"louvain_clus\" nn_network_to_use type NN network use (kNN vs sNN), default \"sNN\" network_name name NN network use, default \"sNN.pca\" python_path specify specific path python required resolution resolution, default = 1 weight_col weight column use edges louv_random randomize node evaluation order community evaluation order get different partitions call (default = FALSE) return_gobject boolean: return giotto object (default = TRUE) set_seed set seed (default = FALSE) seed_number number seed","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster_community.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doLouvainCluster_community — doLouvainCluster_community","text":"giotto object new clusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster_community.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doLouvainCluster_community — doLouvainCluster_community","text":"function wrapper Louvain algorithm implemented Python, can detect communities graphs nodes (cells). See https://python-louvain.readthedocs.io/en/latest/index.htmlreadthedocs page information. Set weight_col = NULL give equal weight (=1) edge.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster_multinet.html","id":null,"dir":"Reference","previous_headings":"","what":"doLouvainCluster_multinet — doLouvainCluster_multinet","title":"doLouvainCluster_multinet — doLouvainCluster_multinet","text":"cluster cells using NN-network Louvain algorithm multinet package R.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster_multinet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doLouvainCluster_multinet — doLouvainCluster_multinet","text":"","code":"doLouvainCluster_multinet(   gobject,   spat_unit = NULL,   feat_type = NULL,   name = \"louvain_clus\",   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   gamma = 1,   omega = 1,   return_gobject = TRUE,   set_seed = FALSE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster_multinet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doLouvainCluster_multinet — doLouvainCluster_multinet","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") name name cluster, default \"louvain_clus\" nn_network_to_use type NN network use (kNN vs sNN), default \"sNN\" network_name name NN network use, default \"sNN.pca\" gamma Resolution parameter modularity generalized louvain method. default  = 1 omega Inter-layer weight parameter generalized louvain method. default = 1 return_gobject boolean: return giotto object (default = TRUE) set_seed set seed (default = FALSE) seed_number number seed","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster_multinet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doLouvainCluster_multinet — doLouvainCluster_multinet","text":"giotto object new clusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainCluster_multinet.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doLouvainCluster_multinet — doLouvainCluster_multinet","text":"See glouvain_ml multinet package R information.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster.html","id":null,"dir":"Reference","previous_headings":"","what":"doLouvainSubCluster — doLouvainSubCluster","title":"doLouvainSubCluster — doLouvainSubCluster","text":"subcluster cells using NN-network Louvain algorithm","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doLouvainSubCluster — doLouvainSubCluster","text":"","code":"doLouvainSubCluster(   gobject,   name = \"sub_louvain_clus\",   version = c(\"community\", \"multinet\"),   cluster_column = NULL,   selected_clusters = NULL,   hvg_param = list(reverse_log_scale = TRUE, difference_in_cov = 1, expression_values =     \"normalized\"),   hvg_min_perc_cells = 5,   hvg_mean_expr_det = 1,   use_all_genes_as_hvg = FALSE,   min_nr_of_hvg = 5,   pca_param = list(expression_values = \"normalized\", scale_unit = TRUE),   nn_param = list(dimensions_to_use = 1:20),   k_neighbors = 10,   resolution = 0.5,   gamma = 1,   omega = 1,   python_path = NULL,   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   return_gobject = TRUE,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doLouvainSubCluster — doLouvainSubCluster","text":"gobject giotto object name name new clustering result version version Louvain algorithm use cluster_column cluster column subcluster selected_clusters subclustering clusters hvg_param parameters calculateHVG hvg_min_perc_cells threshold detection min percentage cells hvg_mean_expr_det threshold mean expression level cells detection use_all_genes_as_hvg forces genes HVG used input PCA min_nr_of_hvg minimum number HVG, genes used input PCA pca_param parameters runPCA nn_param parameters parameters createNearestNetwork k_neighbors number k createNearestNetwork resolution resolution community algorithm gamma gamma omega omega python_path specify specific path python required nn_network_to_use type NN network use (kNN vs sNN) network_name name NN network use return_gobject boolean: return giotto object (default = TRUE) verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doLouvainSubCluster — doLouvainSubCluster","text":"giotto object new subclusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doLouvainSubCluster — doLouvainSubCluster","text":"function performs subclustering using Louvain algorithm selected clusters. systematic steps : 1. subset Giotto object 2. identify highly variable genes 3. run PCA 4. create nearest neighbouring network 5. Louvain clustering","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster_community.html","id":null,"dir":"Reference","previous_headings":"","what":"doLouvainSubCluster_community — doLouvainSubCluster_community","title":"doLouvainSubCluster_community — doLouvainSubCluster_community","text":"subcluster cells using NN-network Louvain community detection algorithm","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster_community.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doLouvainSubCluster_community — doLouvainSubCluster_community","text":"","code":"doLouvainSubCluster_community(   gobject,   name = \"sub_louvain_comm_clus\",   cluster_column = NULL,   selected_clusters = NULL,   hvg_param = list(reverse_log_scale = TRUE, difference_in_cov = 1, expression_values =     \"normalized\"),   hvg_min_perc_cells = 5,   hvg_mean_expr_det = 1,   use_all_genes_as_hvg = FALSE,   min_nr_of_hvg = 5,   pca_param = list(expression_values = \"normalized\", scale_unit = T),   nn_param = list(dimensions_to_use = 1:20),   k_neighbors = 10,   resolution = 0.5,   python_path = NULL,   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   return_gobject = TRUE,   verbose = T )"},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster_community.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doLouvainSubCluster_community — doLouvainSubCluster_community","text":"gobject giotto object name name new clustering result cluster_column cluster column subcluster selected_clusters subclustering clusters hvg_param parameters calculateHVG hvg_min_perc_cells threshold detection min percentage cells hvg_mean_expr_det threshold mean expression level cells detection use_all_genes_as_hvg forces genes HVG used input PCA min_nr_of_hvg minimum number HVG, genes used input PCA pca_param parameters runPCA nn_param parameters parameters createNearestNetwork k_neighbors number k createNearestNetwork resolution resolution python_path specify specific path python required nn_network_to_use type NN network use (kNN vs sNN) network_name name NN network use return_gobject boolean: return giotto object (default = TRUE) verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster_community.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doLouvainSubCluster_community — doLouvainSubCluster_community","text":"giotto object new subclusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster_community.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doLouvainSubCluster_community — doLouvainSubCluster_community","text":"function performs subclustering using Louvain community algorithm selected clusters. systematic steps : 1. subset Giotto object 2. identify highly variable genes 3. run PCA 4. create nearest neighbouring network 5. Louvain community clustering","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster_multinet.html","id":null,"dir":"Reference","previous_headings":"","what":"doLouvainSubCluster_multinet — doLouvainSubCluster_multinet","title":"doLouvainSubCluster_multinet — doLouvainSubCluster_multinet","text":"subcluster cells using NN-network Louvain multinet detection algorithm","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster_multinet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doLouvainSubCluster_multinet — doLouvainSubCluster_multinet","text":"","code":"doLouvainSubCluster_multinet(   gobject,   name = \"sub_louvain_mult_clus\",   cluster_column = NULL,   selected_clusters = NULL,   hvg_param = list(reverse_log_scale = TRUE, difference_in_cov = 1, expression_values =     \"normalized\"),   hvg_min_perc_cells = 5,   hvg_mean_expr_det = 1,   use_all_genes_as_hvg = FALSE,   min_nr_of_hvg = 5,   pca_param = list(expression_values = \"normalized\", scale_unit = TRUE),   nn_param = list(dimensions_to_use = 1:20),   k_neighbors = 10,   gamma = 1,   omega = 1,   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   return_gobject = TRUE,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster_multinet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doLouvainSubCluster_multinet — doLouvainSubCluster_multinet","text":"gobject giotto object name name new clustering result cluster_column cluster column subcluster selected_clusters subclustering clusters hvg_param parameters calculateHVG hvg_min_perc_cells threshold detection min percentage cells hvg_mean_expr_det threshold mean expression level cells detection use_all_genes_as_hvg forces genes HVG used input PCA min_nr_of_hvg minimum number HVG, genes used input PCA pca_param parameters runPCA nn_param parameters parameters createNearestNetwork k_neighbors number k createNearestNetwork gamma gamma omega omega nn_network_to_use type NN network use (kNN vs sNN) network_name name NN network use return_gobject boolean: return giotto object (default = TRUE) verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster_multinet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doLouvainSubCluster_multinet — doLouvainSubCluster_multinet","text":"giotto object new subclusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doLouvainSubCluster_multinet.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doLouvainSubCluster_multinet — doLouvainSubCluster_multinet","text":"function performs subclustering using Louvain multinet algorithm selected clusters. systematic steps : 1. subset Giotto object 2. identify highly variable genes 3. run PCA 4. create nearest neighbouring network 5. Louvain multinet clustering","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/doRandomWalkCluster.html","id":null,"dir":"Reference","previous_headings":"","what":"doRandomWalkCluster — doRandomWalkCluster","title":"doRandomWalkCluster — doRandomWalkCluster","text":"Cluster cells using random walk approach.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doRandomWalkCluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doRandomWalkCluster — doRandomWalkCluster","text":"","code":"doRandomWalkCluster(   gobject,   name = \"random_walk_clus\",   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   walk_steps = 4,   walk_clusters = 10,   walk_weights = NA,   return_gobject = TRUE,   set_seed = FALSE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/doRandomWalkCluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doRandomWalkCluster — doRandomWalkCluster","text":"gobject giotto object name name cluster, default \"random_walk_clus\" nn_network_to_use type NN network use (kNN vs sNN), default \"sNN\" network_name name NN network use, default \"sNN.pca\" walk_steps number walking steps, default = 4 walk_clusters number final clusters, default =  10 walk_weights cluster column defining walk weights return_gobject boolean: return giotto object (default = TRUE) set_seed set seed (default = FALSE) seed_number number seed","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doRandomWalkCluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doRandomWalkCluster — doRandomWalkCluster","text":"giotto object new clusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doRandomWalkCluster.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doRandomWalkCluster — doRandomWalkCluster","text":"See cluster_walktrap function igraph package R information.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doSNNCluster.html","id":null,"dir":"Reference","previous_headings":"","what":"doSNNCluster — doSNNCluster","title":"doSNNCluster — doSNNCluster","text":"Cluster cells using SNN cluster approach.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doSNNCluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doSNNCluster — doSNNCluster","text":"","code":"doSNNCluster(   gobject,   name = \"sNN_clus\",   nn_network_to_use = \"kNN\",   network_name = \"kNN.pca\",   k = 20,   eps = 4,   minPts = 16,   borderPoints = TRUE,   return_gobject = TRUE,   set_seed = FALSE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/doSNNCluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doSNNCluster — doSNNCluster","text":"gobject giotto object name name cluster, default \"sNN_clus\" nn_network_to_use type NN network use (works kNN), default \"kNN\" network_name name kNN network use, default \"kNN.pca\" k Neighborhood size nearest neighbor sparsification create shared NN graph, default = 20 eps Two objects reachable share least eps nearest neighbors, default = 4 minPts minimum number points share least eps nearest neighbors point considered core points, default = 16 borderPoints borderPoints assigned clusters like DBSCAN? (default = TRUE) return_gobject boolean: return giotto object (default = TRUE) set_seed set seed (default = FALSE) seed_number number seed","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doSNNCluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doSNNCluster — doSNNCluster","text":"giotto object new clusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doSNNCluster.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"doSNNCluster — doSNNCluster","text":"See sNNclust dbscan package","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doScrubletDetect.html","id":null,"dir":"Reference","previous_headings":"","what":"doScrubletDetect — doScrubletDetect","title":"doScrubletDetect — doScrubletDetect","text":"run scrublet doublet detection raw expression.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doScrubletDetect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"doScrubletDetect — doScrubletDetect","text":"","code":"doScrubletDetect(   gobject,   feat_type = NULL,   spat_unit = \"cell\",   expression_values = \"raw\",   expected_doublet_rate = 0.06,   min_counts = 1,   min_cells = 1,   min_gene_variability_pctl = 85,   n_prin_comps = 30,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/doScrubletDetect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"doScrubletDetect — doScrubletDetect","text":"gobject giotto object containing expression data feat_type feature type spat_unit spatial unit expression_values expression values use expected_doublet_rate expected transcriptomes doublets. 0.06 10x Chromium guide. min_counts scrublet internal data filtering, min counts found considered cell min_cells scrublet internal data filtering. min cells expressed considered feat min_gene_variability_pctl scrublet internal PCA generation. highly variable gene percentile cutoff n_prin_comps number PCs use PCA detection return_gobject return gobject TRUE, data.frame cell_ID FALSE","code":""},{"path":"https://drieslab.github.io/Giotto/reference/doScrubletDetect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"doScrubletDetect — doScrubletDetect","text":"list including doublet scores classifications","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/do_cell_proximity_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Do cell proximity test — do_cell_proximity_test","title":"Do cell proximity test — do_cell_proximity_test","text":"Performs selected differential test subsets matrix","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_cell_proximity_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Do cell proximity test — do_cell_proximity_test","text":"","code":"do_cell_proximity_test(   expr_values,   select_ind,   other_ind,   diff_test = c(\"permutation\", \"limma\", \"t.test\", \"wilcox\"),   mean_method = c(\"arithmic\", \"geometric\"),   offset = 0.1,   n_perm = 100,   adjust_method = c(\"bonferroni\", \"BH\", \"holm\", \"hochberg\", \"hommel\", \"BY\", \"fdr\",     \"none\"),   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/do_cell_proximity_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Do cell proximity test — do_cell_proximity_test","text":"expr_values Matrix object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_cell_proximity_test_spot.html","id":null,"dir":"Reference","previous_headings":"","what":"do_cell_proximity_test_spot — do_cell_proximity_test_spot","title":"do_cell_proximity_test_spot — do_cell_proximity_test_spot","text":"Performs selected differential test subsets matrix spots","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_cell_proximity_test_spot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_cell_proximity_test_spot — do_cell_proximity_test_spot","text":"","code":"do_cell_proximity_test_spot(   sel_int,   other_ints,   select_ind,   other_ind,   proximityMat,   expr_residual,   diff_test,   n_perm = 100,   adjust_method = \"fdr\",   cores = 2,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/do_limmatest.html","id":null,"dir":"Reference","previous_headings":"","what":"do_limmatest — do_limmatest","title":"do_limmatest — do_limmatest","text":"Performs limma t.test subsets matrix","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_limmatest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_limmatest — do_limmatest","text":"","code":"do_limmatest(expr_values, select_ind, other_ind, mean_method, offset = 0.1)"},{"path":"https://drieslab.github.io/Giotto/reference/do_multi_permuttest_random.html","id":null,"dir":"Reference","previous_headings":"","what":"do_multi_permuttest_random — do_multi_permuttest_random","title":"do_multi_permuttest_random — do_multi_permuttest_random","text":"calculate multiple random values","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_multi_permuttest_random.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_multi_permuttest_random — do_multi_permuttest_random","text":"","code":"do_multi_permuttest_random(   expr_values,   select_ind,   other_ind,   mean_method,   offset = 0.1,   n = 100,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/do_multi_permuttest_random_spot.html","id":null,"dir":"Reference","previous_headings":"","what":"do_multi_permuttest_random_spot — do_multi_permuttest_random_spot","title":"do_multi_permuttest_random_spot — do_multi_permuttest_random_spot","text":"calculate multiple random values spots","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_multi_permuttest_random_spot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_multi_permuttest_random_spot — do_multi_permuttest_random_spot","text":"","code":"do_multi_permuttest_random_spot(   sel_int,   other_ints,   select_ind,   other_ind,   proximityMat,   expr_residual,   n = 100,   cores = NA,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/do_page_permutation.html","id":null,"dir":"Reference","previous_headings":"","what":"do_page_permutation — do_page_permutation","title":"do_page_permutation — do_page_permutation","text":"creates permutation PAGEEnrich test","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_page_permutation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_page_permutation — do_page_permutation","text":"","code":"do_page_permutation(gobject, sig_gene, ntimes)"},{"path":"https://drieslab.github.io/Giotto/reference/do_permuttest_original.html","id":null,"dir":"Reference","previous_headings":"","what":"do_permuttest_original — do_permuttest_original","title":"do_permuttest_original — do_permuttest_original","text":"calculate original values","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_permuttest_original.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_permuttest_original — do_permuttest_original","text":"","code":"do_permuttest_original(   expr_values,   select_ind,   other_ind,   name = \"orig\",   mean_method,   offset = 0.1 )"},{"path":"https://drieslab.github.io/Giotto/reference/do_permuttest_original_spot.html","id":null,"dir":"Reference","previous_headings":"","what":"do_permuttest_original_spot — do_permuttest_original_spot","title":"do_permuttest_original_spot — do_permuttest_original_spot","text":"calculate original values spots","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_permuttest_original_spot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_permuttest_original_spot — do_permuttest_original_spot","text":"","code":"do_permuttest_original_spot(   sel_int,   other_ints,   select_ind,   other_ind,   name = \"orig\",   proximityMat,   expr_residual )"},{"path":"https://drieslab.github.io/Giotto/reference/do_permuttest_random.html","id":null,"dir":"Reference","previous_headings":"","what":"do_permuttest_random — do_permuttest_random","title":"do_permuttest_random — do_permuttest_random","text":"calculate random values Performs permutation test subsets matrix","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_permuttest_random.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_permuttest_random — do_permuttest_random","text":"","code":"do_permuttest_random(   expr_values,   select_ind,   other_ind,   name = \"perm_1\",   mean_method,   offset = 0.1,   set_seed = TRUE,   seed_number = 1234 )  do_permuttest(   expr_values,   select_ind,   other_ind,   n_perm = 1000,   adjust_method = \"fdr\",   mean_method,   offset = 0.1,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/do_permuttest_random_spot.html","id":null,"dir":"Reference","previous_headings":"","what":"do_permuttest_random_spot — do_permuttest_random_spot","title":"do_permuttest_random_spot — do_permuttest_random_spot","text":"calculate random values spots","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_permuttest_random_spot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_permuttest_random_spot — do_permuttest_random_spot","text":"","code":"do_permuttest_random_spot(   sel_int,   other_ints,   select_ind,   other_ind,   name = \"perm_1\",   proximityMat,   expr_residual,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/do_permuttest_spot.html","id":null,"dir":"Reference","previous_headings":"","what":"do_permuttest_spot — do_permuttest_spot","title":"do_permuttest_spot — do_permuttest_spot","text":"Performs permutation test subsets matrix spots","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_permuttest_spot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_permuttest_spot — do_permuttest_spot","text":"","code":"do_permuttest_spot(   sel_int,   other_ints,   select_ind,   other_ind,   proximityMat,   expr_residual,   n_perm = 100,   adjust_method = \"fdr\",   cores = 2,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/do_rank_permutation.html","id":null,"dir":"Reference","previous_headings":"","what":"do_rank_permutation — do_rank_permutation","title":"do_rank_permutation — do_rank_permutation","text":"creates permutation rankEnrich test","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_rank_permutation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_rank_permutation — do_rank_permutation","text":"","code":"do_rank_permutation(sc_gene, n)"},{"path":"https://drieslab.github.io/Giotto/reference/do_spatial_grid_averaging.html","id":null,"dir":"Reference","previous_headings":"","what":"do_spatial_grid_averaging — do_spatial_grid_averaging","title":"do_spatial_grid_averaging — do_spatial_grid_averaging","text":"smooth gene expression defined spatial grid","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_spatial_grid_averaging.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_spatial_grid_averaging — do_spatial_grid_averaging","text":"","code":"do_spatial_grid_averaging(   expression_matrix,   spatial_grid,   spatial_locs,   subset_feats = NULL,   min_cells_per_grid = 4 )"},{"path":"https://drieslab.github.io/Giotto/reference/do_spatial_grid_averaging.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"do_spatial_grid_averaging — do_spatial_grid_averaging","text":"matrix smoothened gene expression values based spatial grid","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_spatial_knn_smoothing.html","id":null,"dir":"Reference","previous_headings":"","what":"do_spatial_knn_smoothing — do_spatial_knn_smoothing","title":"do_spatial_knn_smoothing — do_spatial_knn_smoothing","text":"smooth gene expression kNN spatial network","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_spatial_knn_smoothing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_spatial_knn_smoothing — do_spatial_knn_smoothing","text":"","code":"do_spatial_knn_smoothing(   expression_matrix,   spatial_network,   subset_feats = NULL,   b = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/do_spatial_knn_smoothing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"do_spatial_knn_smoothing — do_spatial_knn_smoothing","text":"subset_feats subset features use b smoothing factor beteen 0 1 (default: automatic) gobject giotto object expression_values gene expression values use spatial_network_name name spatial network use","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_spatial_knn_smoothing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"do_spatial_knn_smoothing — do_spatial_knn_smoothing","text":"matrix smoothened gene expression values based kNN spatial network","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_spatial_knn_smoothing.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"do_spatial_knn_smoothing — do_spatial_knn_smoothing","text":"function smoothen gene expression values per cell according neighbors selected spatial network.  b smoothening factor defaults 1 - 1/k, k median number k-neighbors selected spatial network. Setting b = 0 means smoothing b = 1 means contribution expression.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_ttest.html","id":null,"dir":"Reference","previous_headings":"","what":"do_ttest — do_ttest","title":"do_ttest — do_ttest","text":"Performs t.test subsets matrix","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_ttest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_ttest — do_ttest","text":"","code":"do_ttest(   expr_values,   select_ind,   other_ind,   adjust_method,   mean_method,   offset = 0.1 )"},{"path":"https://drieslab.github.io/Giotto/reference/do_wilctest.html","id":null,"dir":"Reference","previous_headings":"","what":"do_wilctest — do_wilctest","title":"do_wilctest — do_wilctest","text":"Performs wilcoxon subsets matrix","code":""},{"path":"https://drieslab.github.io/Giotto/reference/do_wilctest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"do_wilctest — do_wilctest","text":"","code":"do_wilctest(   expr_values,   select_ind,   other_ind,   adjust_method,   mean_method,   offset = 0.1 )"},{"path":"https://drieslab.github.io/Giotto/reference/dot-h5_read_bare.html","id":null,"dir":"Reference","previous_headings":"","what":"Read dataset from opened HDF5 with C functions — .h5_read_bare","title":"Read dataset from opened HDF5 with C functions — .h5_read_bare","text":"Read dataset opened HDF5 C functions","code":""},{"path":"https://drieslab.github.io/Giotto/reference/dot-h5_read_bare.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read dataset from opened HDF5 with C functions — .h5_read_bare","text":"","code":".h5_read_bare(file, name = \"\", dapl)"},{"path":"https://drieslab.github.io/Giotto/reference/dot-h5_read_bare.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read dataset from opened HDF5 with C functions — .h5_read_bare","text":"file opened HDF5 file name dataset name within dapl HDF5 property list (H5Pcreate('H5P_DATASET_ACCESS'))","code":""},{"path":"https://drieslab.github.io/Giotto/reference/enrich_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"enrich_analysis — enrich_analysis","title":"enrich_analysis — enrich_analysis","text":"Rui fill ","code":""},{"path":"https://drieslab.github.io/Giotto/reference/enrich_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"enrich_analysis — enrich_analysis","text":"","code":"enrich_analysis(expr_values, sign_matrix)"},{"path":"https://drieslab.github.io/Giotto/reference/enrich_deconvolution.html","id":null,"dir":"Reference","previous_headings":"","what":"enrich_deconvolution — enrich_deconvolution","title":"enrich_deconvolution — enrich_deconvolution","text":"Rui fill ","code":""},{"path":"https://drieslab.github.io/Giotto/reference/enrich_deconvolution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"enrich_deconvolution — enrich_deconvolution","text":"","code":"enrich_deconvolution(expr, log_expr, cluster_info, ct_exp, cutoff)"},{"path":"https://drieslab.github.io/Giotto/reference/estimateCellCellDistance.html","id":null,"dir":"Reference","previous_headings":"","what":"estimateCellCellDistance — estimateCellCellDistance","title":"estimateCellCellDistance — estimateCellCellDistance","text":"estimate average distance neighboring cells","code":""},{"path":"https://drieslab.github.io/Giotto/reference/estimateCellCellDistance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"estimateCellCellDistance — estimateCellCellDistance","text":"","code":"estimateCellCellDistance(   gobject,   spatial_network_name = \"Delaunay_network\",   method = c(\"mean\", \"median\") )"},{"path":"https://drieslab.github.io/Giotto/reference/estimateCellCellDistance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"estimateCellCellDistance — estimateCellCellDistance","text":"gobject gobject spatial_network_name spatial_network_name method method","code":""},{"path":"https://drieslab.github.io/Giotto/reference/evaluate_provided_spatial_locations.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate provided spatial locations — evaluate_provided_spatial_locations","title":"Evaluate provided spatial locations — evaluate_provided_spatial_locations","text":"Evaluate provided spatial locations","code":""},{"path":"https://drieslab.github.io/Giotto/reference/evaluate_provided_spatial_locations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate provided spatial locations — evaluate_provided_spatial_locations","text":"","code":"evaluate_provided_spatial_locations(spatial_locs)"},{"path":"https://drieslab.github.io/Giotto/reference/exportGiottoViewer.html","id":null,"dir":"Reference","previous_headings":"","what":"exportGiottoViewer — exportGiottoViewer","title":"exportGiottoViewer — exportGiottoViewer","text":"compute highly variable genes","code":""},{"path":"https://drieslab.github.io/Giotto/reference/exportGiottoViewer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"exportGiottoViewer — exportGiottoViewer","text":"","code":"exportGiottoViewer(   gobject,   spat_unit = NULL,   feat_type = NULL,   spat_loc_name = \"raw\",   output_directory = NULL,   spat_enr_names = NULL,   factor_annotations = NULL,   numeric_annotations = NULL,   dim_reductions,   dim_reduction_names,   expression_values = c(\"scaled\", \"normalized\", \"custom\"),   dim_red_rounding = NULL,   dim_red_rescale = c(-20, 20),   expression_rounding = 2,   overwrite_dir = TRUE,   verbose = T )"},{"path":"https://drieslab.github.io/Giotto/reference/exportGiottoViewer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"exportGiottoViewer — exportGiottoViewer","text":"gobject giotto object spat_unit spatial unit feat_type feature types spat_loc_name name spatial locations export output_directory directory save files spat_enr_names spatial enrichment results include annotations factor_annotations giotto cell annotations view factor numeric_annotations giotto cell annotations view numeric dim_reductions high level dimension reductions view dim_reduction_names specific dimension reduction names expression_values expression values use Viewer dim_red_rounding numerical indicating round coordinates dim_red_rescale numericals rescale coordinates expression_rounding numerical indicating round expression data overwrite_dir overwrite files directory already existed verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/exportGiottoViewer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"exportGiottoViewer — exportGiottoViewer","text":"writes necessary output use Giotto Viewer","code":""},{"path":"https://drieslab.github.io/Giotto/reference/exportGiottoViewer.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"exportGiottoViewer — exportGiottoViewer","text":"Giotto Viewer expects results Giotto Analyzer specific format, provided function. include enrichment results createSpatialEnrich include provided spatial enrichment name (default PAGE rank) add gene signature names (.e.g cell types) numeric annotations parameter.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/exportGiottoViewer.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"exportGiottoViewer — exportGiottoViewer","text":"","code":"if (FALSE) {  data(mini_giotto_single_cell) exportGiottoViewer(mini_giotto_single_cell)  }"},{"path":"https://drieslab.github.io/Giotto/reference/exprCellCellcom.html","id":null,"dir":"Reference","previous_headings":"","what":"exprCellCellcom — exprCellCellcom","title":"exprCellCellcom — exprCellCellcom","text":"Cell-Cell communication scores based expression ","code":""},{"path":"https://drieslab.github.io/Giotto/reference/exprCellCellcom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"exprCellCellcom — exprCellCellcom","text":"","code":"exprCellCellcom(   gobject,   feat_type = NULL,   spat_unit = NULL,   cluster_column = \"cell_types\",   random_iter = 1000,   feat_set_1,   feat_set_2,   gene_set_1 = NULL,   gene_set_2 = NULL,   log2FC_addendum = 0.1,   detailed = FALSE,   adjust_method = c(\"fdr\", \"bonferroni\", \"BH\", \"holm\", \"hochberg\", \"hommel\", \"BY\",     \"none\"),   adjust_target = c(\"feats\", \"cells\"),   set_seed = TRUE,   seed_number = 1234,   verbose = T )"},{"path":"https://drieslab.github.io/Giotto/reference/exprCellCellcom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"exprCellCellcom — exprCellCellcom","text":"gobject giotto object use feat_type feature type spat_unit spatial unit cluster_column cluster column cell type information random_iter number iterations feat_set_1 first specific feature set feature pairs feat_set_2 second specific feature set feature pairs gene_set_1 deprecated. see feat_set_1 gene_set_2 deprecated. see feat_set_2 log2FC_addendum addendum add calculating log2FC detailed provide detailed information (random variance z-score) adjust_method method adjust p-values adjust_target adjust multiple hypotheses cell feature level set_seed set seed random simulations (default = TRUE) seed_number seed number verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/exprCellCellcom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"exprCellCellcom — exprCellCellcom","text":"Cell-Cell communication scores feature pairs based expression ","code":""},{"path":"https://drieslab.github.io/Giotto/reference/exprCellCellcom.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"exprCellCellcom — exprCellCellcom","text":"Statistical framework identify pairs features (ligand-receptor combinations) expressed higher levels expected based reshuffled null distribution feature expression values, without considering spatial position cells. details follow soon.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/extend_vector.html","id":null,"dir":"Reference","previous_headings":"","what":"extend_vector — extend_vector","title":"extend_vector — extend_vector","text":"extend range vector given ratio","code":""},{"path":"https://drieslab.github.io/Giotto/reference/extend_vector.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"extend_vector — extend_vector","text":"","code":"extend_vector(x, extend_ratio)"},{"path":"https://drieslab.github.io/Giotto/reference/extend_vector.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"extend_vector — extend_vector","text":"x x extend_ratio extend_ratio","code":""},{"path":"https://drieslab.github.io/Giotto/reference/extended_gini_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"extended_gini_fun — extended_gini_fun","title":"extended_gini_fun — extended_gini_fun","text":"calculate gini coefficient minimum length vector","code":""},{"path":"https://drieslab.github.io/Giotto/reference/extended_gini_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"extended_gini_fun — extended_gini_fun","text":"","code":"extended_gini_fun(x, weights = rep(1, length = length(x)), minimum_length = 16)"},{"path":"https://drieslab.github.io/Giotto/reference/extended_gini_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"extended_gini_fun — extended_gini_fun","text":"gini coefficient","code":""},{"path":"https://drieslab.github.io/Giotto/reference/featExpDWLS.html","id":null,"dir":"Reference","previous_headings":"","what":"featExpDWLS — featExpDWLS","title":"featExpDWLS — featExpDWLS","text":"Compute predicted feature expression value spatialDWSL results average feature expression cell type","code":""},{"path":"https://drieslab.github.io/Giotto/reference/featExpDWLS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"featExpDWLS — featExpDWLS","text":"","code":"featExpDWLS(gobject, spat_unit = NULL, feat_type = NULL, ave_celltype_exp)"},{"path":"https://drieslab.github.io/Giotto/reference/featExpDWLS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"featExpDWLS — featExpDWLS","text":"gobject giotto object spat_unit spatial unit (e.g. 'cell') feat_type feature type (e.g. 'rna') ave_celltype_exp data.table feature expression cell type","code":""},{"path":"https://drieslab.github.io/Giotto/reference/featExpDWLS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"featExpDWLS — featExpDWLS","text":"matrix","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterCPG.html","id":null,"dir":"Reference","previous_headings":"","what":"filterCPG — filterCPG","title":"filterCPG — filterCPG","text":"Filter Interaction Changed Gene scores.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterCPG.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filterCPG — filterCPG","text":"","code":"filterCPG(...)"},{"path":"https://drieslab.github.io/Giotto/reference/filterCPG.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filterCPG — filterCPG","text":"... Arguments passed filterICF icfObject ICF (interaction changed feature) score object min_cells minimum number source cell type min_cells_expr minimum expression level source cell type min_int_cells minimum number interacting neighbor cell type min_int_cells_expr minimum expression level interacting neighbor cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum log2 fold-change min_zscore minimum z-score change zscores_column calculate z-scores cell types features direction differential expression directions keep","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/filterCellProximityGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"filterCellProximityGenes — filterCellProximityGenes","title":"filterCellProximityGenes — filterCellProximityGenes","text":"Filter Interaction Changed Feature scores.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterCellProximityGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filterCellProximityGenes — filterCellProximityGenes","text":"","code":"filterCellProximityGenes(...)"},{"path":"https://drieslab.github.io/Giotto/reference/filterCellProximityGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filterCellProximityGenes — filterCellProximityGenes","text":"... Arguments passed filterInteractionChangedFeats icfObject ICF (interaction changed feature) score object min_cells minimum number source cell type min_cells_expr minimum expression level source cell type min_int_cells minimum number interacting neighbor cell type min_int_cells_expr minimum expression level interacting neighbor cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum log2 fold-change min_zscore minimum z-score change zscores_column calculate z-scores cell types genes direction differential expression directions keep","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/filterCombinations.html","id":null,"dir":"Reference","previous_headings":"","what":"filterCombinations — filterCombinations","title":"filterCombinations — filterCombinations","text":"Shows many genes cells lost combinations thresholds.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterCombinations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filterCombinations — filterCombinations","text":"","code":"filterCombinations(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"raw\", \"normalized\", \"scaled\", \"custom\"),   expression_thresholds = c(1, 2),   feat_det_in_min_cells = c(5, 50),   min_det_feats_per_cell = c(200, 400),   scale_x_axis = \"identity\",   x_axis_offset = 0,   scale_y_axis = \"identity\",   y_axis_offset = 0,   show_plot = TRUE,   return_plot = FALSE,   save_plot = NA,   save_param = list(),   default_save_name = \"filterCombinations\" )"},{"path":"https://drieslab.github.io/Giotto/reference/filterCombinations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filterCombinations — filterCombinations","text":"gobject giotto object feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") spat_unit spatial unit (e.g. \"cell\") expression_values expression values use expression_thresholds thresholds consider gene expressed feat_det_in_min_cells minimum # cells need express feature min_det_feats_per_cell minimum # features need detected cell scale_x_axis ggplot transformation x-axis (e.g. log2) x_axis_offset x-axis offset used together scaling transformation scale_y_axis ggplot transformation y-axis (e.g. log2) y_axis_offset y-axis offset used together scaling transformation show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterCombinations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"filterCombinations — filterCombinations","text":"list data.table ggplot object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterCombinations.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"filterCombinations — filterCombinations","text":"Creates scatterplot visualizes number genes cells lost specific combination gene cell threshold given arbitrary cutoff call gene expressed. function can used make informed decision filtering step filterGiotto.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterDistributions.html","id":null,"dir":"Reference","previous_headings":"","what":"filterDistributions — filterDistributions","title":"filterDistributions — filterDistributions","text":"show gene cell distribution filtering expression threshold","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterDistributions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filterDistributions — filterDistributions","text":"","code":"filterDistributions(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"raw\", \"normalized\", \"scaled\", \"custom\"),   method = c(\"threshold\", \"sum\", \"mean\"),   expression_threshold = 1,   detection = c(\"feats\", \"cells\"),   plot_type = c(\"histogram\", \"violin\"),   scale_y = NULL,   nr_bins = 30,   fill_color = \"lightblue\",   scale_axis = \"identity\",   axis_offset = 0,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"filterDistributions\" )"},{"path":"https://drieslab.github.io/Giotto/reference/filterDistributions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filterDistributions — filterDistributions","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values expression values use method method create distribution (see details) expression_threshold threshold consider gene expressed detection consider features (e.g. genes) cells plot_type type plot scale_y scale y-axis (e.g. \"log\"), NULL = scaling nr_bins number bins histogram plot fill_color fill color plots scale_axis ggplot transformation axis (e.g. log2) axis_offset offset used together scaling transformation show_plot show plot return_plot return ggplot object save_plot directly save plot [boolean] save_param list saving parameters GiottoVisuals::all_plots_save_function default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterDistributions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"filterDistributions — filterDistributions","text":"ggplot object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterDistributions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"filterDistributions — filterDistributions","text":"3 ways create distribution profile summarize either features cells (spatial units) 1. threshold: calculate features cross thresold (default) 2. sum: summarize features, .e. total feature 3. mean: calculate mean features, .e. average expression","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterGiotto.html","id":null,"dir":"Reference","previous_headings":"","what":"filterGiotto — filterGiotto","title":"filterGiotto — filterGiotto","text":"filter Giotto object based expression threshold","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterGiotto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filterGiotto — filterGiotto","text":"","code":"filterGiotto(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"raw\", \"normalized\", \"scaled\", \"custom\"),   expression_threshold = 1,   feat_det_in_min_cells = 100,   min_det_feats_per_cell = 100,   spat_unit_fsub = \":all:\",   feat_type_ssub = \":all:\",   all_spat_units = NULL,   all_feat_types = NULL,   poly_info = NULL,   tag_cells = FALSE,   tag_cell_name = \"tag\",   tag_feats = FALSE,   tag_feats_name = \"tag\",   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/filterGiotto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filterGiotto — filterGiotto","text":"gobject giotto object spat_unit character. spatial unit. one provided first filtered, filtering results applied across spat_units provided feat_type character. feature type. one provided first filtered, filtering results applied across feat_types provided. expression_values expression values use expression_threshold threshold consider gene expressed feat_det_in_min_cells minimum # cells need express feature min_det_feats_per_cell minimum # features need detected cell spat_unit_fsub character vector. (default = '::') limit features remove results selected spat_units feat_type_ssub character vector. (default = '::') limit cells remove results selected feat_types all_spat_units deprecated. Use spat_unit_fsub = \"::\" all_feat_types deprecated. Use feat_type_ssub = \"::\" poly_info polygon information use tag_cells tag filtered cells metadata vs. remove cells tag_cell_name column name tagged cells metadata tag_feats tag features metadata vs. remove features tag_feats_name column name tagged features metadata verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterGiotto.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"filterGiotto — filterGiotto","text":"giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterGiotto.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"filterGiotto — filterGiotto","text":"function filterCombinations can used explore effect different parameter values. Please note function filters data predefined order, features, cells. filtering order, certain features may left metadata corresponding number cells less threshold value cells, feat_det_in_min_cells. behavior explained detail : https://github.com/drieslab/Giotto/issues/500#issuecomment-1396083446","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterICF.html","id":null,"dir":"Reference","previous_headings":"","what":"filterICF — filterICF","title":"filterICF — filterICF","text":"Filter Interaction Changed Feature scores.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterICF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filterICF — filterICF","text":"","code":"filterICF(   icfObject,   min_cells = 4,   min_cells_expr = 1,   min_int_cells = 4,   min_int_cells_expr = 1,   min_fdr = 0.1,   min_spat_diff = 0.2,   min_log2_fc = 0.2,   min_zscore = 2,   zscores_column = c(\"cell_type\", \"feats\"),   direction = c(\"both\", \"up\", \"down\") )"},{"path":"https://drieslab.github.io/Giotto/reference/filterICF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filterICF — filterICF","text":"icfObject ICF (interaction changed feature) score object min_cells minimum number source cell type min_cells_expr minimum expression level source cell type min_int_cells minimum number interacting neighbor cell type min_int_cells_expr minimum expression level interacting neighbor cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum log2 fold-change min_zscore minimum z-score change zscores_column calculate z-scores cell types features direction differential expression directions keep","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterICF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"filterICF — filterICF","text":"icfObject contains filtered differential feature scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterICFSpot.html","id":null,"dir":"Reference","previous_headings":"","what":"filterICFSpot — filterICFSpot","title":"filterICFSpot — filterICFSpot","text":"Filter Interaction Changed Feature scores spots.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterICFSpot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filterICFSpot — filterICFSpot","text":"","code":"filterICFSpot(   icfObject,   min_cells = 4,   min_cells_expr_resi = 0.05,   min_int_cells = 4,   min_int_cells_expr_resi = 0.05,   min_fdr = 0.5,   min_pcc_diff = 0.05,   min_zscore = 0.05,   zscores_column = c(\"cell_type\", \"features\"),   direction = c(\"both\", \"up\", \"down\") )"},{"path":"https://drieslab.github.io/Giotto/reference/filterICFSpot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filterICFSpot — filterICFSpot","text":"icfObject ICF (interaction changed feature) score object min_cells minimum number source cell type min_cells_expr_resi minimum expression residual level source cell type min_int_cells minimum number interacting neighbor cell type min_int_cells_expr_resi minimum expression residual level interacting neighbor cell type min_fdr minimum adjusted p-value min_pcc_diff minimum absolute pcc difference difference min_zscore minimum z-score change zscores_column calculate z-scores cell types features direction differential expression directions keep","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterICFSpot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"filterICFSpot — filterICFSpot","text":"icfObject contains filtered differential feature scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterICG.html","id":null,"dir":"Reference","previous_headings":"","what":"filterICG — filterICG","title":"filterICG — filterICG","text":"Filter Interaction Changed Gene scores.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterICG.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filterICG — filterICG","text":"","code":"filterICG(...)"},{"path":"https://drieslab.github.io/Giotto/reference/filterICG.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filterICG — filterICG","text":"... Arguments passed filterICF icfObject ICF (interaction changed feature) score object min_cells minimum number source cell type min_cells_expr minimum expression level source cell type min_int_cells minimum number interacting neighbor cell type min_int_cells_expr minimum expression level interacting neighbor cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum log2 fold-change min_zscore minimum z-score change zscores_column calculate z-scores cell types features direction differential expression directions keep","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/filterInteractionChangedFeats.html","id":null,"dir":"Reference","previous_headings":"","what":"filterInteractionChangedFeats — filterInteractionChangedFeats","title":"filterInteractionChangedFeats — filterInteractionChangedFeats","text":"Filter Interaction Changed Feature scores.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterInteractionChangedFeats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filterInteractionChangedFeats — filterInteractionChangedFeats","text":"","code":"filterInteractionChangedFeats(   icfObject,   min_cells = 4,   min_cells_expr = 1,   min_int_cells = 4,   min_int_cells_expr = 1,   min_fdr = 0.1,   min_spat_diff = 0.2,   min_log2_fc = 0.2,   min_zscore = 2,   zscores_column = c(\"cell_type\", \"feats\"),   direction = c(\"both\", \"up\", \"down\") )"},{"path":"https://drieslab.github.io/Giotto/reference/filterInteractionChangedFeats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filterInteractionChangedFeats — filterInteractionChangedFeats","text":"icfObject ICF (interaction changed feature) score object min_cells minimum number source cell type min_cells_expr minimum expression level source cell type min_int_cells minimum number interacting neighbor cell type min_int_cells_expr minimum expression level interacting neighbor cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum log2 fold-change min_zscore minimum z-score change zscores_column calculate z-scores cell types genes direction differential expression directions keep","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterInteractionChangedFeats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"filterInteractionChangedFeats — filterInteractionChangedFeats","text":"icfObject contains filtered differential feature scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterInteractionChangedGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"filterInteractionChangedGenes — filterInteractionChangedGenes","title":"filterInteractionChangedGenes — filterInteractionChangedGenes","text":"Filter Interaction Changed Feature scores.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterInteractionChangedGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filterInteractionChangedGenes — filterInteractionChangedGenes","text":"","code":"filterInteractionChangedGenes(...)"},{"path":"https://drieslab.github.io/Giotto/reference/filterInteractionChangedGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filterInteractionChangedGenes — filterInteractionChangedGenes","text":"... Arguments passed filterInteractionChangedFeats icfObject ICF (interaction changed feature) score object min_cells minimum number source cell type min_cells_expr minimum expression level source cell type min_int_cells minimum number interacting neighbor cell type min_int_cells_expr minimum expression level interacting neighbor cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum log2 fold-change min_zscore minimum z-score change zscores_column calculate z-scores cell types genes direction differential expression directions keep","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/filterSpatialGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"filterSpatialGenes — filterSpatialGenes","title":"filterSpatialGenes — filterSpatialGenes","text":"function filter gene list existing spatial gene sets","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterSpatialGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filterSpatialGenes — filterSpatialGenes","text":"","code":"filterSpatialGenes(   gobject,   spat_unit = NULL,   feat_type = NULL,   spatial_genes,   max = 2500,   name = c(\"binSpect\", \"silhouetteRank\", \"silhouetteRankTest\"),   method = c(\"none\", \"elbow\") )"},{"path":"https://drieslab.github.io/Giotto/reference/filterSpatialGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filterSpatialGenes — filterSpatialGenes","text":"gobject Giotto object spat_unit spatial unit feat_type feature type spatial_genes input gene list max max number genes selected spatial test name name spatial gene test filtering method method spatial gene selection","code":""},{"path":"https://drieslab.github.io/Giotto/reference/filterSpatialGenes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"filterSpatialGenes — filterSpatialGenes","text":"function filters given gene list gene sets selected spatial gene test Giotto, also controls total size gene set given max number.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findCPG.html","id":null,"dir":"Reference","previous_headings":"","what":"findCPG — findCPG","title":"findCPG — findCPG","text":"Identifies cell--cell Interaction Changed Features (ICF), .e. genes differentially expressed due proximity cell types.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findCPG.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findCPG — findCPG","text":"","code":"findCPG(...)"},{"path":"https://drieslab.github.io/Giotto/reference/findCPG.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findCPG — findCPG","text":"... Arguments passed findICF gobject giotto object feat_type feature type spat_unit spatial unit expression_values expression values use selected_feats subset selected features (optional) cluster_column name column use cell types spatial_network_name name spatial network use minimum_unique_cells minimum number target cells required minimum_unique_int_cells minimum number interacting cells required diff_test differential expression test mean_method method use calculate mean offset offset value use calculating log2 ratio adjust_method method adjust p-values nr_permutations number permutations diff_test = permutation exclude_selected_cells_from_test exclude interacting cells cells do_parallel run calculations parallel mclapply set_seed set seed reproducibility seed_number seed number","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/findCellProximityFeats_per_interaction.html","id":null,"dir":"Reference","previous_headings":"","what":"findCellProximityFeats_per_interaction — findCellProximityFeats_per_interaction","title":"findCellProximityFeats_per_interaction — findCellProximityFeats_per_interaction","text":"Identifies features differentially expressed due proximity cell types.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findCellProximityFeats_per_interaction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findCellProximityFeats_per_interaction — findCellProximityFeats_per_interaction","text":"","code":"findCellProximityFeats_per_interaction(   sel_int,   expr_values,   cell_metadata,   annot_spatnetwork,   cluster_column = NULL,   minimum_unique_cells = 1,   minimum_unique_int_cells = 1,   exclude_selected_cells_from_test = T,   diff_test = c(\"permutation\", \"limma\", \"t.test\", \"wilcox\"),   mean_method = c(\"arithmic\", \"geometric\"),   offset = 0.1,   adjust_method = \"bonferroni\",   nr_permutations = 100,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/findCellProximityFeats_per_interaction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findCellProximityFeats_per_interaction — findCellProximityFeats_per_interaction","text":"expr_values Matrix object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findCellProximityGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"findCellProximityGenes — findCellProximityGenes","title":"findCellProximityGenes — findCellProximityGenes","text":"Identifies cell--cell Interaction Changed Features (ICF), .e. genes differentially expressed due proximity cell types.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findCellProximityGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findCellProximityGenes — findCellProximityGenes","text":"","code":"findCellProximityGenes(...)"},{"path":"https://drieslab.github.io/Giotto/reference/findCellProximityGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findCellProximityGenes — findCellProximityGenes","text":"... Arguments passed findInteractionChangedFeats gobject giotto object feat_type feature type spat_unit spatial unit expression_values expression values use selected_feats subset selected features (optional) cluster_column name column use cell types spatial_network_name name spatial network use minimum_unique_cells minimum number target cells required minimum_unique_int_cells minimum number interacting cells required diff_test differential expression test mean_method method use calculate mean offset offset value use calculating log2 ratio adjust_method method adjust p-values nr_permutations number permutations diff_test = permutation exclude_selected_cells_from_test exclude interacting cells cells do_parallel run calculations parallel mclapply set_seed set seed reproducibility seed_number seed number","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/findCellTypesFromEnrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"findCellTypesFromEnrichment — findCellTypesFromEnrichment","title":"findCellTypesFromEnrichment — findCellTypesFromEnrichment","text":"findCellTypesFromEnrichment","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findCellTypesFromEnrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findCellTypesFromEnrichment — findCellTypesFromEnrichment","text":"","code":"findCellTypesFromEnrichment(   gobject = NULL,   spat_unit = NULL,   feat_type = NULL,   enrichment_name = \"PAGE_z_score\",   return_frequency_table = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/findCellTypesFromEnrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findCellTypesFromEnrichment — findCellTypesFromEnrichment","text":"gobject Giotto Object spat_unit spatial unit enrichment information stored feat_type feature type enrichment information calculated enrichment_name name spatial enrichment .e. output GiottoClass::list_spatial_enrichment_names() Default value \"PAGE_Z_score\" return_frequency_table see details. Default FALSE","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findCellTypesFromEnrichment.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"findCellTypesFromEnrichment — findCellTypesFromEnrichment","text":"function returns two-column matrix, one column contain cell IDs contain likely cell type based provided enrichment. setting return_frequency_table TRUE, table instead returned. table detail number occurences cell type, based provided enrichment. cell types assigned determining maximum value z-score -log10(p-value) cell associated cell types enrichment.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findGiniMarkers.html","id":null,"dir":"Reference","previous_headings":"","what":"findGiniMarkers — findGiniMarkers","title":"findGiniMarkers — findGiniMarkers","text":"Identify marker feats selected clusters based gini detection expression scores.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findGiniMarkers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findGiniMarkers — findGiniMarkers","text":"","code":"findGiniMarkers(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   cluster_column,   subset_clusters = NULL,   group_1 = NULL,   group_1_name = NULL,   group_2 = NULL,   group_2_name = NULL,   min_expr_gini_score = 0.2,   min_det_gini_score = 0.2,   detection_threshold = 0,   rank_score = 1,   min_feats = 5,   min_genes = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/findGiniMarkers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findGiniMarkers — findGiniMarkers","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values feat expression values use cluster_column clusters use subset_clusters selection clusters compare group_1 group 1 cluster IDs cluster_column pairwise comparison group_1_name custom name group_1 clusters group_2 group 2 cluster IDs cluster_column pairwise comparison group_2_name custom name group_2 clusters min_expr_gini_score filter minimum gini coefficient expression min_det_gini_score filter minimum gini coefficient detection detection_threshold detection threshold feat expression rank_score rank scores detection expression include min_feats minimum number top feats return min_genes deprecated, use min_feats","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findGiniMarkers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"findGiniMarkers — findGiniMarkers","text":"data.table marker feats","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findGiniMarkers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"findGiniMarkers — findGiniMarkers","text":"Detection marker feats using https://en.wikipedia.org/wiki/Gini_coefficientgini coefficient based following steps/principles per feat: 1. calculate average expression per cluster 2. calculate detection fraction per cluster 3. calculate gini-coefficient av. expression values clusters 4. calculate gini-coefficient detection fractions clusters 5. convert gini-scores rank scores 6. feat create combined score = detection rank x expression rank x expr gini-coefficient x detection gini-coefficient 7. feat sort expression detection rank combined score results \"top gini\" feats feats selectivily expressed specific cluster, however always expressed cells cluster. words highly specific, necessarily sensitive single-cell level. perform differential expression custom selected groups cells need specify cell_ID column parameter cluster_column provide individual cell IDs parameters group_1 group_2 default group names created pasting different id names within selected group. many different ids single group recommend provide names groups group_1_name group_2_name","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findGiniMarkers_one_vs_all.html","id":null,"dir":"Reference","previous_headings":"","what":"findGiniMarkers_one_vs_all — findGiniMarkers_one_vs_all","title":"findGiniMarkers_one_vs_all — findGiniMarkers_one_vs_all","text":"Identify marker feats clusters one vs manner based gini detection expression scores.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findGiniMarkers_one_vs_all.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findGiniMarkers_one_vs_all — findGiniMarkers_one_vs_all","text":"","code":"findGiniMarkers_one_vs_all(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   cluster_column,   subset_clusters = NULL,   min_expr_gini_score = 0.5,   min_det_gini_score = 0.5,   detection_threshold = 0,   rank_score = 1,   min_feats = 4,   min_genes = NULL,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/findGiniMarkers_one_vs_all.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findGiniMarkers_one_vs_all — findGiniMarkers_one_vs_all","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values feat expression values use cluster_column clusters use subset_clusters selection clusters compare min_expr_gini_score filter minimum gini coefficient expression min_det_gini_score filter minimum gini coefficient detection detection_threshold detection threshold feat expression rank_score rank scores detection expression include min_feats minimum number top feats return min_genes deprecated, use min_feats verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findGiniMarkers_one_vs_all.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"findGiniMarkers_one_vs_all — findGiniMarkers_one_vs_all","text":"data.table marker feats","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/findICF.html","id":null,"dir":"Reference","previous_headings":"","what":"findICF — findICF","title":"findICF — findICF","text":"Identifies cell--cell Interaction Changed Features (ICF), .e. features differentially expressed due proximity cell types.#'","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findICF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findICF — findICF","text":"","code":"findICF(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = \"normalized\",   selected_feats = NULL,   cluster_column,   spatial_network_name = \"Delaunay_network\",   minimum_unique_cells = 1,   minimum_unique_int_cells = 1,   diff_test = c(\"permutation\", \"limma\", \"t.test\", \"wilcox\"),   mean_method = c(\"arithmic\", \"geometric\"),   offset = 0.1,   adjust_method = c(\"bonferroni\", \"BH\", \"holm\", \"hochberg\", \"hommel\", \"BY\", \"fdr\",     \"none\"),   nr_permutations = 100,   exclude_selected_cells_from_test = T,   do_parallel = TRUE,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/findICF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findICF — findICF","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values expression values use selected_feats subset selected features (optional) cluster_column name column use cell types spatial_network_name name spatial network use minimum_unique_cells minimum number target cells required minimum_unique_int_cells minimum number interacting cells required diff_test differential expression test mean_method method use calculate mean offset offset value use calculating log2 ratio adjust_method method adjust p-values nr_permutations number permutations diff_test = permutation exclude_selected_cells_from_test exclude interacting cells cells do_parallel run calculations parallel mclapply set_seed set seed reproducibility seed_number seed number","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findICF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"findICF — findICF","text":"icfObject contains Interaction Changed differential gene scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findICF.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"findICF — findICF","text":"Function calculate genes differentially expressed cell types  interact (approximated physical proximity) cell types.  results data.table icfObject contains - least - following columns: features: selected list tested features sel: average feature expression interacting cells target cell type : average feature expression -interacting cells target cell type log2fc: log2 fold-change sel diff: spatial expression difference sel p.value: associated p-value p.adj: adjusted p-value cell_type: target cell type int_cell_type: interacting cell type nr_select: number cells selected target cell type int_nr_select: number cells interacting cell type nr_other: number cells selected target cell type int_nr_other: number cells interacting cell type unif_int: cell-cell interaction","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/findICFSpot.html","id":null,"dir":"Reference","previous_headings":"","what":"findICFSpot — findICFSpot","title":"findICFSpot — findICFSpot","text":"Identifies cell--cell Interaction Changed Features (ICF) spots, .e. features expression residual different due proximity cell types.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findICFSpot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findICFSpot — findICFSpot","text":"","code":"findICFSpot(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   ave_celltype_exp,   selected_features = NULL,   spatial_network_name = \"Delaunay_network\",   minimum_unique_cells = 5,   minimum_unique_int_cells = 5,   CCI_cell_score = 0.1,   dwls_cutoff = 0.001,   diff_test = \"permutation\",   nr_permutations = 100,   adjust_method = \"fdr\",   do_parallel = TRUE,   cores = NA,   set_seed = TRUE,   seed_number = 1234,   verbose = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/findICFSpot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findICFSpot — findICFSpot","text":"gobject giotto object spat_unit spatial unit (e.g. 'cell') feat_type feature type (e.g. 'rna') expression_values expression values use ave_celltype_exp average feature expression cell type selected_features subset selected features (optional) spatial_network_name name spatial network use minimum_unique_cells minimum number target cells required minimum_unique_int_cells minimum number interacting cells required CCI_cell_score cell proximity score filter interacted cell dwls_cutoff cell type proportion cutoff label cell diff_test differential expression test nr_permutations number permutations diff_test = permutation adjust_method method adjust p-values do_parallel run calculations parallel mclapply cores number cores use do_parallel = TRUE set_seed set seed reproducibility seed_number seed number verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findICFSpot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"findICFSpot — findICFSpot","text":"icfObject contains differential feat scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findICFSpot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"findICFSpot — findICFSpot","text":"Function calculate features expression residual differentially expressed cell types  interact (approximated physical proximity) cell types.  Feature expression residual calculated :  (observed expression spot - cell_type_proportion * average_expressed_in_cell_type)  results data.table icfObject contains - least - following columns: features: selected list tested features sel: average feature expression residual interacting cells target cell type : average feature expression residual -interacting cells target cell type pcc_sel: correlation cell proximity score expression residual interacting cells target cell type pcc_other: correlation cell proximity score expression residual -interacting cells target cell type pcc_diff: correlation difference sel p.value: associated p-value p.adj: adjusted p-value cell_type: target cell type int_cell_type: interacting cell type nr_select: number cells selected target cell type int_nr_select: number cells interacting cell type unif_int: cell-cell interaction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findICF_per_interaction_spot.html","id":null,"dir":"Reference","previous_headings":"","what":"findICF_per_interaction_spot — findICF_per_interaction_spot","title":"findICF_per_interaction_spot — findICF_per_interaction_spot","text":"Identifies features differentially expressed due proximity cell types spots.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findICF_per_interaction_spot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findICF_per_interaction_spot — findICF_per_interaction_spot","text":"","code":"findICF_per_interaction_spot(   sel_int,   all_ints,   proximityMat,   expr_residual,   dwls_values,   dwls_cutoff = 0.001,   CCI_cell_score = 0.01,   minimum_unique_cells = 1,   minimum_unique_int_cells = 1,   diff_test = \"permutation\",   n_perm = 100,   adjust_method = \"fdr\",   cores = 2,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/findICG.html","id":null,"dir":"Reference","previous_headings":"","what":"findICG — findICG","title":"findICG — findICG","text":"Identifies cell--cell Interaction Changed Features (ICF), .e. genes differentially expressed due interaction cell types.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findICG.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findICG — findICG","text":"","code":"findICG(...)"},{"path":"https://drieslab.github.io/Giotto/reference/findICG.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findICG — findICG","text":"... Arguments passed findICF gobject giotto object feat_type feature type spat_unit spatial unit expression_values expression values use selected_feats subset selected features (optional) cluster_column name column use cell types spatial_network_name name spatial network use minimum_unique_cells minimum number target cells required minimum_unique_int_cells minimum number interacting cells required diff_test differential expression test mean_method method use calculate mean offset offset value use calculating log2 ratio adjust_method method adjust p-values nr_permutations number permutations diff_test = permutation exclude_selected_cells_from_test exclude interacting cells cells do_parallel run calculations parallel mclapply set_seed set seed reproducibility seed_number seed number","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/findInteractionChangedFeats.html","id":null,"dir":"Reference","previous_headings":"","what":"findInteractionChangedFeats — findInteractionChangedFeats","title":"findInteractionChangedFeats — findInteractionChangedFeats","text":"Identifies cell--cell Interaction Changed Features (ICF), .e. features differentially expressed due proximity cell types.#'","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findInteractionChangedFeats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findInteractionChangedFeats — findInteractionChangedFeats","text":"","code":"findInteractionChangedFeats(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = \"normalized\",   selected_feats = NULL,   cluster_column,   spatial_network_name = \"Delaunay_network\",   minimum_unique_cells = 1,   minimum_unique_int_cells = 1,   diff_test = c(\"permutation\", \"limma\", \"t.test\", \"wilcox\"),   mean_method = c(\"arithmic\", \"geometric\"),   offset = 0.1,   adjust_method = c(\"bonferroni\", \"BH\", \"holm\", \"hochberg\", \"hommel\", \"BY\", \"fdr\",     \"none\"),   nr_permutations = 1000,   exclude_selected_cells_from_test = T,   do_parallel = TRUE,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/findInteractionChangedFeats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findInteractionChangedFeats — findInteractionChangedFeats","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values expression values use selected_feats subset selected features (optional) cluster_column name column use cell types spatial_network_name name spatial network use minimum_unique_cells minimum number target cells required minimum_unique_int_cells minimum number interacting cells required diff_test differential expression test mean_method method use calculate mean offset offset value use calculating log2 ratio adjust_method method adjust p-values nr_permutations number permutations diff_test = permutation exclude_selected_cells_from_test exclude interacting cells cells do_parallel run calculations parallel mclapply set_seed set seed reproducibility seed_number seed number","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findInteractionChangedFeats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"findInteractionChangedFeats — findInteractionChangedFeats","text":"icfObject contains Interaction Changed differential feature scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findInteractionChangedFeats.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"findInteractionChangedFeats — findInteractionChangedFeats","text":"Function calculate features differentially expressed cell types  interact (approximated physical proximity) cell types.  results data.table icfObject contains - least - following columns: features: selected list tested features sel: average feature expression interacting cells target cell type : average feature expression -interacting cells target cell type log2fc: log2 fold-change sel diff: spatial expression difference sel p.value: associated p-value p.adj: adjusted p-value cell_type: target cell type int_cell_type: interacting cell type nr_select: number cells selected target cell type int_nr_select: number cells interacting cell type nr_other: number cells selected target cell type int_nr_other: number cells interacting cell type unif_int: cell-cell interaction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findInteractionChangedGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"findInteractionChangedGenes — findInteractionChangedGenes","title":"findInteractionChangedGenes — findInteractionChangedGenes","text":"Identifies cell--cell Interaction Changed Features (ICF), .e. genes differentially expressed due interactions cell types.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findInteractionChangedGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findInteractionChangedGenes — findInteractionChangedGenes","text":"","code":"findInteractionChangedGenes(...)"},{"path":"https://drieslab.github.io/Giotto/reference/findInteractionChangedGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findInteractionChangedGenes — findInteractionChangedGenes","text":"... params pass findInteractionChangedFeats","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/findMarkers.html","id":null,"dir":"Reference","previous_headings":"","what":"findMarkers — findMarkers","title":"findMarkers — findMarkers","text":"Identify marker feats selected clusters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMarkers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findMarkers — findMarkers","text":"","code":"findMarkers(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   cluster_column = NULL,   method = c(\"scran\", \"gini\", \"mast\"),   subset_clusters = NULL,   group_1 = NULL,   group_2 = NULL,   min_expr_gini_score = 0.5,   min_det_gini_score = 0.5,   detection_threshold = 0,   rank_score = 1,   min_feats = 4,   min_genes = NULL,   group_1_name = NULL,   group_2_name = NULL,   adjust_columns = NULL,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/findMarkers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findMarkers — findMarkers","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values feat expression values use cluster_column clusters use method method use detect differentially expressed feats subset_clusters selection clusters compare group_1 group 1 cluster IDs cluster_column pairwise comparison group_2 group 2 cluster IDs cluster_column pairwise comparison min_expr_gini_score gini: filter minimum gini coefficient expression min_det_gini_score gini: filter minimum gini coefficient detection detection_threshold gini: detection threshold feat expression rank_score gini: rank scores include min_feats minimum number top feats return (gini) min_genes deprecated, use min_feats group_1_name mast: custom name group_1 clusters group_2_name mast: custom name group_2 clusters adjust_columns mast: column pDataDT adjust (e.g. detection rate) ... additional parameters findMarkers function scran zlm function MAST","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMarkers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"findMarkers — findMarkers","text":"data.table marker feats","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMarkers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"findMarkers — findMarkers","text":"Wrapper individual functions detect marker feats clusters.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/findMarkers_one_vs_all.html","id":null,"dir":"Reference","previous_headings":"","what":"findMarkers_one_vs_all — findMarkers_one_vs_all","title":"findMarkers_one_vs_all — findMarkers_one_vs_all","text":"Identify marker feats clusters one vs manner.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMarkers_one_vs_all.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findMarkers_one_vs_all — findMarkers_one_vs_all","text":"","code":"findMarkers_one_vs_all(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   cluster_column,   subset_clusters = NULL,   method = c(\"scran\", \"gini\", \"mast\"),   pval = 0.01,   logFC = 0.5,   min_feats = 10,   min_genes = NULL,   min_expr_gini_score = 0.5,   min_det_gini_score = 0.5,   detection_threshold = 0,   rank_score = 1,   adjust_columns = NULL,   verbose = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/findMarkers_one_vs_all.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findMarkers_one_vs_all — findMarkers_one_vs_all","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values feat expression values use cluster_column clusters use subset_clusters selection clusters compare method method use detect differentially expressed feats pval scran & mast: filter minimal p-value logFC scan & mast: filter logFC min_feats minimum feats keep per cluster, overrides pval logFC min_genes deprecated, use min_feats min_expr_gini_score gini: filter minimum gini coefficient expression min_det_gini_score gini: filter minimum gini coefficient detection detection_threshold gini: detection threshold feat expression rank_score gini: rank scores include adjust_columns mast: column pDataDT adjust (e.g. detection rate) verbose verbose ... additional parameters findMarkers function scran zlm function MAST","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMarkers_one_vs_all.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"findMarkers_one_vs_all — findMarkers_one_vs_all","text":"data.table marker feats","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMarkers_one_vs_all.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"findMarkers_one_vs_all — findMarkers_one_vs_all","text":"Wrapper one vs functions detect marker feats clusters.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/findMastMarkers.html","id":null,"dir":"Reference","previous_headings":"","what":"findMastMarkers — findMastMarkers","title":"findMastMarkers — findMastMarkers","text":"Identify marker feats selected clusters based MAST package.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMastMarkers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findMastMarkers — findMastMarkers","text":"","code":"findMastMarkers(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   cluster_column,   group_1 = NULL,   group_1_name = NULL,   group_2 = NULL,   group_2_name = NULL,   adjust_columns = NULL,   verbose = FALSE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/findMastMarkers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findMastMarkers — findMastMarkers","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values feat expression values use cluster_column clusters use group_1 group 1 cluster IDs cluster_column pairwise comparison group_1_name custom name group_1 clusters group_2 group 2 cluster IDs cluster_column pairwise comparison group_2_name custom name group_2 clusters adjust_columns column pDataDT adjust (e.g. detection rate) verbose verbose ... additional parameters zlm function MAST","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMastMarkers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"findMastMarkers — findMastMarkers","text":"data.table marker feats","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMastMarkers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"findMastMarkers — findMastMarkers","text":"minimal convenience wrapper around zlm MAST package detect differentially expressed feats. Caution: large datasets MAST might take long time run finish","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMastMarkers_one_vs_all.html","id":null,"dir":"Reference","previous_headings":"","what":"findMastMarkers_one_vs_all — findMastMarkers_one_vs_all","title":"findMastMarkers_one_vs_all — findMastMarkers_one_vs_all","text":"Identify marker feats clusters one vs manner based MAST package.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMastMarkers_one_vs_all.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findMastMarkers_one_vs_all — findMastMarkers_one_vs_all","text":"","code":"findMastMarkers_one_vs_all(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   cluster_column,   subset_clusters = NULL,   adjust_columns = NULL,   pval = 0.001,   logFC = 1,   min_feats = 10,   min_genes = NULL,   verbose = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/findMastMarkers_one_vs_all.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findMastMarkers_one_vs_all — findMastMarkers_one_vs_all","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values feat expression values use cluster_column clusters use subset_clusters selection clusters compare adjust_columns column pDataDT adjust (e.g. detection rate) pval filter minimal p-value logFC filter logFC min_feats minimum feats keep per cluster, overrides pval logFC min_genes deprecated, use min_feats verbose verbose ... additional parameters zlm function MAST","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findMastMarkers_one_vs_all.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"findMastMarkers_one_vs_all — findMastMarkers_one_vs_all","text":"data.table marker feats","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/findNetworkNeighbors.html","id":null,"dir":"Reference","previous_headings":"","what":"Find network neighbors — findNetworkNeighbors","title":"Find network neighbors — findNetworkNeighbors","text":"Find spatial neighbors selected group cells within selected spatial network.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findNetworkNeighbors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find network neighbors — findNetworkNeighbors","text":"","code":"findNetworkNeighbors(   gobject,   spat_unit = NULL,   spatial_network_name,   source_cell_ids = NULL,   name = \"nb_cells\" )"},{"path":"https://drieslab.github.io/Giotto/reference/findNetworkNeighbors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find network neighbors — findNetworkNeighbors","text":"gobject Giotto object spat_unit spatial unit spatial_network_name name spatial network source_cell_ids cell ids want know spatial neighbors name name results","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findNetworkNeighbors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find network neighbors — findNetworkNeighbors","text":"data.table","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findScranMarkers.html","id":null,"dir":"Reference","previous_headings":"","what":"findScranMarkers — findScranMarkers","title":"findScranMarkers — findScranMarkers","text":"Identify marker genes selected clusters based scran's implementation findMarkers.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findScranMarkers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findScranMarkers — findScranMarkers","text":"","code":"findScranMarkers(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   cluster_column,   subset_clusters = NULL,   group_1 = NULL,   group_1_name = NULL,   group_2 = NULL,   group_2_name = NULL,   verbose = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/findScranMarkers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findScranMarkers — findScranMarkers","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values gene expression values use cluster_column clusters use subset_clusters selection clusters compare group_1 group 1 cluster IDs cluster_column pairwise comparison group_1_name custom name group_1 clusters group_2 group 2 cluster IDs cluster_column pairwise comparison group_2_name custom name group_2 clusters verbose verbose (default = FALSE) ... additional parameters findMarkers function scran","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findScranMarkers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"findScranMarkers — findScranMarkers","text":"data.table marker genes","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findScranMarkers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"findScranMarkers — findScranMarkers","text":"minimal convenience wrapper around findMarkers function scran package. perform differential expression custom selected groups cells need specify cell_ID column parameter cluster_column provide individual cell IDs parameters group_1 group_2 default group names created pasting different id names within selected group. many different ids single group recommend provide names groups group_1_name group_2_name","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findScranMarkers_one_vs_all.html","id":null,"dir":"Reference","previous_headings":"","what":"findScranMarkers_one_vs_all — findScranMarkers_one_vs_all","title":"findScranMarkers_one_vs_all — findScranMarkers_one_vs_all","text":"Identify marker feats clusters one vs manner based scran's implementation findMarkers.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findScranMarkers_one_vs_all.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"findScranMarkers_one_vs_all — findScranMarkers_one_vs_all","text":"","code":"findScranMarkers_one_vs_all(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   cluster_column,   subset_clusters = NULL,   pval = 0.01,   logFC = 0.5,   min_feats = 10,   min_genes = NULL,   verbose = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/findScranMarkers_one_vs_all.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"findScranMarkers_one_vs_all — findScranMarkers_one_vs_all","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values feat expression values use cluster_column clusters use subset_clusters subset clusters use pval filter minimal p-value logFC filter logFC min_feats minimum feats keep per cluster, overrides pval logFC min_genes deprecated, use min_feats verbose verbose ... additional parameters findMarkers function scran","code":""},{"path":"https://drieslab.github.io/Giotto/reference/findScranMarkers_one_vs_all.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"findScranMarkers_one_vs_all — findScranMarkers_one_vs_all","text":"data.table marker feats","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/find_dampening_constant.html","id":null,"dir":"Reference","previous_headings":"","what":"find_dampening_constant — find_dampening_constant","title":"find_dampening_constant — find_dampening_constant","text":"find dampening constant weights using cross-validation","code":""},{"path":"https://drieslab.github.io/Giotto/reference/find_dampening_constant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"find_dampening_constant — find_dampening_constant","text":"","code":"find_dampening_constant(S, B, goldStandard)"},{"path":"https://drieslab.github.io/Giotto/reference/find_x_y_ranges.html","id":null,"dir":"Reference","previous_headings":"","what":"find_x_y_ranges — find_x_y_ranges","title":"find_x_y_ranges — find_x_y_ranges","text":"get extended ranges x y","code":""},{"path":"https://drieslab.github.io/Giotto/reference/find_x_y_ranges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"find_x_y_ranges — find_x_y_ranges","text":"","code":"find_x_y_ranges(data, extend_ratio)"},{"path":"https://drieslab.github.io/Giotto/reference/find_x_y_ranges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"find_x_y_ranges — find_x_y_ranges","text":"data data extend_ratio extend_ratio","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10Xmatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"get10Xmatrix — get10Xmatrix","title":"get10Xmatrix — get10Xmatrix","text":"function creates expression matrix 10X structured folder","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10Xmatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get10Xmatrix — get10Xmatrix","text":"","code":"get10Xmatrix(   path_to_data,   gene_column_index = 1,   remove_zero_rows = TRUE,   split_by_type = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/get10Xmatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get10Xmatrix — get10Xmatrix","text":"path_to_data path 10X folder gene_column_index column features genes .tsv file use row ids remove_zero_rows removes rows sum equal zero split_by_type split multiple matrices based 3rd column features.tsv(.gz)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10Xmatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get10Xmatrix — get10Xmatrix","text":"sparse expression matrix 10X","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10Xmatrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"get10Xmatrix — get10Xmatrix","text":"typical 10X folder named raw_feature_bc_matrix filtered_feature_bc_matrix 3 files: barcodes.tsv(.gz) features.tsv(.gz) genes.tsv(.gz) matrix.mtx(.gz) default first column features genes .tsv file used, however multiple annotations provided (e.g. ensembl gene ids gene symbols) user can select another column.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10XmatrixOLD.html","id":null,"dir":"Reference","previous_headings":"","what":"get10XmatrixOLD — get10XmatrixOLD","title":"get10XmatrixOLD — get10XmatrixOLD","text":"function creates expression matrix 10X structured folder","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10XmatrixOLD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get10XmatrixOLD — get10XmatrixOLD","text":"","code":"get10XmatrixOLD(path_to_data, gene_column_index = 1)"},{"path":"https://drieslab.github.io/Giotto/reference/get10XmatrixOLD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get10XmatrixOLD — get10XmatrixOLD","text":"path_to_data path 10X folder gene_column_index column features genes .tsv file use row ids","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10XmatrixOLD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get10XmatrixOLD — get10XmatrixOLD","text":"sparse expression matrix 10X","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10XmatrixOLD.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"get10XmatrixOLD — get10XmatrixOLD","text":"typical 10X folder named raw_feature_bc_matrix filtered_feature_bc_matrix 3 files: barcodes.tsv(.gz) features.tsv(.gz) genes.tsv(.gz) matrix.mtx(.gz) default first column features genes .tsv file used, however multiple annotations provided (e.g. ensembl gene ids gene symbols) user can select another column.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10Xmatrix_h5.html","id":null,"dir":"Reference","previous_headings":"","what":"get10Xmatrix_h5 — get10Xmatrix_h5","title":"get10Xmatrix_h5 — get10Xmatrix_h5","text":"function creates expression matrix 10X h5 file path","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10Xmatrix_h5.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get10Xmatrix_h5 — get10Xmatrix_h5","text":"","code":"get10Xmatrix_h5(   path_to_data,   gene_ids = c(\"symbols\", \"ensembl\"),   remove_zero_rows = TRUE,   split_by_type = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/get10Xmatrix_h5.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get10Xmatrix_h5 — get10Xmatrix_h5","text":"path_to_data path 10X .h5 file gene_ids use gene symbols (default) ensembl ids gene expression matrix remove_zero_rows removes rows sum equal zero split_by_type split multiple matrices based 3rd column features.tsv(.gz)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10Xmatrix_h5.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get10Xmatrix_h5 — get10Xmatrix_h5","text":"(list ) sparse expression matrix 10X","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get10Xmatrix_h5.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"get10Xmatrix_h5 — get10Xmatrix_h5","text":".h5 10x file multiple classes features (e.g. expression vs QC probes) modalities (e.g. RNA protein), split_by_type param TRUE, multiple matrices returned","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getBalancedSpatCoexpressionFeats.html","id":null,"dir":"Reference","previous_headings":"","what":"getBalancedSpatCoexpressionFeats — getBalancedSpatCoexpressionFeats","title":"getBalancedSpatCoexpressionFeats — getBalancedSpatCoexpressionFeats","text":"Extract features spatial co-expression modules balanced manner","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getBalancedSpatCoexpressionFeats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"getBalancedSpatCoexpressionFeats — getBalancedSpatCoexpressionFeats","text":"","code":"getBalancedSpatCoexpressionFeats(   spatCorObject,   maximum = 50,   rank = c(\"weighted\", \"random\", \"informed\"),   informed_ranking = NULL,   seed = NA,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/getBalancedSpatCoexpressionFeats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"getBalancedSpatCoexpressionFeats — getBalancedSpatCoexpressionFeats","text":"spatCorObject spatial correlation object maximum maximum number genes get spatial co-expression module rank ranking method (see details) informed_ranking vector ranked features seed seed verbose verbosity","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getBalancedSpatCoexpressionFeats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"getBalancedSpatCoexpressionFeats — getBalancedSpatCoexpressionFeats","text":"balanced vector features co-expression module","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getBalancedSpatCoexpressionFeats.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"getBalancedSpatCoexpressionFeats — getBalancedSpatCoexpressionFeats","text":"3 different ways selectig features spatial co-expression modules 1. weighted: Features ranked based summarized pairwise co-expression scores 2. random: random selection features, set seed reproducibility 3. informed: Features selected based prior information/ranking","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getCellsFromPolygon.html","id":null,"dir":"Reference","previous_headings":"","what":"Get cells located within the polygons area — getCellsFromPolygon","title":"Get cells located within the polygons area — getCellsFromPolygon","text":"Get cells located within polygons area","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getCellsFromPolygon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get cells located within the polygons area — getCellsFromPolygon","text":"","code":"getCellsFromPolygon(   gobject,   polygon_name = \"selections\",   spat_unit = \"cell\",   spat_loc_name = \"raw\",   polygons = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/getCellsFromPolygon.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get cells located within the polygons area — getCellsFromPolygon","text":"gobject Giotto object polygon_name name polygon selections spat_unit spatial unit, default = 'cell' spat_loc_name name spatial locations use, default = 'raw' polygons character. vector polygon names extract cells . NULL, cells polygons retrieved","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getCellsFromPolygon.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get cells located within the polygons area — getCellsFromPolygon","text":"terra 'SpatVector' cell ID, x y coordinates, polygon ID cell located .","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getCellsFromPolygon.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get cells located within the polygons area — getCellsFromPolygon","text":"","code":"if (FALSE) { ## Plot interactive polygons my_spatPlot <- spatPlot2D(gobject = my_giotto_object,                           show_image = TRUE,                           point_alpha = 0.75,                           save_plot = FALSE) my_polygon_coords <- plotInteractivePolygons(my_spatPlot)  ## Add polygon coordinates to Giotto object my_giotto_polygons <- createGiottoPolygonsFromDfr(my_polygon_coords) my_giotto_object <- addGiottoPolygons(gobject = my_giotto_object,                                       gpolygons = list(my_giotto_polygons))  ## Get cells located within polygons area getCellsFromPolygon(my_giotto_object)  ## Get only cells from polygon 1 getCellsFromPolygon(my_giotto_object, polygons = \"polygon 1\") }"},{"path":"https://drieslab.github.io/Giotto/reference/getClusterSimilarity.html","id":null,"dir":"Reference","previous_headings":"","what":"getClusterSimilarity — getClusterSimilarity","title":"getClusterSimilarity — getClusterSimilarity","text":"Creates data.table pairwise correlation scores cluster.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getClusterSimilarity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"getClusterSimilarity — getClusterSimilarity","text":"","code":"getClusterSimilarity(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   cluster_column,   cor = c(\"pearson\", \"spearman\") )"},{"path":"https://drieslab.github.io/Giotto/reference/getClusterSimilarity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"getClusterSimilarity — getClusterSimilarity","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use cluster_column name column use clusters cor correlation score calculate distance","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getClusterSimilarity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"getClusterSimilarity — getClusterSimilarity","text":"data.table","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getClusterSimilarity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"getClusterSimilarity — getClusterSimilarity","text":"Creates data.table pairwise correlation scores cluster group size (# cells) cluster. information can used together mergeClusters combine similar small clusters bigger clusters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getDendrogramSplits.html","id":null,"dir":"Reference","previous_headings":"","what":"getDendrogramSplits — getDendrogramSplits","title":"getDendrogramSplits — getDendrogramSplits","text":"Split dendrogram node keep leave (label) information..","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getDendrogramSplits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"getDendrogramSplits — getDendrogramSplits","text":"","code":"getDendrogramSplits(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   cluster_column,   cor = c(\"pearson\", \"spearman\"),   distance = \"ward.D\",   h = NULL,   h_color = \"red\",   show_dend = TRUE,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/getDendrogramSplits.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"getDendrogramSplits — getDendrogramSplits","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use cluster_column name column use clusters cor correlation score calculate distance distance distance method use hierarchical clustering h height horizontal lines plot h_color color horizontal lines show_dend show dendrogram verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getDendrogramSplits.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"getDendrogramSplits — getDendrogramSplits","text":"data.table object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getDendrogramSplits.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"getDendrogramSplits — getDendrogramSplits","text":"Creates data.table three columns row represents node dendrogram. node height node given together two subdendrograms. information can used determine hierarchical manner differentially expressed marker genes node.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getGEFtxCoords.html","id":null,"dir":"Reference","previous_headings":"","what":"getGEFtxCoords — getGEFtxCoords","title":"getGEFtxCoords — getGEFtxCoords","text":"Converts .gef file (output stereo-seq pipeline) transcript coordinates","code":""},{"path":"https://drieslab.github.io/Giotto/reference/getGEFtxCoords.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"getGEFtxCoords — getGEFtxCoords","text":"","code":"getGEFtxCoords(gef_file, bin_size = \"bin100\")"},{"path":"https://drieslab.github.io/Giotto/reference/getGEFtxCoords.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"getGEFtxCoords — getGEFtxCoords","text":"gef_file path .gef file bin_size bin size select .gef file","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get_cross_section_coordinates.html","id":null,"dir":"Reference","previous_headings":"","what":"get_cross_section_coordinates — get_cross_section_coordinates","title":"get_cross_section_coordinates — get_cross_section_coordinates","text":"get local coordinates within cross section plane","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get_cross_section_coordinates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_cross_section_coordinates — get_cross_section_coordinates","text":"","code":"get_cross_section_coordinates(cell_subset_projection_locations)"},{"path":"https://drieslab.github.io/Giotto/reference/get_cross_section_coordinates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_cross_section_coordinates — get_cross_section_coordinates","text":"cell_subset_projection_locations cell_subset_projection_locations","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get_img_corners.html","id":null,"dir":"Reference","previous_headings":"","what":"get_img_corners — get_img_corners","title":"get_img_corners — get_img_corners","text":"finds four corner spatial coords giottoImages magick-images","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get_img_corners.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_img_corners — get_img_corners","text":"","code":"get_img_corners(img_object)"},{"path":"https://drieslab.github.io/Giotto/reference/get_img_corners.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_img_corners — get_img_corners","text":"img_object giottoImage magick-image use","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get_sectionThickness.html","id":null,"dir":"Reference","previous_headings":"","what":"get_sectionThickness — get_sectionThickness","title":"get_sectionThickness — get_sectionThickness","text":"get section thickness","code":""},{"path":"https://drieslab.github.io/Giotto/reference/get_sectionThickness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_sectionThickness — get_sectionThickness","text":"","code":"get_sectionThickness(   gobject,   thickness_unit = c(\"cell\", \"natural\"),   slice_thickness = 2,   spatial_network_name = \"Delaunay_network\",   cell_distance_estimate_method = c(\"mean\", \"median\"),   plane_equation = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/get_sectionThickness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_sectionThickness — get_sectionThickness","text":"gobject gobject thickness_unit thickness_unit spatial_network_name spatial_network_name cell_distance_estimate_method cell_distance_estimate_method plane_equation plane_equation","code":""},{"path":"https://drieslab.github.io/Giotto/reference/gpoly_from_dfr_smoothed_wrapped.html","id":null,"dir":"Reference","previous_headings":"","what":"Polygon creation and smoothing for parallel — gpoly_from_dfr_smoothed_wrapped","title":"Polygon creation and smoothing for parallel — gpoly_from_dfr_smoothed_wrapped","text":"Polygon creation smoothing parallel","code":""},{"path":"https://drieslab.github.io/Giotto/reference/gpoly_from_dfr_smoothed_wrapped.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Polygon creation and smoothing for parallel — gpoly_from_dfr_smoothed_wrapped","text":"","code":"gpoly_from_dfr_smoothed_wrapped(   segmdfr,   name = \"cell\",   calc_centroids = FALSE,   smooth_polygons = FALSE,   vertices = 20L,   k = 3L,   set_neg_to_zero = TRUE,   skip_eval_dfr = FALSE,   copy_dt = TRUE,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/heatmSpatialCorFeats.html","id":null,"dir":"Reference","previous_headings":"","what":"heatmSpatialCorFeats — heatmSpatialCorFeats","title":"heatmSpatialCorFeats — heatmSpatialCorFeats","text":"Create heatmap spatially correlated features","code":""},{"path":"https://drieslab.github.io/Giotto/reference/heatmSpatialCorFeats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"heatmSpatialCorFeats — heatmSpatialCorFeats","text":"","code":"heatmSpatialCorFeats(   gobject,   spatCorObject,   use_clus_name = NULL,   show_cluster_annot = TRUE,   show_row_dend = T,   show_column_dend = F,   show_row_names = F,   show_column_names = F,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"heatmSpatialCorFeats\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/heatmSpatialCorFeats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"heatmSpatialCorFeats — heatmSpatialCorFeats","text":"gobject giotto object spatCorObject spatial correlation object use_clus_name name clusters visualize (clusterSpatialCorFeats()) show_cluster_annot show cluster annotation top heatmap show_row_dend show row dendrogram show_column_dend show column dendrogram show_row_names show row names show_column_names show column names show_plot show plot return_plot return ggplot object save_plot directly save plot [boolean] save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param ... additional parameters Heatmap function ComplexHeatmap","code":""},{"path":"https://drieslab.github.io/Giotto/reference/heatmSpatialCorFeats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"heatmSpatialCorFeats — heatmSpatialCorFeats","text":"Heatmap generated ComplexHeatmap","code":""},{"path":"https://drieslab.github.io/Giotto/reference/heatmSpatialCorGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"heatmSpatialCorGenes — heatmSpatialCorGenes","title":"heatmSpatialCorGenes — heatmSpatialCorGenes","text":"Create heatmap spatially correlated genes","code":""},{"path":"https://drieslab.github.io/Giotto/reference/heatmSpatialCorGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"heatmSpatialCorGenes — heatmSpatialCorGenes","text":"","code":"heatmSpatialCorGenes(...)"},{"path":"https://drieslab.github.io/Giotto/reference/heatmSpatialCorGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"heatmSpatialCorGenes — heatmSpatialCorGenes","text":"... Arguments passed heatmSpatialCorFeats gobject giotto object spatCorObject spatial correlation object use_clus_name name clusters visualize (clusterSpatialCorFeats()) show_cluster_annot show cluster annotation top heatmap show_row_dend show row dendrogram show_column_dend show column dendrogram show_row_names show row names show_column_names show column names show_plot show plot return_plot return ggplot object save_plot directly save plot [boolean] save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/hyperGeometricEnrich.html","id":null,"dir":"Reference","previous_headings":"","what":"hyperGeometricEnrich — hyperGeometricEnrich","title":"hyperGeometricEnrich — hyperGeometricEnrich","text":"Function calculate gene signature enrichment scores per spatial position using hypergeometric test.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/hyperGeometricEnrich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"hyperGeometricEnrich — hyperGeometricEnrich","text":"","code":"hyperGeometricEnrich(...)"},{"path":"https://drieslab.github.io/Giotto/reference/hyperGeometricEnrich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"hyperGeometricEnrich — hyperGeometricEnrich","text":"... Arguments passed runHyperGeometricEnrich gobject Giotto object spat_unit spatial unit feat_type feature type sign_matrix Matrix signature genes cell type / process expression_values expression values use reverse_log_scale reverse expression values log scale logbase log base use reverse_log_scale = TRUE top_percentage percentage cells considered gene expression matrix binarization output_enrichment return enrichment output p_value calculate p-values (boolean, default = FALSE) name give spatial enrichment results, default = hypergeometric return_gobject return giotto object","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/igraph_remove_hetero_edges.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove hetero edges from igraph — igraph_remove_hetero_edges","title":"Remove hetero edges from igraph — igraph_remove_hetero_edges","text":"Given igraph `g` set node attributes `clus_att` encode different spatial clusters, remove edges connect non-similar nodes. can used data already clustered, clusters broken based whether spatially touching.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/igraph_remove_hetero_edges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove hetero edges from igraph — igraph_remove_hetero_edges","text":"","code":"igraph_remove_hetero_edges(g, clus_attr)"},{"path":"https://drieslab.github.io/Giotto/reference/igraph_remove_hetero_edges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove hetero edges from igraph — igraph_remove_hetero_edges","text":"g igraph object clus_attr character. categorical node attribute","code":""},{"path":"https://drieslab.github.io/Giotto/reference/igraph_remove_hetero_edges.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove hetero edges from igraph — igraph_remove_hetero_edges","text":"igraph","code":""},{"path":"https://drieslab.github.io/Giotto/reference/igraph_vertex_membership.html","id":null,"dir":"Reference","previous_headings":"","what":"igraph vertex membership — igraph_vertex_membership","title":"igraph vertex membership — igraph_vertex_membership","text":"Get weakly connected set vertices vertex part ","code":""},{"path":"https://drieslab.github.io/Giotto/reference/igraph_vertex_membership.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"igraph vertex membership — igraph_vertex_membership","text":"","code":"igraph_vertex_membership(g, clus_name)"},{"path":"https://drieslab.github.io/Giotto/reference/igraph_vertex_membership.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"igraph vertex membership — igraph_vertex_membership","text":"g igraph clus_name character. name assign column clustering info","code":""},{"path":"https://drieslab.github.io/Giotto/reference/igraph_vertex_membership.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"igraph vertex membership — igraph_vertex_membership","text":"data.table","code":""},{"path":"https://drieslab.github.io/Giotto/reference/initHMRF_V2.html","id":null,"dir":"Reference","previous_headings":"","what":"initHMRF_V2 — initHMRF_V2","title":"initHMRF_V2 — initHMRF_V2","text":"Run initialzation HMRF model","code":""},{"path":"https://drieslab.github.io/Giotto/reference/initHMRF_V2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"initHMRF_V2 — initHMRF_V2","text":"","code":"initHMRF_V2(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"scaled\", \"normalized\", \"custom\"),   spatial_network_name = \"Delaunay_network\",   use_spatial_genes = c(\"binSpect\", \"silhouetteRank\"),   use_score = FALSE,   gene_list_from_top = 2500,   filter_method = c(\"none\", \"elbow\"),   user_gene_list = NULL,   use_pca = FALSE,   use_pca_dim = 1:20,   gene_samples = 500,   gene_sampling_rate = 2,   gene_sampling_seed = 10,   use_metagene = FALSE,   cluster_metagene = 50,   top_metagene = 20,   existing_dim_reduction_to_use = NULL,   existing_dim_reduction_name = NULL,   existing_dimensions_to_use = NULL,   hmrf_seed = 100,   cl.method = c(\"km\", \"leiden\", \"louvain\"),   resolution.cl = 1,   k = 10,   tolerance = 1e-05,   zscore = c(\"none\", \"rowcol\", \"colrow\"),   nstart = 1000,   factor_step = 1.05,   python_path = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/initHMRF_V2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"initHMRF_V2 — initHMRF_V2","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use spatial_network_name name spatial network use HMRF use_spatial_genes Giotto's spatial genes use use_score use score gene selection criterion (applies use_spatial_genes=silhouetteRank) gene_list_from_top total spatial genes sampling filter_method filter genes top elbow method, prior sampling user_gene_list user-specified genes (optional) use_pca PCA used spatial gene expression value clustering use_pca_dim dimensions PCs selected expression gene_samples number spatial gene subset use HMRF gene_sampling_rate parameter (1-50) controlling proportion gene samples different module sampling, 1 corresponding equal gene samples different modules; 50 corresponding gene samples proportional module size. gene_sampling_seed random number seed sample spatial genes use_metagene metagene expression used clustering cluster_metagene number metagenes use top_metagene = number genes cluster metagene calculation existing_dim_reduction_to_use name dimension reduction method use existing_dim_reduction_name name dimension reduction result use expression value clustering existing_dimensions_to_use integers selected dimensions specified dimension reduction result, set NULL select hmrf_seed random number seed generate initial mean vector HMRF model cl.method clustering method calculate initial mean vector, selecting 'km', 'leiden', 'louvain' resolution.cl resolution Leiden Louvain clustering k number HMRF domains tolerance error tolerance threshold zscore type zscore use nstart number Kmeans initializations select best initialization factor_step dampened factor step","code":""},{"path":"https://drieslab.github.io/Giotto/reference/initHMRF_V2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"initHMRF_V2 — initHMRF_V2","text":"function initialization step HMRF domain clustering. First, user specify Giotto's spatial genes run, use_spatial_genes. Spatial genes stored gene metadata table. first pass genes filter genes significantly spatial, determined filter_method. filter_method none, top 2500 (gene_list_from_top) genes ranked pvalue considered spatial. filter_method elbow, exact cutoff determined elbow -log10 P-value vs. gene rank plot. Second, users options decrease dimension spatial genes clustering, listed selection priority:    1. use PCA spatial gene expressions (selected use_pca)    2. use metagene expressions (selected use_metagene)    3. sampling select 500 spatial genes (controlled gene_samples). Third, spatial genes finalized, using clustering method initialize HMRF. 3 clustering algorithm: K-means, Leiden, Louvain determine initial centroids HMRF. initialization finished. function returns list containing y (expression), nei (neighborhood structure), numnei (number neighbors), blocks (graph colors), damp (dampened factor), mu (mean), sigma (covariance), k, genes, edgelist, init.cl (initial clusters), spat_unit, feat_type. information needed second step, doHMRF.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/insertCrossSectionGenePlot3D.html","id":null,"dir":"Reference","previous_headings":"","what":"insertCrossSectionGenePlot3D — insertCrossSectionGenePlot3D","title":"insertCrossSectionGenePlot3D — insertCrossSectionGenePlot3D","text":"Visualize cells gene expression virtual cross section according spatial coordinates","code":""},{"path":"https://drieslab.github.io/Giotto/reference/insertCrossSectionGenePlot3D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"insertCrossSectionGenePlot3D — insertCrossSectionGenePlot3D","text":"","code":"insertCrossSectionGenePlot3D(   gobject,   spat_loc_name = \"raw\",   crossSection_obj = NULL,   name = NULL,   spatial_network_name = \"Delaunay_network\",   mesh_grid_color = \"#1f77b4\",   mesh_grid_width = 3,   mesh_grid_style = \"dot\",   sdimx = \"sdimx\",   sdimy = \"sdimy\",   sdimz = \"sdimz\",   show_other_cells = F,   axis_scale = c(\"cube\", \"real\", \"custom\"),   custom_ratio = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"spatGenePlot3D_with_cross_section\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/insertCrossSectionGenePlot3D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"insertCrossSectionGenePlot3D — insertCrossSectionGenePlot3D","text":"gobject giotto object spat_loc_name name spatial locations crossSection_obj cross section object alternative input. default = NULL. name name virtual cross section use spatial_network_name name spatial network use mesh_grid_color color meshgrid lines mesh_grid_width width meshgrid lines mesh_grid_style style meshgrid lines sdimx x-axis dimension name (default = 'sdimx') sdimy y-axis dimension name (default = 'sdimy') sdimz z-axis dimension name (default = 'sdimy') show_other_cells display selected cells axis_scale axis_scale custom_ratio custom_ratio show_plot show plots return_plot return ggplot object save_plot directly save plot [boolean] save_param list saving parameters GiottoVisuals::all_plots_save_function default_save_name default save name saving, change, change save_name save_param ... parameters spatGenePlot3D","code":""},{"path":"https://drieslab.github.io/Giotto/reference/insertCrossSectionGenePlot3D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"insertCrossSectionGenePlot3D — insertCrossSectionGenePlot3D","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/insertCrossSectionGenePlot3D.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"insertCrossSectionGenePlot3D — insertCrossSectionGenePlot3D","text":"Description parameters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/insertCrossSectionSpatPlot3D.html","id":null,"dir":"Reference","previous_headings":"","what":"insertCrossSectionSpatPlot3D — insertCrossSectionSpatPlot3D","title":"insertCrossSectionSpatPlot3D — insertCrossSectionSpatPlot3D","text":"Visualize meshgrid lines cross section together cells","code":""},{"path":"https://drieslab.github.io/Giotto/reference/insertCrossSectionSpatPlot3D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"insertCrossSectionSpatPlot3D — insertCrossSectionSpatPlot3D","text":"","code":"insertCrossSectionSpatPlot3D(   gobject,   spat_loc_name = \"raw\",   crossSection_obj = NULL,   name = NULL,   spatial_network_name = \"Delaunay_network\",   mesh_grid_color = \"#1f77b4\",   mesh_grid_width = 3,   mesh_grid_style = \"dot\",   sdimx = \"sdimx\",   sdimy = \"sdimy\",   sdimz = \"sdimz\",   show_other_cells = F,   axis_scale = c(\"cube\", \"real\", \"custom\"),   custom_ratio = NULL,   default_save_name = \"spat3D_with_cross_section\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/insertCrossSectionSpatPlot3D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"insertCrossSectionSpatPlot3D — insertCrossSectionSpatPlot3D","text":"gobject giotto object spat_loc_name name spatial locations crossSection_obj cross section object alternative input. default = NULL. name name virtual cross section use spatial_network_name name spatial network use mesh_grid_color color meshgrid lines mesh_grid_width width meshgrid lines mesh_grid_style style meshgrid lines sdimx x-axis dimension name (default = 'sdimx') sdimy y-axis dimension name (default = 'sdimy') sdimz z-axis dimension name (default = 'sdimy') show_other_cells display selected cells axis_scale axis_scale custom_ratio custom_ratio default_save_name default save name saving, change, change save_name save_param ... parameters spatPlot3D","code":""},{"path":"https://drieslab.github.io/Giotto/reference/insertCrossSectionSpatPlot3D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"insertCrossSectionSpatPlot3D — insertCrossSectionSpatPlot3D","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/insertCrossSectionSpatPlot3D.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"insertCrossSectionSpatPlot3D — insertCrossSectionSpatPlot3D","text":"Description parameters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/jackstrawPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"jackstrawPlot — jackstrawPlot","title":"jackstrawPlot — jackstrawPlot","text":"identify significant prinicipal components (PCs)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/jackstrawPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"jackstrawPlot — jackstrawPlot","text":"","code":"jackstrawPlot(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reduction = c(\"cells\", \"feats\"),   feats_to_use = NULL,   center = FALSE,   scale_unit = FALSE,   ncp = 20,   ylim = c(0, 1),   iter = 10,   threshold = 0.01,   verbose = TRUE,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"jackstrawPlot\" )"},{"path":"https://drieslab.github.io/Giotto/reference/jackstrawPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"jackstrawPlot — jackstrawPlot","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") expression_values expression values use reduction cells genes feats_to_use subset features use PCA center center data PCA scale_unit scale features PCA ncp number principal components calculate ylim y-axis limits jackstraw plot iter number interations jackstraw threshold p-value threshold call PC significant verbose show progress jackstraw method show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/jackstrawPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"jackstrawPlot — jackstrawPlot","text":"ggplot object jackstraw method","code":""},{"path":"https://drieslab.github.io/Giotto/reference/jackstrawPlot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"jackstrawPlot — jackstrawPlot","text":"Jackstraw method uses permutationPA function.  systematically permuting genes identifies robust, thus significant, PCs.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/kmeans_arma_binarize.html","id":null,"dir":"Reference","previous_headings":"","what":"kmeans_arma_binarize — kmeans_arma_binarize","title":"kmeans_arma_binarize — kmeans_arma_binarize","text":"create binarized scores vector using kmeans_arma","code":""},{"path":"https://drieslab.github.io/Giotto/reference/kmeans_arma_binarize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"kmeans_arma_binarize — kmeans_arma_binarize","text":"","code":"kmeans_arma_binarize(x, n_iter = 5, set.seed = NULL)"},{"path":"https://drieslab.github.io/Giotto/reference/kmeans_arma_subset_binarize.html","id":null,"dir":"Reference","previous_headings":"","what":"kmeans_arma_subset_binarize — kmeans_arma_subset_binarize","title":"kmeans_arma_subset_binarize — kmeans_arma_subset_binarize","text":"create binarized scores subsetted vector using kmeans_arma","code":""},{"path":"https://drieslab.github.io/Giotto/reference/kmeans_arma_subset_binarize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"kmeans_arma_subset_binarize — kmeans_arma_subset_binarize","text":"","code":"kmeans_arma_subset_binarize(   x,   n_iter = 5,   extreme_nr = 20,   sample_nr = 200,   set.seed = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/kmeans_binarize.html","id":null,"dir":"Reference","previous_headings":"","what":"kmeans_binarize — kmeans_binarize","title":"kmeans_binarize — kmeans_binarize","text":"create binarized scores vector using kmeans","code":""},{"path":"https://drieslab.github.io/Giotto/reference/kmeans_binarize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"kmeans_binarize — kmeans_binarize","text":"","code":"kmeans_binarize(x, nstart = 3, iter.max = 10, set.seed = NULL)"},{"path":"https://drieslab.github.io/Giotto/reference/kmeans_binarize_wrapper.html","id":null,"dir":"Reference","previous_headings":"","what":"kmeans_binarize_wrapper — kmeans_binarize_wrapper","title":"kmeans_binarize_wrapper — kmeans_binarize_wrapper","text":"wrapper different binarization functions","code":""},{"path":"https://drieslab.github.io/Giotto/reference/kmeans_binarize_wrapper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"kmeans_binarize_wrapper — kmeans_binarize_wrapper","text":"","code":"kmeans_binarize_wrapper(   expr_values,   subset_feats = NULL,   kmeans_algo = c(\"kmeans\", \"kmeans_arma\", \"kmeans_arma_subset\"),   nstart = 3,   iter_max = 10,   extreme_nr = 50,   sample_nr = 50,   set.seed = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/libNorm_giotto.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize for library size — libNorm_giotto","title":"Normalize for library size — libNorm_giotto","text":"Normalize library size","code":""},{"path":"https://drieslab.github.io/Giotto/reference/libNorm_giotto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize for library size — libNorm_giotto","text":"","code":"libNorm_giotto(mymatrix, scalefactor)"},{"path":"https://drieslab.github.io/Giotto/reference/libNorm_giotto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize for library size — libNorm_giotto","text":"mymatrix matrix object scalefactor scalefactor","code":""},{"path":"https://drieslab.github.io/Giotto/reference/loadHMRF.html","id":null,"dir":"Reference","previous_headings":"","what":"loadHMRF — loadHMRF","title":"loadHMRF — loadHMRF","text":"load previous HMRF","code":""},{"path":"https://drieslab.github.io/Giotto/reference/loadHMRF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"loadHMRF — loadHMRF","text":"","code":"loadHMRF(   name_used = \"test\",   output_folder_used,   k_used = 10,   betas_used,   python_path_used )"},{"path":"https://drieslab.github.io/Giotto/reference/loadHMRF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"loadHMRF — loadHMRF","text":"name_used name HMRF run output_folder_used output folder used k_used number HMRF domains tested betas_used betas tested python_path_used python path used","code":""},{"path":"https://drieslab.github.io/Giotto/reference/loadHMRF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"loadHMRF — loadHMRF","text":"reloads previous ran HMRF doHRMF","code":""},{"path":"https://drieslab.github.io/Giotto/reference/loadHMRF.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"loadHMRF — loadHMRF","text":"Description HMRF parameters ...","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_cosmx_folder_aggregate.html","id":null,"dir":"Reference","previous_headings":"","what":"Load CosMx folder aggregate info — load_cosmx_folder_aggregate","title":"Load CosMx folder aggregate info — load_cosmx_folder_aggregate","text":"Load CosMx folder aggregate info","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_cosmx_folder_aggregate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load CosMx folder aggregate info — load_cosmx_folder_aggregate","text":"","code":"load_cosmx_folder_aggregate(dir_items, cores, verbose = TRUE)"},{"path":"https://drieslab.github.io/Giotto/reference/load_cosmx_folder_aggregate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load CosMx folder aggregate info — load_cosmx_folder_aggregate","text":"cores many cores threads use read data paths provided verbose verbose building Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_cosmx_folder_subcellular.html","id":null,"dir":"Reference","previous_headings":"","what":"Load CosMx folder subcellular info — load_cosmx_folder_subcellular","title":"Load CosMx folder subcellular info — load_cosmx_folder_subcellular","text":"loads feature detections information. Note mask images still required working subcellular object, loaded createGiottoCosMxObject_subcellular","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_cosmx_folder_subcellular.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load CosMx folder subcellular info — load_cosmx_folder_subcellular","text":"","code":"load_cosmx_folder_subcellular(dir_items, FOVs = NULL, cores, verbose = TRUE)"},{"path":"https://drieslab.github.io/Giotto/reference/load_cosmx_folder_subcellular.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load CosMx folder subcellular info — load_cosmx_folder_subcellular","text":"FOVs field views load (affects subcellular data images) cores many cores threads use read data paths provided verbose verbose building Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_merscope_folder.html","id":null,"dir":"Reference","previous_headings":"","what":"Load MERSCOPE data from folder — load_merscope_folder","title":"Load MERSCOPE data from folder — load_merscope_folder","text":"Load MERSCOPE data folder","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_merscope_folder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load MERSCOPE data from folder — load_merscope_folder","text":"","code":"load_merscope_folder(   dir_items,   data_to_use,   fovs = NULL,   poly_z_indices = 1L:7L,   cores = NA,   verbose = TRUE )  load_merscope_folder_subcellular(   dir_items,   data_to_use,   cores = NA,   poly_z_indices = 1L:7L,   verbose = TRUE,   fovs = NULL )  load_merscope_folder_aggregate(   dir_items,   data_to_use,   cores = NA,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/load_merscope_folder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load MERSCOPE data from folder — load_merscope_folder","text":"dir_items list full filepaths read_merscope_folder data_to_use either 'subcellular' 'aggregate' information use object creation cores many cores threads use read data paths provided verbose verbose building Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_merscope_folder.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load MERSCOPE data from folder — load_merscope_folder","text":"list loaded-MERSCOPE data","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_merscope_folder.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Load MERSCOPE data from folder — load_merscope_folder","text":"load_merscope_folder_subcellular(): Load items 'subcellular' workflow load_merscope_folder_aggregate(): Load items 'aggregate' workflow","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_xenium_folder.html","id":null,"dir":"Reference","previous_headings":"","what":"Load xenium data from folder — load_xenium_folder","title":"Load xenium data from folder — load_xenium_folder","text":"Load xenium data folder","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_xenium_folder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load xenium data from folder — load_xenium_folder","text":"","code":"load_xenium_folder(   path_list,   load_format = \"csv\",   data_to_use = \"subcellular\",   h5_expression = \"FALSE\",   h5_gene_ids = \"symbols\",   gene_column_index = 1,   cores,   verbose = TRUE )  load_xenium_folder_csv(   path_list,   cores,   data_to_use = \"subcellular\",   h5_expression = FALSE,   h5_gene_ids = \"symbols\",   gene_column_index = 1,   verbose = TRUE )  load_xenium_folder_parquet(   path_list,   cores,   data_to_use = \"subcellular\",   h5_expression = FALSE,   h5_gene_ids = \"symbols\",   gene_column_index = 1,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/load_xenium_folder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load xenium data from folder — load_xenium_folder","text":"path_list list full filepaths read_xenium_folder load_format files formats load data. Either `csv` `parquet` currently supported. data_to_use type(s) expression data build gobject (e.g. default: 'subcellular', 'aggregate', '') h5_expression (boolean) whether load cell_feature_matrix .h5 file. Default TRUE h5_gene_ids use gene symbols (default) ensembl ids .h5 gene expression matrix gene_column_index column features genes .tsv file use row ids cores many cores threads use read data paths provided verbose verbose building Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_xenium_folder.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load xenium data from folder — load_xenium_folder","text":"list loaded xenium data","code":""},{"path":"https://drieslab.github.io/Giotto/reference/load_xenium_folder.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Load xenium data from folder — load_xenium_folder","text":"load_xenium_folder_csv(): Load csv files load_xenium_folder_parquet(): Load parquet files","code":""},{"path":"https://drieslab.github.io/Giotto/reference/logNorm_giotto.html","id":null,"dir":"Reference","previous_headings":"","what":"logNorm_giotto — logNorm_giotto","title":"logNorm_giotto — logNorm_giotto","text":"logNorm_giotto","code":""},{"path":"https://drieslab.github.io/Giotto/reference/logNorm_giotto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"logNorm_giotto — logNorm_giotto","text":"","code":"logNorm_giotto(mymatrix, base, offset)"},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixDWLS.html","id":null,"dir":"Reference","previous_headings":"","what":"makeSignMatrixDWLS — makeSignMatrixDWLS","title":"makeSignMatrixDWLS — makeSignMatrixDWLS","text":"Function convert matrix within Giotto object format  can used runDWLSDeconv deconvolution. vector cell types  parameter cell_type_vector can created cell metadata (pDataDT).","code":""},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixDWLS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"makeSignMatrixDWLS — makeSignMatrixDWLS","text":"","code":"makeSignMatrixDWLS(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reverse_log = TRUE,   log_base = 2,   sign_gene,   cell_type_vector,   cell_type = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixDWLS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"makeSignMatrixDWLS — makeSignMatrixDWLS","text":"gobject Giotto object single cell spat_unit spatial unit feat_type feature type use expression_values expression values use reverse_log reverse log-normalized expression matrix log_base logarithm base (default = 2) sign_gene DE genes (signature) cell_type_vector vector cell types (length = ncol(matrix)) cell_type deprecated, use cell_type_vector","code":""},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixDWLS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"makeSignMatrixDWLS — makeSignMatrixDWLS","text":"matrix","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixDWLSfromMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"makeSignMatrixDWLSfromMatrix — makeSignMatrixDWLSfromMatrix","title":"makeSignMatrixDWLSfromMatrix — makeSignMatrixDWLSfromMatrix","text":"Function convert single-cell RNAseq matrix format  can used runDWLSDeconv.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixDWLSfromMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"makeSignMatrixDWLSfromMatrix — makeSignMatrixDWLSfromMatrix","text":"","code":"makeSignMatrixDWLSfromMatrix(matrix, sign_gene, cell_type_vector)"},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixDWLSfromMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"makeSignMatrixDWLSfromMatrix — makeSignMatrixDWLSfromMatrix","text":"matrix scRNA-seq matrix sign_gene genes use (e.g. marker genes) cell_type_vector vector cell types (length = ncol(matrix))","code":""},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixDWLSfromMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"makeSignMatrixDWLSfromMatrix — makeSignMatrixDWLSfromMatrix","text":"matrix","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixPAGE.html","id":null,"dir":"Reference","previous_headings":"","what":"makeSignMatrixPAGE — makeSignMatrixPAGE","title":"makeSignMatrixPAGE — makeSignMatrixPAGE","text":"Function convert list signature genes (e.g. cell types processes) binary matrix format can used PAGE enrichment option. cell type process vector cell-type process specific genes. vectors need combined list (sign_list). names cell types processes provided list need given (sign_names).","code":""},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixPAGE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"makeSignMatrixPAGE — makeSignMatrixPAGE","text":"","code":"makeSignMatrixPAGE(sign_names, sign_list)"},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixPAGE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"makeSignMatrixPAGE — makeSignMatrixPAGE","text":"sign_names vector names provided gene signature sign_list list genes (signature)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixPAGE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"makeSignMatrixPAGE — makeSignMatrixPAGE","text":"matrix","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixRank.html","id":null,"dir":"Reference","previous_headings":"","what":"makeSignMatrixRank — makeSignMatrixRank","title":"makeSignMatrixRank — makeSignMatrixRank","text":"Function convert single-cell count matrix corresponding single-cell cluster vector rank matrix can used Rank enrichment option.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixRank.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"makeSignMatrixRank — makeSignMatrixRank","text":"","code":"makeSignMatrixRank(   sc_matrix,   sc_cluster_ids,   ties_method = c(\"random\", \"max\"),   gobject = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixRank.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"makeSignMatrixRank — makeSignMatrixRank","text":"sc_matrix matrix single-cell RNAseq expression data sc_cluster_ids vector cluster ids ties_method handle rank ties gobject giotto object given genes present datasets considered","code":""},{"path":"https://drieslab.github.io/Giotto/reference/makeSignMatrixRank.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"makeSignMatrixRank — makeSignMatrixRank","text":"matrix","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/make_simulated_network.html","id":null,"dir":"Reference","previous_headings":"","what":"make_simulated_network — make_simulated_network","title":"make_simulated_network — make_simulated_network","text":"Simulate random network.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/make_simulated_network.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"make_simulated_network — make_simulated_network","text":"","code":"make_simulated_network(   gobject,   spat_unit = NULL,   feat_type = NULL,   spatial_network_name = \"Delaunay_network\",   cluster_column,   number_of_simulations = 100,   set_seed = TRUE,   seed_number = 1234 )"},{"path":"https://drieslab.github.io/Giotto/reference/mean_expr_det_test.html","id":null,"dir":"Reference","previous_headings":"","what":"mean_expr_det_test — mean_expr_det_test","title":"mean_expr_det_test — mean_expr_det_test","text":"mean_expr_det_test","code":""},{"path":"https://drieslab.github.io/Giotto/reference/mean_expr_det_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mean_expr_det_test — mean_expr_det_test","text":"","code":"mean_expr_det_test(mymatrix, detection_threshold = 1)"},{"path":"https://drieslab.github.io/Giotto/reference/mean_expr_det_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mean_expr_det_test — mean_expr_det_test","text":"mymatrix matrix expression info detection_threshold detection threshold. Defaults 1 count.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/mergeClusters.html","id":null,"dir":"Reference","previous_headings":"","what":"mergeClusters — mergeClusters","title":"mergeClusters — mergeClusters","text":"Merge selected clusters based pairwise correlation scores size cluster.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/mergeClusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mergeClusters — mergeClusters","text":"","code":"mergeClusters(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   cluster_column,   cor = c(\"pearson\", \"spearman\"),   new_cluster_name = \"merged_cluster\",   min_cor_score = 0.8,   max_group_size = 20,   force_min_group_size = 10,   max_sim_clusters = 10,   return_gobject = TRUE,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/mergeClusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mergeClusters — mergeClusters","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use cluster_column name column use clusters cor correlation score calculate distance new_cluster_name new name merged clusters min_cor_score min correlation score merge pairwise clusters max_group_size max cluster size can merged force_min_group_size size clusters merged similar neighbor(s) max_sim_clusters maximum number clusters potentially merge reach force_min_group_size return_gobject return giotto object verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/mergeClusters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"mergeClusters — mergeClusters","text":"Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/mergeClusters.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"mergeClusters — mergeClusters","text":"Merge selected clusters based pairwise correlation scores size cluster. avoid large clusters merge max_group_size can lowered. Small clusters can forcibly merged similar pairwise cluster adjusting force_min_group_size parameter. Clusters smaller value merged independent provided min_cor_score value. force_min_group_size might always reached clusters already merged  giotto object returned default, FALSE merging vector returned.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/mygini_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"mygini_fun — mygini_fun","title":"mygini_fun — mygini_fun","text":"calculate gini coefficient","code":""},{"path":"https://drieslab.github.io/Giotto/reference/mygini_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mygini_fun — mygini_fun","text":"","code":"mygini_fun(x, weights = rep(1, length(x)))"},{"path":"https://drieslab.github.io/Giotto/reference/mygini_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"mygini_fun — mygini_fun","text":"gini coefficient","code":""},{"path":"https://drieslab.github.io/Giotto/reference/node_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"node_clusters — node_clusters","title":"node_clusters — node_clusters","text":"Merge selected clusters based pairwise correlation scores size cluster.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/node_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"node_clusters — node_clusters","text":"","code":"node_clusters(hclus_obj, verbose = TRUE)"},{"path":"https://drieslab.github.io/Giotto/reference/node_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"node_clusters — node_clusters","text":"hclus_obj hclus object verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/node_clusters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"node_clusters — node_clusters","text":"list splitted dendrogram nodes high low node height","code":""},{"path":"https://drieslab.github.io/Giotto/reference/normalizeGiotto.html","id":null,"dir":"Reference","previous_headings":"","what":"normalizeGiotto — normalizeGiotto","title":"normalizeGiotto — normalizeGiotto","text":"fast normalize /scale expresion values Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/normalizeGiotto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"normalizeGiotto — normalizeGiotto","text":"","code":"normalizeGiotto(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = \"raw\",   norm_methods = c(\"standard\", \"pearson_resid\", \"osmFISH\"),   library_size_norm = TRUE,   scalefactor = 6000,   log_norm = TRUE,   log_offset = 1,   logbase = 2,   scale_feats = TRUE,   scale_genes = NULL,   scale_cells = TRUE,   scale_order = c(\"first_feats\", \"first_cells\"),   theta = 100,   update_slot = \"scaled\",   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/normalizeGiotto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"normalizeGiotto — normalizeGiotto","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use norm_methods normalization method use library_size_norm normalize cells library size scalefactor scale factor use library size normalization log_norm transform values log-scale log_offset offset value add expression matrix, default = 1 logbase log base use log normalize expression values scale_feats z-score genes cells scale_genes deprecated, use scale_feats scale_cells z-score cells genes scale_order order scale feats cells theta theta parameter pearson residual normalization step update_slot slot name use results osmFISH pearson residual normalization verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/normalizeGiotto.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"normalizeGiotto — normalizeGiotto","text":"giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/normalizeGiotto.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"normalizeGiotto — normalizeGiotto","text":"Currently two 'methods' normalize raw counts data. . standard method follows standard protocol can adjusted using provided parameters follows following order: 1. Data normalization total library size scaling custom scale-factor. 2. Log transformation data. 3. Z-scoring data genes /cells. B. normalization method provided osmFISH paper also implemented: 1. First normalize genes, gene divide counts total gene count multiply total number genes. 2. Next normalize cells, cell divide normalized gene counts total counts per cell multiply total number cells. C. normalization method provided Lause/Kobak et al also implemented: 1. First calculate expected values based Pearson correlations. 2. Next calculate z-scores based observed expected values. default latter two results saved Giotto slot scaled expression,  can changed changing update_slot parameters","code":""},{"path":"https://drieslab.github.io/Giotto/reference/numPts_below_line.html","id":null,"dir":"Reference","previous_headings":"","what":"numPts_below_line — numPts_below_line","title":"numPts_below_line — numPts_below_line","text":"function calculate number data points given line","code":""},{"path":"https://drieslab.github.io/Giotto/reference/numPts_below_line.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"numPts_below_line — numPts_below_line","text":"","code":"numPts_below_line(myVector, slope, x)"},{"path":"https://drieslab.github.io/Giotto/reference/numPts_below_line.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"numPts_below_line — numPts_below_line","text":"myVector input sequence sorted positive values smallest greatest slope slope compare x location point line compare, integer 1 length myVector","code":""},{"path":"https://drieslab.github.io/Giotto/reference/numPts_below_line.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"numPts_below_line — numPts_below_line","text":"function calculates number data points sorted sequence line given slope certain point sequence.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/optimize_deconvolute_dwls.html","id":null,"dir":"Reference","previous_headings":"","what":"optimize_deconvolute_dwls — optimize_deconvolute_dwls","title":"optimize_deconvolute_dwls — optimize_deconvolute_dwls","text":"Rui fill ","code":""},{"path":"https://drieslab.github.io/Giotto/reference/optimize_deconvolute_dwls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"optimize_deconvolute_dwls — optimize_deconvolute_dwls","text":"","code":"optimize_deconvolute_dwls(exp, Signature)"},{"path":"https://drieslab.github.io/Giotto/reference/optimize_solveDampenedWLS.html","id":null,"dir":"Reference","previous_headings":"","what":"optimize_solveDampenedWLS — optimize_solveDampenedWLS","title":"optimize_solveDampenedWLS — optimize_solveDampenedWLS","text":"Rui fill ","code":""},{"path":"https://drieslab.github.io/Giotto/reference/optimize_solveDampenedWLS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"optimize_solveDampenedWLS — optimize_solveDampenedWLS","text":"","code":"optimize_solveDampenedWLS(S, B, constant_J)"},{"path":"https://drieslab.github.io/Giotto/reference/pieCellTypesFromEnrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"pieCellTypesFromEnrichment — pieCellTypesFromEnrichment","title":"pieCellTypesFromEnrichment — pieCellTypesFromEnrichment","text":"pieCellTypesFromEnrichment","code":""},{"path":"https://drieslab.github.io/Giotto/reference/pieCellTypesFromEnrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"pieCellTypesFromEnrichment — pieCellTypesFromEnrichment","text":"","code":"pieCellTypesFromEnrichment(   gobject = NULL,   spat_unit = NULL,   feat_type = NULL,   enrichment_name = \"PAGE_z_score\",   title = NULL,   save_param = list(),   default_save_name = \"cell_types_from_enrichment_pie\",   save_plot = NA,   show_plot = NA,   return_plot = NA )"},{"path":"https://drieslab.github.io/Giotto/reference/pieCellTypesFromEnrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"pieCellTypesFromEnrichment — pieCellTypesFromEnrichment","text":"gobject Giotto Object spat_unit spatial unit enrichment information stored feat_type feature type enrichment information calculated enrichment_name name spatial enrichment .e. output GiottoClass::list_spatial_enrichment_names() Default value \"PAGE_Z_score\" title Title generated plot. Default `paste0(spat_unit,\"cell types (maximum\", enrichment_name, \")\")` save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param save_plot logical. save plot show_plot logical. show plot return_plot logical. return ggplot object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/pieCellTypesFromEnrichment.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"pieCellTypesFromEnrichment — pieCellTypesFromEnrichment","text":"function generates pie chart cell types frequency. cell type resutls based provided `enrichment_name`, determined maximum value z-score p-value given cell annotation.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCCcomDotplot.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCCcomDotplot — plotCCcomDotplot","title":"plotCCcomDotplot — plotCCcomDotplot","text":"Plots dotplot ligand-receptor communication scores cell-cell interactions","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCCcomDotplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCCcomDotplot — plotCCcomDotplot","text":"","code":"plotCCcomDotplot(   gobject,   comScores,   selected_LR = NULL,   selected_cell_LR = NULL,   show_LR_names = TRUE,   show_cell_LR_names = TRUE,   cluster_on = c(\"PI\", \"LR_expr\", \"log2fc\"),   cor_method = c(\"pearson\", \"kendall\", \"spearman\"),   aggl_method = c(\"ward.D\", \"ward.D2\", \"single\", \"complete\", \"average\", \"mcquitty\",     \"median\", \"centroid\"),   dot_color_gradient = NULL,   gradient_style = c(\"divergent\", \"sequential\"),   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotCCcomDotplot\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotCCcomDotplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCCcomDotplot — plotCCcomDotplot","text":"gobject giotto object comScores communication scores exprCellCellcom spatCellCellcom selected_LR selected ligand-receptor combinations selected_cell_LR selected cell-cell combinations ligand-receptor combinations show_LR_names show ligand-receptor names show_cell_LR_names show cell-cell names cluster_on values use clustering cell-cell ligand-receptor pairs cor_method correlation method used clustering aggl_method agglomeration method used hclust dot_color_gradient character. continuous colors use. palette use vector colors use (minimum 2). gradient_style either 'divergent' (midpoint used color scaling) 'sequential' (scaled based data range) show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCCcomDotplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotCCcomDotplot — plotCCcomDotplot","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCCcomHeatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCCcomHeatmap — plotCCcomHeatmap","title":"plotCCcomHeatmap — plotCCcomHeatmap","text":"Plots heatmap ligand-receptor communication scores cell-cell interactions","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCCcomHeatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCCcomHeatmap — plotCCcomHeatmap","text":"","code":"plotCCcomHeatmap(   gobject,   comScores,   selected_LR = NULL,   selected_cell_LR = NULL,   show_LR_names = TRUE,   show_cell_LR_names = TRUE,   show = c(\"PI\", \"LR_expr\", \"log2fc\"),   cor_method = c(\"pearson\", \"kendall\", \"spearman\"),   aggl_method = c(\"ward.D\", \"ward.D2\", \"single\", \"complete\", \"average\", \"mcquitty\",     \"median\", \"centroid\"),   gradient_color = NULL,   gradient_style = c(\"divergent\", \"sequential\"),   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotCCcomHeatmap\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotCCcomHeatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCCcomHeatmap — plotCCcomHeatmap","text":"gobject giotto object comScores communinication scores exprCellCellcom spatCellCellcom selected_LR selected ligand-receptor combinations selected_cell_LR selected cell-cell combinations ligand-receptor combinations show_LR_names show ligand-receptor names show_cell_LR_names show cell-cell names show values show heatmap cor_method correlation method used clustering aggl_method agglomeration method used hclust gradient_color character. continuous colors use. palette use vector colors use (minimum 2). gradient_style either 'divergent' (midpoint used color scaling) 'sequential' (scaled based data range) show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCCcomHeatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotCCcomHeatmap — plotCCcomHeatmap","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCPF.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCPF — plotCPF","title":"plotCPF — plotCPF","text":"Create visualization cell proximity feature scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCPF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCPF — plotCPF","text":"","code":"plotCPF(   gobject,   icfObject,   method = c(\"volcano\", \"cell_barplot\", \"cell-cell\", \"cell_sankey\", \"heatmap\", \"dotplot\"),   min_cells = 5,   min_cells_expr = 1,   min_int_cells = 3,   min_int_cells_expr = 1,   min_fdr = 0.05,   min_spat_diff = 0.2,   min_log2_fc = 0.2,   min_zscore = 2,   zscores_column = c(\"cell_type\", \"feats\"),   direction = c(\"both\", \"up\", \"down\"),   cell_color_code = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotCPG\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotCPF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCPF — plotCPF","text":"gobject giotto object icfObject ICF (interaction changed feature) score object method plotting method use min_cells minimum number source cell type min_cells_expr minimum expression level source cell type min_int_cells minimum number interacting neighbor cell type min_int_cells_expr minimum expression level interacting neighbor cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum log2 fold-change min_zscore minimum z-score change zscores_column calculate z-scores cell types features direction differential expression directions keep cell_color_code character. discrete colors use. palette use named vector colors show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCPF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotCPF — plotCPF","text":"plot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCellProximityFeatSpot.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCellProximityFeatSpot — plotCellProximityFeatSpot","title":"plotCellProximityFeatSpot — plotCellProximityFeatSpot","text":"Create visualization cell proximity feature scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCellProximityFeatSpot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCellProximityFeatSpot — plotCellProximityFeatSpot","text":"","code":"plotCellProximityFeatSpot(   gobject,   icfObject,   method = c(\"volcano\", \"cell_barplot\", \"cell-cell\", \"cell_sankey\", \"heatmap\", \"dotplot\"),   min_cells = 4,   min_cells_expr_resi = 0.05,   min_int_cells = 4,   min_int_cells_expr_resi = 0.05,   min_fdr = 0.5,   min_pcc_diff = 0.05,   min_zscore = 0.05,   zscores_column = c(\"cell_type\", \"features\"),   direction = c(\"both\", \"up\", \"down\"),   cell_color_code = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotCellProximityFeats\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotCellProximityFeatSpot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCellProximityFeatSpot — plotCellProximityFeatSpot","text":"gobject giotto object icfObject ICF (interaction changed feature) score object method plotting method use min_cells minimum number source cell type min_cells_expr_resi Default = 0.05 min_int_cells minimum number interacting neighbor cell type min_int_cells_expr_resi Default = 0.05 min_fdr minimum adjusted p-value min_pcc_diff Default = 0.05 min_zscore minimum z-score change zscores_column calculate z-scores cell types features direction differential expression directions keep cell_color_code vector colors cell types names show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCellProximityFeatSpot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotCellProximityFeatSpot — plotCellProximityFeatSpot","text":"plot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCellProximityFeats.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCellProximityFeats — plotCellProximityFeats","title":"plotCellProximityFeats — plotCellProximityFeats","text":"Create visualization cell proximity feature scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCellProximityFeats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCellProximityFeats — plotCellProximityFeats","text":"","code":"plotCellProximityFeats(   gobject,   icfObject,   method = c(\"volcano\", \"cell_barplot\", \"cell-cell\", \"cell_sankey\", \"heatmap\", \"dotplot\"),   min_cells = 4,   min_cells_expr = 1,   min_int_cells = 4,   min_int_cells_expr = 1,   min_fdr = 0.1,   min_spat_diff = 0.2,   min_log2_fc = 0.2,   min_zscore = 2,   zscores_column = c(\"cell_type\", \"feats\"),   direction = c(\"both\", \"up\", \"down\"),   cell_color_code = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotCellProximityFeats\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotCellProximityFeats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCellProximityFeats — plotCellProximityFeats","text":"gobject giotto object icfObject ICF (interaction changed feature) score object method plotting method use min_cells minimum number source cell type min_cells_expr minimum expression level source cell type min_int_cells minimum number interacting neighbor cell type min_int_cells_expr minimum expression level interacting neighbor cell type min_fdr minimum adjusted p-value min_spat_diff minimum absolute spatial expression difference min_log2_fc minimum log2 fold-change min_zscore minimum z-score change zscores_column calculate z-scores cell types featuress direction differential expression directions keep cell_color_code character. discrete colors use. palette use named vector colors show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCellProximityFeats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotCellProximityFeats — plotCellProximityFeats","text":"plot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCellTypesFromEnrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCellTypesFromEnrichment — plotCellTypesFromEnrichment","title":"plotCellTypesFromEnrichment — plotCellTypesFromEnrichment","text":"plotCellTypesFromEnrichment","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCellTypesFromEnrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCellTypesFromEnrichment — plotCellTypesFromEnrichment","text":"","code":"plotCellTypesFromEnrichment(   gobject = NULL,   spat_unit = NULL,   feat_type = NULL,   enrichment_name = \"PAGE_z_score\",   title = NULL,   save_param = list(),   default_save_name = \"cell_types_from_enrichment\",   save_plot = NA,   show_plot = NA,   return_plot = NA )"},{"path":"https://drieslab.github.io/Giotto/reference/plotCellTypesFromEnrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCellTypesFromEnrichment — plotCellTypesFromEnrichment","text":"gobject Giotto Object spat_unit spatial unit enrichment information stored feat_type feature type enrichment information calculated enrichment_name name spatial enrichment .e. output GiottoClass::list_spatial_enrichment_names() Default value \"PAGE_Z_score\" title Title generated plot. Default `paste0(spat_unit,\"cell types (maximum\", enrichment_name, \")\")` save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param save_plot logical. save plot show_plot logical. show plot return_plot logical. return ggplot object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCellTypesFromEnrichment.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"plotCellTypesFromEnrichment — plotCellTypesFromEnrichment","text":"function generates bar plot cell types vs frequency cell type data. cell type resutls based provided `enrichment_name`, determined maximum value z-score p-value given cell annotation.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineCCcom.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCombineCCcom — plotCombineCCcom","title":"plotCombineCCcom — plotCombineCCcom","text":"Create visualization combined (pairwise) cell proximity gene scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineCCcom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCombineCCcom — plotCombineCCcom","text":"","code":"plotCombineCCcom(   gobject,   combCCcom,   selected_LR = NULL,   selected_cell_LR = NULL,   detail_plot = T,   simple_plot = F,   simple_plot_facet = c(\"interaction\", \"genes\"),   facet_scales = \"fixed\",   facet_ncol = length(selected_LR),   facet_nrow = length(selected_cell_LR),   colors = c(\"#9932CC\", \"#FF8C00\"),   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotCombineCCcom\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineCCcom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCombineCCcom — plotCombineCCcom","text":"gobject giotto object combCCcom combined communcation scores, output combCCcom() selected_LR selected ligand-receptor pair selected_cell_LR selected cell-cell interaction pair ligand-receptor pair detail_plot show detailed info interacting cell types simple_plot show simplified plot simple_plot_facet facet interactions genes simple plot facet_scales ggplot facet scales paramter facet_ncol ggplot facet ncol parameter facet_nrow ggplot facet nrow parameter colors vector two colors use show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineCCcom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotCombineCCcom — plotCombineCCcom","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineCellCellCommunication.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCombineCellCellCommunication — plotCombineCellCellCommunication","title":"plotCombineCellCellCommunication — plotCombineCellCellCommunication","text":"Create visualization combined (pairwise) cell proximity gene scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineCellCellCommunication.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCombineCellCellCommunication — plotCombineCellCellCommunication","text":"","code":"plotCombineCellCellCommunication(   gobject,   combCCcom,   selected_LR = NULL,   selected_cell_LR = NULL,   detail_plot = T,   simple_plot = F,   simple_plot_facet = c(\"interaction\", \"genes\"),   facet_scales = \"fixed\",   facet_ncol = length(selected_LR),   facet_nrow = length(selected_cell_LR),   colors = c(\"#9932CC\", \"#FF8C00\"),   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotCombineCellCellCommunication\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineCellCellCommunication.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCombineCellCellCommunication — plotCombineCellCellCommunication","text":"gobject giotto object combCCcom combined communcation scores, output combCCcom() selected_LR selected ligand-receptor pair selected_cell_LR selected cell-cell interaction pair ligand-receptor pair detail_plot show detailed info interacting cell types simple_plot show simplified plot simple_plot_facet facet interactions genes simple plot facet_scales ggplot facet scales paramter facet_ncol ggplot facet ncol parameter facet_nrow ggplot facet nrow parameter colors vector two colors use show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineCellCellCommunication.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotCombineCellCellCommunication — plotCombineCellCellCommunication","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineICF.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCombineICF — plotCombineICF","title":"plotCombineICF — plotCombineICF","text":"Create visualization combined (pairwise) ICF scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineICF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCombineICF — plotCombineICF","text":"","code":"plotCombineICF(   gobject,   combIcfObject,   selected_interactions = NULL,   selected_feat_to_feat = NULL,   detail_plot = T,   simple_plot = F,   simple_plot_facet = c(\"interaction\", \"feats\"),   facet_scales = \"fixed\",   facet_ncol = length(selected_feat_to_feat),   facet_nrow = length(selected_interactions),   colors = c(\"#9932CC\", \"#FF8C00\"),   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotCombineICF\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineICF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCombineICF — plotCombineICF","text":"gobject giotto object combIcfObject ICFscores, output combineInteractionChangedFeats() selected_interactions interactions show selected_feat_to_feat pairwise feature combinations show detail_plot show detailed info interacting cell types simple_plot show simplified plot simple_plot_facet facet interactions feats simple plot facet_scales ggplot facet scales paramter facet_ncol ggplot facet ncol parameter facet_nrow ggplot facet nrow parameter colors vector two colors use show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineICF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotCombineICF — plotCombineICF","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineInteractionChangedFeats.html","id":null,"dir":"Reference","previous_headings":"","what":"plotCombineInteractionChangedFeats — plotCombineInteractionChangedFeats","title":"plotCombineInteractionChangedFeats — plotCombineInteractionChangedFeats","text":"Create visualization combined (pairwise) ICF scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineInteractionChangedFeats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotCombineInteractionChangedFeats — plotCombineInteractionChangedFeats","text":"","code":"plotCombineInteractionChangedFeats(   gobject,   combIcfObject,   selected_interactions = NULL,   selected_feat_to_feat = NULL,   detail_plot = T,   simple_plot = F,   simple_plot_facet = c(\"interaction\", \"feats\"),   facet_scales = \"fixed\",   facet_ncol = length(selected_feat_to_feat),   facet_nrow = length(selected_interactions),   colors = c(\"#9932CC\", \"#FF8C00\"),   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotCombineICF\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineInteractionChangedFeats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotCombineInteractionChangedFeats — plotCombineInteractionChangedFeats","text":"gobject giotto object combIcfObject ICFscores, output combineInteractionChangedFeats() selected_interactions interactions show selected_feat_to_feat pairwise feature combinations show detail_plot show detailed info interacting cell types simple_plot show simplified plot simple_plot_facet facet interactions feats simple plot facet_scales ggplot facet scales paramter facet_ncol ggplot facet ncol parameter facet_nrow ggplot facet nrow parameter colors vector two colors use show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotCombineInteractionChangedFeats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotCombineInteractionChangedFeats — plotCombineInteractionChangedFeats","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotICF.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot interaction changed features — plotICF","title":"Plot interaction changed features — plotICF","text":"Create barplot visualize interaction changed features","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotICF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot interaction changed features — plotICF","text":"","code":"plotICF(   gobject,   icfObject,   source_type,   source_markers,   ICF_feats,   cell_color_code = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotICF\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotICF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot interaction changed features — plotICF","text":"gobject giotto object icfObject ICF (interaction changed feature) score object source_type cell type source cell source_markers markers source cell type ICF_feats named character vector ICF features cell_color_code character. discrete colors use. palette use named vector colors show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotICF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot interaction changed features — plotICF","text":"plot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotICFSpot.html","id":null,"dir":"Reference","previous_headings":"","what":"plotICFSpot — plotICFSpot","title":"plotICFSpot — plotICFSpot","text":"Create barplot visualize interaction changed features","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotICFSpot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotICFSpot — plotICFSpot","text":"","code":"plotICFSpot(   gobject,   icfObject,   source_type,   source_markers,   ICF_features,   cell_color_code = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotICFSpot\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotICFSpot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotICFSpot — plotICFSpot","text":"gobject giotto object icfObject ICF (interaction changed feature) score object source_type cell type source cell source_markers markers source cell type ICF_features named character vector ICF features cell_color_code cell color code interacting cell types show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotICFSpot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotICFSpot — plotICFSpot","text":"plot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractionChangedFeats.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot interaction changed features — plotInteractionChangedFeats","title":"Plot interaction changed features — plotInteractionChangedFeats","text":"Create barplot visualize interaction changed features","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractionChangedFeats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot interaction changed features — plotInteractionChangedFeats","text":"","code":"plotInteractionChangedFeats(   gobject,   icfObject,   source_type,   source_markers,   ICF_feats,   cell_color_code = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotInteractionChangedFeats\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractionChangedFeats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot interaction changed features — plotInteractionChangedFeats","text":"gobject giotto object icfObject ICF (interaction changed feature) score object source_type cell type source cell source_markers markers source cell type ICF_feats named character vector ICF features cell_color_code character. discrete colors use. palette use named vector colors show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractionChangedFeats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot interaction changed features — plotInteractionChangedFeats","text":"plot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractive3D.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot interactive 3D spatial plot — plotInteractive3D","title":"Plot interactive 3D spatial plot — plotInteractive3D","text":"Plot interactive 3D spatial plot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractive3D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot interactive 3D spatial plot — plotInteractive3D","text":"","code":"plotInteractive3D(   gobject,   spat_unit = \"cell\",   feat_type = \"rna\",   cell_color = \"leiden_clus\",   cell_color_code = NULL,   point_size = 0.5,   width = \"100%\",   height = \"400px\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractive3D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot interactive 3D spatial plot — plotInteractive3D","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") cell_color character. color cells (e.g. metadata col spatial enrichment col) cell_color_code character. discrete colors use. Palette use named vector colors point_size size point (cell) width plot width height plot height","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractive3D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot interactive 3D spatial plot — plotInteractive3D","text":"data.table selected cell_IDs, spatial coordinates, cluster_ID.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractivePolygons.html","id":null,"dir":"Reference","previous_headings":"","what":"Select image regions by plotting interactive polygons — plotInteractivePolygons","title":"Select image regions by plotting interactive polygons — plotInteractivePolygons","text":"Plot interactive polygons image retrieve polygons coordinates.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractivePolygons.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select image regions by plotting interactive polygons — plotInteractivePolygons","text":"","code":"plotInteractivePolygons(x, width = \"auto\", height = \"auto\", ...)"},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractivePolygons.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select image regions by plotting interactive polygons — plotInteractivePolygons","text":"x `ggplot` `rast` plot object draw polygons width, height integer, defining width/height pixels. ... Graphical parameters passed `polygon` `geom_point`.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotInteractivePolygons.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select image regions by plotting interactive polygons — plotInteractivePolygons","text":"`data.table` containing x,y coordinates plotted polygons.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotPolygons.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot stored polygons — plotPolygons","title":"Plot stored polygons — plotPolygons","text":"Plot stored polygons","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotPolygons.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot stored polygons — plotPolygons","text":"","code":"plotPolygons(   gobject,   polygon_name = \"selections\",   x,   spat_unit = \"cell\",   polygons = NULL,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/plotPolygons.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot stored polygons — plotPolygons","text":"gobject Giotto object polygon coordinates polygon_name name polygon selections x ggplot2, spatPlot terra::rast object spat_unit spatial unit polygons character. Vector polygon names plot. NULL, polygons plotted ... Additional parameters passed ggplot2::geom_polygon() graphics::polygon","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotPolygons.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot stored polygons — plotPolygons","text":"ggplot2 image","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotRankSpatvsExpr.html","id":null,"dir":"Reference","previous_headings":"","what":"plotRankSpatvsExpr — plotRankSpatvsExpr","title":"plotRankSpatvsExpr — plotRankSpatvsExpr","text":"Plots dotplot compare ligand-receptor rankings spatial expression information","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotRankSpatvsExpr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotRankSpatvsExpr — plotRankSpatvsExpr","text":"","code":"plotRankSpatvsExpr(   gobject,   combCC,   expr_rnk_column = \"LR_expr_rnk\",   spat_rnk_column = \"LR_spat_rnk\",   dot_color_gradient = NULL,   midpoint = deprecated(),   gradient_midpoint = 10,   gradient_style = c(\"divergent\", \"sequential\"),   size_range = c(0.01, 1.5),   xlims = NULL,   ylims = NULL,   selected_ranks = c(1, 10, 20),   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotRankSpatvsExpr\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotRankSpatvsExpr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotRankSpatvsExpr — plotRankSpatvsExpr","text":"gobject giotto object combCC combined communication scores combCCcom expr_rnk_column column expression rank information use spat_rnk_column column spatial rank information use dot_color_gradient character. continuous colors use. palette use vector colors use (minimum 2). midpoint deprecated gradient_midpoint numeric. default = 10. midpoint colors gradient_style either 'divergent' (midpoint used color scaling) 'sequential' (scaled based data range) size_range size ranges dotplot xlims x-limits, numerical vector 2 ylims y-limits, numerical vector 2 selected_ranks numerical vector, used print percentage top spatial ranks recovered show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotRankSpatvsExpr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotRankSpatvsExpr — plotRankSpatvsExpr","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotRecovery.html","id":null,"dir":"Reference","previous_headings":"","what":"plotRecovery — plotRecovery","title":"plotRecovery — plotRecovery","text":"Plots recovery plot compare ligand-receptor rankings spatial expression information","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotRecovery.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotRecovery — plotRecovery","text":"","code":"plotRecovery(   gobject,   combCC,   expr_rnk_column = \"exprPI_rnk\",   spat_rnk_column = \"spatPI_rnk\",   ground_truth = c(\"spatial\", \"expression\"),   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"plotRecovery\" )"},{"path":"https://drieslab.github.io/Giotto/reference/plotRecovery.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotRecovery — plotRecovery","text":"gobject giotto object combCC combined communication scores combCCcom expr_rnk_column column expression rank information use spat_rnk_column column spatial rank information use ground_truth consider ground truth (default: spatial) show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotRecovery.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plotRecovery — plotRecovery","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotRecovery_sub.html","id":null,"dir":"Reference","previous_headings":"","what":"plotRecovery_sub — plotRecovery_sub","title":"plotRecovery_sub — plotRecovery_sub","text":"Plots recovery plot compare ligand-receptor rankings spatial expression information","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plotRecovery_sub.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plotRecovery_sub — plotRecovery_sub","text":"","code":"plotRecovery_sub(combCC, first_col = \"LR_expr_rnk\", second_col = \"LR_spat_rnk\")"},{"path":"https://drieslab.github.io/Giotto/reference/plotRecovery_sub.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plotRecovery_sub — plotRecovery_sub","text":"combCC combined communinication scores combCCcom first_col first column use second_col second column use","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_cell_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Params documentation template: plot_cell_params — plot_cell_params","title":"Params documentation template: plot_cell_params — plot_cell_params","text":"Params documentation template: plot_cell_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_cell_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Params documentation template: plot_cell_params — plot_cell_params","text":"cell_color character. color cells (e.g. metadata col spatial enrichment col) color_as_factor logical. convert color column factor. discrete colors used TRUE. continuous colors FALSE. cell_color_code character. discrete colors use. palette use named vector colors cell_color_gradient character. continuous colors use. palette use vector colors use (minimum 2).","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_cow_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Params documentation template: plot_cow_params — plot_cow_params","title":"Params documentation template: plot_cow_params — plot_cow_params","text":"Params documentation template: plot_cow_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_cow_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Params documentation template: plot_cow_params — plot_cow_params","text":"cow_n_col cowplot param: many columns cow_rel_h cowplot param: relative heights rows (e.g. c(1,2)) cow_rel_w cowplot param: relative widths columns (e.g. c(1,2)) cow_align cowplot param: align","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_dimred_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Params documentation template: plot_dimred_params — plot_dimred_params","title":"Params documentation template: plot_dimred_params — plot_dimred_params","text":"Params documentation template: plot_dimred_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_dimred_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Params documentation template: plot_dimred_params — plot_dimred_params","text":"dim_reduction_to_use character. dimension reduction use dim_reduction_name character. dimension reduction name dim1_to_use numeric. dimension use x-axis dim2_to_use numeric. dimension use y-axis dim3_to_use numeric. dimension use z-axis dim_point_shape point border (border no_border) dim_point_size size points dim. reduction space dim_point_alpha transparancy point dim. reduction space dim_point_border_col border color points dim. reduction space dim_point_border_stroke border stroke points dim. reduction space","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_feat_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Params documentation template: plot_feat_params — plot_feat_params","title":"Params documentation template: plot_feat_params — plot_feat_params","text":"Params documentation template: plot_feat_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_feat_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Params documentation template: plot_feat_params — plot_feat_params","text":"feats_color_code code color provided features feat_shape_code code shape provided feature types","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_image_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Params documentation template: plot_image_params — plot_image_params","title":"Params documentation template: plot_image_params — plot_image_params","text":"Params documentation template: plot_image_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_image_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Params documentation template: plot_image_params — plot_image_params","text":"show_image show tissue background image gimage giotto image image_name name giotto image multiple images group_by largeImage_name name giottoLargeImage multiple images group_by","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_nn_net_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Params documentation template: plot_nn_net_params — plot_nn_net_params","title":"Params documentation template: plot_nn_net_params — plot_nn_net_params","text":"Params documentation template: plot_nn_net_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_nn_net_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Params documentation template: plot_nn_net_params — plot_nn_net_params","text":"show_NN_network logical. Show underlying NN network nn_network_to_use character. type NN network use (kNN vs sNN) network_name character. name NN network use, show_NN_network = TRUE nn_network_name character. name NN network use, show_NN_network = TRUE network_color color NN network nn_network_alpha column use alpha edges","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_output_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Params documentation template: plot_output_params — plot_output_params","title":"Params documentation template: plot_output_params — plot_output_params","text":"Params documentation template: plot_output_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_output_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Params documentation template: plot_output_params — plot_output_params","text":"show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Params documentation template: plot_params — plot_params","title":"Params documentation template: plot_params — plot_params","text":"Params documentation template: plot_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Params documentation template: plot_params — plot_params","text":"group_by character. Create multiple plots based cell annotation column group_by_subset character. subset group_by factor column gradient_midpoint numeric. midpoint color gradient gradient_style either 'divergent' (midpoint used color scaling) 'sequential' (scaled based data range) gradient_limits numeric vector lower upper limits gradient_color character. continuous colors use. palette use vector colors use (minimum 2). select_cell_groups select subset cells/clusters based cell_color parameter select_cells select subset cells based cell IDs show_other_cells display selected cells other_cell_color color selected cells other_cell_alpha (0 1) alpha selected cells other_cells_alpha (0 1) alpha selected cells other_point_size point size selected cells show_cluster_center plot center selected clusters show_center_label plot label selected clusters center_point_size size center points center_point_border_col border color center points center_point_border_stroke border stroke size center points label_size size labels label_fontface font labels edge_alpha column use alpha edges point_shape point border (border no_border) point_size size point (cell) point_alpha transparency points point_border_col color border around points point_border_stroke stroke size border around points title character. title plot, defaults cell_color parameter show_legend logical. show legend legend_text size legend text legend_symbol_size size legend symbols background_color color plot background axis_text size axis text axis_title size axis title","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_poly_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Params documentation template: plot_poly_params — plot_poly_params","title":"Params documentation template: plot_poly_params — plot_poly_params","text":"Params documentation template: plot_poly_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_poly_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Params documentation template: plot_poly_params — plot_poly_params","text":"show_polygon overlay polygon information (e.g. cell shape) use_overlap use polygon feature coordinates overlap results polygon_feat_type feature type associated polygon information polygon_color color polygon border polygon_bg_color color polygon background (overruled polygon_fill) polygon_fill character. color fill polgyons (e.g. metadata col spatial enrichment col) polygon_fill_gradient polygon fill gradient colors given order low high polygon_fill_gradient_midpoint value set gradient midpoint (optional). left NULL, median value detected chosen polygon_fill_gradient_style either 'divergent' (midpoint used color scaling) 'sequential' (scaled based data range) polygon_fill_as_factor fill color factor polygon_fill_code code color fill column polygon_alpha alpha polygon polygon_line_size line width polygon's outline","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_spatenr_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Params documentation template: plot_spatenr_params — plot_spatenr_params","title":"Params documentation template: plot_spatenr_params — plot_spatenr_params","text":"Params documentation template: plot_spatenr_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_spatenr_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Params documentation template: plot_spatenr_params — plot_spatenr_params","text":"spat_enr_names character. names spatial enrichment results include","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_spatnet_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Params documentation template: plot_spatnet_params — plot_spatnet_params","title":"Params documentation template: plot_spatnet_params — plot_spatnet_params","text":"Params documentation template: plot_spatnet_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/plot_spatnet_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Params documentation template: plot_spatnet_params — plot_spatnet_params","text":"show_spatial_network show spatial network spatial_network_name name spatial network use spat_network_name name spatial network use spat_network_color color spatial network spatial_network_color color spatial network spat_network_alpha alpha spatial network","code":""},{"path":"https://drieslab.github.io/Giotto/reference/processGiotto.html","id":null,"dir":"Reference","previous_headings":"","what":"processGiotto — processGiotto","title":"processGiotto — processGiotto","text":"Wrapper different Giotto object processing functions","code":""},{"path":"https://drieslab.github.io/Giotto/reference/processGiotto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"processGiotto — processGiotto","text":"","code":"processGiotto(   gobject,   filter_params = list(),   norm_params = list(),   stat_params = list(),   adjust_params = list(),   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/processGiotto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"processGiotto — processGiotto","text":"gobject giotto object filter_params additional parameters filterGiotto norm_params additional parameters normalizeGiotto stat_params additional parameters addStatistics adjust_params additional parameters adjustGiottoMatrix; set NULL required verbose verbose (default TRUE)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/processGiotto.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"processGiotto — processGiotto","text":"giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/processGiotto.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"processGiotto — processGiotto","text":"See filterGiotto, normalizeGiotto, addStatistics, adjustGiottoMatrix. information different parameters step. provide use default values. adjustment required, adjust_params must set NULL","code":""},{"path":"https://drieslab.github.io/Giotto/reference/projection_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"projection_fun — projection_fun","title":"projection_fun — projection_fun","text":"project point onto plane","code":""},{"path":"https://drieslab.github.io/Giotto/reference/projection_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"projection_fun — projection_fun","text":"","code":"projection_fun(point_to_project, plane_point, plane_norm)"},{"path":"https://drieslab.github.io/Giotto/reference/projection_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"projection_fun — projection_fun","text":"point_to_project point_to_project plane_point plane_point plane_norm plane_norm","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rankEnrich.html","id":null,"dir":"Reference","previous_headings":"","what":"rankEnrich — rankEnrich","title":"rankEnrich — rankEnrich","text":"Function calculate gene signature enrichment scores per spatial position using rank based approach.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rankEnrich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rankEnrich — rankEnrich","text":"","code":"rankEnrich(...)"},{"path":"https://drieslab.github.io/Giotto/reference/rankEnrich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"rankEnrich — rankEnrich","text":"... Arguments passed runRankEnrich gobject Giotto object spat_unit spatial unit feat_type feature type sign_matrix Matrix signature genes cell type / process expression_values expression values use reverse_log_scale reverse expression values log scale logbase log base use reverse_log_scale = TRUE output_enrichment return enrichment output ties_method handle rank ties p_value calculate p-values (boolean, default = FALSE) n_times number permutations calculate p_value rbp_p fractional binarization threshold (default = 0.99) num_agg number top genes aggregate (default = 100) name give spatial enrichment results, default = rank return_gobject return giotto object","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/rankSpatialCorGroups.html","id":null,"dir":"Reference","previous_headings":"","what":"rankSpatialCorGroups — rankSpatialCorGroups","title":"rankSpatialCorGroups — rankSpatialCorGroups","text":"Rank spatial correlated clusters according correlation structure","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rankSpatialCorGroups.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rankSpatialCorGroups — rankSpatialCorGroups","text":"","code":"rankSpatialCorGroups(   gobject,   spatCorObject,   use_clus_name = NULL,   show_plot = NA,   return_plot = FALSE,   save_plot = NA,   save_param = list(),   default_save_name = \"rankSpatialCorGroups\" )"},{"path":"https://drieslab.github.io/Giotto/reference/rankSpatialCorGroups.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"rankSpatialCorGroups — rankSpatialCorGroups","text":"gobject giotto object spatCorObject spatial correlation object use_clus_name name clusters visualize (clusterSpatialCorGenes()) show_plot show plot return_plot return ggplot object save_plot directly save plot [boolean] save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rankSpatialCorGroups.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"rankSpatialCorGroups — rankSpatialCorGroups","text":"data.table positive (within group) negative (outside group) scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rank_binarize.html","id":null,"dir":"Reference","previous_headings":"","what":"rank_binarize — rank_binarize","title":"rank_binarize — rank_binarize","text":"create binarized scores vector using arbitrary rank","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rank_binarize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rank_binarize — rank_binarize","text":"","code":"rank_binarize(x, max_rank = 200)"},{"path":"https://drieslab.github.io/Giotto/reference/rank_binarize_wrapper.html","id":null,"dir":"Reference","previous_headings":"","what":"rank_binarize_wrapper — rank_binarize_wrapper","title":"rank_binarize_wrapper — rank_binarize_wrapper","text":"wrapper rank binarization function","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rank_binarize_wrapper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rank_binarize_wrapper — rank_binarize_wrapper","text":"","code":"rank_binarize_wrapper(expr_values, subset_feats = NULL, percentage_rank = 30)"},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgen.html","id":null,"dir":"Reference","previous_headings":"","what":"readPolygonFilesVizgen — readPolygonFilesVizgen","title":"readPolygonFilesVizgen — readPolygonFilesVizgen","text":"Read selected polygon files FOVs present Giotto object add smoothed polygons object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"readPolygonFilesVizgen — readPolygonFilesVizgen","text":"","code":"readPolygonFilesVizgen(   gobject,   boundaries_path,   fovs = NULL,   polygon_feat_types = 0:6,   flip_x_axis = F,   flip_y_axis = F,   smooth_polygons = TRUE,   smooth_vertices = 60,   set_neg_to_zero = FALSE,   return_gobject = TRUE,   verbose = TRUE )  h5read_vizgen(   h5File,   z_indices = 1L:7L,   segm_to_use = \"p_0\",   H5Fopen_flags = \"H5F_ACC_RDWR\" )"},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"readPolygonFilesVizgen — readPolygonFilesVizgen","text":"gobject giotto object boundaries_path path cell_boundaries folder fovs selected fovs, NULL select fovs within Giotto object polygon_feat_types vector containing polygon feature types flip_x_axis flip x axis polygon coordinates (multiply -1) flip_y_axis flip y axis polygon coordinates (multiply -1) smooth_polygons smooth polygons (default = TRUE) smooth_vertices number vertices smoothing set_neg_to_zero set negative values zero smoothing return_gobject return giotto object verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgen.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"readPolygonFilesVizgen — readPolygonFilesVizgen","text":"h5read_vizgen(): (internal) Optimized .hdf5 reading vizgen merscope output. Returns data.table xyz coords cell_id","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgenHDF5.html","id":null,"dir":"Reference","previous_headings":"","what":"readPolygonFilesVizgenHDF5 — readPolygonFilesVizgenHDF5","title":"readPolygonFilesVizgenHDF5 — readPolygonFilesVizgenHDF5","text":"Read polygon info cells selected FOVs Vizgen HDF5 files. Data returned list giottoPolygons data.tables requested z indices.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgenHDF5.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"readPolygonFilesVizgenHDF5 — readPolygonFilesVizgenHDF5","text":"","code":"readPolygonFilesVizgenHDF5(   boundaries_path,   fovs = NULL,   z_indices = 1L:7L,   segm_to_use = 1L,   custom_polygon_names = NULL,   flip_x_axis = FALSE,   flip_y_axis = TRUE,   calc_centroids = FALSE,   smooth_polygons = TRUE,   smooth_vertices = 60L,   set_neg_to_zero = FALSE,   H5Fopen_flags = \"H5F_ACC_RDWR\",   cores = determine_cores(),   create_gpoly_parallel = TRUE,   create_gpoly_bin = FALSE,   verbose = TRUE,   output = c(\"giottoPolygon\", \"data.table\"),   polygon_feat_types = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgenHDF5.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"readPolygonFilesVizgenHDF5 — readPolygonFilesVizgenHDF5","text":"boundaries_path path cell_boundaries folder fovs subset fovs use z_indices z indices polygons use segm_to_use segmentation results use (usually = 1. Depends alternative segmentations generated) custom_polygon_names character vector provide custom polygon names (optional) flip_x_axis flip x axis polygon coordinates (multiply -1) flip_y_axis flip y axis polygon coordinates (multiply -1) calc_centroids calculate centroids (default = FALSE) smooth_polygons smooth polygons (default = TRUE) smooth_vertices number vertices smoothing set_neg_to_zero set negative values zero smoothing H5Fopen_flags see H5Fopen details cores cores use create_gpoly_parallel (default = TRUE) Whether run gpoly creation parallel create_gpoly_bin (Optional, default = FALSE) Parallelization option. Accepts integer values binning size generating giottoPolygon objects verbose verbose output whether return list giottoPolygon data.table polygon_feat_types deprecated. Use z_indices","code":""},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgenHDF5.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"readPolygonFilesVizgenHDF5 — readPolygonFilesVizgenHDF5","text":"Set H5Fopen_flags \"H5F_ACC_RDONLY\" encounter permission issues.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgenHDF5_old.html","id":null,"dir":"Reference","previous_headings":"","what":"readPolygonFilesVizgenHDF5 — readPolygonFilesVizgenHDF5_old","title":"readPolygonFilesVizgenHDF5 — readPolygonFilesVizgenHDF5_old","text":"Read create polygons cells, selected FOVs.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgenHDF5_old.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"readPolygonFilesVizgenHDF5 — readPolygonFilesVizgenHDF5_old","text":"","code":"readPolygonFilesVizgenHDF5_old(   boundaries_path,   fovs = NULL,   polygon_feat_types = 0:6,   custom_polygon_names = NULL,   flip_x_axis = F,   flip_y_axis = F,   smooth_polygons = TRUE,   smooth_vertices = 60,   set_neg_to_zero = FALSE,   H5Fopen_flags = \"H5F_ACC_RDWR\",   cores = NA,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgenHDF5_old.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"readPolygonFilesVizgenHDF5 — readPolygonFilesVizgenHDF5_old","text":"boundaries_path path cell_boundaries folder fovs subset fovs use polygon_feat_types vector containing polygon feature types custom_polygon_names character vector provide custom polygon names (optional) flip_x_axis flip x axis polygon coordinates (multiply -1) flip_y_axis flip y axis polygon coordinates (multiply -1) smooth_polygons smooth polygons (default = TRUE) smooth_vertices number vertices smoothing set_neg_to_zero set negative values zero smoothing H5Fopen_flags see H5Fopen details cores cores use verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonFilesVizgenHDF5_old.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"readPolygonFilesVizgenHDF5 — readPolygonFilesVizgenHDF5_old","text":"Set H5Fopen_flags \"H5F_ACC_RDONLY\" encounter permission issues.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonVizgenParquet.html","id":null,"dir":"Reference","previous_headings":"","what":"Read MERSCOPE polygons from parquet — readPolygonVizgenParquet","title":"Read MERSCOPE polygons from parquet — readPolygonVizgenParquet","text":"Read Vizgen exported cell boundary parquet files giottoPolyons. z level can selected.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonVizgenParquet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read MERSCOPE polygons from parquet — readPolygonVizgenParquet","text":"","code":"readPolygonVizgenParquet(file, z_index = \"all\", verbose = TRUE)"},{"path":"https://drieslab.github.io/Giotto/reference/readPolygonVizgenParquet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read MERSCOPE polygons from parquet — readPolygonVizgenParquet","text":"file parquet file load z_index either '' numeric vector z_indices get polygons verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_cosmx_folder.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a structured CosMx folder — read_cosmx_folder","title":"Read a structured CosMx folder — read_cosmx_folder","text":"Read structured CosMx folder","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_cosmx_folder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a structured CosMx folder — read_cosmx_folder","text":"","code":"read_cosmx_folder(cosmx_dir, verbose = TRUE)"},{"path":"https://drieslab.github.io/Giotto/reference/read_cosmx_folder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a structured CosMx folder — read_cosmx_folder","text":"cosmx_dir full path exported cosmx directory verbose verbose building Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_cosmx_folder.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a structured CosMx folder — read_cosmx_folder","text":"path_list list cosmx files discovered filepaths. NULL values denote missing items","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/read_crossSection.html","id":null,"dir":"Reference","previous_headings":"","what":"read_crossSection — read_crossSection","title":"read_crossSection — read_crossSection","text":"read cross section object giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_crossSection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"read_crossSection — read_crossSection","text":"","code":"read_crossSection(gobject, name = NULL, spatial_network_name = NULL)"},{"path":"https://drieslab.github.io/Giotto/reference/read_crossSection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"read_crossSection — read_crossSection","text":"gobject gobject name name spatial_network_name spatial_network_name","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_data_folder.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a structured folder of exported data — read_data_folder","title":"Read a structured folder of exported data — read_data_folder","text":"Read exported folder spatial method detect presence needed files. NULL values denote missing items.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_data_folder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a structured folder of exported data — read_data_folder","text":"","code":"read_data_folder(   spat_method = NULL,   data_dir = NULL,   dir_items,   data_to_use,   load_format = NULL,   require_data_DT,   cores = NA,   verbose = TRUE )  read_merscope_folder(merscope_dir, data_to_use, cores = NA, verbose = TRUE)"},{"path":"https://drieslab.github.io/Giotto/reference/read_data_folder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a structured folder of exported data — read_data_folder","text":"spat_method spatial method data read data_dir exported data directory read dir_items named list directory items expect keywords match data_to_use type(s) expression data build gobject require_data_DT data.table detailing expected data items required optional data_to_use workflow cores cores use verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_data_folder.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read a structured folder of exported data — read_data_folder","text":"Steps performed: 1. detection items within data_dir looking keywords   assigned dir_items 2. check detected items see everything needed found.   Dictionary necessary vs optional items data_to_use workflow   provided require_data_DT 3. multiple filepaths found matching select first   one. function intended find first level subdirectories   files.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_data_folder.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Read a structured folder of exported data — read_data_folder","text":"read_merscope_folder(): Read structured MERSCOPE folder","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_data_params.html","id":null,"dir":"Reference","previous_headings":"","what":"read_data_params — read_data_params","title":"read_data_params — read_data_params","text":"read_data_params","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_data_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"read_data_params — read_data_params","text":"data_list (nested) list input data read default_spat_unit (optional) default spat_unit use default_feat_type (optional) default feat_type use provenance (optional) provenance information verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_xenium_folder.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a structured xenium folder — read_xenium_folder","title":"Read a structured xenium folder — read_xenium_folder","text":"Read structured xenium folder","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_xenium_folder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a structured xenium folder — read_xenium_folder","text":"","code":"read_xenium_folder(   xenium_dir,   data_to_use = \"subcellular\",   bounds_to_load = c(\"cell\"),   load_format = \"csv\",   h5_expression = FALSE,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/read_xenium_folder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a structured xenium folder — read_xenium_folder","text":"xenium_dir full path exported xenium directory data_to_use type(s) expression data build gobject (e.g. default: 'subcellular', 'aggregate', '') bounds_to_load vector boundary information load (e.g. 'cell' 'nucleus' c('cell', 'nucleus') load time.) load_format files formats load data. Either `csv` `parquet` currently supported. h5_expression (boolean) whether load cell_feature_matrix .h5 file. Default TRUE verbose verbose building Giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/read_xenium_folder.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a structured xenium folder — read_xenium_folder","text":"path_list list xenium files discovered filepaths. NULL values denote missing items","code":""},{"path":"https://drieslab.github.io/Giotto/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. GiottoClass addCellMetadata, addGiottoImage, addGiottoImageMG, addGiottoLargeImage, addGiottoPoints, addGiottoPoints3D, addGiottoPolygons, addSpatialCentroidLocations, addSpatialCentroidLocationsLayer, aggregateStacks, aggregateStacksExpression, aggregateStacksLocations, aggregateStacksPolygonOverlaps, aggregateStacksPolygons, aggregateStacksPolygonsOLD, anndataToGiotto, annotateGiotto, annotateSpatialGrid, annotateSpatialNetwork, calculateMetaTable, calculateMetaTableCells, calculateOverlapParallel, calculateOverlapPolygonImages, calculateOverlapRaster, calculateOverlapSerial, changeGiottoInstructions, changeImageBg, circleVertices, combineCellData, combineFeatureData, combineFeatureOverlapData, combineMetadata, combineSpatialCellFeatureInfo, combineSpatialCellMetadataInfo, convertGiottoLargeImageToMG, createCellMetaObj, createDimObj, createExprObj, createFeatMetaObj, createGiottoImage, createGiottoInstructions, createGiottoLargeImage, createGiottoLargeImageList, createGiottoObject, createGiottoObjectSubcellular, createGiottoPoints, createGiottoPolygonsFromDfr, createGiottoPolygonsFromGeoJSON, createGiottoPolygonsFromMask, createMetafeats, createNearestNetObj, createSpatEnrObj, createSpatialDefaultGrid, createSpatialDelaunayNetwork, createSpatialFeaturesKNNnetwork, createSpatialGrid, createSpatialKNNnetwork, createSpatialNetwork, createSpatialWeightMatrix, createSpatLocsObj, createSpatNetObj, cropGiottoLargeImage, distGiottoImage, estimateImageBg, fDataDT, featType, featureNetwork, gefToGiotto, get_dimReduction, get_dimReduction, get_feature_info, get_feature_info, get_giottoImage, get_giottoImage, get_multiomics, get_multiomics, get_NearestNetwork, get_NearestNetwork, get_polygon_info, get_polygon_info, get_spatial_enrichment, get_spatial_enrichment, get_spatial_locations, get_spatial_locations, get_spatialGrid, get_spatialGrid, get_spatialNetwork, get_spatialNetwork, getCellMetadata, getDimReduction, getExpression, getFeatureInfo, getFeatureMetadata, getGiottoImage, getMultiomics, getNearestNetwork, getPolygonInfo, getRainbowColors, getSpatialEnrichment, getSpatialEnrichment, getSpatialGrid, getSpatialGrid, getSpatialLocations, getSpatialLocations, getSpatialNetwork, getSpatialNetwork, giotto, giottoImage, giottoLargeImage, giottoMasterToSuite, giottoPoints, giottoPolygon, giottoToAnnData, giottoToSeurat, giottoToSpatialExperiment, hexVertices, joinGiottoObjects, loadGiotto, makePseudoVisium, objHistory, objName, overlapImagesToMatrix, overlapToMatrix, overlapToMatrixMultiPoly, pDataDT, plotGiottoImage, polyStamp, prov, readCellMetadata, readDimReducData, readExprData, readExprMatrix, readFeatData, readFeatMetadata, readGiottoInstructions, readNearestNetData, readPolygonData, readSpatEnrichData, readSpatLocsData, readSpatNetData, reconnectGiottoImage, rectVertices, removeCellAnnotation, removeFeatAnnotation, replaceGiottoInstructions, rescalePolygons, saveGiotto, set_dimReduction, set_expression_values, set_feature_info, set_giottoImage, set_multiomics, set_NearestNetwork, set_polygon_info, set_spatial_enrichment, set_spatial_locations, set_spatialGrid, set_spatialNetwork, setDimReduction, setExpression, setFeatureInfo, setGiottoImage, setMultiomics, setNearestNetwork, setPolygonInfo, setSpatialEnrichment, setSpatialGrid, setSpatialLocations, setSpatialNetwork, seuratToGiotto, showGiottoCellMetadata, showGiottoDimRed, showGiottoExpression, showGiottoFeatInfo, showGiottoFeatMetadata, showGiottoImageNames, showGiottoInstructions, showGiottoNearestNetworks, showGiottoSpatEnrichments, showGiottoSpatGrids, showGiottoSpatialInfo, showGiottoSpatLocs, showGiottoSpatNetworks, showGrids, showNetworks, showProcessingSteps GiottoUtils %>% GiottoVisuals dimCellPlot2D, dimFeatPlot2D, dimGenePlot3D, dimPlot, dimPlot2D, dimPlot3D, getDistinctColors, plotHeatmap, plotMetaDataCellsHeatmap, plotMetaDataHeatmap, plotPCA, plotPCA_2D, plotPCA_3D, plotStatDelaunayNetwork, plotTSNE, plotTSNE_2D, plotTSNE_3D, plotUMAP, plotUMAP_2D, plotUMAP_3D, showClusterDendrogram, showClusterHeatmap, showSaveParameters","code":""},{"path":"https://drieslab.github.io/Giotto/reference/reg_img_minmax_finder.html","id":null,"dir":"Reference","previous_headings":"","what":"reg_img_minmax_finder — reg_img_minmax_finder","title":"reg_img_minmax_finder — reg_img_minmax_finder","text":"finds new minmax boundaries registration transformed images","code":""},{"path":"https://drieslab.github.io/Giotto/reference/reg_img_minmax_finder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"reg_img_minmax_finder — reg_img_minmax_finder","text":"","code":"reg_img_minmax_finder(   gobject_list,   image_unreg = NULL,   largeImage_unreg = NULL,   scale_factor,   transform_values,   method )"},{"path":"https://drieslab.github.io/Giotto/reference/reg_img_minmax_finder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"reg_img_minmax_finder — reg_img_minmax_finder","text":"gobject_list list gobjects use image_unreg name original unregistered images largeImage_unreg name original unregistered largeImages scale_factor scale factors registered images relative spatlocs. transform_values transformation values use method method registration","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectList.html","id":null,"dir":"Reference","previous_headings":"","what":"registerGiottoObjectList — registerGiottoObjectList","title":"registerGiottoObjectList — registerGiottoObjectList","text":"Wrapper function registerGiottoObjectListFiji registerGiottoObjectListRvision","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectList.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"registerGiottoObjectList — registerGiottoObjectList","text":"","code":"registerGiottoObjectList(   gobject_list,   spat_unit = NULL,   method = c(\"fiji\", \"rvision\"),   image_unreg = \"image\",   image_reg_name = \"image\",   image_list = NULL,   save_dir = NULL,   spatloc_unreg = \"raw\",   spatloc_reg_name = \"raw\",   fiji_xml_files,   fiji_registered_images,   scale_factor = NULL,   allow_rvision_autoscale = TRUE,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectList.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"registerGiottoObjectList — registerGiottoObjectList","text":"gobject_list List gobjects register spat_unit spatial unit method Method used align gobjects. Current options either using FIJI register_virtual_stack_slices output rvision image_unreg Gobject image slot use. Defaults 'image' (optional) image_reg_name Arbitrary image slot name registered images occupy. Defaults replacement 'image' slot (optional) image_list RVISION - construction save_dir RVISION - construction spatloc_unreg Unregistered spatial locations align. Defaults 'raw' slot (optional) spatloc_reg_name Arbitrary name registered spatial locations. Defaults replacement 'raw' slot (optional) fiji_xml_files Filepaths FIJI registration XML outputs fiji_registered_images Registered images output FIJI register_virtual_stack_slices scale_factor Scaling applied spatial coordinates allow_rvision_autoscale Whether allow rvision automatically scale images performing image registration verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectList.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"registerGiottoObjectList — registerGiottoObjectList","text":"List registered giotto objects registered images spatial locations","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectListFiji.html","id":null,"dir":"Reference","previous_headings":"","what":"registerGiottoObjectListFiji — registerGiottoObjectListFiji","title":"registerGiottoObjectListFiji — registerGiottoObjectListFiji","text":"Function spatially align gobject data based FIJI image registration.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectListFiji.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"registerGiottoObjectListFiji — registerGiottoObjectListFiji","text":"","code":"registerGiottoObjectListFiji(   gobject_list,   spat_unit = NULL,   image_unreg = \"image\",   image_reg_name = \"image\",   image_replace_name = \"unregistered\",   registered_images = NULL,   spatloc_unreg = \"raw\",   spatloc_reg_name = \"raw\",   spatloc_replace_name = \"unregistered\",   xml_files,   scale_factor = NULL,   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectListFiji.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"registerGiottoObjectListFiji — registerGiottoObjectListFiji","text":"gobject_list list gobjects register spat_unit spatial unit image_unreg name original unregistered images. Defaults 'image' (optional) image_reg_name arbitrary name registered images occupy. Defaults replacement 'image' (optional) image_replace_name arbitrary name images replaced due image_reg_name argument (optional) registered_images registered images output FIJI register_virtual_stack_slices spatloc_unreg spatial locations use. Defaults 'raw' (optional) spatloc_reg_name name registered spatial locations. Defaults replacement 'raw' (optional) spatloc_replace_name arbitrary name spatial locations replaced due spatloc_reg_name argument (optional) xml_files atomic vector filepaths xml outputs FIJI register_virtual_stack_slices scale_factor vector scaling factors images used registration vs spatlocs verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectListFiji.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"registerGiottoObjectListFiji — registerGiottoObjectListFiji","text":"list registered giotto objects registered images spatial locations","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectListRvision.html","id":null,"dir":"Reference","previous_headings":"","what":"registerGiottoObjectListRvision — registerGiottoObjectListRvision","title":"registerGiottoObjectListRvision — registerGiottoObjectListRvision","text":"Function spatially align gobject data based Rvision image registration.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectListRvision.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"registerGiottoObjectListRvision — registerGiottoObjectListRvision","text":"","code":"registerGiottoObjectListRvision(   gobject_list = gobject_list,   image_list = NULL,   save_dir = NULL,   spatloc_unreg = NULL,   spatloc_reg_name = \"raw\",   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectListRvision.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"registerGiottoObjectListRvision — registerGiottoObjectListRvision","text":"gobject_list list gobjects register image_list Filepaths unregistered images save_dir (Optional) given, save registered images directory spatloc_unreg spatial locations use spatloc_reg_name name registered spatial locations . Defaults replacement spat_unreg (optional) verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerGiottoObjectListRvision.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"registerGiottoObjectListRvision — registerGiottoObjectListRvision","text":"list registered giotto objects registered images spatial locations","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerImagesFIJI.html","id":null,"dir":"Reference","previous_headings":"","what":"registerImagesFIJI — registerImagesFIJI","title":"registerImagesFIJI — registerImagesFIJI","text":"Wrapper function Register Virtual Stack Slices plugin FIJI","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerImagesFIJI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"registerImagesFIJI — registerImagesFIJI","text":"","code":"registerImagesFIJI(   source_img_dir,   output_img_dir,   transforms_save_dir,   ref_img_name,   init_gauss_blur = 1.6,   steps_per_scale_octave = 3,   min_img_size = 64,   max_img_size = 1024,   feat_desc_size = 8,   feat_desc_orient_bins = 8,   closest_next_closest_ratio = 0.92,   max_align_err = 25,   inlier_ratio = 0.05,   headless = FALSE,   batch = TRUE,   MinMem = MaxMem,   MaxMem = 2500,   IncrementalGC = TRUE,   Threads = NULL,   fijiArgs = NULL,   javaArgs = NULL,   ijArgs = NULL,   jython = FALSE,   fijiPath = fiji(),   DryRun = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/registerImagesFIJI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"registerImagesFIJI — registerImagesFIJI","text":"source_img_dir Folder containing images registered output_img_dir Folder save registered images transforms_save_dir (jython implementation ) Folder save transforms ref_img_name (jython implementation ) File name reference image registration init_gauss_blur Point detector option: initial image blurring steps_per_scale_octave Point detector option min_img_size Point detector option max_img_size Point detector option feat_desc_size Feature descriptor option feat_desc_orient_bins Feature descriptor option closest_next_closest_ratio Feature descriptor option max_align_err Geometric consensus filter option inlier_ratio Geometric consensus filter option headless Whether ImageJ/Fiji running headless #TODO batch Use batch mode #TODO MinMem, MaxMem Memory limits IncrementalGC Whether use incremental garbage collection Threads Number threads fijiArgs Arguments ImageJ/FIJI javaArgs Arguments Java ijArgs Arguments ImageJ jython Use jython wrapper script fijiPath Path fiji executable (can set options(giotto.fiji=\"//path\")) DryRun Whether return command run rather actually executing .","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerImagesFIJI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"registerImagesFIJI — registerImagesFIJI","text":"list registered giotto objects registered images spatial locations","code":""},{"path":"https://drieslab.github.io/Giotto/reference/registerImagesFIJI.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"registerImagesFIJI — registerImagesFIJI","text":"function adapted runFijiMacro function jimpipeline jefferislab","code":""},{"path":"https://drieslab.github.io/Giotto/reference/reshape_to_data_point.html","id":null,"dir":"Reference","previous_headings":"","what":"reshape_to_data_point — reshape_to_data_point","title":"reshape_to_data_point — reshape_to_data_point","text":"reshape mesh grid line object data point matrix","code":""},{"path":"https://drieslab.github.io/Giotto/reference/reshape_to_data_point.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"reshape_to_data_point — reshape_to_data_point","text":"","code":"reshape_to_data_point(mesh_grid_obj)"},{"path":"https://drieslab.github.io/Giotto/reference/reshape_to_data_point.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"reshape_to_data_point — reshape_to_data_point","text":"mesh_grid_obj mesh_grid_obj","code":""},{"path":"https://drieslab.github.io/Giotto/reference/reshape_to_mesh_grid_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"reshape_to_mesh_grid_obj — reshape_to_mesh_grid_obj","title":"reshape_to_mesh_grid_obj — reshape_to_mesh_grid_obj","text":"reshape data point matrix mesh grid line object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/reshape_to_mesh_grid_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"reshape_to_mesh_grid_obj — reshape_to_mesh_grid_obj","text":"","code":"reshape_to_mesh_grid_obj(data_points, mesh_grid_n)"},{"path":"https://drieslab.github.io/Giotto/reference/reshape_to_mesh_grid_obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"reshape_to_mesh_grid_obj — reshape_to_mesh_grid_obj","text":"data_points data_points mesh_grid_n mesh_grid_n","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rigid_transform_spatial_locations.html","id":null,"dir":"Reference","previous_headings":"","what":"rigid_transform_spatial_locations — rigid_transform_spatial_locations","title":"rigid_transform_spatial_locations — rigid_transform_spatial_locations","text":"Performs appropriate transforms align spatial locations registered images.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rigid_transform_spatial_locations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rigid_transform_spatial_locations — rigid_transform_spatial_locations","text":"","code":"rigid_transform_spatial_locations(spatlocs, transform_values, method)"},{"path":"https://drieslab.github.io/Giotto/reference/rigid_transform_spatial_locations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"rigid_transform_spatial_locations — rigid_transform_spatial_locations","text":"spatlocs input spatial locations transform_values transformation values use method method used image registration","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rna_osmfish_normalization.html","id":null,"dir":"Reference","previous_headings":"","what":"RNA osmfish normalization — rna_osmfish_normalization","title":"RNA osmfish normalization — rna_osmfish_normalization","text":"function RNA normalization according osmFISH paper","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rna_osmfish_normalization.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RNA osmfish normalization — rna_osmfish_normalization","text":"","code":"rna_osmfish_normalization(   gobject,   raw_expr,   feat_type,   spat_unit,   name = \"custom\",   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/rna_pears_resid_normalization.html","id":null,"dir":"Reference","previous_headings":"","what":"RNA pearson residuals normalization — rna_pears_resid_normalization","title":"RNA pearson residuals normalization — rna_pears_resid_normalization","text":"function RNA normalization according Lause/Kobak et al paper Adapted https://gist.github.com/hypercompetent/51a3c428745e1c06d826d76c3671797c#file-pearson_residuals-r","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rna_pears_resid_normalization.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RNA pearson residuals normalization — rna_pears_resid_normalization","text":"","code":"rna_pears_resid_normalization(   gobject,   raw_expr,   feat_type,   spat_unit,   theta = 100,   name = \"scaled\",   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/rna_standard_normalization.html","id":null,"dir":"Reference","previous_headings":"","what":"RNA standard normalization — rna_standard_normalization","title":"RNA standard normalization — rna_standard_normalization","text":"standard function RNA normalization","code":""},{"path":"https://drieslab.github.io/Giotto/reference/rna_standard_normalization.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RNA standard normalization — rna_standard_normalization","text":"","code":"rna_standard_normalization(   gobject,   raw_expr,   feat_type,   spat_unit,   library_size_norm = TRUE,   scalefactor = 6000,   log_norm = TRUE,   log_offset = 1,   logbase = 2,   scale_feats = TRUE,   scale_cells = TRUE,   scale_order = c(\"first_feats\", \"first_cells\"),   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/runDWLSDeconv.html","id":null,"dir":"Reference","previous_headings":"","what":"runDWLSDeconv — runDWLSDeconv","title":"runDWLSDeconv — runDWLSDeconv","text":"Function perform DWLS deconvolution based single cell expression data","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runDWLSDeconv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runDWLSDeconv — runDWLSDeconv","text":"","code":"runDWLSDeconv(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\"),   logbase = 2,   cluster_column = \"leiden_clus\",   sign_matrix,   n_cell = 50,   cutoff = 2,   name = NULL,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/runDWLSDeconv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runDWLSDeconv — runDWLSDeconv","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use logbase base used log normalization cluster_column name cluster column sign_matrix sig matrix deconvolution n_cell number cells per spot cutoff cut (default = 2) name name give spatial deconvolution results, default = DWLS return_gobject return giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runDWLSDeconv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runDWLSDeconv — runDWLSDeconv","text":"giotto object deconvolution results","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/runFijiMacro.html","id":null,"dir":"Reference","previous_headings":"","what":"Find Fiji location — fiji","title":"Find Fiji location — fiji","text":"fiji returns path preferred Fiji executable.    function modified jimpipeline jefferislab","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runFijiMacro.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find Fiji location — fiji","text":"","code":"fiji(fijiPath = NULL)"},{"path":"https://drieslab.github.io/Giotto/reference/runFijiMacro.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find Fiji location — fiji","text":"fijiPath manually set filepath Fiji executable","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runFijiMacro.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find Fiji location — fiji","text":"","code":"if (FALSE) { # Path to current Fiji executable fiji()  # Set path to preferred Fiji executable (this will be remembered) # you can also set options(giotto.fiji=\"/some/path\") fiji(\"/Applications/Fiji.app/Contents/MacOS/ImageJ-macosx\") }"},{"path":"https://drieslab.github.io/Giotto/reference/runGiottoHarmony.html","id":null,"dir":"Reference","previous_headings":"","what":"runGiottoHarmony — runGiottoHarmony","title":"runGiottoHarmony — runGiottoHarmony","text":"run UMAP","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runGiottoHarmony.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runGiottoHarmony — runGiottoHarmony","text":"","code":"runGiottoHarmony(   gobject,   spat_unit = NULL,   feat_type = NULL,   vars_use = \"list_ID\",   do_pca = FALSE,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reduction = \"cells\",   dim_reduction_to_use = \"pca\",   dim_reduction_name = NULL,   dimensions_to_use = 1:10,   name = NULL,   feats_to_use = NULL,   toplevel_params = 2,   return_gobject = TRUE,   verbose = NULL,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runGiottoHarmony.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runGiottoHarmony — runGiottoHarmony","text":"gobject giotto object spat_unit spatial unit feat_type feature type vars_use meta_data dataframe, defines variable(s) remove (character vector). do_pca Whether perform PCA input matrix. expression_values expression values use reduction reduction cells features dim_reduction_to_use use another dimension reduction set input dim_reduction_name name dimension reduction set use dimensions_to_use number dimensions use input name arbitrary name Harmony run feats_to_use dim_reduction_to_use = NULL, feats use toplevel_params parameters extract return_gobject boolean: return giotto object (default = TRUE) verbose verbose ... additional HarmonyMatrix parameters","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runGiottoHarmony.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runGiottoHarmony — runGiottoHarmony","text":"giotto object updated Harmony dimension recuction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runGiottoHarmony.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"runGiottoHarmony — runGiottoHarmony","text":"simple wrapper HarmonyMatrix function Harmony package doi:10.1038/s41592-019-0619-0 .","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runHyperGeometricEnrich.html","id":null,"dir":"Reference","previous_headings":"","what":"runHyperGeometricEnrich — runHyperGeometricEnrich","title":"runHyperGeometricEnrich — runHyperGeometricEnrich","text":"Function calculate gene signature enrichment scores per spatial position using hypergeometric test.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runHyperGeometricEnrich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runHyperGeometricEnrich — runHyperGeometricEnrich","text":"","code":"runHyperGeometricEnrich(   gobject,   spat_unit = NULL,   feat_type = NULL,   sign_matrix,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reverse_log_scale = TRUE,   logbase = 2,   top_percentage = 5,   output_enrichment = c(\"original\", \"zscore\"),   p_value = FALSE,   name = NULL,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/runHyperGeometricEnrich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runHyperGeometricEnrich — runHyperGeometricEnrich","text":"gobject Giotto object spat_unit spatial unit feat_type feature type sign_matrix Matrix signature genes cell type / process expression_values expression values use reverse_log_scale reverse expression values log scale logbase log base use reverse_log_scale = TRUE top_percentage percentage cells considered gene expression matrix binarization output_enrichment return enrichment output p_value calculate p-values (boolean, default = FALSE) name give spatial enrichment results, default = hypergeometric return_gobject return giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runHyperGeometricEnrich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runHyperGeometricEnrich — runHyperGeometricEnrich","text":"data.table enrichment results","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runHyperGeometricEnrich.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"runHyperGeometricEnrich — runHyperGeometricEnrich","text":"enrichment score calculated based p-value hypergeometric test, -log10(p-value).","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runIntegratedUMAP.html","id":null,"dir":"Reference","previous_headings":"","what":"Run integrated UMAP — runIntegratedUMAP","title":"Run integrated UMAP — runIntegratedUMAP","text":"Run integrated UMAP","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runIntegratedUMAP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run integrated UMAP — runIntegratedUMAP","text":"","code":"runIntegratedUMAP(   gobject,   spat_unit = \"cell\",   modality1 = \"rna\",   modality2 = \"protein\",   integrated_feat_type = NULL,   integration_method = \"WNN\",   matrix_result_name = \"theta_weighted_matrix\",   k = 20,   spread = 5,   min_dist = 0.01,   force = FALSE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runIntegratedUMAP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run integrated UMAP — runIntegratedUMAP","text":"gobject giotto object spat_unit spatial unit modality1 modality 1 name. Default = \"rna\" modality2 modality 2 name. Default = \"protein\" integrated_feat_type integrated feature type (e.g. 'rna_protein') integration_method multiomics integration method used. Default = 'WNN' matrix_result_name Default = 'theta_weighted_matrix' k k number spread UMAP param: spread min_dist UMAP param: min_dist force force calculation integrated kNN. Default = FALSE ... additional UMAP parameters","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runIntegratedUMAP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run integrated UMAP — runIntegratedUMAP","text":"Giotto object integrated UMAP","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPAGEEnrich.html","id":null,"dir":"Reference","previous_headings":"","what":"runPAGEEnrich — runPAGEEnrich","title":"runPAGEEnrich — runPAGEEnrich","text":"Function calculate gene signature enrichment scores per spatial position using PAGE.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPAGEEnrich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runPAGEEnrich — runPAGEEnrich","text":"","code":"runPAGEEnrich(   gobject,   spat_unit = NULL,   feat_type = NULL,   sign_matrix,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   min_overlap_genes = 5,   reverse_log_scale = TRUE,   logbase = 2,   output_enrichment = c(\"original\", \"zscore\"),   p_value = FALSE,   include_depletion = FALSE,   n_times = 1000,   max_block = 2e+07,   name = NULL,   verbose = TRUE,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/runPAGEEnrich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runPAGEEnrich — runPAGEEnrich","text":"gobject Giotto object spat_unit spatial unit feat_type feature type sign_matrix Matrix signature genes cell type / process expression_values expression values use min_overlap_genes minimum number overlapping genes sign_matrix required calculate enrichment reverse_log_scale reverse expression values log scale logbase log base use reverse_log_scale = TRUE output_enrichment return enrichment output p_value calculate p-values (boolean, default = FALSE) include_depletion calculate enrichment depletion n_times number permutations calculate p_value max_block number lines process together (default = 20e6) name give spatial enrichment results, default = PAGE verbose verbose return_gobject return giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPAGEEnrich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runPAGEEnrich — runPAGEEnrich","text":"data.table enrichment results","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPAGEEnrich.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"runPAGEEnrich — runPAGEEnrich","text":"sign_matrix: binary matrix genes row names cell-types column names. Alternatively list signature genes can provided makeSignMatrixPAGE, create matrix . enrichment Z score calculated using method (PAGE) Kim SY et al., BMC bioinformatics, 2005 \\(Z = ((Sm – mu)*m^(1/2)) / delta\\). gene spot, mu fold change values versus mean expression delta standard deviation. Sm mean fold change value specific marker gene set  m size given marker gene set.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/runPAGEEnrich_OLD.html","id":null,"dir":"Reference","previous_headings":"","what":"runPAGEEnrich_OLD — runPAGEEnrich_OLD","title":"runPAGEEnrich_OLD — runPAGEEnrich_OLD","text":"Function calculate gene signature enrichment scores per spatial position using PAGE.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPAGEEnrich_OLD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runPAGEEnrich_OLD — runPAGEEnrich_OLD","text":"","code":"runPAGEEnrich_OLD(   gobject,   sign_matrix,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reverse_log_scale = TRUE,   logbase = 2,   output_enrichment = c(\"original\", \"zscore\"),   p_value = FALSE,   n_times = 1000,   name = NULL,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/runPAGEEnrich_OLD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runPAGEEnrich_OLD — runPAGEEnrich_OLD","text":"gobject Giotto object sign_matrix Matrix signature genes cell type / process expression_values expression values use reverse_log_scale reverse expression values log scale logbase log base use reverse_log_scale = TRUE output_enrichment return enrichment output p_value calculate p-values (boolean, default = FALSE) n_times number permutations calculate p_value name give spatial enrichment results, default = PAGE return_gobject return giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPAGEEnrich_OLD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runPAGEEnrich_OLD — runPAGEEnrich_OLD","text":"data.table enrichment results","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPAGEEnrich_OLD.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"runPAGEEnrich_OLD — runPAGEEnrich_OLD","text":"sign_matrix: binary matrix genes row names cell-types column names. Alternatively list signature genes can provided makeSignMatrixPAGE, create matrix . enrichment Z score calculated using method (PAGE) Kim SY et al., BMC bioinformatics, 2005 \\(Z = ((Sm – mu)*m^(1/2)) / delta\\). gene spot, mu fold change values versus mean expression delta standard deviation. Sm mean fold change value specific marker gene set  m size given marker gene set.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/runPCA.html","id":null,"dir":"Reference","previous_headings":"","what":"runPCA — runPCA","title":"runPCA — runPCA","text":"runs Principal Component Analysis","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runPCA — runPCA","text":"","code":"runPCA(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reduction = c(\"cells\", \"feats\"),   name = NULL,   feats_to_use = \"hvf\",   return_gobject = TRUE,   center = TRUE,   scale_unit = TRUE,   ncp = 100,   method = c(\"irlba\", \"exact\", \"random\", \"factominer\"),   method_params = BiocParallel::SerialParam(),   rev = FALSE,   set_seed = TRUE,   seed_number = 1234,   verbose = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runPCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runPCA — runPCA","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use reduction cells genes name arbitrary name PCA run feats_to_use subset features use PCA return_gobject boolean: return giotto object (default = TRUE) center center data first (default = TRUE) scale_unit scale features PCA (default = TRUE) ncp number principal components calculate (see details) method implementation use method_params BiocParallelParam object rev reverse PCA set_seed use seed seed_number seed number use verbose verbosity function ... additional parameters PCA (see details)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runPCA — runPCA","text":"giotto object updated PCA dimension recuction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"runPCA — runPCA","text":"See runPCA PCA information parameters. feats_to_use param, can control features used calculate PCA, can useful making sure downstream dimension reduction clusterings based features interest. feats_to_use = NULL: use features selected matrix feats_to_use = <hvg name>: can used select column name   highly variable features, created (see calculateHVF) feats_to_use = c('geneA', 'geneB', ...): use manually provided features default number principle components calculate 100, may encompass variation within dataset. Setting ncp NULL calculate principle components.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_BiocSingular.html","id":null,"dir":"Reference","previous_headings":"","what":"runPCA_BiocSingular — runPCA_BiocSingular","title":"runPCA_BiocSingular — runPCA_BiocSingular","text":"Performs PCA based biocSingular package","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_BiocSingular.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runPCA_BiocSingular — runPCA_BiocSingular","text":"","code":"runPCA_BiocSingular(   x,   ncp = 100,   center = TRUE,   scale = TRUE,   rev = FALSE,   set_seed = TRUE,   seed_number = 1234,   BSPARAM = c(\"irlba\", \"exact\", \"random\"),   BPPARAM = BiocParallel::SerialParam(),   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_BiocSingular.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runPCA_BiocSingular — runPCA_BiocSingular","text":"x matrix object can converted matrix ncp number principal components calculate center center matrix pca scale scale features rev reverse PCA set_seed use seed seed_number seed number use BSPARAM method use BPPARAM BiocParallelParam object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_BiocSingular.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runPCA_BiocSingular — runPCA_BiocSingular","text":"list eigenvalues, loadings pca coordinates","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_BiocSingular_irlba_projection.html","id":null,"dir":"Reference","previous_headings":"","what":"runPCA_BiocSingular_irlba_projection — runPCA_BiocSingular_irlba_projection","title":"runPCA_BiocSingular_irlba_projection — runPCA_BiocSingular_irlba_projection","text":"Performs PCA based biocSingular package subset matrix. uses obtained loadings predicted coordinates remaining matrix.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_BiocSingular_irlba_projection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runPCA_BiocSingular_irlba_projection — runPCA_BiocSingular_irlba_projection","text":"","code":"runPCA_BiocSingular_irlba_projection(   x,   ncp = 100,   center = TRUE,   scale = TRUE,   rev = FALSE,   set_seed = TRUE,   seed_number = 1234,   BPPARAM = BiocParallel::SerialParam(),   random_subset = 500,   verbose = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_BiocSingular_irlba_projection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runPCA_BiocSingular_irlba_projection — runPCA_BiocSingular_irlba_projection","text":"x matrix object can converted matrix ncp number principal components calculate center center matrix pca scale scale features rev reverse PCA set_seed use seed seed_number seed number use BPPARAM BiocParallelParam object random_subset random subset perform PCA verbose verbosity level","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_BiocSingular_irlba_projection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runPCA_BiocSingular_irlba_projection — runPCA_BiocSingular_irlba_projection","text":"list eigenvalues, loadings pca coordinates","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_factominer.html","id":null,"dir":"Reference","previous_headings":"","what":"runPCA_factominer — runPCA_factominer","title":"runPCA_factominer — runPCA_factominer","text":"performs PCA based factominer package","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_factominer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runPCA_factominer — runPCA_factominer","text":"","code":"runPCA_factominer(   x,   ncp = 100,   scale = TRUE,   rev = FALSE,   set_seed = TRUE,   seed_number = 1234,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_factominer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runPCA_factominer — runPCA_factominer","text":"x matrix object can converted matrix ncp number principal components calculate scale scale features rev reverse PCA set_seed use seed seed_number seed number use","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCA_factominer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runPCA_factominer — runPCA_factominer","text":"list eigenvalues, loadings pca coordinates","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCAprojection.html","id":null,"dir":"Reference","previous_headings":"","what":"runPCAprojection — runPCAprojection","title":"runPCAprojection — runPCAprojection","text":"runs Principal Component Analysis random subet + projection","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCAprojection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runPCAprojection — runPCAprojection","text":"","code":"runPCAprojection(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reduction = c(\"cells\", \"feats\"),   random_subset = 500,   name = \"pca.projection\",   feats_to_use = \"hvf\",   return_gobject = TRUE,   center = TRUE,   scale_unit = TRUE,   ncp = 100,   method = c(\"irlba\"),   method_params = BiocParallel::SerialParam(),   rev = FALSE,   set_seed = TRUE,   seed_number = 1234,   verbose = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runPCAprojection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runPCAprojection — runPCAprojection","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use reduction cells genes random_subset numeric. random subset perform PCA name arbitrary name PCA run feats_to_use subset features use PCA return_gobject boolean: return giotto object (default = TRUE) center center data first (default = TRUE) scale_unit scale features PCA (default = TRUE) ncp number principal components calculate method implementation use method_params BiocParallelParam object rev reverse PCA set_seed use seed seed_number seed number use verbose verbosity function ... additional parameters PCA (see details)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCAprojection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runPCAprojection — runPCAprojection","text":"giotto object updated PCA dimension recuction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCAprojection.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"runPCAprojection — runPCAprojection","text":"See runPCA PCA information parameters. PCA implementation similar  runPCA, except performs PCA subset cells features, predict others. can significantly increase speed without sacrificing accuracy much. feats_to_use = NULL: use features selected matrix feats_to_use = <hvg name>: can used select column name   highly variable features, created (see calculateHVF) feats_to_use = c('geneA', 'geneB', ...): use manually provided features","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCAprojectionBatch.html","id":null,"dir":"Reference","previous_headings":"","what":"runPCAprojectionBatch — runPCAprojectionBatch","title":"runPCAprojectionBatch — runPCAprojectionBatch","text":"runs Principal Component Analysis multiple random batches + projection","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCAprojectionBatch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runPCAprojectionBatch — runPCAprojectionBatch","text":"","code":"runPCAprojectionBatch(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reduction = c(\"cells\", \"feats\"),   random_subset = 500,   batch_number = 5,   name = \"pca.projection.batch\",   feats_to_use = \"hvf\",   return_gobject = TRUE,   center = TRUE,   scale_unit = TRUE,   ncp = 100,   method = c(\"irlba\"),   method_params = BiocParallel::SerialParam(),   rev = FALSE,   set_seed = TRUE,   seed_number = 1234,   verbose = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runPCAprojectionBatch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runPCAprojectionBatch — runPCAprojectionBatch","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use reduction cells genes random_subset random subset perform PCA batch_number number random batches run name arbitrary name PCA run feats_to_use subset features use PCA return_gobject boolean: return giotto object (default = TRUE) center center data first (default = TRUE) scale_unit scale features PCA (default = TRUE) ncp number principal components calculate method implementation use method_params BiocParallelParam object rev reverse PCA set_seed use seed seed_number seed number use verbose verbosity function ... additional parameters PCA (see details)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCAprojectionBatch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runPCAprojectionBatch — runPCAprojectionBatch","text":"giotto object updated PCA dimension recuction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPCAprojectionBatch.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"runPCAprojectionBatch — runPCAprojectionBatch","text":"See runPCA PCA information parameters. PCA implementation similar  runPCA  runPCAprojection, except performs PCA multiple subsets (batches) cells features, predict others. can significantly increase speed without sacrificing accuracy much. feats_to_use = NULL: use features selected matrix feats_to_use = <hvg name>: can used select column name   highly variable features, created (see calculateHVF) feats_to_use = c('geneA', 'geneB', ...): use manually provided features","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPatternSimulation.html","id":null,"dir":"Reference","previous_headings":"","what":"runPatternSimulation — runPatternSimulation","title":"runPatternSimulation — runPatternSimulation","text":"Creates known spatial pattern selected genes one--one runs different spatial gene detection tests","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPatternSimulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runPatternSimulation — runPatternSimulation","text":"","code":"runPatternSimulation(   gobject,   pattern_name = \"pattern\",   pattern_colors = c(`in` = \"green\", out = \"red\"),   pattern_cell_ids = NULL,   gene_names = NULL,   spatial_probs = c(0.5, 1),   reps = 2,   spatial_network_name = \"kNN_network\",   spat_methods = c(\"binSpect_single\", \"binSpect_multi\", \"spatialDE\", \"spark\",     \"silhouetteRank\"),   spat_methods_params = list(NA, NA, NA, NA, NA),   spat_methods_names = c(\"binSpect_single\", \"binSpect_multi\", \"spatialDE\", \"spark\",     \"silhouetteRank\"),   scalefactor = 6000,   save_plot = T,   save_raw = T,   save_norm = T,   save_dir = \"~\",   max_col = 4,   height = 7,   width = 7,   run_simulations = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runPatternSimulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runPatternSimulation — runPatternSimulation","text":"gobject giotto object pattern_name name spatial pattern pattern_colors 2 color vector spatial pattern pattern_cell_ids cell ids make spatial pattern gene_names selected genes spatial_probs probabilities test high expressing gene value part spatial pattern reps number random simulation repetitions spatial_network_name spatial network use binSpectSingle spat_methods vector spatial methods test spat_methods_params list parameters list element vector spatial methods test spat_methods_names name element vector spatial elements test scalefactor library size scaling factor re-normalizing dataset save_plot save intermediate random simulation plots save_raw save raw expression matrix simulation save_norm save normalized expression matrix simulation save_dir directory save results max_col maximum number columns final plots height height final plots width width final plots run_simulations run simulations (default = TRUE) ... additional parameters renormalization","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runPatternSimulation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runPatternSimulation — runPatternSimulation","text":"data.table results","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runRankEnrich.html","id":null,"dir":"Reference","previous_headings":"","what":"runRankEnrich — runRankEnrich","title":"runRankEnrich — runRankEnrich","text":"Function calculate gene signature enrichment scores per spatial position using rank based approach.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runRankEnrich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runRankEnrich — runRankEnrich","text":"","code":"runRankEnrich(   gobject,   spat_unit = NULL,   feat_type = NULL,   sign_matrix,   expression_values = c(\"normalized\", \"raw\", \"scaled\", \"custom\"),   reverse_log_scale = TRUE,   logbase = 2,   output_enrichment = c(\"original\", \"zscore\"),   ties_method = c(\"average\", \"max\"),   p_value = FALSE,   n_times = 1000,   rbp_p = 0.99,   num_agg = 100,   name = NULL,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/runRankEnrich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runRankEnrich — runRankEnrich","text":"gobject Giotto object spat_unit spatial unit feat_type feature type sign_matrix Matrix signature genes cell type / process expression_values expression values use reverse_log_scale reverse expression values log scale logbase log base use reverse_log_scale = TRUE output_enrichment return enrichment output ties_method handle rank ties p_value calculate p-values (boolean, default = FALSE) n_times number permutations calculate p_value rbp_p fractional binarization threshold (default = 0.99) num_agg number top genes aggregate (default = 100) name give spatial enrichment results, default = rank return_gobject return giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runRankEnrich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runRankEnrich — runRankEnrich","text":"data.table enrichment results","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runRankEnrich.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"runRankEnrich — runRankEnrich","text":"sign_matrix: rank-fold matrix genes row names cell-types column names. Alternatively scRNA-seq matrix vector clusters can provided makeSignMatrixRank, create matrix . First new rank calculated R = (R1*R2)^(1/2), R1 rank fold-change gene spot R2 rank marker cell type. Rank-Biased Precision calculated : RBP = (1 - 0.99) * (0.99)^(R - 1) final enrichment score calculated sum top 100 RBPs.","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/runSpatialDeconv.html","id":null,"dir":"Reference","previous_headings":"","what":"runSpatialDeconv — runSpatialDeconv","title":"runSpatialDeconv — runSpatialDeconv","text":"Function perform deconvolution based single cell expression data","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runSpatialDeconv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runSpatialDeconv — runSpatialDeconv","text":"","code":"runSpatialDeconv(   gobject,   spat_unit = NULL,   feat_type = NULL,   deconv_method = c(\"DWLS\"),   expression_values = c(\"normalized\"),   logbase = 2,   cluster_column = \"leiden_clus\",   sign_matrix,   n_cell = 50,   cutoff = 2,   name = NULL,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/runSpatialDeconv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runSpatialDeconv — runSpatialDeconv","text":"gobject giotto object spat_unit spatial unit feat_type feature type deconv_method method use deconvolution expression_values expression values use logbase base used log normalization cluster_column name cluster column sign_matrix signature matrix deconvolution n_cell number cells per spot cutoff cut (default = 2) name name give spatial deconvolution results return_gobject return giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runSpatialDeconv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runSpatialDeconv — runSpatialDeconv","text":"giotto object deconvolution results","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/runSpatialEnrich.html","id":null,"dir":"Reference","previous_headings":"","what":"runSpatialEnrich — runSpatialEnrich","title":"runSpatialEnrich — runSpatialEnrich","text":"Function calculate gene signature enrichment scores per spatial position using enrichment test.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runSpatialEnrich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"runSpatialEnrich — runSpatialEnrich","text":"","code":"runSpatialEnrich(   gobject,   spat_unit = NULL,   feat_type = NULL,   enrich_method = c(\"PAGE\", \"rank\", \"hypergeometric\"),   sign_matrix,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   min_overlap_genes = 5,   reverse_log_scale = TRUE,   logbase = 2,   p_value = FALSE,   n_times = 1000,   rbp_p = 0.99,   num_agg = 100,   max_block = 2e+07,   top_percentage = 5,   output_enrichment = c(\"original\", \"zscore\"),   name = NULL,   verbose = TRUE,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/runSpatialEnrich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"runSpatialEnrich — runSpatialEnrich","text":"gobject Giotto object spat_unit spatial unit feat_type feature type enrich_method method gene signature enrichment calculation sign_matrix Matrix signature genes cell type / process expression_values expression values use min_overlap_genes minimum number overlapping genes sign_matrix required calculate enrichment (PAGE) reverse_log_scale reverse expression values log scale logbase log base use reverse_log_scale = TRUE p_value calculate p-value (default = FALSE) n_times (page/rank) number permutation iterations calculate p-value rbp_p (rank) fractional binarization threshold (default = 0.99) num_agg (rank) number top genes aggregate (default = 100) max_block number lines process together (default = 20e6) top_percentage (hyper) percentage cells considered gene expression matrix binarization output_enrichment return enrichment output name give spatial enrichment results, default = PAGE verbose verbose return_gobject return giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runSpatialEnrich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"runSpatialEnrich — runSpatialEnrich","text":"Giotto object enrichment results return_gobject = FALSE","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runSpatialEnrich.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"runSpatialEnrich — runSpatialEnrich","text":"details see individual functions: PAGE: runPAGEEnrich Rank: runRankEnrich Hypergeometric: runHyperGeometricEnrich","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runUMAP.html","id":null,"dir":"Reference","previous_headings":"","what":"Run UMAP dimension reduction — runUMAP","title":"Run UMAP dimension reduction — runUMAP","text":"run UMAP","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runUMAP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run UMAP dimension reduction — runUMAP","text":"","code":"runUMAP(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reduction = c(\"cells\", \"feats\"),   dim_reduction_to_use = \"pca\",   dim_reduction_name = NULL,   dimensions_to_use = 1:10,   name = NULL,   feats_to_use = NULL,   return_gobject = TRUE,   n_neighbors = 40,   n_components = 2,   n_epochs = 400,   min_dist = 0.01,   n_threads = NA,   spread = 5,   set_seed = TRUE,   seed_number = 1234L,   verbose = TRUE,   toplevel_params = 2L,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runUMAP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run UMAP dimension reduction — runUMAP","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values expression values use reduction cells genes dim_reduction_to_use use another dimension reduction set input dim_reduction_name name dimension reduction set use dimensions_to_use number dimensions use input name arbitrary name UMAP run feats_to_use dim_reduction_to_use = NULL, features use return_gobject logical: return giotto object (default = TRUE) n_neighbors UMAP param: number neighbors n_components UMAP param: number components n_epochs UMAP param: number epochs min_dist UMAP param: minimum distance n_threads UMAP param: threads/cores use spread UMAP param: spread set_seed use seed seed_number seed number use verbose verbosity function toplevel_params parameters extract ... Arguments passed uwot::umap metric Type distance metric use find nearest neighbors. One   : \"euclidean\" (default) \"cosine\" \"manhattan\" \"hamming\" \"correlation\" (distance based Pearson correlation) \"categorical\" (see ) applies nn_method = \"annoy\" (nn_method = \"fnn\", distance metric always \"euclidean\"). X data frame matrix, multiple metrics can specified, passing list argument, name item list one metric names . value list item vector giving names integer ids columns included calculation, e.g. metric = list(euclidean = 1:4, manhattan = 5:10). metric calculation results separate fuzzy simplicial set, intersected together produce final set. Metric names can repeated. non-numeric columns removed data frame, safer use column names integer ids. Factor columns can also used specifying metric name \"categorical\". Factor columns treated different numeric columns although multiple factor columns can specified vector, factor column specified processed individually. specify non-factor column, coerced factor. given data block, may override pca pca_center arguments block, providing list one unnamed item containing column names ids, pca pca_center overrides named items, e.g. metric = list(euclidean = 1:4, manhattan = list(5:10, pca_center = FALSE)). exists allow mixed binary real-valued data included PCA applied , centering applied real-valued data (typical apply centering binary data PCA applied). learning_rate Initial learning rate used optimization coordinates. init Type initialization coordinates. Options : \"spectral\" Spectral embedding using normalized Laplacian    fuzzy 1-skeleton, Gaussian noise added. \"normlaplacian\". Spectral embedding using normalized    Laplacian fuzzy 1-skeleton, without noise. \"random\". Coordinates assigned using uniform random    distribution -10 10. \"lvrandom\". Coordinates assigned using Gaussian    distribution standard deviation 1e-4, used LargeVis    (Tang et al., 2016) t-SNE. \"laplacian\". Spectral embedding using Laplacian Eigenmap    (Belkin Niyogi, 2002). \"pca\". first two principal components PCA    X X data frame, 2-dimensional classical    MDS X class \"dist\". \"spca\". Like \"pca\", dimension scaled    standard deviation 1e-4, give distribution similar    used t-SNE. alias init = \"pca\", init_sdev =    1e-4. \"agspectral\" \"approximate global\" modification    \"spectral\" edges graph value 1,    sets random number edges (negative_sample_rate edges per    vertex) 0.1, approximate effect non-local affinities. matrix initial coordinates. spectral initializations, (\"spectral\", \"normlaplacian\", \"laplacian\", \"agspectral\"), one connected component identified, spectral initialization attempted. Instead PCA-based initialization attempted. verbose = TRUE number connected components logged console. existence multiple connected components implies global view data attained initialization. Increasing value n_neighbors may help. init_sdev non-NULL, scales dimension initialized coordinates (including user-supplied matrix) standard deviation. default scaling carried , except init = \"spca\", case value 0.0001. Scaling input may help unscaled versions result initial coordinates large inter-point distances outliers. usually results small gradients optimization little progress made layout. Shrinking initial embedding rescaling can help circumstances. Scaling result init = \"pca\" usually recommended init = \"spca\" alias init = \"pca\", init_sdev = 1e-4 spectral initializations scaled versions usually necessary unless using large value n_neighbors (e.g. n_neighbors = 150 higher). compatibility recent versions Python UMAP package, using init = \"spectral\", also set init_sdev = \"range\", range scale columns containing initial data 0-10. set default maintain backwards compatibility previous versions uwot. set_op_mix_ratio Interpolate (fuzzy) union intersection set operation used combine local fuzzy simplicial sets obtain global fuzzy simplicial sets. fuzzy set operations use product t-norm. value parameter 0.0 1.0; value 1.0 use pure fuzzy union, 0.0 use pure fuzzy intersection. local_connectivity local connectivity required -- .e. number nearest neighbors assumed connected local level. higher value connected manifold becomes locally. practice local intrinsic dimension manifold. bandwidth effective bandwidth kernel view algorithm similar Laplacian Eigenmaps. Larger values induce connectivity global view data, smaller values concentrate locally. repulsion_strength Weighting applied negative samples low dimensional embedding optimization. Values higher one result greater weight given negative samples. negative_sample_rate number negative edge/1-simplex samples use per positive edge/1-simplex sample optimizing low dimensional embedding. specific parameters controlling embedding. NULL values set automatically determined min_dist spread. b specific parameters controlling embedding. NULL values set automatically determined min_dist spread. nn_method Method finding nearest neighbors. Options : \"fnn\". Use exact nearest neighbors via     FNN package. \"annoy\" Use approximate nearest neighbors via     RcppAnnoy package. default, X less 4,096 vertices, exact nearest neighbors found. Otherwise, approximate nearest neighbors used. may also pass pre-calculated nearest neighbor data argument. must one two formats, either list consisting two elements: \"idx\". n_vertices x n_neighbors matrix   containing integer indexes nearest neighbors X.   vertex considered nearest neighbor, .e.   idx[, 1] == 1:n_vertices. \"dist\". n_vertices x n_neighbors matrix   containing distances nearest neighbors. sparse distance matrix type dgCMatrix, dimensions n_vertices x n_vertices. Distances arranged column, .e. non-zero entry row j ith column indicates jth observation X nearest neighbor ith observation distance given value element. n_neighbors parameter ignored using precomputed nearest neighbor data. using sparse distance matrix input, column can contain different number neighbors. n_trees Number trees build constructing nearest neighbor index. trees specified, larger index, better results. search_k, determines accuracy Annoy nearest neighbor search. used nn_method \"annoy\". Sensible values 10 100. search_k Number nodes search neighbor retrieval. larger k, accurate results, longer search takes. n_trees, determines accuracy Annoy nearest neighbor search. used nn_method \"annoy\". approx_pow TRUE, use approximation power function UMAP gradient, https://martin.ankerl.com/2012/01/25/optimized-approximative-pow--c--cpp/. Ignored dens_scale non-NULL. y Optional target data supervised dimension reduction. Can vector, matrix data frame. Use target_metric parameter specify metrics use, using syntax metric. Usually either single numeric factor column used, complex formats possible. following types allowed: Factor columns length X. NA     allowed observation unknown level, case     UMAP operates form semi-supervised learning. column     treated separately. Numeric data. NA allowed case. Use     parameter target_n_neighbors set number neighbors used     y. unset, n_neighbors used. Unlike factors,     numeric columns grouped one block unless target_metric     specifies otherwise. example, wish columns     b treated separately, specify     target_metric = list(euclidean = \"\", euclidean = \"b\"). Otherwise,     data effectively treated matrix two columns. Nearest neighbor data, consisting list two matrices,     idx dist. represent precalculated nearest     neighbor indices distances, respectively.     format expected precalculated data     nn_method. format assumes underlying data     numeric vector. user-supplied value target_n_neighbors     parameter ignored case, number columns     matrices used value. Multiple nearest neighbor data using     different metrics can supplied passing list lists. Unlike X, factor columns included y automatically used. target_n_neighbors Number nearest neighbors use construct target simplicial set. Default value n_neighbors. Applies y non-NULL numeric. target_metric metric used measure distance y using supervised dimension reduction. Used y numeric. target_weight Weighting factor data topology target topology. value 0.0 weights entirely data, value 1.0 weights entirely target. default 0.5 balances weighting equally data target. applies y non-NULL. pcg_rand TRUE, use PCG random number generator (O'Neill, 2014) optimization. Otherwise, use faster (probably less statistically good) Tausworthe \"taus88\" generator. default TRUE. fast_sgd TRUE, following combination parameters set: pcg_rand = TRUE, n_sgd_threads = \"auto\" approx_pow = TRUE. default FALSE. Setting TRUE speed stochastic optimization phase, give potentially less accurate embedding, exactly reproducible even fixed seed. visualization, fast_sgd = TRUE give perfectly good results. generic dimensionality reduction, safer leave fast_sgd = FALSE. fast_sgd = TRUE, user-supplied values pcg_rand, n_sgd_threads, approx_pow ignored. ret_model TRUE, return extra data can used add new data existing embedding via umap_transform. embedded coordinates returned list item embedding. FALSE, just return coordinates. parameter can used conjunction ret_nn ret_extra. Note settings incompatible production UMAP model: external neighbor data (passed via list nn_method), factor columns included via metric parameter. latter case, model produced based numeric data. transformation using new data possible, factor columns new data ignored. Note setting ret_model = TRUE forces use approximate nearest neighbors method. small datasets otherwise use exact nearest neighbor calculations, setting ret_model = TRUE means different results may returned small datasets terms returned nearest neighbors (requested) final embedded coordinates, compared ret_model = FALSE, even random number seed fixed. avoid , explicitly set nn_method = \"annoy\" ret_model = FALSE case. ret_nn TRUE, addition embedding, also return nearest neighbor data can used input nn_method avoid overhead repeatedly calculating nearest neighbors manipulating unrelated parameters (e.g. min_dist, n_epochs, init). See \"Value\" section names list items. FALSE, just return coordinates. Note nearest neighbors sensitive data scaling, wary reusing nearest neighbor data modifying scale parameter. parameter can used conjunction ret_model ret_extra. ret_extra vector indicating extra data return. May contain combination following strings: \"model\" setting ret_model = TRUE. \"nn\" setting ret_nn = TRUE. \"fgraph\" high dimensional fuzzy graph (.e. fuzzy     simplicial set merged local views input data). graph     returned sparse symmetric N x N matrix class     dgCMatrix-class, non-zero entry (, j) gives     membership strength edge connecting vertex vertex j.     can considered analogous input probability (similarity     affinity) used t-SNE LargeVis. Note graph     sparsified removing edges sufficiently low membership strength     sampled probabilistic edge sampling     employed optimization therefore number non-zero elements     matrix dependent n_epochs.     interested fuzzy input graph (e.g. clustering), setting     n_epochs = 0 avoid sparsifying.     aware setting `binary_edge_weights = TRUE` affect     graph (non-zero edge weights 1). \"sigma\" normalization value observation     dataset constructing smoothed distances     neighbors. gives sense local density     observation high dimensional space: higher values     sigma indicate higher dispersion lower density. n_sgd_threads Number threads use stochastic gradient descent. set > 1, aware batch = FALSE, results reproducible, even set.seed called fixed seed running. Set \"auto\" use value n_threads. grain_size minimum amount work thread. value set high enough, less n_threads n_sgd_threads used processing, might give performance improvement overhead thread management context switching outweighing improvement due concurrent processing. left default (1) work spread evenly threads specified. tmpdir Temporary directory store nearest neighbor indexes nearest neighbor search. Default tempdir. index written disk n_threads > 1 nn_method = \"annoy\"; otherwise, parameter ignored. batch TRUE, embedding coordinates updated end epoch rather epoch. batch mode, results reproducible fixed random seed even n_sgd_threads > 1, cost slightly higher memory use. may also modify learning_rate increase n_epochs, whether provides speed increase single-threaded optimization likely dataset hardware-dependent. opt_args list optimizer parameters, used batch = TRUE. default optimization method used Adam (Kingma Ba, 2014). method optimization method use. Either \"adam\"   \"sgd\" (stochastic gradient descent). Default: \"adam\". beta1 (Adam ). weighting parameter   exponential moving average first moment estimator. Effectively   momentum parameter. floating point value 0 1.   Higher values can smooth oscillatory updates poorly-conditioned   situations may allow larger learning_rate   specified, high can cause divergence. Default: 0.5. beta2 (Adam ). weighting parameter   exponential moving average uncentered second moment estimator.   floating point value 0 1. Controls degree   adaptivity step-size. Higher values put weight previous   time steps. Default: 0.9. eps (Adam ). Intended small value prevent   division zero, practice can also affect convergence due   interaction beta2. Higher values reduce effect   step-size adaptivity bring behavior closer stochastic gradient   descent momentum. Typical values 1e-8 1e-3. Default:   1e-7. alpha initial learning rate. Default: value   learning_rate parameter. epoch_callback function invoked end every epoch. signature : (epoch, n_epochs, coords), : epoch current epoch number (1   n_epochs). n_epochs Number epochs use optimization   embedded coordinates. coords embedded coordinates end current   epoch, matrix dimensions (N, n_components). binary_edge_weights TRUE edge weights input graph treated binary (0/1) rather real valued. affects sampling frequency neighbors strategy used PaCMAP method (Wang co-workers, 2020). Practical (Böhm co-workers, 2020) theoretical (Damrich Hamprecht, 2021) work suggests little effect UMAP's performance. dens_scale value 0 1. > 0 output attempts preserve relative local density around observation. uses approximation densMAP method (Narayan co-workers, 2021). larger value dens_scale, greater range output densities used map input densities. option ignored using multiple metric blocks.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runUMAP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run UMAP dimension reduction — runUMAP","text":"giotto object updated UMAP dimension reduction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runUMAP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run UMAP dimension reduction — runUMAP","text":"See umap information parameters. Input UMAP dimension reduction can another dimension reduction   (default = 'pca') use gene expression input set dim_reduction_to_use = NULL dim_reduction_to_use = NULL, feats_to_use can used select   column name highly variable features (see calculateHVF)   simply provide vector features multiple UMAP results can stored changing name   analysis","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runUMAPprojection.html","id":null,"dir":"Reference","previous_headings":"","what":"Run UMAP dimension reduction — runUMAPprojection","title":"Run UMAP dimension reduction — runUMAPprojection","text":"run UMAP subset project rest","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runUMAPprojection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run UMAP dimension reduction — runUMAPprojection","text":"","code":"runUMAPprojection(   gobject,   feat_type = NULL,   spat_unit = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reduction = c(\"cells\", \"feats\"),   dim_reduction_to_use = \"pca\",   dim_reduction_name = NULL,   dimensions_to_use = 1:10,   random_subset = 500,   name = NULL,   feats_to_use = NULL,   return_gobject = TRUE,   n_neighbors = 40,   n_components = 2,   n_epochs = 400,   min_dist = 0.01,   n_threads = NA,   spread = 5,   set_seed = TRUE,   seed_number = 1234,   verbose = T,   toplevel_params = 2,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runUMAPprojection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run UMAP dimension reduction — runUMAPprojection","text":"gobject giotto object feat_type feature type spat_unit spatial unit expression_values expression values use reduction 'cells' 'feats' dim_reduction_to_use use another dimension reduction set input dim_reduction_name name dimension reduction set use dimensions_to_use number dimensions use input random_subset random subset perform UMAP name arbitrary name UMAP run feats_to_use dim_reduction_to_use = NULL, features use return_gobject boolean: return giotto object (default = TRUE) n_neighbors UMAP param: number neighbors n_components UMAP param: number components n_epochs UMAP param: number epochs min_dist UMAP param: minimum distance n_threads UMAP param: threads/cores use spread UMAP param: spread set_seed use seed seed_number seed number use verbose verbosity function toplevel_params parameters extract ... additional UMAP parameters","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runUMAPprojection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run UMAP dimension reduction — runUMAPprojection","text":"giotto object updated UMAP dimension reduction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runUMAPprojection.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run UMAP dimension reduction — runUMAPprojection","text":"See umap information parameters. Input UMAP dimension reduction can another dimension reduction (default = 'pca') use gene expression input set dim_reduction_to_use = NULL dim_reduction_to_use = NULL, feats_to_use can used select column name   highly variable genes (see calculateHVF) simply provide vector genes multiple UMAP results can stored changing name analysis","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runWNN.html","id":null,"dir":"Reference","previous_headings":"","what":"Multi omics integration with WNN — runWNN","title":"Multi omics integration with WNN — runWNN","text":"Multi omics integration WNN","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runWNN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multi omics integration with WNN — runWNN","text":"","code":"runWNN(   gobject,   spat_unit = \"cell\",   modality_1 = \"rna\",   modality_2 = \"protein\",   pca_name_modality_1 = \"rna.pca\",   pca_name_modality_2 = \"protein.pca\",   k = 20,   integrated_feat_type = NULL,   matrix_result_name = NULL,   w_name_modality_1 = NULL,   w_name_modality_2 = NULL,   verbose = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/runWNN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multi omics integration with WNN — runWNN","text":"gobject Giotto object individual PCA modalities pre-calculated spat_unit spatial unit modality_1 modality 1 name. Default = \"rna\" modality_2 modality 2 name. Default = \"protein\" pca_name_modality_1 Default = 'rna.pca' pca_name_modality_2 Default = 'protein.pca' k k number, default = 20 integrated_feat_type integrated feature type (e.g. 'rna_protein') matrix_result_name Default = 'theta_weighted_matrix' w_name_modality_1 name modality 1 weights w_name_modality_2 name modality 2 weights verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runWNN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multi omics integration with WNN — runWNN","text":"Giotto object integrated UMAP (integrated.umap) within dimension_reduction slot Leiden clusters (integrated_leiden_clus) cellular metadata.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/run_spat_autocor_global.html","id":null,"dir":"Reference","previous_headings":"","what":"run_spat_autocor_global — run_spat_autocor_global","title":"run_spat_autocor_global — run_spat_autocor_global","text":"run_spat_autocor_global","code":""},{"path":"https://drieslab.github.io/Giotto/reference/run_spat_autocor_global.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"run_spat_autocor_global — run_spat_autocor_global","text":"","code":"run_spat_autocor_global(   use_values,   feats,   weight_matrix,   method,   test_method,   mc_nsim,   cor_name )"},{"path":"https://drieslab.github.io/Giotto/reference/run_spat_autocor_local.html","id":null,"dir":"Reference","previous_headings":"","what":"run_spat_autocor_local — run_spat_autocor_local","title":"run_spat_autocor_local — run_spat_autocor_local","text":"run_spat_autocor_local","code":""},{"path":"https://drieslab.github.io/Giotto/reference/run_spat_autocor_local.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"run_spat_autocor_local — run_spat_autocor_local","text":"","code":"run_spat_autocor_local(   use_values,   feats,   weight_matrix,   method,   test_method,   IDs )"},{"path":"https://drieslab.github.io/Giotto/reference/run_spatial_sim_tests_multi.html","id":null,"dir":"Reference","previous_headings":"","what":"run_spatial_sim_tests_multi — run_spatial_sim_tests_multi","title":"run_spatial_sim_tests_multi — run_spatial_sim_tests_multi","text":"runs spatial tests multiple probabilities repetitions","code":""},{"path":"https://drieslab.github.io/Giotto/reference/run_spatial_sim_tests_multi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"run_spatial_sim_tests_multi — run_spatial_sim_tests_multi","text":"","code":"run_spatial_sim_tests_multi(   gobject,   pattern_name = \"pattern\",   pattern_cell_ids = NULL,   gene_name = NULL,   spatial_probs = c(0.5, 1),   reps = 2,   spatial_network_name = \"kNN_network\",   spat_methods = c(\"binSpect_single\", \"binSpect_multi\", \"spatialDE\", \"spark\",     \"silhouetteRank\"),   spat_methods_params = list(NA, NA, NA, NA, NA),   spat_methods_names = c(\"binSpect_single\", \"binSpect_multi\", \"spatialDE\", \"spark\",     \"silhouetteRank\"),   save_plot = FALSE,   save_raw = FALSE,   save_norm = FALSE,   save_dir = \"~\",   verbose = TRUE,   run_simulations = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/run_spatial_sim_tests_one_rep.html","id":null,"dir":"Reference","previous_headings":"","what":"run_spatial_sim_tests_one_rep — run_spatial_sim_tests_one_rep","title":"run_spatial_sim_tests_one_rep — run_spatial_sim_tests_one_rep","text":"runs spatial tests 1 probability 1 rep","code":""},{"path":"https://drieslab.github.io/Giotto/reference/run_spatial_sim_tests_one_rep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"run_spatial_sim_tests_one_rep — run_spatial_sim_tests_one_rep","text":"","code":"run_spatial_sim_tests_one_rep(   gobject,   pattern_name = \"pattern\",   pattern_cell_ids = NULL,   gene_name = NULL,   spatial_prob = 0.95,   show_pattern = FALSE,   spatial_network_name = \"kNN_network\",   spat_methods = c(\"binSpect_single\", \"binSpect_multi\", \"spatialDE\", \"spark\",     \"silhouetteRank\"),   spat_methods_params = list(NA, NA, NA, NA, NA),   spat_methods_names = c(\"binSpect_single\", \"binSpect_multi\", \"spatialDE\", \"spark\",     \"silhouetteRank\"),   save_plot = FALSE,   save_raw = FALSE,   save_norm = FALSE,   save_dir = \"~\",   save_name = \"plot\",   run_simulations = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runtSNE.html","id":null,"dir":"Reference","previous_headings":"","what":"Run tSNE dimensional reduction — runtSNE","title":"Run tSNE dimensional reduction — runtSNE","text":"run tSNE","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runtSNE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run tSNE dimensional reduction — runtSNE","text":"","code":"runtSNE(   gobject,   spat_unit = NULL,   feat_type = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reduction = c(\"cells\", \"feats\"),   dim_reduction_to_use = \"pca\",   dim_reduction_name = NULL,   dimensions_to_use = 1:10,   name = NULL,   feats_to_use = NULL,   return_gobject = TRUE,   dims = 2,   perplexity = 30,   theta = 0.5,   do_PCA_first = FALSE,   set_seed = TRUE,   seed_number = 1234,   verbose = TRUE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/runtSNE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run tSNE dimensional reduction — runtSNE","text":"gobject giotto object spat_unit spatial unit feat_type feature type expression_values expression values use reduction cells feats dim_reduction_to_use use another dimension reduction set input dim_reduction_name name dimension reduction set use dimensions_to_use number dimensions use input name arbitrary name tSNE run feats_to_use dim_reduction_to_use = NULL, features use return_gobject boolean: return giotto object (default = TRUE) dims tSNE param: number dimensions return perplexity tSNE param: perplexity theta tSNE param: theta do_PCA_first tSNE param: PCA tSNE (default = FALSE) set_seed use seed seed_number seed number use verbose verbosity function ... additional tSNE parameters","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runtSNE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run tSNE dimensional reduction — runtSNE","text":"giotto object updated tSNE dimension recuction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/runtSNE.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run tSNE dimensional reduction — runtSNE","text":"See Rtsne information parameters. Input tSNE dimension reduction can another dimension reduction (default = 'pca') use gene expression input set dim_reduction_to_use = NULL dim_reduction_to_use = NULL, feats_to_use can used select column name   highly variable genes (see calculateHVF) simply provide vector genes multiple tSNE results can stored changing name analysis","code":""},{"path":"https://drieslab.github.io/Giotto/reference/sampling_sp_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"sampling_sp_genes — sampling_sp_genes","title":"sampling_sp_genes — sampling_sp_genes","text":"function select set spatial genes","code":""},{"path":"https://drieslab.github.io/Giotto/reference/sampling_sp_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"sampling_sp_genes — sampling_sp_genes","text":"","code":"sampling_sp_genes(clust, sample_rate = 2, target = 500, seed = 10)"},{"path":"https://drieslab.github.io/Giotto/reference/sampling_sp_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"sampling_sp_genes — sampling_sp_genes","text":"clust spatial gene clusters sample_rate sampling rate, takes values equal greater 1 target target length gene list seed random seed","code":""},{"path":"https://drieslab.github.io/Giotto/reference/sampling_sp_genes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"sampling_sp_genes — sampling_sp_genes","text":"function samples subset spatial genes among different clusters, size n = target. Number samples cluster denpends relative proportion cluster. Changing equal size setting sample_rate = 1 exact proportion cluster setting sample_rate = +Inf","code":""},{"path":"https://drieslab.github.io/Giotto/reference/screePlot.html","id":null,"dir":"Reference","previous_headings":"","what":"screePlot — screePlot","title":"screePlot — screePlot","text":"identify significant principal components (PCs) using screeplot (.k.. elbowplot)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/screePlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"screePlot — screePlot","text":"","code":"screePlot(   gobject,   spat_unit = NULL,   feat_type = NULL,   name = NULL,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reduction = c(\"cells\", \"feats\"),   method = c(\"irlba\", \"exact\", \"random\", \"factominer\"),   rev = FALSE,   feats_to_use = NULL,   center = FALSE,   scale_unit = FALSE,   ncp = 100,   ylim = c(0, 20),   verbose = TRUE,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"screePlot\",   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/screePlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"screePlot — screePlot","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") name name PCA object available expression_values expression values use reduction cells features method implementation use rev reverse PCA feats_to_use subset features use PCA center center data PCA scale_unit scale features PCA ncp numeric. max number principal components plot ylim numeric. y-axis limits scree plot verbose verbose show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param ... additional arguments pca function, see runPCA","code":""},{"path":"https://drieslab.github.io/Giotto/reference/screePlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"screePlot — screePlot","text":"ggplot object scree method","code":""},{"path":"https://drieslab.github.io/Giotto/reference/screePlot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"screePlot — screePlot","text":"Screeplot works plotting explained variance  individual PC barplot allowing identify PC provides significant  contribution (.k.'elbow method').   Screeplot use available pca object, based parameter 'name',  create available (see runPCA)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/selectPatternGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"selectPatternGenes — selectPatternGenes","title":"selectPatternGenes — selectPatternGenes","text":"Select genes correlated spatial patterns","code":""},{"path":"https://drieslab.github.io/Giotto/reference/selectPatternGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"selectPatternGenes — selectPatternGenes","text":"","code":"selectPatternGenes(   spatPatObj,   dimensions = 1:5,   top_pos_genes = 10,   top_neg_genes = 10,   min_pos_cor = 0.5,   min_neg_cor = -0.5,   return_top_selection = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/selectPatternGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"selectPatternGenes — selectPatternGenes","text":"spatPatObj Output detectSpatialPatterns dimensions dimensions identify correlated genes . top_pos_genes Top positively correlated genes. top_neg_genes Top negatively correlated genes. min_pos_cor Minimum positive correlation score include gene. min_neg_cor Minimum negative correlation score include gene. return_top_selection return selection based correlation criteria (boolean)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/selectPatternGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"selectPatternGenes — selectPatternGenes","text":"Data.table genes associated selected dimension (PC).","code":""},{"path":"https://drieslab.github.io/Giotto/reference/selectPatternGenes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"selectPatternGenes — selectPatternGenes","text":"Description.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showCellProportionSwitchedPie.html","id":null,"dir":"Reference","previous_headings":"","what":"showCellProportionSwitchedPie — showCellProportionSwitchedPie","title":"showCellProportionSwitchedPie — showCellProportionSwitchedPie","text":"showCellProportionSwitchedPie","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showCellProportionSwitchedPie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"showCellProportionSwitchedPie — showCellProportionSwitchedPie","text":"","code":"showCellProportionSwitchedPie(   gobject = NULL,   spat_unit = NULL,   feat_type = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/showCellProportionSwitchedPie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"showCellProportionSwitchedPie — showCellProportionSwitchedPie","text":"gobject giotto object spat_unit spatial unit feat_type feature type","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showCellProportionSwitchedPie.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"showCellProportionSwitchedPie — showCellProportionSwitchedPie","text":"Creates pie chart showing many cells switched clusters annotation resizing. function showPolygonSizeInfluence() must run Giotto Object function run.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showCellProportionSwitchedSanKey.html","id":null,"dir":"Reference","previous_headings":"","what":"showCellProportionSwitchedSanKey — showCellProportionSwitchedSanKey","title":"showCellProportionSwitchedSanKey — showCellProportionSwitchedSanKey","text":"showCellProportionSwitchedSanKey","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showCellProportionSwitchedSanKey.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"showCellProportionSwitchedSanKey — showCellProportionSwitchedSanKey","text":"","code":"showCellProportionSwitchedSanKey(   gobject = NULL,   spat_unit = NULL,   alt_spat_unit = NULL,   feat_type = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/showCellProportionSwitchedSanKey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"showCellProportionSwitchedSanKey — showCellProportionSwitchedSanKey","text":"gobject giotto object contains metadata spat_unit alt_spat_unit spat_unit spatial unit alt_spat_unit alternative spatial unit stores data resizing annotations feat_type feature type","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showCellProportionSwitchedSanKey.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"showCellProportionSwitchedSanKey — showCellProportionSwitchedSanKey","text":"Creates Sankey Diagram illustrate cluster switching behavior. Currently supports displaying cluster switching kmeans clusters.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPattern.html","id":null,"dir":"Reference","previous_headings":"","what":"showPattern — showPattern","title":"showPattern — showPattern","text":"show patterns 2D spatial data","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPattern.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"showPattern — showPattern","text":"","code":"showPattern(gobject, spatPatObj, ...)"},{"path":"https://drieslab.github.io/Giotto/reference/showPattern.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"showPattern — showPattern","text":"gobject giotto object spatPatObj Output detectSpatialPatterns ... Arguments passed showPattern2D dimension dimension plot trim Trim ends PC values. background_color background color plot grid_border_color color grid show_legend show legend ggplot point_size size points show_plot show plot return_plot return ggplot object save_plot directly save plot [boolean] save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPattern.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"showPattern — showPattern","text":"ggplot","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/showPattern2D.html","id":null,"dir":"Reference","previous_headings":"","what":"showPattern2D — showPattern2D","title":"showPattern2D — showPattern2D","text":"show patterns 2D spatial data","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPattern2D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"showPattern2D — showPattern2D","text":"","code":"showPattern2D(   gobject,   spatPatObj,   dimension = 1,   trim = c(0.02, 0.98),   background_color = \"white\",   grid_border_color = \"grey\",   show_legend = T,   point_size = 1,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"showPattern2D\" )"},{"path":"https://drieslab.github.io/Giotto/reference/showPattern2D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"showPattern2D — showPattern2D","text":"gobject giotto object spatPatObj Output detectSpatialPatterns dimension dimension plot trim Trim ends PC values. background_color background color plot grid_border_color color grid show_legend show legend ggplot point_size size points show_plot show plot return_plot return ggplot object save_plot directly save plot [boolean] save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPattern2D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"showPattern2D — showPattern2D","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPattern3D.html","id":null,"dir":"Reference","previous_headings":"","what":"showPattern3D — showPattern3D","title":"showPattern3D — showPattern3D","text":"show patterns 3D spatial data","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPattern3D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"showPattern3D — showPattern3D","text":"","code":"showPattern3D(   gobject,   spatPatObj,   dimension = 1,   trim = c(0.02, 0.98),   background_color = \"white\",   grid_border_color = \"grey\",   show_legend = T,   point_size = 1,   axis_scale = c(\"cube\", \"real\", \"custom\"),   custom_ratio = NULL,   x_ticks = NULL,   y_ticks = NULL,   z_ticks = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"showPattern3D\" )"},{"path":"https://drieslab.github.io/Giotto/reference/showPattern3D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"showPattern3D — showPattern3D","text":"gobject giotto object spatPatObj Output detectSpatialPatterns dimension dimension plot trim Trim ends PC values. background_color background color plot grid_border_color color grid show_legend show legend plot point_size adjust point size axis_scale scale axis custom_ratio cutomize scale axis x_ticks tick number x_axis y_ticks tick number y_axis z_ticks tick number z_axis show_plot show plot return_plot return plot object save_plot directly save plot [boolean] save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPattern3D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"showPattern3D — showPattern3D","text":"plotly","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPatternGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"showPatternGenes — showPatternGenes","title":"showPatternGenes — showPatternGenes","text":"show genes correlated spatial patterns","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPatternGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"showPatternGenes — showPatternGenes","text":"","code":"showPatternGenes(   gobject,   spatPatObj,   dimension = 1,   top_pos_genes = 5,   top_neg_genes = 5,   point_size = 1,   return_DT = FALSE,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"showPatternGenes\" )"},{"path":"https://drieslab.github.io/Giotto/reference/showPatternGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"showPatternGenes — showPatternGenes","text":"gobject giotto object spatPatObj Output detectSpatialPatterns dimension dimension plot genes . top_pos_genes Top positively correlated genes. top_neg_genes Top negatively correlated genes. point_size size points return_DT TRUE, return data.table used generate plots show_plot show plot return_plot return ggplot object save_plot directly save plot [boolean] save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPatternGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"showPatternGenes — showPatternGenes","text":"ggplot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPolygonSizeInfluence.html","id":null,"dir":"Reference","previous_headings":"","what":"showPolygonSizeInfluence — showPolygonSizeInfluence","title":"showPolygonSizeInfluence — showPolygonSizeInfluence","text":"showPolygonSizeInfluence","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPolygonSizeInfluence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"showPolygonSizeInfluence — showPolygonSizeInfluence","text":"","code":"showPolygonSizeInfluence(   gobject = NULL,   spat_unit = NULL,   alt_spat_unit = NULL,   feat_type = NULL,   clus_name = \"kmeans\",   return_plot = FALSE,   verbose = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/showPolygonSizeInfluence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"showPolygonSizeInfluence — showPolygonSizeInfluence","text":"gobject giotto object spat_unit spatial unit alt_spat_unit alternaitve spatial unit represents resized polygon data feat_type feature type clus_name name cluster column cell_metadata given spat_unit alt_spat_unit, .e. \"kmeans\" return_plot logical. whether return plot object verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPolygonSizeInfluence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"showPolygonSizeInfluence — showPolygonSizeInfluence","text":"giotto object altered cell_metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showPolygonSizeInfluence.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"showPolygonSizeInfluence — showPolygonSizeInfluence","text":"Compares cell metadata spat_unit-feat_type pairs provided. New columns, resize_switch cluster_interaction, created within cell_metadata spat_unit-feat_type. new columns describe given cell switched cluster number resized. amount clusters exist spat_unit-feat_type alt_spat_unit-feat_type, clusters determined corresponding based Otherwise, multiple clusters spatial unit feature type pair condensed align smaller number clusters ensure overlap.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showSpatialCorFeats.html","id":null,"dir":"Reference","previous_headings":"","what":"showSpatialCorFeats — showSpatialCorFeats","title":"showSpatialCorFeats — showSpatialCorFeats","text":"Shows filters spatially correlated features","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showSpatialCorFeats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"showSpatialCorFeats — showSpatialCorFeats","text":"","code":"showSpatialCorFeats(   spatCorObject,   use_clus_name = NULL,   selected_clusters = NULL,   feats = NULL,   min_spat_cor = 0.5,   min_expr_cor = NULL,   min_cor_diff = NULL,   min_rank_diff = NULL,   show_top_feats = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/showSpatialCorFeats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"showSpatialCorFeats — showSpatialCorFeats","text":"spatCorObject spatial correlation object use_clus_name cluster information show selected_clusters subset clusters show feats subset features show min_spat_cor filter minimum spatial correlation min_expr_cor filter minimum single-cell expression correlation min_cor_diff filter minimum correlation difference (spatial vs expression) min_rank_diff filter minimum correlation rank difference (spatial vs expression) show_top_feats show top features per gene","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showSpatialCorFeats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"showSpatialCorFeats — showSpatialCorFeats","text":"data.table filtered information","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showSpatialCorGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"showSpatialCorGenes — showSpatialCorGenes","title":"showSpatialCorGenes — showSpatialCorGenes","text":"Shows filters spatially correlated genes","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showSpatialCorGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"showSpatialCorGenes — showSpatialCorGenes","text":"","code":"showSpatialCorGenes(   spatCorObject,   use_clus_name = NULL,   selected_clusters = NULL,   genes = NULL,   min_spat_cor = 0.5,   min_expr_cor = NULL,   min_cor_diff = NULL,   min_rank_diff = NULL,   show_top_genes = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/showSpatialCorGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"showSpatialCorGenes — showSpatialCorGenes","text":"spatCorObject spatial correlation object use_clus_name cluster information show selected_clusters subset clusters show genes subset genes show min_spat_cor filter minimum spatial correlation min_expr_cor filter minimum single-cell expression correlation min_cor_diff filter minimum correlation difference (spatial vs expression) min_rank_diff filter minimum correlation rank difference (spatial vs expression) show_top_genes show top genes per gene","code":""},{"path":"https://drieslab.github.io/Giotto/reference/showSpatialCorGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"showSpatialCorGenes — showSpatialCorGenes","text":"data.table filtered information","code":""},{"path":"https://drieslab.github.io/Giotto/reference/signPCA.html","id":null,"dir":"Reference","previous_headings":"","what":"signPCA — signPCA","title":"signPCA — signPCA","text":"identify significant prinicipal components (PCs)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/signPCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"signPCA — signPCA","text":"","code":"signPCA(   gobject,   feat_type = NULL,   spat_unit = NULL,   name = NULL,   method = c(\"screeplot\", \"jackstraw\"),   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   reduction = c(\"cells\", \"feats\"),   pca_method = c(\"irlba\", \"factominer\"),   rev = FALSE,   feats_to_use = NULL,   center = TRUE,   scale_unit = TRUE,   ncp = 50,   scree_ylim = c(0, 10),   jack_iter = 10,   jack_threshold = 0.01,   jack_ylim = c(0, 1),   verbose = TRUE,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"signPCA\" )"},{"path":"https://drieslab.github.io/Giotto/reference/signPCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"signPCA — signPCA","text":"gobject giotto object feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") spat_unit spatial unit (e.g. \"cell\") name name PCA object available method method use identify significant PCs expression_values expression values use reduction cells genes pca_method implementation use rev reverse PCA feats_to_use subset features use PCA center center data PCA scale_unit scale features PCA ncp number principal components calculate scree_ylim y-axis limits scree plot jack_iter number interations jackstraw jack_threshold p-value threshold call PC significant jack_ylim y-axis limits jackstraw plot verbose verbose show_plot logical. show plot return_plot logical. return ggplot object save_plot logical. save plot save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/signPCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"signPCA — signPCA","text":"ggplot object scree method maxtrix p-values jackstraw","code":""},{"path":"https://drieslab.github.io/Giotto/reference/signPCA.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"signPCA — signPCA","text":"Two different methods can used assess number relevant significant  prinicipal components (PC's).   1. Screeplot works plotting explained variance  individual PC barplot allowing identify PC provides significant  contribution  (.k.. 'elbow method').   2. Jackstraw method uses permutationPA function.  systematically permuting genes identifies robust, thus significant, PCs.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/silhouetteRank.html","id":null,"dir":"Reference","previous_headings":"","what":"silhouetteRank — silhouetteRank","title":"silhouetteRank — silhouetteRank","text":"Previously: calculate_spatial_genes_python. method computes silhouette score per gene based spatial distribution two partitions cells (expressed L1, non-expressed L0). , rather L2 Euclidean norm, uses rank-transformed, exponentially weighted function represent local physical distance two cells. New multi aggregator implementation can found silhouetteRankTest","code":""},{"path":"https://drieslab.github.io/Giotto/reference/silhouetteRank.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"silhouetteRank — silhouetteRank","text":"","code":"silhouetteRank(   gobject,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   metric = \"euclidean\",   subset_genes = NULL,   rbp_p = 0.95,   examine_top = 0.3,   python_path = NULL )"},{"path":"https://drieslab.github.io/Giotto/reference/silhouetteRank.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"silhouetteRank — silhouetteRank","text":"gobject giotto object expression_values expression values use metric distance metric use subset_genes run subset genes rbp_p fractional binarization threshold examine_top top fraction evaluate silhouette python_path specify specific path python required","code":""},{"path":"https://drieslab.github.io/Giotto/reference/silhouetteRank.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"silhouetteRank — silhouetteRank","text":"data.table spatial scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/silhouetteRankTest.html","id":null,"dir":"Reference","previous_headings":"","what":"silhouetteRankTest — silhouetteRankTest","title":"silhouetteRankTest — silhouetteRankTest","text":"Multi parameter aggregator version silhouetteRank","code":""},{"path":"https://drieslab.github.io/Giotto/reference/silhouetteRankTest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"silhouetteRankTest — silhouetteRankTest","text":"","code":"silhouetteRankTest(   gobject,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   subset_genes = NULL,   overwrite_input_bin = TRUE,   rbp_ps = c(0.95, 0.99),   examine_tops = c(0.005, 0.01, 0.05, 0.1, 0.3),   matrix_type = \"dissim\",   num_core = 4,   parallel_path = \"/usr/bin\",   output = NULL,   query_sizes = 10L,   verbose = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/silhouetteRankTest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"silhouetteRankTest — silhouetteRankTest","text":"gobject giotto object expression_values expression values use subset_genes run subset genes overwrite_input_bin overwrite input bin rbp_ps fractional binarization thresholds examine_tops top fractions evaluate silhouette matrix_type type matrix num_core number cores use parallel_path path GNU parallel function output output directory query_sizes size query verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/silhouetteRankTest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"silhouetteRankTest — silhouetteRankTest","text":"data.table spatial scores","code":""},{"path":"https://drieslab.github.io/Giotto/reference/simulateOneGenePatternGiottoObject.html","id":null,"dir":"Reference","previous_headings":"","what":"simulateOneGenePatternGiottoObject — simulateOneGenePatternGiottoObject","title":"simulateOneGenePatternGiottoObject — simulateOneGenePatternGiottoObject","text":"Create simulated spatial pattern one selected gnee","code":""},{"path":"https://drieslab.github.io/Giotto/reference/simulateOneGenePatternGiottoObject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simulateOneGenePatternGiottoObject — simulateOneGenePatternGiottoObject","text":"","code":"simulateOneGenePatternGiottoObject(   gobject,   pattern_name = \"pattern\",   pattern_cell_ids = NULL,   gene_name = NULL,   spatial_prob = 0.95,   gradient_direction = NULL,   show_pattern = TRUE,   pattern_colors = c(`in` = \"green\", out = \"red\"),   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/simulateOneGenePatternGiottoObject.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simulateOneGenePatternGiottoObject — simulateOneGenePatternGiottoObject","text":"gobject giotto object pattern_name name spatial pattern pattern_cell_ids cell ids make spatial pattern gene_name selected gene spatial_prob probability high expressing gene value part spatial pattern gradient_direction direction gradient show_pattern show discrete spatial pattern pattern_colors 2 color vector spatial pattern ... additional parameters (re-)normalizing","code":""},{"path":"https://drieslab.github.io/Giotto/reference/simulateOneGenePatternGiottoObject.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"simulateOneGenePatternGiottoObject — simulateOneGenePatternGiottoObject","text":"Reprocessed Giotto object one gene forced spatial pattern","code":""},{"path":"https://drieslab.github.io/Giotto/reference/solve_OLS_internal.html","id":null,"dir":"Reference","previous_headings":"","what":"solve_OLS_internal — solve_OLS_internal","title":"solve_OLS_internal — solve_OLS_internal","text":"basic functions dwls","code":""},{"path":"https://drieslab.github.io/Giotto/reference/solve_OLS_internal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"solve_OLS_internal — solve_OLS_internal","text":"","code":"solve_OLS_internal(S, B)"},{"path":"https://drieslab.github.io/Giotto/reference/solve_dampened_WLSj.html","id":null,"dir":"Reference","previous_headings":"","what":"solve_dampened_WLSj — solve_dampened_WLSj","title":"solve_dampened_WLSj — solve_dampened_WLSj","text":"solve WLS given dampening constant","code":""},{"path":"https://drieslab.github.io/Giotto/reference/solve_dampened_WLSj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"solve_dampened_WLSj — solve_dampened_WLSj","text":"","code":"solve_dampened_WLSj(S, B, goldStandard, j)"},{"path":"https://drieslab.github.io/Giotto/reference/spark.html","id":null,"dir":"Reference","previous_headings":"","what":"spark — spark","title":"spark — spark","text":"Compute spatially expressed genes SPARK method","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spark.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spark — spark","text":"","code":"spark(   gobject,   spat_loc_name = \"raw\",   feat_type = NULL,   spat_unit = NULL,   percentage = 0.1,   min_count = 10,   expression_values = \"raw\",   num_core = 5,   covariates = NULL,   return_object = c(\"data.table\", \"spark\"),   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/spark.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"spark — spark","text":"gobject giotto object spat_loc_name name spatial locations feat_type feature type spat_unit spatial unit percentage percentage cells expressed analysis min_count minimum number counts gene included expression_values type values use (raw default) num_core number cores use covariates covariates experiments, .e. confounding factors/batch effect. Column name giotto cell metadata. return_object type result return (data.table spark object) ... Additional parameters spark.vc function","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spark.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"spark — spark","text":"data.table SPARK spatial genes results SPARK object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spark.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"spark — spark","text":"function wrapper method implemented SPARK package: 1. CreateSPARKObject create SPARK object Giotto object 2. spark.vc  Fits count-based spatial model estimate parameters,  see spark.vc additional parameters 3. spark.test  Testing multiple kernel matrices Publication: doi:10.1101/810903","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatCellCellcom.html","id":null,"dir":"Reference","previous_headings":"","what":"spatCellCellcom — spatCellCellcom","title":"spatCellCellcom — spatCellCellcom","text":"Spatial Cell-Cell communication scores based spatial expression interacting cells","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatCellCellcom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spatCellCellcom — spatCellCellcom","text":"","code":"spatCellCellcom(   gobject,   feat_type = NULL,   spat_unit = NULL,   spatial_network_name = \"Delaunay_network\",   cluster_column = \"cell_types\",   random_iter = 1000,   feat_set_1,   feat_set_2,   gene_set_1 = NULL,   gene_set_2 = NULL,   log2FC_addendum = 0.1,   min_observations = 2,   detailed = FALSE,   adjust_method = c(\"fdr\", \"bonferroni\", \"BH\", \"holm\", \"hochberg\", \"hommel\", \"BY\",     \"none\"),   adjust_target = c(\"feats\", \"cells\"),   do_parallel = TRUE,   cores = NA,   set_seed = TRUE,   seed_number = 1234,   verbose = c(\"a little\", \"a lot\", \"none\") )"},{"path":"https://drieslab.github.io/Giotto/reference/spatCellCellcom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"spatCellCellcom — spatCellCellcom","text":"gobject giotto object use feat_type feature type spat_unit spatial unit spatial_network_name spatial network use identifying interacting cells cluster_column cluster column cell type information random_iter number iterations feat_set_1 first specific feature set feature pairs feat_set_2 second specific feature set feature pairs gene_set_1 deprecated, use feat_set_1 gene_set_2 deprecated, use feat_set_2 log2FC_addendum addendum add calculating log2FC min_observations minimum number interactions needed considered detailed provide detailed information (random variance z-score) adjust_method method adjust p-values adjust_target adjust multiple hypotheses cell feature level do_parallel run calculations parallel mclapply cores number cores use do_parallel = TRUE set_seed set seed reproducibility seed_number seed number verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatCellCellcom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"spatCellCellcom — spatCellCellcom","text":"Cell-Cell communication scores feature pairs based spatial interaction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatCellCellcom.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"spatCellCellcom — spatCellCellcom","text":"Statistical framework identify pairs genes (ligand-receptor combinations) expressed higher levels expected based reshuffled null distribution feature expression values cells spatially proximity eachother.. LR_comb:Pair ligand receptor lig_cell_type: cell type assess expression level ligand lig_expr: average expression ligand lig_cell_type ligand: ligand name rec_cell_type: cell type assess expression level receptor rec_expr: average expression receptor rec_cell_type receptor: receptor name LR_expr: combined average ligand receptor expression lig_nr: total number cells lig_cell_type spatially interact cells rec_cell_type rec_nr: total number cells rec_cell_type spatially interact cells lig_cell_type rand_expr: average combined ligand receptor expression random spatial permutations av_diff: average difference LR_expr rand_expr random spatial permutations sd_diff: (optional) standard deviation difference LR_expr rand_expr random spatial permutations z_score: (optinal) z-score log2fc: log2 fold-change (LR_expr/rand_expr) pvalue: p-value LR_cell_comb: cell type pair combination p.adj: adjusted p-value PI: significanc score: log2fc * -log10(p.adj)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatCellCellcomSpots.html","id":null,"dir":"Reference","previous_headings":"","what":"spatCellCellcomSpots — spatCellCellcomSpots","title":"spatCellCellcomSpots — spatCellCellcomSpots","text":"Spatial Cell-Cell communication scores based spatial expression interacting cells spots resolution","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatCellCellcomSpots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spatCellCellcomSpots — spatCellCellcomSpots","text":"","code":"spatCellCellcomSpots(   gobject,   spat_unit = NULL,   feat_type = NULL,   ave_celltype_exp,   spatial_network_name = \"Delaunay_network\",   cluster_column = \"cell_ID\",   random_iter = 1000,   feature_set_1,   feature_set_2,   min_observations = 2,   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   detailed = FALSE,   adjust_method = c(\"fdr\", \"bonferroni\", \"BH\", \"holm\", \"hochberg\", \"hommel\", \"BY\",     \"none\"),   adjust_target = c(\"features\", \"cells\"),   do_parallel = TRUE,   cores = NA,   set_seed = TRUE,   seed_number = 1234,   verbose = c(\"a little\", \"a lot\", \"none\") )"},{"path":"https://drieslab.github.io/Giotto/reference/spatCellCellcomSpots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"spatCellCellcomSpots — spatCellCellcomSpots","text":"gobject giotto object use spat_unit spatial unit (e.g. 'cell') feat_type feature type (e.g. 'rna') ave_celltype_exp Matrix average expression per cell type spatial_network_name spatial network use identifying interacting cells cluster_column cluster column cell type information random_iter number iterations feature_set_1 first specific feature set feature pairs feature_set_2 second specific feature set feature pairs min_observations minimum number interactions needed considered expression_values (e.g. 'normalized', 'scaled', 'custom') detailed provide detailed information (random variance z-score) adjust_method method adjust p-values adjust_target adjust multiple hypotheses cell feature level do_parallel run calculations parallel mclapply cores number cores use do_parallel = TRUE set_seed set seed reproducibility seed_number seed number verbose verbose (e.g. 'little', 'lot', 'none')","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatCellCellcomSpots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"spatCellCellcomSpots — spatCellCellcomSpots","text":"Cell-Cell communication scores feature pairs based spatial interaction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatCellCellcomSpots.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"spatCellCellcomSpots — spatCellCellcomSpots","text":"Statistical framework identify pairs features (ligand-receptor combinations) expressed higher levels expected based reshuffled null distribution feature expression values cells spatially proximity eachother.. LR_comb:Pair ligand receptor lig_cell_type: cell type assess expression level ligand lig_expr: average expression residual(observed - DWLS_predicted) ligand lig_cell_type ligand: ligand name rec_cell_type: cell type assess expression level receptor rec_expr: average expression residual(observed - DWLS_predicted) receptor rec_cell_type receptor: receptor name LR_expr: combined average ligand receptor expression residual lig_nr: total number cells lig_cell_type spatially interact cells rec_cell_type rec_nr: total number cells rec_cell_type spatially interact cells lig_cell_type rand_expr: average combined ligand receptor expression residual random spatial permutations av_diff: average difference LR_expr rand_expr random spatial permutations sd_diff: (optional) standard deviation difference LR_expr rand_expr random spatial permutations z_score: (optinal) z-score log2fc: LR_expr - rand_expr pvalue: p-value LR_cell_comb: cell type pair combination p.adj: adjusted p-value PI: significanc score: log2fc * -log10(p.adj)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spat_OR_func.html","id":null,"dir":"Reference","previous_headings":"","what":"spat_OR_func — spat_OR_func","title":"spat_OR_func — spat_OR_func","text":"calculate odds-ratio","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spat_OR_func.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spat_OR_func — spat_OR_func","text":"","code":"spat_OR_func(feat, bin_matrix, spat_mat, calc_hub = F, hub_min_int = 3)"},{"path":"https://drieslab.github.io/Giotto/reference/spat_OR_func_DT.html","id":null,"dir":"Reference","previous_headings":"","what":"spat_OR_func_DT — spat_OR_func_DT","title":"spat_OR_func_DT — spat_OR_func_DT","text":"calculate odds-ratio data.table implementation","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spat_OR_func_DT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spat_OR_func_DT — spat_OR_func_DT","text":"","code":"spat_OR_func_DT(   bin_matrix_DTm,   spat_netw_min,   calc_hub = F,   hub_min_int = 3,   cores = NA )"},{"path":"https://drieslab.github.io/Giotto/reference/spat_fish_func.html","id":null,"dir":"Reference","previous_headings":"","what":"spat_fish_func — spat_fish_func","title":"spat_fish_func — spat_fish_func","text":"performs fisher exact test","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spat_fish_func.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spat_fish_func — spat_fish_func","text":"","code":"spat_fish_func(feat, bin_matrix, spat_mat, calc_hub = F, hub_min_int = 3)"},{"path":"https://drieslab.github.io/Giotto/reference/spat_fish_func_DT.html","id":null,"dir":"Reference","previous_headings":"","what":"spat_fish_func_DT — spat_fish_func_DT","title":"spat_fish_func_DT — spat_fish_func_DT","text":"performs fisher exact test data.table implementation","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spat_fish_func_DT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spat_fish_func_DT — spat_fish_func_DT","text":"","code":"spat_fish_func_DT(   bin_matrix_DTm,   spat_netw_min,   calc_hub = F,   hub_min_int = 3,   cores = NA )"},{"path":"https://drieslab.github.io/Giotto/reference/spatialAEH.html","id":null,"dir":"Reference","previous_headings":"","what":"spatialAEH — spatialAEH","title":"spatialAEH — spatialAEH","text":"Compute spatial variable genes spatialDE method","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialAEH.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spatialAEH — spatialAEH","text":"","code":"spatialAEH(   gobject = NULL,   feat_type = NULL,   spat_unit = NULL,   spat_loc_name = \"raw\",   SpatialDE_results = NULL,   name_pattern = \"AEH_patterns\",   expression_values = c(\"raw\", \"normalized\", \"scaled\", \"custom\"),   pattern_num = 6,   l = 1.05,   python_path = NULL,   return_gobject = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/spatialAEH.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"spatialAEH — spatialAEH","text":"gobject Giotto object feat_type feature type spat_unit spatial unit spat_loc_name name spatial locations SpatialDE_results results spatialDE function name_pattern name computed spatial patterns expression_values gene expression values use pattern_num number spatial patterns look l lengthscale python_path specify specific path python required return_gobject show plot","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialAEH.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"spatialAEH — spatialAEH","text":"updated giotto object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialAEH.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"spatialAEH — spatialAEH","text":"function wrapper SpatialAEH method implemented ...","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialAutoCor.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial autocorrelation — spatialAutoCor","title":"Spatial autocorrelation — spatialAutoCor","text":"Find spatial autocorrelation. Note spatialAutoCorGlobal return values data.table instead appending information gobject. spatialAutoCorLocal append results spatial enrichment object default.  providing external data using either node_values /weight_matrix params, order values provided ordering columns rows weight matrix.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialAutoCor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial autocorrelation — spatialAutoCor","text":"","code":"spatialAutoCorGlobal(   gobject = NULL,   spat_unit = NULL,   feat_type = NULL,   feats = NULL,   method = c(\"moran\", \"geary\"),   data_to_use = c(\"expression\", \"cell_meta\"),   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   meta_cols = NULL,   spatial_network_to_use = \"kNN_network\",   wm_method = c(\"distance\", \"adjacency\"),   wm_name = \"spat_weights\",   node_values = NULL,   weight_matrix = NULL,   test_method = c(\"none\", \"monte_carlo\"),   mc_nsim = 99,   cor_name = NULL,   return_gobject = FALSE,   verbose = TRUE )  spatialAutoCorLocal(   gobject = NULL,   spat_unit = NULL,   feat_type = NULL,   feats = NULL,   method = c(\"moran\", \"gi\", \"gi*\", \"mean\"),   data_to_use = c(\"expression\", \"cell_meta\"),   expression_values = c(\"normalized\", \"scaled\", \"custom\"),   meta_cols = NULL,   spatial_network_to_use = \"kNN_network\",   wm_method = c(\"distance\", \"adjacency\"),   wm_name = \"spat_weights\",   node_values = NULL,   weight_matrix = NULL,   test_method = c(\"none\"),   enrich_name = NULL,   return_gobject = TRUE,   output = c(\"spatEnrObj\", \"data.table\"),   verbose = TRUE )"},{"path":"https://drieslab.github.io/Giotto/reference/spatialAutoCor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatial autocorrelation — spatialAutoCor","text":"gobject giotto object spat_unit spatial unit feat_type feature type feats features (expression) run autocorrelation. (leaving NULL means features tested) method method autocorrelation. See details (default = 'moran') data_to_use using data gobject, whether test using expression ('expression') cell metadata ('cell_meta') expression_values name expression information use meta_cols columns cell metadata test spatial_network_to_use spatial network use wm_method type weight matrix generate spatial network weight matrix found attached spatial network wm_name name attached weight matrix use node_values alternative method directly supplying set node values weight_matrix alternative method directly supplying spatial weight matrix test_method method test values significance (default testing) mc_nsim test_method = 'monte_carlo' number simulations perform cor_name name assign results global autocorrelation output return_gobject (default = FALSE) whether return results appended verbose verbose enrich_name name assign local autocorrelation spatial enrichment results output 'spatEnrObj' 'data.table' metadata giotto object data.table","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialAutoCor.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Spatial autocorrelation — spatialAutoCor","text":"Global Methods: Moran's 'moran' Geary's C 'geary' Local Methods: Local Moran's 'moran' Getis-Ord Gi 'Gi' Getis-Ord Gi* 'Gi*' Local mean 'mean'","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialAutoCor.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Spatial autocorrelation — spatialAutoCor","text":"spatialAutoCorGlobal(): Global autocorrelation (single value returned) spatialAutoCorLocal(): Local autocorrelation (values generated spatial ID)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialDE.html","id":null,"dir":"Reference","previous_headings":"","what":"spatialDE — spatialDE","title":"spatialDE — spatialDE","text":"Compute spatial variable genes spatialDE method","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialDE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spatialDE — spatialDE","text":"","code":"spatialDE(   gobject = NULL,   feat_type = NULL,   spat_unit = NULL,   spat_loc_name = \"raw\",   expression_values = c(\"raw\", \"normalized\", \"scaled\", \"custom\"),   size = c(4, 2, 1),   color = c(\"blue\", \"green\", \"red\"),   sig_alpha = 0.5,   unsig_alpha = 0.5,   python_path = NULL,   show_plot = NA,   return_plot = NA,   save_plot = NA,   save_param = list(),   default_save_name = \"SpatialDE\" )"},{"path":"https://drieslab.github.io/Giotto/reference/spatialDE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"spatialDE — spatialDE","text":"gobject Giotto object feat_type feature type spat_unit spatial unit spat_loc_name name spatial locations expression_values gene expression values use size size plot color low/medium/high color scheme plot sig_alpha alpha value significance unsig_alpha alpha value unsignificance python_path specify specific path python required show_plot show plot return_plot return ggplot object save_plot directly save plot [boolean] save_param list saving parameters, see showSaveParameters default_save_name default save name saving, change, change save_name save_param","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialDE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"spatialDE — spatialDE","text":"list data.frames results plot (optional)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialDE.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"spatialDE — spatialDE","text":"function wrapper SpatialDE method originally implemented python. See publication doi:10.1038/nmeth.4636","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialSplitCluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Split cluster annotations based on a spatial network — spatialSplitCluster","title":"Split cluster annotations based on a spatial network — spatialSplitCluster","text":"Split cluster annotations based spatial network","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialSplitCluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split cluster annotations based on a spatial network — spatialSplitCluster","text":"","code":"spatialSplitCluster(   gobject,   spat_unit = NULL,   feat_type = NULL,   spatial_network_name = \"Delaunay_network\",   cluster_col,   split_clus_name = paste0(cluster_col, \"_split\") )"},{"path":"https://drieslab.github.io/Giotto/reference/spatialSplitCluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split cluster annotations based on a spatial network — spatialSplitCluster","text":"gobject giotto object spat_unit spatial unit (e.g. \"cell\") feat_type feature type (e.g. \"rna\", \"dna\", \"protein\") spatial_network_name character. Name spatial network use cluster_col character. Column metadata containing original clustering split_clus_name character. Name assign split cluster results information split","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spatialSplitCluster.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Split cluster annotations based on a spatial network — spatialSplitCluster","text":"","code":"g = GiottoData::loadGiottoMini('vizgen') #> 1. read Giotto object #> 2. read Giotto feature information #> [1] \"/Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library/GiottoData//Mini_datasets/Vizgen/VizgenObject//Features/rna_feature_spatVector.shp\" #> [1] \"rna\" #> 3. read Giotto spatial information #>  #> 3.1 read Giotto spatial shape information #> [1] \"aggregate_spatInfo_spatVector.shp\" \"z0_spatInfo_spatVector.shp\"        #> [3] \"z1_spatInfo_spatVector.shp\"        #> aggregate #> z0 #> z1 #>  #> 3.2 read Giotto spatial centroid information #> aggregate #> z0 #> z1 #>  #> 3.3 read Giotto spatial overlap information #> [1] \"rna_aggregate_spatInfo_spatVectorOverlaps.shp\" #> [2] \"rna_z0_spatInfo_spatVectorOverlaps.shp\"        #> [3] \"rna_z1_spatInfo_spatVectorOverlaps.shp\"        #> [1] \"poly_ID\"      \"feat_ID\"      \"feat_ID_uniq\" \"stack\"        #> aggregate and rna #> [1] \"poly_ID\"      \"feat_ID\"      \"feat_ID_uniq\" #> z0 and rna #> [1] \"poly_ID\"      \"feat_ID\"      \"feat_ID_uniq\" #> z1 and rna #>  #> 4. read Giotto image information #>  #> no external python path was provided, but a giotto python environment was found #>  and will be used activeSpatUnit(g) = 'aggregate' spatPlot2D(g, cell_color = 'leiden_clus')   g = spatialSplitCluster(g,                         cluster_col = 'leiden_clus',                         split_clus_name = 'new') # don't show legend since there are too many categories generated spatPlot2D(g, cell_color = 'new', show_legend = FALSE)"},{"path":"https://drieslab.github.io/Giotto/reference/spdepAutoCorr.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute spatial auto correlation using spdep — spdepAutoCorr","title":"Compute spatial auto correlation using spdep — spdepAutoCorr","text":"Compute spatial auto correlation using spdep","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spdepAutoCorr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute spatial auto correlation using spdep — spdepAutoCorr","text":"","code":"spdepAutoCorr(   gobject,   method = c(\"geary.test\", \"lee.test\", \"lm.morantest\", \"moran.test\"),   spat_unit = NULL,   feat_type = NULL,   expression_values = \"normalized\",   spatial_network_to_use = \"spatial_network\",   return_gobject = FALSE,   verbose = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/spdepAutoCorr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute spatial auto correlation using spdep — spdepAutoCorr","text":"gobject Input Giotto object. method Specify method name compute auto correlation. Available methods include \"geary.test\", \"lee.test\", \"lm.morantest\",\"moran.test\". spat_unit spatial unit feat_type feature type expression_values expression values use, default = normalized spatial_network_to_use spatial network use, default = spatial_network verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spdepAutoCorr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute spatial auto correlation using spdep — spdepAutoCorr","text":"data table computed values feature.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/specificCellCellcommunicationScores.html","id":null,"dir":"Reference","previous_headings":"","what":"specificCellCellcommunicationScores — specificCellCellcommunicationScores","title":"specificCellCellcommunicationScores — specificCellCellcommunicationScores","text":"Specific Cell-Cell communication scores based spatial expression interacting cells","code":""},{"path":"https://drieslab.github.io/Giotto/reference/specificCellCellcommunicationScores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"specificCellCellcommunicationScores — specificCellCellcommunicationScores","text":"","code":"specificCellCellcommunicationScores(   gobject,   feat_type = NULL,   spat_unit = NULL,   spatial_network_name = \"Delaunay_network\",   cluster_column = \"cell_types\",   random_iter = 100,   cell_type_1 = \"astrocyte\",   cell_type_2 = \"endothelial\",   feat_set_1,   feat_set_2,   gene_set_1 = NULL,   gene_set_2 = NULL,   log2FC_addendum = 0.1,   min_observations = 2,   detailed = FALSE,   adjust_method = c(\"fdr\", \"bonferroni\", \"BH\", \"holm\", \"hochberg\", \"hommel\", \"BY\",     \"none\"),   adjust_target = c(\"feats\", \"cells\"),   set_seed = FALSE,   seed_number = 1234,   verbose = T )"},{"path":"https://drieslab.github.io/Giotto/reference/specificCellCellcommunicationScores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"specificCellCellcommunicationScores — specificCellCellcommunicationScores","text":"gobject giotto object use feat_type feature type spat_unit spatial unit spatial_network_name spatial network use identifying interacting cells cluster_column cluster column cell type information random_iter number iterations cell_type_1 first cell type cell_type_2 second cell type feat_set_1 first specific gene set gene pairs feat_set_2 second specific gene set gene pairs gene_set_1 deprecated, use feat_set_1 gene_set_2 deprecated, use feat_set_2 log2FC_addendum addendum add calculating log2FC min_observations minimum number interactions needed considered detailed provide detailed information (random variance z-score) adjust_method method adjust p-values adjust_target adjust multiple hypotheses cell feature level set_seed set seed reproducibility seed_number seed number verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/specificCellCellcommunicationScores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"specificCellCellcommunicationScores — specificCellCellcommunicationScores","text":"Cell-Cell communication scores feature pairs based spatial interaction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/specificCellCellcommunicationScores.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"specificCellCellcommunicationScores — specificCellCellcommunicationScores","text":"Statistical framework identify pairs features (ligand-receptor combinations) expressed higher levels expected based reshuffled null distribution feature expression values cells spatially proximity eachother. LR_comb:Pair ligand receptor lig_cell_type: cell type assess expression level ligand lig_expr: average expression ligand lig_cell_type ligand: ligand name rec_cell_type: cell type assess expression level receptor rec_expr: average expression receptor rec_cell_type receptor: receptor name LR_expr: combined average ligand receptor expression lig_nr: total number cells lig_cell_type spatially interact cells rec_cell_type rec_nr: total number cells rec_cell_type spatially interact cells lig_cell_type rand_expr: average combined ligand receptor expression random spatial permutations av_diff: average difference LR_expr rand_expr random spatial permutations sd_diff: (optional) standard deviation difference LR_expr rand_expr random spatial permutations z_score: (optinal) z-score log2fc: log2 fold-change (LR_expr/rand_expr) pvalue: p-value LR_cell_comb: cell type pair combination p.adj: adjusted p-value PI: significanc score: log2fc * -log10(p.adj)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/specific_CCCScores_spots.html","id":null,"dir":"Reference","previous_headings":"","what":"specific_CCCScores_spots — specific_CCCScores_spots","title":"specific_CCCScores_spots — specific_CCCScores_spots","text":"Specific Cell-Cell communication scores based spatial expression interacting cells spots resulation","code":""},{"path":"https://drieslab.github.io/Giotto/reference/specific_CCCScores_spots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"specific_CCCScores_spots — specific_CCCScores_spots","text":"","code":"specific_CCCScores_spots(   gobject,   spat_unit = NULL,   feat_type = NULL,   expr_residual,   dwls_values,   proximityMat,   random_iter = 1000,   cell_type_1 = \"astrocytes\",   cell_type_2 = \"endothelial\",   feature_set_1,   feature_set_2,   min_observations = 2,   detailed = FALSE,   adjust_method = c(\"fdr\", \"bonferroni\", \" BH\", \"holm\", \"hochberg\", \"hommel\", \"BY\",     \"none\"),   adjust_target = c(\"features\", \"cells\"),   set_seed = FALSE,   seed_number = 1234,   verbose = FALSE )"},{"path":"https://drieslab.github.io/Giotto/reference/specific_CCCScores_spots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"specific_CCCScores_spots — specific_CCCScores_spots","text":"gobject giotto object use spat_unit spatial unit (e.g. 'cell') feat_type feature type (e.g. 'rna') expr_residual spatial network use identifying interacting cells dwls_values dwls matrix proximityMat cell cell communication score matrix random_iter number iterations cell_type_1 first cell type cell_type_2 second cell type feature_set_1 first specific feature set feature pairs feature_set_2 second specific feature set feature pairs min_observations minimum number interactions needed considered detailed provide detailed information (random variance z-score) adjust_method method adjust p-values adjust_target adjust multiple hypotheses cell feature level set_seed set seed reproducibility seed_number seed number verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/specific_CCCScores_spots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"specific_CCCScores_spots — specific_CCCScores_spots","text":"Cell-Cell communication scores feature pairs based spatial interaction","code":""},{"path":"https://drieslab.github.io/Giotto/reference/specific_CCCScores_spots.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"specific_CCCScores_spots — specific_CCCScores_spots","text":"Statistical framework identify pairs features (ligand-receptor combinations) expressed higher levels expected based reshuffled null distribution feature expression values cells spatially proximity eachother. LR_comb:Pair ligand receptor lig_cell_type: cell type assess expression level ligand lig_expr: average expressionresidual(observed - DWLS_predicted) ligand lig_cell_type ligand: ligand name rec_cell_type: cell type assess expression level receptor rec_expr: average expression residual(observed - DWLS_predicted) receptor rec_cell_type receptor: receptor name LR_expr: combined average ligand receptor expression lig_nr: total number cells lig_cell_type spatially interact cells rec_cell_type rec_nr: total number cells rec_cell_type spatially interact cells lig_cell_type rand_expr: average combined ligand receptor expression residual random spatial permutations av_diff: average difference LR_expr rand_expr random spatial permutations sd_diff: (optional) standard deviation difference LR_expr rand_expr random spatial permutations z_score: (optinal) z-score log2fc: LR_expr - rand_expr pvalue: p-value LR_cell_comb: cell type pair combination p.adj: adjusted p-value PI: significanc score: log2fc * -log10(p.adj)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/split_dendrogram_in_two.html","id":null,"dir":"Reference","previous_headings":"","what":"split_dendrogram_in_two — split_dendrogram_in_two","title":"split_dendrogram_in_two — split_dendrogram_in_two","text":"Merge selected clusters based pairwise correlation scores size cluster.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/split_dendrogram_in_two.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"split_dendrogram_in_two — split_dendrogram_in_two","text":"","code":"split_dendrogram_in_two(dend)"},{"path":"https://drieslab.github.io/Giotto/reference/split_dendrogram_in_two.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"split_dendrogram_in_two — split_dendrogram_in_two","text":"dend dendrogram object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/split_dendrogram_in_two.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"split_dendrogram_in_two — split_dendrogram_in_two","text":"list two dendrograms height node","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spot_deconvolution.html","id":null,"dir":"Reference","previous_headings":"","what":"spot_deconvolution — spot_deconvolution","title":"spot_deconvolution — spot_deconvolution","text":"Rui fill ","code":""},{"path":"https://drieslab.github.io/Giotto/reference/spot_deconvolution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spot_deconvolution — spot_deconvolution","text":"","code":"spot_deconvolution(expr, cluster_info, ct_exp, binary_matrix)"},{"path":"https://drieslab.github.io/Giotto/reference/subClusterCells.html","id":null,"dir":"Reference","previous_headings":"","what":"subClusterCells — subClusterCells","title":"subClusterCells — subClusterCells","text":"subcluster cells","code":""},{"path":"https://drieslab.github.io/Giotto/reference/subClusterCells.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"subClusterCells — subClusterCells","text":"","code":"subClusterCells(   gobject,   name = \"sub_clus\",   cluster_method = c(\"leiden\", \"louvain_community\", \"louvain_multinet\"),   cluster_column = NULL,   selected_clusters = NULL,   hvg_param = list(reverse_log_scale = T, difference_in_cov = 1, expression_values =     \"normalized\"),   hvg_min_perc_cells = 5,   hvg_mean_expr_det = 1,   use_all_genes_as_hvg = FALSE,   min_nr_of_hvg = 5,   pca_param = list(expression_values = \"normalized\", scale_unit = T),   nn_param = list(dimensions_to_use = 1:20),   k_neighbors = 10,   resolution = 1,   n_iterations = 1000,   gamma = 1,   omega = 1,   python_path = NULL,   nn_network_to_use = \"sNN\",   network_name = \"sNN.pca\",   return_gobject = TRUE,   verbose = T )"},{"path":"https://drieslab.github.io/Giotto/reference/subClusterCells.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"subClusterCells — subClusterCells","text":"gobject giotto object name name new clustering result cluster_method clustering method use cluster_column cluster column subcluster selected_clusters subclustering clusters hvg_param parameters calculateHVG hvg_min_perc_cells threshold detection min percentage cells hvg_mean_expr_det threshold mean expression level cells detection use_all_genes_as_hvg forces genes HVG used input PCA min_nr_of_hvg minimum number HVG, genes used input PCA pca_param parameters runPCA nn_param parameters parameters createNearestNetwork k_neighbors number k createNearestNetwork resolution resolution n_iterations number interations run Leiden algorithm. gamma gamma omega omega python_path specify specific path python required nn_network_to_use type NN network use (kNN vs sNN) network_name name NN network use return_gobject boolean: return giotto object (default = TRUE) verbose verbose","code":""},{"path":"https://drieslab.github.io/Giotto/reference/subClusterCells.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"subClusterCells — subClusterCells","text":"giotto object new subclusters appended cell metadata","code":""},{"path":"https://drieslab.github.io/Giotto/reference/subClusterCells.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"subClusterCells — subClusterCells","text":"function performs subclustering selected clusters. systematic steps : 1. subset Giotto object 2. identify highly variable genes 3. run PCA 4. create nearest neighbouring network 5. clustering","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/trakem2_rigid_transf_extract.html","id":null,"dir":"Reference","previous_headings":"","what":"trakem2_rigid_transf_extract — trakem2_rigid_transf_extract","title":"trakem2_rigid_transf_extract — trakem2_rigid_transf_extract","text":"Extract rigid registration transformation values FIJI TrakEM2 xml file. Generated register_virtual_stack_slices.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/trakem2_rigid_transf_extract.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"trakem2_rigid_transf_extract — trakem2_rigid_transf_extract","text":"","code":"trakem2_rigid_transf_extract(inputstring)"},{"path":"https://drieslab.github.io/Giotto/reference/trakem2_rigid_transf_extract.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"trakem2_rigid_transf_extract — trakem2_rigid_transf_extract","text":"inputstring string read TrakeEM2 xml file","code":""},{"path":"https://drieslab.github.io/Giotto/reference/transform_2d_mesh_to_3d_mesh.html","id":null,"dir":"Reference","previous_headings":"","what":"transform_2d_mesh_to_3d_mesh — transform_2d_mesh_to_3d_mesh","title":"transform_2d_mesh_to_3d_mesh — transform_2d_mesh_to_3d_mesh","text":"transform 2d mesh 3d mesh reversing PCA","code":""},{"path":"https://drieslab.github.io/Giotto/reference/transform_2d_mesh_to_3d_mesh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"transform_2d_mesh_to_3d_mesh — transform_2d_mesh_to_3d_mesh","text":"","code":"transform_2d_mesh_to_3d_mesh(   mesh_line_obj_2d,   pca_out,   center_vec,   mesh_grid_n )"},{"path":"https://drieslab.github.io/Giotto/reference/transform_2d_mesh_to_3d_mesh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"transform_2d_mesh_to_3d_mesh — transform_2d_mesh_to_3d_mesh","text":"mesh_line_obj_2d mesh_line_obj_2d pca_out pca_out center_vec center_vec mesh_grid_n mesh_grid_n","code":""},{"path":"https://drieslab.github.io/Giotto/reference/trendSceek.html","id":null,"dir":"Reference","previous_headings":"","what":"trendSceek — trendSceek","title":"trendSceek — trendSceek","text":"Compute spatial variable genes trendsceek method","code":""},{"path":"https://drieslab.github.io/Giotto/reference/trendSceek.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"trendSceek — trendSceek","text":"","code":"trendSceek(   gobject,   feat_type = NULL,   spat_unit = NULL,   spat_loc_name = \"raw\",   expression_values = c(\"normalized\", \"raw\"),   subset_genes = NULL,   nrand = 100,   ncores = 8,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/trendSceek.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"trendSceek — trendSceek","text":"gobject Giotto object feat_type feature type spat_unit spatial unit spat_loc_name name spatial locations expression_values gene expression values use subset_genes subset genes run trendsceek nrand integer specifying number random resamplings mark distribution create null-distribution. ncores integer specifying number cores used BiocParallel ... Additional parameters trendsceek_test function","code":""},{"path":"https://drieslab.github.io/Giotto/reference/trendSceek.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"trendSceek — trendSceek","text":"data.frame trendsceek spatial genes results","code":""},{"path":"https://drieslab.github.io/Giotto/reference/trendSceek.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"trendSceek — trendSceek","text":"function wrapper trendsceek_test method implemented trendsceek package Publication: doi:10.1038/nmeth.4634","code":""},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults.html","id":null,"dir":"Reference","previous_headings":"","what":"viewHMRFresults — viewHMRFresults","title":"viewHMRFresults — viewHMRFresults","text":"View results doHMRF.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"viewHMRFresults — viewHMRFresults","text":"","code":"viewHMRFresults(   gobject,   HMRFoutput,   k = NULL,   betas_to_view = NULL,   third_dim = FALSE,   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"viewHMRFresults — viewHMRFresults","text":"gobject giotto object HMRFoutput HMRF output doHMRF k number HMRF domains betas_to_view results different betas want view third_dim 3D data (boolean) ... additional paramters (see details)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"viewHMRFresults — viewHMRFresults","text":"spatial plots HMRF domains","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults2D.html","id":null,"dir":"Reference","previous_headings":"","what":"viewHMRFresults2D — viewHMRFresults2D","title":"viewHMRFresults2D — viewHMRFresults2D","text":"View results doHMRF.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults2D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"viewHMRFresults2D — viewHMRFresults2D","text":"","code":"viewHMRFresults2D(gobject, HMRFoutput, k = NULL, betas_to_view = NULL, ...)"},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults2D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"viewHMRFresults2D — viewHMRFresults2D","text":"gobject giotto object HMRFoutput HMRF output doHMRF k number HMRF domains betas_to_view results different betas want view ... additional parameters spatPlot2D()","code":""},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults2D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"viewHMRFresults2D — viewHMRFresults2D","text":"spatial plots HMRF domains","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults3D.html","id":null,"dir":"Reference","previous_headings":"","what":"viewHMRFresults3D — viewHMRFresults3D","title":"viewHMRFresults3D — viewHMRFresults3D","text":"View results doHMRF.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults3D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"viewHMRFresults3D — viewHMRFresults3D","text":"","code":"viewHMRFresults3D(gobject, HMRFoutput, k = NULL, betas_to_view = NULL, ...)"},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults3D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"viewHMRFresults3D — viewHMRFresults3D","text":"gobject giotto object HMRFoutput HMRF output doHMRF k number HMRF domains betas_to_view results different betas want view ... additional parameters spatPlot3D()","code":""},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults3D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"viewHMRFresults3D — viewHMRFresults3D","text":"spatial plots HMRF domains","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults_V2.html","id":null,"dir":"Reference","previous_headings":"","what":"viewHMRFresults_V2 — viewHMRFresults_V2","title":"viewHMRFresults_V2 — viewHMRFresults_V2","text":"function view HMRF results multiple betas","code":""},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults_V2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"viewHMRFresults_V2 — viewHMRFresults_V2","text":"","code":"viewHMRFresults_V2(   gobject,   k,   betas,   hmrf_name,   spat_unit = NULL,   feat_type = NULL,   third_dim = FALSE,   cow_n_col = 2,   cow_rel_h = 1,   cow_rel_w = 1,   cow_align = \"h\",   show_plot = TRUE,   save_plot = TRUE,   return_plot = TRUE,   default_save_name = \"HMRF_result\",   save_param = list(),   ... )"},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults_V2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"viewHMRFresults_V2 — viewHMRFresults_V2","text":"gobject giotto object k number clusters hmrf results betas values beta plot hmrf_name name hmrf models spat_unit spatial unit feat_type feature type third_dim index 3D plot cow_n_col number columns show figure cow_rel_h relative height cow_rel_w relative width cow_align cowplot alignment parameter show_plot option show plot save_plot option save plot return_plot function return plot default_save_name names figure file save save_param saving parameters","code":""},{"path":"https://drieslab.github.io/Giotto/reference/viewHMRFresults_V2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"viewHMRFresults_V2 — viewHMRFresults_V2","text":"function plots spatial map HMRF domain clusters multiple beta name (hmrf_name), matching first part cell meta column names HMRF clusters (example name ‘hmrf1 k=8 b=0.00’ ‘hmrf1’)","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_micron_scalefactor.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Pixel to Micron Scalefactor — visium_micron_scalefactor","title":"Calculate Pixel to Micron Scalefactor — visium_micron_scalefactor","text":"Calculate Pixel Micron Scalefactor","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_micron_scalefactor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Pixel to Micron Scalefactor — visium_micron_scalefactor","text":"","code":"visium_micron_scale(json_scalefactors)"},{"path":"https://drieslab.github.io/Giotto/reference/visium_micron_scalefactor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Pixel to Micron Scalefactor — visium_micron_scalefactor","text":"json_scalefactors list scalefactors visium_read_scalefactors()","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_micron_scalefactor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Pixel to Micron Scalefactor — visium_micron_scalefactor","text":"scale factor converting pixel micron","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_micron_scalefactor.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Pixel to Micron Scalefactor — visium_micron_scalefactor","text":"Calculates pixel micron scalefactor. Visium xy coordinates based fullres image values provided directly usable generating polygon information calculating micron size relative spatial coordinates set spatial information.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_read_scalefactors.html","id":null,"dir":"Reference","previous_headings":"","what":"Read Visium ScaleFactors — visium_read_scalefactors","title":"Read Visium ScaleFactors — visium_read_scalefactors","text":"Read Visium ScaleFactors","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_read_scalefactors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read Visium ScaleFactors — visium_read_scalefactors","text":"","code":"visium_read_scalefactors(json_path = NULL)"},{"path":"https://drieslab.github.io/Giotto/reference/visium_read_scalefactors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read Visium ScaleFactors — visium_read_scalefactors","text":"json_path path scalefactors_json.json Visium experimental data","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_read_scalefactors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read Visium ScaleFactors — visium_read_scalefactors","text":"scalefactors within provided json file named list, NULL discovered","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_read_scalefactors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read Visium ScaleFactors — visium_read_scalefactors","text":"asserts existence reads .json file containing scalefactors Visium data expected format. Returns NULL path provided file exist.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_spot_poly.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Polygons for Visium Data — visium_spot_poly","title":"Create Polygons for Visium Data — visium_spot_poly","text":"Create Polygons Visium Data","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_spot_poly.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Polygons for Visium Data — visium_spot_poly","text":"","code":"visium_spot_poly(spatLocsObj = NULL, json_scalefactors)"},{"path":"https://drieslab.github.io/Giotto/reference/visium_spot_poly.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Polygons for Visium Data — visium_spot_poly","text":"spatLocsObj spatial locations object containing centroid locations visium spots json_scalefactors list scalefactors visium_read_scalefactors()","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_spot_poly.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Polygons for Visium Data — visium_spot_poly","text":"giottoPolygon object","code":""},{"path":"https://drieslab.github.io/Giotto/reference/visium_spot_poly.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create Polygons for Visium Data — visium_spot_poly","text":"Creates circular polygons spatial representation Visium spots.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/writeHMRFresults.html","id":null,"dir":"Reference","previous_headings":"","what":"writeHMRFresults — writeHMRFresults","title":"writeHMRFresults — writeHMRFresults","text":"write results doHMRF data.table.","code":""},{"path":"https://drieslab.github.io/Giotto/reference/writeHMRFresults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"writeHMRFresults — writeHMRFresults","text":"","code":"writeHMRFresults(   gobject,   HMRFoutput,   k = NULL,   betas_to_view = NULL,   print_command = F )"},{"path":"https://drieslab.github.io/Giotto/reference/writeHMRFresults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"writeHMRFresults — writeHMRFresults","text":"gobject giotto object HMRFoutput HMRF output doHMRF k k write results betas_to_view results different betas want view print_command see python command","code":""},{"path":"https://drieslab.github.io/Giotto/reference/writeHMRFresults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"writeHMRFresults — writeHMRFresults","text":"data.table HMRF results b selected k","code":""},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"write_giotto_viewer_annotation — write_giotto_viewer_annotation","title":"write_giotto_viewer_annotation — write_giotto_viewer_annotation","text":"write factor-like annotation data giotto object Viewer","code":""},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"write_giotto_viewer_annotation — write_giotto_viewer_annotation","text":"","code":"write_giotto_viewer_annotation(   annotation,   annot_name = \"test\",   output_directory = getwd() )"},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_annotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"write_giotto_viewer_annotation — write_giotto_viewer_annotation","text":"annotation annotation data.table giotto object annot_name name annotation output_directory directory save files","code":""},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_annotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"write_giotto_viewer_annotation — write_giotto_viewer_annotation","text":"write .txt .annot file selection annotation","code":""},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_dim_reduction.html","id":null,"dir":"Reference","previous_headings":"","what":"write_giotto_viewer_dim_reduction — write_giotto_viewer_dim_reduction","title":"write_giotto_viewer_dim_reduction — write_giotto_viewer_dim_reduction","text":"write dimensional reduction data giotto object Viewer","code":""},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_dim_reduction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"write_giotto_viewer_dim_reduction — write_giotto_viewer_dim_reduction","text":"","code":"write_giotto_viewer_dim_reduction(   dim_reduction_cell,   dim_red = NULL,   dim_red_name = NULL,   dim_red_rounding = NULL,   dim_red_rescale = c(-20, 20),   output_directory = getwd() )"},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_dim_reduction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"write_giotto_viewer_dim_reduction — write_giotto_viewer_dim_reduction","text":"dim_reduction_cell dimension reduction slot giotto object dim_red high level name dimension reduction dim_red_name specific name dimension reduction use dim_red_rounding numerical indicating round coordinates dim_red_rescale numericals rescale coordinates output_directory directory save files","code":""},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_dim_reduction.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"write_giotto_viewer_dim_reduction — write_giotto_viewer_dim_reduction","text":"write .txt .annot file selection annotation","code":""},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_numeric_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"write_giotto_viewer_numeric_annotation — write_giotto_viewer_numeric_annotation","title":"write_giotto_viewer_numeric_annotation — write_giotto_viewer_numeric_annotation","text":"write numeric annotation data giotto object Viewer","code":""},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_numeric_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"write_giotto_viewer_numeric_annotation — write_giotto_viewer_numeric_annotation","text":"","code":"write_giotto_viewer_numeric_annotation(   annotation,   annot_name = \"test\",   output_directory = getwd() )"},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_numeric_annotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"write_giotto_viewer_numeric_annotation — write_giotto_viewer_numeric_annotation","text":"annotation annotation data.table giotto object annot_name name annotation output_directory directory save files","code":""},{"path":"https://drieslab.github.io/Giotto/reference/write_giotto_viewer_numeric_annotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"write_giotto_viewer_numeric_annotation — write_giotto_viewer_numeric_annotation","text":"write .txt .annot file selection annotation","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"breaking-changes-4-0-0","dir":"Changelog","previous_headings":"","what":"Breaking Changes","title":"Giotto 4.0.0 (2023/11/29)","text":"Update modular package organization main packages GiottoUtils, GiottoClass, GiottoVisuals, Giotto analytical umbrella package.","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"added-4-0-0","dir":"Changelog","previous_headings":"","what":"Added","title":"Giotto 4.0.0 (2023/11/29)","text":"New File spatial_enrichment_visuals.R New function findCellTypesFromEnrichment() within spatial_enrichment_visuals.R show probable cell types based provided enrichment New function plotCellTypesFromEnrichment() within spatial_enrichment_visuals.R generates bar plot cell types vs frequency based provided enrichment New function pieCellTypesFromEnrichment() within spatial_enrichment_visuals.R generates pie chart cell types based provided enrichment New function addVisiumPolygons() within convenience.R (along requisite internal functions) adds circular polygons centered spatial locations Giotto Object made Visium data. Takes Giotto Object path Visium output file scalefactors_json.json input arguments. Added addVisiumPolygons() createGiottoVisiumObject() workflow. Add cell_ids param calculateHVF() allow calculation HVFs subset cells New function plotInteractive3D() interactive visualization silico creation slices 3D datasets (e.g. MERFISH).","code":""},{"path":[]},{"path":[]},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"breaking-changes-3-3-1","dir":"Changelog","previous_headings":"","what":"Breaking Changes","title":"Giotto 3.3.1 (2023/08/02)","text":"Change checkGiottoEnvironment(). Downgrade error message return FALSE provided directory exist","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"added-3-3-1","dir":"Changelog","previous_headings":"","what":"Added","title":"Giotto 3.3.1 (2023/08/02)","text":"New file poly_influence.R New function showPolygonSizeInfluence() within poly_influence.R show cells switch clusters across resized polygon annotations New function showCellProportionSwitchedPie() within poly_influence.R visualize results showPolygonSizeInfluence() pie chart New function showCellProportionSwitchedSankey() within poly_influence.R visualize results showPolygonSizeInfluence() Sankey diagram New function makePseudoVisium() within giotto_structure.R generate pseudo visium grid circular spots New function tessellate() within giotto_structure.R generate grid hexagons squares spatial binning New file feature_set_enrichment.R New function doFeatureSetEnrichment() within feature_set_enrichment.R GSEA analysis New function doGiottoClustree() within clustering.R visualizations leiden clusters varying resolutions New createArchRProj() CreateGiottoObjectFromArchR() functions create giotto object ATAC epigenetic features using ArchR pipeline. New giottoMasterToSuite() function convert giotto object created master version Giotto suite object. New readPolygonVizgenParquet() updated parquet outputs Add checkmate Imports assertions checking Add exported create function exprObj creation New file spatial_manipulation.R Add ext() methods giottoPolygon, giottoPoints, spatialNetworkObj, spatLocsObj, giottoLargeImage Add flip() methods giottoPolygon, giottoPoints, spatialNetworkObj, spatLocsObj, SpatExtent, giottoLargeImage Add access terra plotting params giottoLargeImage plot() method.","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"changes-3-3-1","dir":"Changelog","previous_headings":"","what":"Changes","title":"Giotto 3.3.1 (2023/08/02)","text":"Fix bug combine_matrices() Fix bug createGiottoObject() allow object creation without supplied expression information Updated polyStamp() replace apply function crossjoin better performance. Updated spatInSituPlotPoints() plot_last parameter. Default output now plots polygons points better visibility. Add check spatLocsObj spatlocs polyStamp() Removed various print() cat() statements throughout. Changed default verbose argument FALSE createGiottoObject Changed default verbose argument FALSE joinGiottoObjects Changed default verbose argument FALSE createGiottoObjectSubcellular Default verbose = FALSE argument added cellProximityEnrichmentSpots Default verbose = FALSE argument added specific_CCCScores_spots Default verbose = FALSE argument added runWNN Default verbose = FALSE argument added subset_giotto_points_object Default verbose = FALSE argument added subset_feature_info_data Default verbose = FALSE argument added subsetGiotto Default verbose = FALSE argument added subsetGiottoLocsSubcellular Default verbose = FALSE argument added createGiottoXeniumObject_subcellular Update readPolygonFilesVizgenHDF5() add option return data.table skip giottoPolygon creation. Downstream giottoPolygon creation refactored new internal function Update cell segmentation workflow check deepcell PIL python packages Update cell segmentation workflow return grayscale mask images instead RGB Update createGiottoVisiumObject() image h5 scalefactors reading use partial matching whether hi lowres image supplied Update giottoLargeImage plot() method use terra::plot() instead terra::plotRGB() grayscale images Remove unnecessary prints subsetGiotto() Fix bug readCellMetadata() readFeatMetadata()","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"breaking-changes-3-3-0","dir":"Changelog","previous_headings":"","what":"Breaking Changes","title":"Giotto 3.3.0 (2023/04/18)","text":"Set Suite default branch Removed deprecated accessors accessors.R set_default_feat_type() error downgraded warning feat_types exist given spat_unit update loadGiotto() saveGiotto() allow using long strings column names spatVector objects 'active_spat_unit' 'active_feat_type' params can set instructions() now used instead ‘giotto.spat_unit’ ‘giotto.feat_type’ global options removed duplicate create_dimObject() internal function. Keeping create_dim_obj()","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"added-3-3-0","dir":"Changelog","previous_headings":"","what":"Added","title":"Giotto 3.3.0 (2023/04/18)","text":"New implementations anndataToGiotto() giottoToAnnData() Nearest Neighbor Spatial Networks New check_py_for_scanpy() function, shifting code around anndataToGiotto() Add initialize() method giotto Add exported create constructor functions Giotto S4 subobjects Add activeSpatUnit() activeFeatType() getting setting active defaults gobject New get_*_list() internal functions retrieving list objects particular class spat_unit feat_type Add instructions() generic giotto access edit giottoInstructions Add centroids() method giottoPolygon get centroid info Add overlaps() generic accessing overlaps slot giottoPolygon Add [ [<* (empty) access generics get data main slots giottoPolygon giottoPoints Add cores detection run package attach. (getOption('giotto.cores')) Add option return giottoPoints getFeatureInfo (default still SpatVector) Add spatVector_to_dt2 internal barebones alternative spatVector_to_dt() Add getRainbowColors() color palette New assign_objnames_2_list() assign_listnames_2_obj() internals passing list names object @name slots vice versa New test_that test_createObject.R script read functions/S4 subobject creation New test_that test_accessors.R script accessor functions New test_that test_gobject.R script gobject consistency checks","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"changes-3-3-0","dir":"Changelog","previous_headings":"","what":"Changes","title":"Giotto 3.3.0 (2023/04/18)","text":"Update installGiottoEnvironment() downstream internal functions allow custom python installation new argument, mini_install_path. Update checkGiottoEnvironment() account custom python installations new argument, mini_install_path. Update removeGiottoEnvironment() account custom python installations new argument, mini_path. Update createGiottoObject() new data ingestion pipeline Modify cell_ID, feat_ID, cell_metadata, feat_metadata slot initialization Update read_expression_data() evaluate_expr_matrix() compatible exprObj Change changeGiottoInstructions() allow addition new params enforce logical class known params Update fix bugs createGiottoCosMxObject() associated polygon placement generation Update plot() giottoPoints faster rasterized plotting option. (Now used default) Fix bug doLouvainCluster() (sub)functions made compatible new Giotto Suite framework. Fix bug gefToGiotto() bin_size arguments. Update loadGiotto() saveGiotto() path.expand expand provided file/directory paths Organize new refactored slot check functions giotto.R checking gobject consistency initialize() Organize new refactored evaluate functions data_evaluation.R data wrangling external data Organize new refactored read functions data_input.R ingesting data converting list Giotto native S4 subobjects Organize dummy documentation dd.R inheriting commonly used documentation Moved create_featureNetwork_object(), create_giotto_points_object(), create_giotto_polygon_object() classes.R Moved depth() giotto.R utilities.R","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"breaking-changes-3-2-0","dir":"Changelog","previous_headings":"","what":"Breaking Changes","title":"Giotto 3.2.0 (2023/02/02)","text":"Removed support deprecated nesting @nn_network slot createSpatialNetwork() now output spatialNetworkObj default return_gobject = FALSE. possible change back data.table output setting output = 'data.table' Set incomplete classes classes.R virtual prevent instantiation Removed createGiottoCosMxObject() aggregate workflows updated","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"added-3-2-0","dir":"Changelog","previous_headings":"","what":"Added","title":"Giotto 3.2.0 (2023/02/02)","text":"New gefToGiotto() interoperability function convert gef object Stereo*seq giotto New giottoToAnnData() interoperability function convert giotto object squidpy flavor anndata .h5ad file(s) New giottoToSpatialExperiment() spatialExperimentToGiotto() convert Giotto SpatialExperiment New spatialAutoCorLocal() spatialAutoCorGlobal() functions find spatial autocorrelations expression cell metadata information New createSpatialWeightMatrix() function generate spatial weight matrix spatial networks autocorrelation Add spatial_interaction_spot.R functions adapted master branch working Giotto suite object. New exported accessors slots (experimental) New multiomics slot giotto Add coord_fix_ratio param spatFeatPlot2D() spatFeatPlot2D_single() Add order parameter dimFeatPlot2D spatDimFeatPlot2d plot order cells according levels selected feature (#477) Add plot() method spatialNetworkObj New set_row_order_dt() internal setting data.table specific row order reference New fread_colmatch() internal fread loading subset rows based matches specified column Add missing create_nn_net_obj() internal constructor function S4 nnNetObj Add id_col, x_col, y_col params polyStamp() make stamp location input flexible Add optional custom_msg params package_check() New wrap() vect() generics giotto, giottoPoints, giottoPolygons New rotate(), t(), spatShift generics giotto subobject spatial manipulation New spatIDs() featIDs() generics New objName() objName generics setting names relevant S4 subobjects New rbind() generic append giottoPolygon objects Add packages exactextractr sf “suggests” packages Add package progressr “imports” packages","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"changes-3-2-0","dir":"Changelog","previous_headings":"","what":"Changes","title":"Giotto 3.2.0 (2023/02/02)","text":"Move giotto object method*specific creation functions giotto.R convenience.R Update addFeatMetadata() handle replacement existing columns Update show() method giotto Update show() method spatEnrObj Deprecate older snake_case accessors Deprecate polygon_feat_names param favor z_indices readPolygonFilesVizgenHDF5() Deprecate xy_translate_spatial_locations() favor shift_spatial_locations() Optimize readPolygonFilesVizgen() Fix bug replaceGiottoInstructions() instructions slots previous allowed Fix bug loadGiotto() prevents proper parsing filenames spat_unit feat_type contains ’_’ characters Fix loadGiotto() loss overallocation data.tablesbased objects loading disk","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"added-3-1-0","dir":"Changelog","previous_headings":"","what":"Added","title":"Giotto 3.1.0 (2022/12/01)","text":"New initialize() generic calls setalloccol() data.table*based S4 subobjects allow setting reference New spatUnit, spatUnit<*, featType, featType<* feat type generics S4 subobjects setting relevant slots Add hexVertices() polygon shape array generation functionality","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"changes-3-1-0","dir":"Changelog","previous_headings":"","what":"Changes","title":"Giotto 3.1.0 (2022/12/01)","text":"Update createGiottoCosMxObject() 3.0 modularization functions. ‘subcellular’ workflow tested work along updated tutorial. Update grid plotting behavior set default number columns use based number elements plot. Can overridden explicitly providing input cow_n_col param Fix bug annotateGiotto() 3.0 update (#433) Fix bug joinGiottoObjects() metadata processing Update seed setting behavior dimension_reduction.R clustering.R","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"added-3-0-1","dir":"Changelog","previous_headings":"","what":"Added","title":"Giotto 3.0.1 (2022/11/20)","text":"New system color support detection (based crayon package logic) Add ability turn colored text show functions options(\"giotto.color_show\" = FALSE)","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"changes-3-0-1","dir":"Changelog","previous_headings":"","what":"Changes","title":"Giotto 3.0.1 (2022/11/20)","text":"Fix bug extract_polygon_list() (#433) Update Unicode character printing show functions Latin1 systems","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"breaking-changes-3-0-0","dir":"Changelog","previous_headings":"","what":"Breaking Changes","title":"Giotto 3.0.0 (2022/11/18)","text":"S4 subobjects framework require giotto objects remade","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"added-3-0-0","dir":"Changelog","previous_headings":"","what":"Added","title":"Giotto 3.0.0 (2022/11/18)","text":"New createGiottoXeniumObject() loading 10x Xenium data New S4 subobjects. Details can found classes.R New basic generics S4 subobjects. Mainly use [] []<* get set information main data slot New @provenance slot S4 subobjects track provenance aggregated information (z_layers used example) New calculateOverlapPolygonImages() calculating overlapped intensities image*based information (e.g. IMC, , MIBI, …) polygon data (e.g. cell) New overlapImagesToMatrix() converts intensity*polygon overlap info expression matrix (e.g. cell protein) New aggregateStacks() set functions work multiple subcellular layers generating aggregated expression matrices","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"changes-3-0-0","dir":"Changelog","previous_headings":"","what":"Changes","title":"Giotto 3.0.0 (2022/11/18)","text":"Update setter functions read @spat_unit @feat_type slots subobjects determine nesting Update show functions display color coded nesting names tree structure","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"breaking-changes-2-1-0","dir":"Changelog","previous_headings":"","what":"Breaking Changes","title":"Giotto 2.1.0 (2022/11/09)","text":"Update python version 3.10.2 details","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"added-2-1-0","dir":"Changelog","previous_headings":"","what":"Added","title":"Giotto 2.1.0 (2022/11/09)","text":"New anndataToGiotto() convert scanpy anndata Giotto","code":""},{"path":[]},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"added-2-0-0-998","dir":"Changelog","previous_headings":"","what":"Added","title":"Giotto 2.0.0.998","text":"Stores minidatasets: preprocessed giotto objects ready used function Moved: getSpatialDataset() loadGiottoMini() functions package saves Giotto object folder using specific structure. Essentially wrapper around saveRDS() also works spatVector spatRaster pointers. New plotInteractivePolygon() plot*interactive polygonal selection points. New polygon shape array creation polyStamp(), circleVertices, rectVertices. giotto_structures.R Add accessor functions get_CellMetadata (alias pDataDT()), set_CellMetadata, get_FeatMetadata (alias fDataDT()), set_FeatMetadata. See accessors.R New filterDistributions() generate histogram plots expression statistics","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"changes-2-0-0-998","dir":"Changelog","previous_headings":"","what":"Changes","title":"Giotto 2.0.0.998","text":"Deprecate plotInteractionChangedGenes() ,plotICG(), plotCPG() favor plotInteractionChangedFeatures() plotICF() plotCPF() Deprecate plotCellProximityGenes(), favor plotCellProximityFeatures() Deprecate plotCombineInteractionChangedGenes(), plotCombineICG(), plotCombineCPG() favor plotCombineInteractionChangedFeatures() plotCombineICF() Deprecate findInteractionChangedGenes(), findICG(), findCPG() favor findInteractionChangedFeats() findICF Deprecate filterInteractionChangedGenes(), filterICG(), filterCPG() favor filterInteractionChangedFeats() filterICF() Deprecate combineInteractionChangedGenes(), combineICG(), combineCPG() favor combineInteractionChangedFeats() combineICF() Deprecate combineCellProximityGenes_per_interaction() favor combineCellProximityFeatures_per_interaction()","code":""},{"path":"https://drieslab.github.io/Giotto/news/index.html","id":"breaking-changes-2-0-0-998","dir":"Changelog","previous_headings":"","what":"Breaking Changes","title":"Giotto 2.0.0.998","text":"ICF output internal object structure names changed use feats instead genes","code":""}]
